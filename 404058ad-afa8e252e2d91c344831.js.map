{"version":3,"sources":["webpack:///../node_modules/@cosmotech/core/dist/index.esm.js"],"names":["_createForOfIteratorHelper2","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray2","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray2","length","i","F","s","done","value","e","_e4","f","TypeError","err","normalCompletion","didErr","step","next","_e5","return","arr","len","arr2","commonjsGlobal","globalThis","window","global","self","dist","CSV","Parser$1","defineProperty","Parser","input","comma","quote","this","pointer","linePointer","residueChars","_residueRegExp","RegExp","_simpleValueRegExp","_replaceQuoteRegExp","File","output","rows","tempointer","row","Row","pop","push","EOF","headers_1","shift","map","reduce","data","k","Value","Comma","LineBreak","residue","Residue","quotedvalue","QuotedValue","replace","simplevalue","SimpleValue","charAt","index","search","searchIndex","_extendStatics","Streamer$1","__extends","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__","create","stream_1","CSV_1","Parser_1$1","Streamer","_super","options","_this","readableObjectMode","writableObjectMode","buffer","sep","separator","quo","_transform","chunk","_encoding","callback","concat","undefined","detect","csv","forEach","_flush","Transform","Parser_1","Streamer_1","eol","quoteCharReqex","specialCharReqex","_quoteIfRquired","includes","_shouldBeQuoted","reducer","item","memo","prependSep","JSON","stringify","_stringifySingleValue","idx","indexOf","prev","cur","read$2","Error","ret","join","loop","key","parse","sepOrOpts","opts","read","r","fields","readAll","readChunk","fetch","exports","createStream","m","__export","has_buf","Buffer","process","versions","node","chr0","___utf16le","ss","String","fromCharCode","__readUInt16LE","__utf16le","isBuffer","___utf8","__readUInt8","__utf8","___lpstr","__readUInt32LE","___cpstr","___lpwstr","___lpp4","___8lpp4","___double","Infinity","NaN","Math","pow","read_double_le","readUInt32LE","readDoubleLE","validator$1","toDate$1","assertString","module","_typeof","obj","default","invalidType","date","_assertString","Date","isNaN","__esModule","toFloat","isFloat$1","alpha$1","commaDecimal","dotDecimal","farsiLocales","arabicLocales","englishLocales","decimal","alphanumeric","alpha","ar","he","fa","locale$1","_locale","_i","_locale2","_i2","_i3","_i4","str","_assertString$a","float","locale","_alpha$2","parseFloat","min","max","lt","gt","locales","locales$5","keys","_isFloat","_interopRequireDefault","toInt","radix","parseInt","toBoolean","strict","equals","comparison","contains","toString$1","merge","arguments","defaults","elem","_merge","defaulContainsOptions","ignoreCase","toLowerCase","split","_toString","minOccurrences","matches","pattern","modifiers","isEmail","isByteLength","encodeURI","isFQDN","default_fqdn_options","allow_trailing_dot","substring","allow_wildcard","parts","tld","require_tld","allow_numeric_tld","every","part","allow_underscores","isIP","version","IPv4AddressRegExp","sort","a","IPv6AddressRegExp","IPv4SegmentFormat","IPv4AddressFormat","IPv6SegmentFormat","default_email_options","require_display_name","allow_display_name","display_email","match","splitNameAddress","display_name","endsWith","substr","display_name_without_quotes","trim","validateDisplayName","ignore_max_length","domain","lower_domain","host_blacklist","user","domain_specific_validation","username","_isByteLength","_user_parts","gmailUserPart","_isFQDN","allow_ip_domain","_isIP","startsWith","noBracketdomain","allow_utf8_local_part","quotedEmailUserUtf8","quotedEmailUser","emailUserUtf8Part","emailUserPart","user_parts","blacklisted_chars","isURL","url","default_url_options","validate_length","allow_fragments","allow_query_components","protocol","auth","host","hostname","port","port_str","ipv6","require_valid_protocol","protocols","require_protocol","allow_protocol_relative_urls","require_host","disallow_auth","_auth$split2","_arrayWithHoles","_arr","_n","_d","_e","_s","_iterableToArrayLimit","_arrayLikeToArray","_unsupportedIterableToArray","_nonIterableRest","_slicedToArray","password","ipv6_match","wrapped_ipv6","require_port","host_whitelist","checkHost","isRegExp","isMACAddress","no_colons","no_separators","macAddressNoSeparators","macAddress","macAddressWithDots","isIPRange","subnetMaybe","isValidIP","expectedSubnet","isDate$2","format","default_date_options","isValidFormat","_step","formatDelimiter","delimiters","find","delimiter","dateDelimiter","strictMode","dateAndFormat","zippedArr","zip","dateObj","_iterator","_e2","_e3","_createForOfIteratorHelper","_step$value","dateWord","formatWord","y","getDate","isFinite","isBoolean","defaultOptions","loose","looseBooleans","strictBooleans","isLocale","localeReg","isAlpha$1","_str","_assertString$9","ignore","_alpha$1","_interopRequireDefault$9","locales$4","isAlphanumeric$1","_assertString$8","_alpha","_interopRequireDefault$8","locales$3","isNumeric","no_symbols","numericNoSymbols","isPassportNumber","countryCode","normalizedStr","toUpperCase","passportRegexByCountryCode","AM","AR","AT","AU","BE","BG","BR","BY","CA","CH","CN","CY","CZ","DE","DK","DZ","EE","ES","FI","FR","GB","GR","HR","HU","IE","IN","ID","IR","IS","IT","JP","KR","LT","LU","LV","LY","MT","MZ","MY","NL","PL","PT","RO","RU","SE","SL","SK","TR","UA","US","isPort","isInt$1","regex","allow_leading_zeroes","int","intLeadingZeroes","minCheckPassed","maxCheckPassed","ltCheckPassed","gtCheckPassed","_isInt","isLowercase","isUppercase","isIMEI","imeiRegex","imeiRegexWithoutHypens","allow_hyphens","imeiRegexWithHypens","sum","mul","digit","tp","isAscii","ascii","isFullWidth$1","_assertString$7","fullWidth","_interopRequireDefault$7","isHalfWidth$1","_assertString$6","halfWidth","_interopRequireDefault$6","isVariableWidth","_isFullWidth","_isHalfWidth","isMultibyte","multibyte","isSemVer","multilineRegex","flags","regexpAsStringLiteral","semanticVersioningRegex","isSurrogatePair","surrogatePair","isDecimal","_default","val","some","arrVal","default_decimal_options","_includes","blacklist","decimal_digits","force_decimal","decimalRegExp","isHexadecimal","hexadecimal","isOctal","octal","isDivisibleBy","num","_toFloat","isHexColor","hexcolor","isRgbColor","includePercentValues","rgbColor","rgbaColor","rgbColorPercent","rgbaColorPercent","isHSL","strippedStr","hslComma","hslSpace","isISRC","isrc","isIBAN$1","_assertString$5","isoCountryCode","ibanRegexThroughCountryCode","hasValidIbanFormat","char","charCodeAt","acc","Number","hasValidIbanChecksum","_interopRequireDefault$5","AD","AE","AL","AZ","BA","BH","CR","DO","EG","FO","GE","GI","GL","GT","IL","IQ","JO","KW","KZ","LB","LC","LI","MC","MD","ME","MK","MR","MU","NO","PK","PS","QA","RS","SA","SC","SI","SM","SV","TL","TN","VA","VG","XK","locales$2","isBIC","isISO31661Alpha2$1","_assertString$4","validISO31661Alpha2CountriesCodes","has","CountryCodes","_interopRequireDefault$4","Set","_isISO31661Alpha","isBICReg","isMD5","md5","isHash","algorithm","lengths","md4","sha1","sha256","sha384","sha512","ripemd128","ripemd160","tiger128","tiger160","tiger192","crc32","crc32b","isJWT","isBase64","defaultBase64Options","urlSafe","urlSafeBase64","notBase64","firstPaddingChar","dotSplit","currElem","_isBase","isJSON","default_json_options","primitives","allow_primitives","isEmpty","default_is_empty_options","ignore_whitespace","isLength","surrogatePairs","isUUID","uuid","1","2","3","4","5","all","isMongoId","_isHexadecimal","isAfter","_toDate","original","isBefore","isIn","array","isCreditCard","sanitized","creditCard","tmpNum","shouldDouble","isIdentityCard","validators","validator","weightOfDigits","6","7","8","9","10","11","modulo","lastDigit","charsValue","X","Y","Z","number","c","reverse","lastNumber","k1","k2","TH","LK","incNum","id","idCardNo","provincesAndCities","powers","parityBit","checkAddressCode","addressCode","checkBirthDayCode","birDayCode","yyyy","mm","dd","xdata","getFullYear","getMonth","checkParityBit","id17","power","getParityBit","check","check15IdCardNo","check18IdCardNo","ALPHABET_CODES","A","B","C","D","E","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","code","floor","isEAN","actualCheckDigit","validEanRegex","ean","remainder","getPositionWeightThroughLengthAndIndex","partialSum","isISIN","isin","double","lo","hi","trunc","_digit","isISBN","checksum","isbn10Maybe","isbn13Maybe","factor","isISSN","testIssn","issn","require_hyphen","case_sensitive","digits","isTaxID","algorithms","iso7064Check","checkvalue","luhnCheck","second","product","reverseMultiplyAndSum","base","total","verhoeffCheck","d_table","p_table","str_copy","strcopy","taxIdFormat","sanitizeRegexes","taxIdCheck","algorithms$1","cache","_getRequireWildcardCache","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","desc","set","_interopRequireWildcard","_isDate","WeakMap","_toConsumableArray","_arrayWithoutHoles","iter","_iterableToArray","_nonIterableSpread","enUsCampusPrefix","andover","atlanta","austin","brookhaven","cincinnati","fresno","internet","kansas","memphis","ogden","philadelphia","sba","itItNameCheck","vowelflag","xflag","tin","century_year","month","multip_lookup","full_year","checkdigit","occurences","j","filter","trip_locations","recurrent","year","weight","prefixes","location","apply","enUsGetPrefixes","chars","lead_replace","splice","unshift","checkdigits","number_replace","_number_locations","day","_i5","char_to_int","odd_convert","0","_i6","_char_to_int","multiplier","first_part","lookup","_checksum","_i7","_sum","_i8","identifiers","verificators","pos","_i9","result","_i10","multipliers","tin_copy","current_year","current_century","allsymbols","isMobilePhone$1","_assertString$3","phones","_interopRequireDefault$3","locales$1","isEthereumAddress","eth","isCurrency","digits_after_decimal","symbol","require_symbol","whole_dollar_amount_with_sep","thousands_separator","whole_dollar_amount","decimal_amount","decimal_separator","require_decimal","allow_decimal","allow_negatives","parens_for_negatives","negative_sign_after_digits","negative_sign_before_digits","allow_negative_sign_placeholder","allow_space_after_symbol","allow_space_after_digits","symbol_after_digits","currencyRegex","default_currency_options","isBtcAddress","bech32","base58","isISO8601","strictSeparator","iso8601StrictSeparator","iso8601","isValidDate","ordinalMatch","oYear","oDay","monthString","dayString","getUTCFullYear","getUTCMonth","getUTCDate","isRFC3339","rfc3339","timeHour","timeMinute","timeNumOffset","source","timeOffset","partialTime","fullDate","fullTime","isISO31661Alpha3","validISO31661Alpha3CountriesCodes","isISO4217$1","_assertString$2","validISO4217CurrencyCodes","CurrencyCodes","_interopRequireDefault$2","isBase32","base32","isBase58","base58Reg","isDataURI","attributes","schemeAndMediaType","mediaType","validMediaType","validAttribute","validData","isMagnetURI","magnetURI","isMimeType","mimeTypeSimple","mimeTypeText","mimeTypeMultipart","isLatLong","defaultLatLongOptions","pair","checkDMS","latDMS","longDMS","lat","long","isPostalCode$1","_assertString$1","patterns","_interopRequireDefault$1","fourDigit","fiveDigit","sixDigit","HT","KE","MX","NP","NZ","PR","SG","TW","ZA","ZM","ltrim","rtrim","strIndex","_rtrim","_ltrim","_escape","_unescape","stripLow","keep_new_lines","_blacklist","whitelist","isWhitelisted","normalizeEmail","email","default_normalize_email_options","raw_parts","gmail_remove_subaddress","gmail_remove_dots","dotsReplacer","all_lowercase","gmail_lowercase","gmail_convert_googlemaildotcom","icloud_domains","icloud_remove_subaddress","icloud_lowercase","outlookdotcom_domains","outlookdotcom_remove_subaddress","outlookdotcom_lowercase","yahoo_domains","yahoo_remove_subaddress","components","yahoo_lowercase","yandex_domains","yandex_lowercase","isSlug","charsetRegex","isLicensePlate","isStrongPassword","analysis","analyzePassword","returnScore","scorePassword","minLength","lowercaseCount","minLowercase","uppercaseCount","minUppercase","numberCount","minNumbers","symbolCount","minSymbols","upperCaseRegex","lowerCaseRegex","numberRegex","symbolRegex","pointsPerUnique","pointsPerRepeat","pointsForContainingLower","pointsForContainingUpper","pointsForContainingNumber","pointsForContainingSymbol","charMap","uniqueChars","scoringOptions","points","isVAT$1","vatMatchers","_toInt","_toBoolean","_equals","_contains","_matches","_isEmail","_isURL","_isMACAddress","_isIPRange","_isBoolean","_isLocale","_isAlpha","_isAlphanumeric","_isNumeric","_isPassportNumber","_isPort","_isLowercase","_isUppercase","_isIMEI","_isAscii","_isVariableWidth","_isMultibyte","_isSemVer","_isSurrogatePair","_isDecimal","_isOctal","_isDivisibleBy","_isHexColor","_isRgbColor","_isHSL","_isISRC","_isIBAN","_isBIC","_isMD","_isHash","_isJWT","_isJSON","_isEmpty","_isLength","_isUUID","_isMongoId","_isAfter","_isBefore","_isIn","_isCreditCard","_isIdentityCard","_isEAN","_isISIN","_isISBN","_isISSN","_isTaxID","_isMobilePhone","_isEthereumAddress","_isCurrency","_isBtcAddress","_isISO","_isRFC","_isISO31661Alpha2","_isISO2","_isBase2","_isBase3","_isDataURI","_isMagnetURI","_isMimeType","_isLatLong","_isPostalCode","_trim","_escape$1","_unescape$1","_stripLow","_whitelist","_isWhitelisted","_normalizeEmail","_isSlug","_isLicensePlate","_isStrongPassword","_isVAT","toDate","isIBAN","isAlpha","isAlphaLocales","isAlphanumeric","isAlphanumericLocales","isFullWidth","isHalfWidth","isInt","isFloat","isFloatLocales","isMobilePhone","isMobilePhoneLocales","isPostalCode","isPostalCodeLocales","isISO31661Alpha2","isISO4217","escape","unescape","isDate","isVAT","ibanLocales","toInteger","dirtyNumber","ceil","requiredArgs","required","args","argument","argStr","getTime","console","warn","stack","addMilliseconds","dirtyDate","dirtyAmount","timestamp","amount","getTimezoneOffsetInMilliseconds","utcDate","UTC","getHours","getMinutes","getSeconds","getMilliseconds","setUTCFullYear","isDate$1","isValid$2","formatDistanceLocale","lessThanXSeconds","one","other","xSeconds","halfAMinute","lessThanXMinutes","xMinutes","aboutXHours","xHours","xDays","aboutXWeeks","xWeeks","aboutXMonths","xMonths","aboutXYears","xYears","overXYears","almostXYears","formatDistance$1","token","count","tokenValue","addSuffix","buildFormatLongFn","width","defaultWidth","formats","formatLong","full","medium","short","time","dateTime","formatRelativeLocale","lastWeek","yesterday","today","tomorrow","nextWeek","buildLocalizeFn","dirtyIndex","dirtyOptions","valuesArray","context","formattingValues","defaultFormattingWidth","_defaultWidth","_width","values","argumentCallback","buildMatchFn","string","matchPattern","matchPatterns","defaultMatchWidth","matchResult","matchedString","parsePatterns","defaultParseWidth","findIndex","findKey","valueCallback","rest","object","predicate","defaultLocale","formatDistance","formatRelative","_date","_baseDate","_options","localize","ordinalNumber","rem100","era","narrow","abbreviated","wide","quarter","dayPeriod","am","pm","midnight","noon","morning","afternoon","evening","night","parsePattern","parseResult","any","weekStartsOn","firstWeekContainsDate","subMilliseconds","startOfUTCISOWeek","getUTCDay","diff","setUTCDate","setUTCHours","getUTCISOWeekYear","fourthOfJanuaryOfNextYear","startOfNextYear","fourthOfJanuaryOfThisYear","startOfThisYear","startOfUTCISOWeekYear","fourthOfJanuary","getUTCISOWeek","round","startOfUTCWeek","localeWeekStartsOn","defaultWeekStartsOn","RangeError","getUTCWeekYear","localeFirstWeekContainsDate","defaultFirstWeekContainsDate","firstWeekOfNextYear","firstWeekOfThisYear","startOfUTCWeekYear","firstWeek","getUTCWeek","addLeadingZeros","targetLength","sign","abs","formatters$3","signedYear","dayPeriodEnumValue","getUTCHours","h","getUTCMinutes","getUTCSeconds","numberOfDigits","milliseconds","getUTCMilliseconds","dayPeriodEnum","formatTimezoneShort","offset","dirtyDelimiter","absOffset","hours","minutes","formatTimezoneWithOptionalMinutes","formatTimezone","formatters$1","unit","signedWeekYear","weekYear","u","q","w","week","isoWeek","dayOfYear","setUTCMonth","startOfYearTimestamp","difference","getUTCDayOfYear","dayOfWeek","localDayOfWeek","isoDayOfWeek","_localize","timezoneOffset","_originalDate","getTimezoneOffset","x","z","t","originalDate","dateLongFormatter","timeLongFormatter","longFormatters$1","dateTimeFormat","datePattern","timePattern","protectedDayOfYearTokens","protectedWeekYearTokens","isProtectedDayOfYearToken","isProtectedWeekYearToken","throwProtectedError","formattingTokensRegExp$1","longFormattingTokensRegExp$1","escapedStringRegExp$1","doubleQuoteRegExp$1","unescapedLatinCharacterRegExp$1","format$1","dirtyFormatStr","formatStr","formatterOptions","firstCharacter","longFormatter","cleanEscapedString$1","formatter","useAdditionalWeekYearTokens","useAdditionalDayOfYearTokens","assign","target","dirtyObject","property","setUTCDay","dirtyDay","currentDay","dayIndex","numericPatterns","timezonePatterns","parseNumericPattern","parseTimezonePattern","parseAnyDigitsSigned","parseNDigits","parseNDigitsSigned","dayPeriodEnumToHours","enumValue","normalizeTwoDigitYear","twoDigitYear","currentYear","isCommonEra","absCurrentYear","rangeEnd","DAYS_IN_MONTH","DAYS_IN_MONTH_LEAP_YEAR","isLeapYearIndex","parsers$1","priority","incompatibleTokens","isTwoDigitYear","validate","normalizedTwoDigitYear","_match","_flags","firstWeekOfYear","dirtyWeek","setUTCWeek","dirtyISOWeek","setUTCISOWeek","subPriority","isLeapYear","wholeWeekDays","setUTCISODay","isPM","setUTCMinutes","setUTCSeconds","setUTCMilliseconds","timestampIsSet","_token","formattingTokensRegExp","longFormattingTokensRegExp","escapedStringRegExp","doubleQuoteRegExp","notWhitespaceRegExp","unescapedLatinCharacterRegExp","parse$1","dirtyDateString","dirtyFormatString","dirtyReferenceDate","dateString","formatString","subFnOptions","setters","dateToSystemTimezone","tokens","usedTokens","parser","incompatibleToken","usedToken","fullToken","cleanEscapedString","uniquePrioritySetters","setter","setterArray","convertedDate","setFullYear","setHours","dateStr","dateFormat","error","DateUtils","isValid","isMatch","dateA","dateB","strMin","dateStrA","dateStrB","strMax","DatasetUtils","getDatasetNames","datasets","scenarioDatasets","_step2","names","_loop","datasetId","dataset","el","_iterator2","ScenarioUtils","scenarioExistsInList","scenarioName","scenarioList","scenario","scenarioExistsInTree","scenarioTree","treeSearch","_step3","_iterator3","children","getScenarioTree","compareFn","_step5","parentScenario","parentId","grandParent","_step4","_iterator4","childScenario","_iterator5","countScenariosInTree","treeData","_step6","_iterator6"],"mappings":"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","file":"404058ad-afa8e252e2d91c344831.js","sourcesContent":["import _classCallCheck from \"/home/runner/work/webapp-component-ui/webapp-component-ui/doc/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/runner/work/webapp-component-ui/webapp-component-ui/doc/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n\nfunction _createForOfIteratorHelper2(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray2(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e4) { throw _e4; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e5) { didErr = true; err = _e5; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray2(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray2(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray2(o, minLen); }\n\nfunction _arrayLikeToArray2(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport _regeneratorRuntime from \"/home/runner/work/webapp-component-ui/webapp-component-ui/doc/node_modules/@babel/runtime/regenerator/index.js\";\nimport \"core-js/modules/esnext.global-this.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport require$$0 from 'stream';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction getDefaultExportFromCjs(x) {\n  return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nvar dist = {};\nvar CSV = {};\nvar Parser$1 = {};\n/*\nfile:         row + EOF;\nrow:          value (Comma value)* (LineBreak | EOF);\nvalue:        SimpleValue | QuotedValue;\nComma:        ',';\nLineBreak:    '\\r'?'\\n' | '\\r';\nSimpleValue:  ~(',' | '\\r' | '\\n' | '\"')+;\nQuotedValue:  Residue '\"' ('\"\"' | ~'\"')* '\"' Residue;\nResidue:      (' ' | '\\t' | '\\f')*\n*/\n\nObject.defineProperty(Parser$1, \"__esModule\", {\n  value: true\n});\n\nvar Parser =\n/** @class */\nfunction () {\n  function Parser(input, comma, quote) {\n    if (!(this instanceof Parser)) {\n      return new Parser(input, comma);\n    }\n\n    this.input = input;\n    this.pointer = 0;\n    this.linePointer = 0;\n    this.comma = comma && comma[0] || ',';\n    this.quote = quote && quote[0] || '\"'; // initialize RegExp Object\n\n    var residueChars = \" \\f\\x0B\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\";\n\n    if (this.comma !== '\\t') {\n      residueChars += '\\t';\n    }\n\n    this._residueRegExp = new RegExp(\"[^\" + residueChars + \"]\"); // TODO: `(${this.comma}|\\r\\n)` instead?\n\n    this._simpleValueRegExp = new RegExp(\"[\" + this.comma + \"\\r\\n]\");\n    this._replaceQuoteRegExp = new RegExp(this.quote + this.quote, 'g');\n  }\n\n  Parser.prototype.File = function (output) {\n    var rows = [];\n\n    while (true) {\n      var tempointer = this.pointer;\n      var row = this.Row();\n\n      if (row.length > 0) {\n        this.linePointer = tempointer;\n        rows.push(row);\n      } else {\n        if (this.linePointer && this.pointer !== this.input.length) {\n          rows.pop();\n          this.pointer = this.linePointer;\n        }\n\n        break;\n      }\n\n      if (this.EOF()) {\n        if (this.linePointer && this.pointer !== this.input.length) {\n          rows.pop();\n          this.pointer = this.linePointer;\n        }\n\n        break;\n      }\n    }\n\n    if (output && output === \"objects\") {\n      if (rows.length === 0) {\n        return [];\n      }\n\n      var headers_1 = rows.shift();\n      return rows.map(function (row) {\n        return headers_1.reduce(function (data, k, i) {\n          data[k] = row[i];\n          return data;\n        }, {});\n      });\n    } else {\n      return rows;\n    }\n  };\n\n  Parser.prototype.Row = function () {\n    var row = [];\n\n    while (true) {\n      row.push(this.Value());\n\n      if (this.Comma()) {\n        continue;\n      }\n\n      if (this.LineBreak() || this.EOF()) {\n        return row;\n      } else {\n        row.pop();\n        return row;\n      }\n    }\n  };\n\n  Parser.prototype.Value = function () {\n    var residue = this.Residue();\n    var quotedvalue = this.QuotedValue();\n\n    if (quotedvalue) {\n      var value = quotedvalue.slice(1, -1).replace(this._replaceQuoteRegExp, this.quote);\n      this.Residue();\n      return value;\n    }\n\n    var simplevalue = this.SimpleValue();\n\n    if (simplevalue) {\n      return residue ? residue + simplevalue : simplevalue;\n    }\n\n    return '';\n  };\n\n  Parser.prototype.Comma = function () {\n    if (this.input.slice(this.pointer, this.pointer + this.comma.length) === this.comma) {\n      this.pointer += this.comma.length;\n      return this.comma;\n    }\n  };\n\n  Parser.prototype.LineBreak = function () {\n    if (this.input.slice(this.pointer, this.pointer + 2) === '\\r\\n') {\n      this.pointer += 2;\n      return '\\r\\n';\n    }\n\n    if (this.input.charAt(this.pointer) === '\\n') {\n      this.pointer += 1;\n      return '\\n';\n    }\n\n    if (this.input.charAt(this.pointer) === '\\r') {\n      this.pointer += 1;\n      return '\\r';\n    }\n  };\n\n  Parser.prototype.SimpleValue = function () {\n    var value = '';\n    var index = this.input.slice(this.pointer).search(this._simpleValueRegExp);\n\n    if (this.input.charAt(this.pointer) === this.quote) {\n      return;\n    } else if (index === -1) {\n      value = this.input.slice(this.pointer);\n    } else if (index === 0) {\n      return;\n    } else {\n      value = this.input.slice(this.pointer, this.pointer + index);\n    }\n\n    this.pointer += value.length;\n    return value;\n  };\n\n  Parser.prototype.QuotedValue = function () {\n    if (this.input.charAt(this.pointer) === this.quote) {\n      var searchIndex = void 0;\n      var index = 1;\n\n      while (true) {\n        searchIndex = this.input.slice(this.pointer + index).search(this.quote);\n\n        if (searchIndex === -1) {\n          return;\n        }\n\n        if (this.input.charAt(this.pointer + index + searchIndex + 1) === this.quote) {\n          index += searchIndex + 2;\n          continue;\n        }\n\n        var value = this.input.slice(this.pointer, this.pointer + index + searchIndex + 1);\n        this.pointer += value.length;\n        return value;\n      }\n    }\n  };\n\n  Parser.prototype.EOF = function () {\n    return this.pointer >= this.input.length;\n  };\n\n  Parser.prototype.Residue = function () {\n    var value = '';\n    var index = this.input.slice(this.pointer).search(this._residueRegExp);\n\n    if (index === -1) {\n      value = this.input.slice(this.pointer);\n    } else if (index === 0) {\n      return '';\n    } else {\n      value = this.input.slice(this.pointer, this.pointer + index);\n    }\n\n    this.pointer += value.length;\n    return value;\n  };\n\n  return Parser;\n}();\n\nParser$1.Parser = Parser;\nvar Streamer$1 = {};\n\nvar __extends = commonjsGlobal && commonjsGlobal.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(Streamer$1, \"__esModule\", {\n  value: true\n});\nvar stream_1 = require$$0;\nvar CSV_1 = CSV;\nvar Parser_1$1 = Parser$1;\n\nvar Streamer =\n/** @class */\nfunction (_super) {\n  __extends(Streamer, _super);\n\n  function Streamer(options) {\n    var _this = _super.call(this, {\n      readableObjectMode: true,\n      writableObjectMode: false\n    }) || this; // Transform.call(this, );\n\n\n    _this.buffer = '';\n    _this.sep = options && options.separator;\n    _this.quo = options && options.quote;\n    return _this;\n  } // overridden function with same signature\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n  Streamer.prototype._transform = function (chunk, _encoding, callback) {\n    var _this = this;\n\n    this.buffer = this.buffer.concat(chunk.toString());\n\n    if (this.sep === undefined) {\n      // try to detect the separator if not provided\n      this.sep = CSV_1.detect(this.buffer);\n    }\n\n    var csv = new Parser_1$1.Parser(this.buffer, this.sep, this.quo);\n    var rows = csv.File();\n\n    if (csv.linePointer !== csv.pointer) {\n      rows.pop();\n    }\n\n    this.buffer = this.buffer.slice(csv.linePointer);\n\n    if (rows.length > 0) {\n      rows.forEach(function (row) {\n        _this.push(row);\n      });\n    }\n\n    callback();\n  }; // TODO\n\n  /*\n  push(chunk: any, encoding?: string | undefined): boolean {\n    throw new Error(\"Method not implemented.\");\n  }\n  */\n\n\n  Streamer.prototype._flush = function (callback) {\n    var _this = this;\n\n    var csv = new Parser_1$1.Parser(this.buffer, this.sep, this.quo);\n    var rows = csv.File();\n\n    if (rows.length > 0) {\n      rows.forEach(function (row) {\n        _this.push(row);\n      });\n    }\n\n    callback();\n  };\n\n  return Streamer;\n}(stream_1.Transform);\n\nStreamer$1.Streamer = Streamer;\nObject.defineProperty(CSV, \"__esModule\", {\n  value: true\n});\nvar Parser_1 = Parser$1;\nvar Streamer_1 = Streamer$1;\nvar EOL = '\\r\\n';\nCSV.eol = EOL;\nvar SEPARATOR = ',';\nCSV.separator = SEPARATOR;\nvar quoteCharReqex = new RegExp('\"', 'g');\nvar specialCharReqex = new RegExp('[\"\\r\\n]', 'g');\n\nvar _shouldBeQuoted = function _shouldBeQuoted(value, sep) {\n  return value.search(specialCharReqex) >= 0 || value.includes(sep);\n};\n\nvar _quoteIfRquired = function _quoteIfRquired(value, sep) {\n  return _shouldBeQuoted(value, sep) ? '\"' + value.replace(quoteCharReqex, '\"\"') + '\"' : value;\n};\n\nvar _stringifySingleValue = function _stringifySingleValue(item) {\n  if (item === 0) {\n    item = '0';\n  } else if (item === undefined || item === null) {\n    item = '';\n  }\n\n  if (typeof item != 'string') {\n    var s = item.toString();\n\n    if (s == '[object Object]') {\n      item = JSON.stringify(item);\n\n      if (item == '{}') {\n        item = '';\n      }\n    } else {\n      item = s;\n    }\n  }\n\n  return item;\n};\n\nvar reducer = function reducer(item, memo, sep, prependSep) {\n  item = _stringifySingleValue(item);\n  return (memo !== undefined || prependSep ? \"\" + memo + sep : '') + _quoteIfRquired(item, sep);\n};\n\nvar detect = function detect(input) {\n  var separators = [',', ';', '|', '\\t'];\n  var idx = separators.map(function (separator) {\n    return input.indexOf(separator);\n  }).reduce(function (prev, cur) {\n    return prev === -1 || cur !== -1 && cur < prev ? cur : prev;\n  });\n  return input[idx] || ',';\n};\n\nCSV.detect = detect;\n\nvar stringify = function stringify(input, sep) {\n  if (sep === void 0) {\n    sep = SEPARATOR;\n  }\n\n  var ret;\n  sep = sep || SEPARATOR;\n\n  if (Array.isArray(input)) {\n    if (input.length === 0) {\n      ret = EOL;\n    } else if (!Array.isArray(input[0])) {\n      for (var loop = 0; loop < input.length; loop++) {\n        ret = reducer(input[loop], ret, sep, loop > 0);\n      }\n\n      ret += EOL;\n    } else if (Array.isArray(input[0])) {\n      ret = input.map(function (item) {\n        return stringify(item, sep);\n      }).join('');\n    }\n  } else if (typeof input == 'object') {\n    for (var key in input) {\n      if (input.hasOwnProperty(key)) {\n        ret = reducer(input[key], ret, sep);\n      }\n    }\n\n    ret += EOL;\n  } else {\n    ret = reducer(input, ret, sep) + EOL;\n  }\n\n  return ret;\n};\n\nCSV.stringify = stringify;\n\nfunction parse$2(input, sepOrOpts, quo) {\n  // Create an options hash, using positional parameters or the passed in options hash for values\n  var opts = typeof sepOrOpts === \"object\" ? sepOrOpts : {};\n\n  if (typeof sepOrOpts === \"string\") {\n    opts.comma = sepOrOpts;\n  }\n\n  if (quo) {\n    opts.quote = quo;\n  } // try to detect the separator if not provided\n\n\n  if (opts.comma === undefined) {\n    opts.comma = detect(input);\n  } // Clean characters, if necessary\n  // TODO: We should probably throw an error here to signal bad input to the user\n\n\n  if (opts.comma) {\n    opts.comma = opts.comma[0];\n  }\n\n  if (opts.quote) {\n    opts.quote = opts.quote[0];\n  }\n\n  var csv = new Parser_1.Parser(input, opts.comma, opts.quote);\n  return csv.File(opts.output);\n}\n\nCSV.parse = parse$2;\n\nfunction read$2(input, sep, quo, callback) {\n  if (callback === undefined) {\n    if (quo === undefined) {\n      // arguments.length < 3) {\n      if (typeof sep !== 'function') {\n        throw Error('Last/second argument is not a callback');\n      }\n\n      callback = sep;\n      sep = ',';\n    } else {\n      // arguments.length < 4) {\n      if (typeof quo !== 'function') {\n        throw Error('Last/third argument is not a callback');\n      }\n\n      callback = quo;\n      quo = '\"';\n    }\n  }\n\n  var csv = new Parser_1.Parser(input, sep, quo);\n  var fields = csv.Row();\n  callback(fields);\n  return csv.pointer;\n}\n\nCSV.read = read$2;\n\nfunction forEach(input, sep, quo, callback) {\n  if (callback === undefined) {\n    if (quo === undefined) {\n      // arguments.length < 3) {\n      if (typeof sep !== 'function') {\n        throw Error('Last/second argument is not a callback');\n      }\n\n      callback = sep;\n      sep = ',';\n    } else {\n      // arguments.length < 4) {\n      if (typeof quo !== 'function') {\n        throw Error('Last/third argument is not a callback');\n      }\n\n      callback = quo;\n      quo = '\"';\n    }\n  }\n\n  var i = 0;\n  var s = 0;\n  var r;\n\n  while (r = read$2(input.slice(s), sep, quo, function (fields) {\n    return callback(fields, i++);\n  })) {\n    s += r;\n  }\n}\n\nCSV.forEach = forEach;\n\nfunction readAll(input, sep, quo, callback) {\n  if (callback === undefined) {\n    if (quo === undefined) {\n      // arguments.length < 3) {\n      if (typeof sep !== 'function') {\n        throw Error('Last/second argument is not a callback');\n      }\n\n      callback = sep;\n      sep = ',';\n    } else {\n      // arguments.length < 4) {\n      if (typeof quo !== 'function') {\n        throw Error('Last/third argument is not a callback');\n      }\n\n      callback = quo;\n      quo = '\"';\n    }\n  }\n\n  var csv = new Parser_1.Parser(input, sep, quo);\n  var rows = csv.File();\n  callback(rows);\n  return csv.pointer;\n}\n\nCSV.readAll = readAll;\n\nfunction readChunk(input, sep, quo, callback) {\n  if (callback === undefined) {\n    if (quo === undefined) {\n      // arguments.length < 3) {\n      if (typeof sep !== 'function') {\n        throw Error('Last/second argument is not a callback');\n      }\n\n      callback = sep;\n      sep = ',';\n    } else {\n      // arguments.length < 4) {\n      if (typeof quo !== 'function') {\n        throw Error('Last/third argument is not a callback');\n      }\n\n      callback = quo;\n      quo = '\"';\n    }\n  }\n\n  var csv = new Parser_1.Parser(input, sep, quo);\n  var rows = csv.File();\n  var ret = 0;\n\n  if (csv.pointer < input.length) {\n    ret = csv.pointer;\n  } else {\n    rows.pop();\n    ret = csv.linePointer;\n  }\n\n  callback(rows);\n  return ret;\n}\n\nCSV.readChunk = readChunk;\n\nvar fetch = function fetch(input, sep, quo) {\n  // TODO\n  var output;\n  read$2(input, sep, quo, function (fields) {\n    output = fields;\n  });\n  return output;\n};\n\nCSV.fetch = fetch;\n\nvar createStream = function createStream(options) {\n  return new Streamer_1.Streamer(options);\n};\n\nCSV.createStream = createStream;\n\n(function (exports) {\n  function __export(m) {\n    for (var p in m) {\n      if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n  }\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  __export(CSV);\n})(dist); // Copyright (c) Cosmo Tech.\n\n\nvar read$1 = function read$1(dataStr) {\n  return dist.parse(dataStr).map(function (row) {\n    return row.map(function (cell) {\n      return cell.trim();\n    });\n  });\n};\n\nvar write = function write(dataArray) {\n  return dist.stringify(dataArray);\n};\n\nvar CSVUtils = {\n  read: read$1,\n  write: write\n};\n/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\nvar current_ansi = 1252;\nvar VALID_ANSI = [874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\n\nvar CS2CP = {\n  /*::[*/\n  0\n  /*::]*/\n  : 1252,\n\n  /* ANSI */\n\n  /*::[*/\n  1\n  /*::]*/\n  : 65001,\n\n  /* DEFAULT */\n\n  /*::[*/\n  2\n  /*::]*/\n  : 65001,\n\n  /* SYMBOL */\n\n  /*::[*/\n  77\n  /*::]*/\n  : 10000,\n\n  /* MAC */\n\n  /*::[*/\n  128\n  /*::]*/\n  : 932,\n\n  /* SHIFTJIS */\n\n  /*::[*/\n  129\n  /*::]*/\n  : 949,\n\n  /* HANGUL */\n\n  /*::[*/\n  130\n  /*::]*/\n  : 1361,\n\n  /* JOHAB */\n\n  /*::[*/\n  134\n  /*::]*/\n  : 936,\n\n  /* GB2312 */\n\n  /*::[*/\n  136\n  /*::]*/\n  : 950,\n\n  /* CHINESEBIG5 */\n\n  /*::[*/\n  161\n  /*::]*/\n  : 1253,\n\n  /* GREEK */\n\n  /*::[*/\n  162\n  /*::]*/\n  : 1254,\n\n  /* TURKISH */\n\n  /*::[*/\n  163\n  /*::]*/\n  : 1258,\n\n  /* VIETNAMESE */\n\n  /*::[*/\n  177\n  /*::]*/\n  : 1255,\n\n  /* HEBREW */\n\n  /*::[*/\n  178\n  /*::]*/\n  : 1256,\n\n  /* ARABIC */\n\n  /*::[*/\n  186\n  /*::]*/\n  : 1257,\n\n  /* BALTIC */\n\n  /*::[*/\n  204\n  /*::]*/\n  : 1251,\n\n  /* RUSSIAN */\n\n  /*::[*/\n  222\n  /*::]*/\n  : 874,\n\n  /* THAI */\n\n  /*::[*/\n  238\n  /*::]*/\n  : 1250,\n\n  /* EASTEUROPE */\n\n  /*::[*/\n  255\n  /*::]*/\n  : 1252,\n\n  /* OEM */\n\n  /*::[*/\n  69\n  /*::]*/\n  : 6969\n  /* MISC */\n\n}\n/*:any*/\n;\n\nvar set_ansi = function set_ansi(cp\n/*:number*/\n) {\n  if (VALID_ANSI.indexOf(cp) == -1) return;\n  current_ansi = CS2CP[0] = cp;\n};\n\nfunction reset_ansi() {\n  set_ansi(1252);\n}\n\nvar set_cp = function set_cp(cp\n/*:number*/\n) {\n  set_ansi(cp);\n};\n\nfunction reset_cp() {\n  set_cp(1200);\n  reset_ansi();\n}\n\nfunction char_codes(data\n/*:string*/\n)\n/*:Array<number>*/\n{\n  var o\n  /*:Array<number>*/\n  = [];\n\n  for (var i = 0, len = data.length; i < len; ++i) {\n    o[i] = data.charCodeAt(i);\n  }\n\n  return o;\n}\n\nfunction utf16leread(data\n/*:string*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length >> 1; ++i) {\n    o[i] = String.fromCharCode(data.charCodeAt(2 * i) + (data.charCodeAt(2 * i + 1) << 8));\n  }\n\n  return o.join(\"\");\n}\n\nfunction utf16beread(data\n/*:string*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length >> 1; ++i) {\n    o[i] = String.fromCharCode(data.charCodeAt(2 * i + 1) + (data.charCodeAt(2 * i) << 8));\n  }\n\n  return o.join(\"\");\n}\n\nvar debom = function debom(data\n/*:string*/\n)\n/*:string*/\n{\n  var c1 = data.charCodeAt(0),\n      c2 = data.charCodeAt(1);\n  if (c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n  if (c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n  if (c1 == 0xFEFF) return data.slice(1);\n  return data;\n};\n\nvar _getchar = function _gc1(x\n/*:number*/\n)\n/*:string*/\n{\n  return String.fromCharCode(x);\n};\n\nvar _getansi = function _ga1(x\n/*:number*/\n)\n/*:string*/\n{\n  return String.fromCharCode(x);\n};\n\nvar $cptable;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n\n  for (var i = 0; i < input.length;) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n\n  return o;\n}\n\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n  input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n\n  for (var i = 0; i < input.length;) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n\n  return o;\n}\n\nvar has_buf = /*#__PURE__*/function () {\n  return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node;\n}();\n\nvar Buffer_from = /*#__PURE__*/function () {\n  if (typeof Buffer !== 'undefined') {\n    var nbfs = !Buffer.from;\n    if (!nbfs) try {\n      Buffer.from(\"foo\", \"utf8\");\n    } catch (e) {\n      nbfs = true;\n    }\n    return nbfs ? function (buf, enc) {\n      return enc ? new Buffer(buf, enc) : new Buffer(buf);\n    } : Buffer.from.bind(Buffer);\n  }\n\n  return function () {};\n}();\n\nfunction new_raw_buf(len\n/*:number*/\n) {\n  /* jshint -W056 */\n  if (has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n  return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n  /* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len\n/*:number*/\n) {\n  /* jshint -W056 */\n  if (has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n  return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n  /* jshint +W056 */\n}\n\nvar s2a = function s2a(s\n/*:string*/\n)\n/*:any*/\n{\n  if (has_buf) return Buffer_from(s, \"binary\");\n  return s.split(\"\").map(function (x\n  /*:string*/\n  )\n  /*:number*/\n  {\n    return x.charCodeAt(0) & 0xff;\n  });\n};\n\nfunction a2s(data\n/*:any*/\n)\n/*:string*/\n{\n  if (Array.isArray(data)) return data.map(function (c) {\n    return String.fromCharCode(c);\n  }).join(\"\");\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length; ++i) {\n    o[i] = String.fromCharCode(data[i]);\n  }\n\n  return o.join(\"\");\n}\n\nfunction ab2a(data\n/*:ArrayBuffer|Uint8Array*/\n)\n/*:Array<number>*/\n{\n  if (typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n  if (data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\n  /*:: if(data instanceof ArrayBuffer) throw new Error(\"unreachable\"); */\n\n  var o = new Array(data.length);\n\n  for (var i = 0; i < data.length; ++i) {\n    o[i] = data[i];\n  }\n\n  return o;\n}\n\nvar bconcat = has_buf ? function (bufs) {\n  return Buffer.concat(bufs.map(function (buf) {\n    return Buffer.isBuffer(buf) ? buf : Buffer_from(buf);\n  }));\n} : function (bufs) {\n  if (typeof Uint8Array !== \"undefined\") {\n    var i = 0,\n        maxlen = 0;\n\n    for (i = 0; i < bufs.length; ++i) {\n      maxlen += bufs[i].length;\n    }\n\n    var o = new Uint8Array(maxlen);\n    var len = 0;\n\n    for (i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n      len = bufs[i].length;\n      if (bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);else if (typeof bufs[i] == \"string\") {\n        throw \"wtf\";\n      } else o.set(new Uint8Array(bufs[i]), maxlen);\n    }\n\n    return o;\n  }\n\n  return [].concat.apply([], bufs.map(function (buf) {\n    return Array.isArray(buf) ? buf : [].slice.call(buf);\n  }));\n};\n\nfunction utf8decode(content\n/*:string*/\n) {\n  var out = [],\n      widx = 0,\n      L = content.length + 250;\n  var o = new_raw_buf(content.length + 255);\n\n  for (var ridx = 0; ridx < content.length; ++ridx) {\n    var c = content.charCodeAt(ridx);\n    if (c < 0x80) o[widx++] = c;else if (c < 0x800) {\n      o[widx++] = 192 | c >> 6 & 31;\n      o[widx++] = 128 | c & 63;\n    } else if (c >= 0xD800 && c < 0xE000) {\n      c = (c & 1023) + 64;\n      var d = content.charCodeAt(++ridx) & 1023;\n      o[widx++] = 240 | c >> 8 & 7;\n      o[widx++] = 128 | c >> 2 & 63;\n      o[widx++] = 128 | d >> 6 & 15 | (c & 3) << 4;\n      o[widx++] = 128 | d & 63;\n    } else {\n      o[widx++] = 224 | c >> 12 & 15;\n      o[widx++] = 128 | c >> 6 & 63;\n      o[widx++] = 128 | c & 63;\n    }\n\n    if (widx > L) {\n      out.push(o.slice(0, widx));\n      widx = 0;\n      o = new_raw_buf(65535);\n      L = 65530;\n    }\n  }\n\n  out.push(o.slice(0, widx));\n  return bconcat(out);\n}\n\nvar chr0 = /\\u0000/g,\n    chr1 = /[\\u0001-\\u0006]/g;\n/*::\ndeclare type Block = any;\ndeclare type BufArray = {\n\tnewblk(sz:number):Block;\n\tnext(sz:number):Block;\n\tend():any;\n\tpush(buf:Block):void;\n};\n\ntype RecordHopperCB = {(d:any, Rn:string, RT:number):?boolean;};\n\ntype EvertType = {[string]:string};\ntype EvertNumType = {[string]:number};\ntype EvertArrType = {[string]:Array<string>};\n\ntype StringConv = {(string):string};\n\n*/\n\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\n/*jshint -W041 */\n\nfunction _strrev(x\n/*:string*/\n)\n/*:string*/\n{\n  var o = \"\",\n      i = x.length - 1;\n\n  while (i >= 0) {\n    o += x.charAt(i--);\n  }\n\n  return o;\n}\n\nfunction pad0(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nfunction pad_(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill(' ', d - t.length) + t;\n}\n\nfunction rpad_(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : t + fill(' ', d - t.length);\n}\n\nfunction pad0r1(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + Math.round(v);\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nfunction pad0r2(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nvar p2_32 = /*#__PURE__*/Math.pow(2, 32);\n\nfunction pad0r(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n  var i = Math.round(v);\n  return pad0r2(i, d);\n}\n/* yes, in 2022 this is still faster than string compare */\n\n\nfunction SSF_isgeneral(s\n/*:string*/\n, i\n/*:?number*/\n)\n/*:boolean*/\n{\n  i = i || 0;\n  return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n}\n\nvar days\n/*:Array<Array<string> >*/\n= [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\nvar months\n/*:Array<Array<string> >*/\n= [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n\nfunction SSF_init_table(t\n/*:any*/\n) {\n  if (!t) t = {};\n  t[0] = 'General';\n  t[1] = '0';\n  t[2] = '0.00';\n  t[3] = '#,##0';\n  t[4] = '#,##0.00';\n  t[9] = '0%';\n  t[10] = '0.00%';\n  t[11] = '0.00E+00';\n  t[12] = '# ?/?';\n  t[13] = '# ??/??';\n  t[14] = 'm/d/yy';\n  t[15] = 'd-mmm-yy';\n  t[16] = 'd-mmm';\n  t[17] = 'mmm-yy';\n  t[18] = 'h:mm AM/PM';\n  t[19] = 'h:mm:ss AM/PM';\n  t[20] = 'h:mm';\n  t[21] = 'h:mm:ss';\n  t[22] = 'm/d/yy h:mm';\n  t[37] = '#,##0 ;(#,##0)';\n  t[38] = '#,##0 ;[Red](#,##0)';\n  t[39] = '#,##0.00;(#,##0.00)';\n  t[40] = '#,##0.00;[Red](#,##0.00)';\n  t[45] = 'mm:ss';\n  t[46] = '[h]:mm:ss';\n  t[47] = 'mmss.0';\n  t[48] = '##0.0E+0';\n  t[49] = '@';\n  t[56] = '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"';\n  return t;\n}\n/* repeated to satiate webpack */\n\n\nvar table_fmt = {\n  0: 'General',\n  1: '0',\n  2: '0.00',\n  3: '#,##0',\n  4: '#,##0.00',\n  9: '0%',\n  10: '0.00%',\n  11: '0.00E+00',\n  12: '# ?/?',\n  13: '# ??/??',\n  14: 'm/d/yy',\n  15: 'd-mmm-yy',\n  16: 'd-mmm',\n  17: 'mmm-yy',\n  18: 'h:mm AM/PM',\n  19: 'h:mm:ss AM/PM',\n  20: 'h:mm',\n  21: 'h:mm:ss',\n  22: 'm/d/yy h:mm',\n  37: '#,##0 ;(#,##0)',\n  38: '#,##0 ;[Red](#,##0)',\n  39: '#,##0.00;(#,##0.00)',\n  40: '#,##0.00;[Red](#,##0.00)',\n  45: 'mm:ss',\n  46: '[h]:mm:ss',\n  47: 'mmss.0',\n  48: '##0.0E+0',\n  49: '@',\n  56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n};\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\n\nvar SSF_default_map = {\n  5: 37,\n  6: 38,\n  7: 39,\n  8: 40,\n  //  5 -> 37 ...  8 -> 40\n  23: 0,\n  24: 0,\n  25: 0,\n  26: 0,\n  // 23 ->  0 ... 26 ->  0\n  27: 14,\n  28: 14,\n  29: 14,\n  30: 14,\n  31: 14,\n  // 27 -> 14 ... 31 -> 14\n  50: 14,\n  51: 14,\n  52: 14,\n  53: 14,\n  54: 14,\n  // 50 -> 14 ... 58 -> 14\n  55: 14,\n  56: 14,\n  57: 14,\n  58: 14,\n  59: 1,\n  60: 2,\n  61: 3,\n  62: 4,\n  // 59 ->  1 ... 62 ->  4\n  67: 9,\n  68: 10,\n  // 67 ->  9 ... 68 -> 10\n  69: 12,\n  70: 13,\n  71: 14,\n  // 69 -> 12 ... 71 -> 14\n  72: 14,\n  73: 15,\n  74: 16,\n  75: 17,\n  // 72 -> 14 ... 75 -> 17\n  76: 20,\n  77: 21,\n  78: 22,\n  // 76 -> 20 ... 78 -> 22\n  79: 45,\n  80: 46,\n  81: 47,\n  // 79 -> 45 ... 81 -> 47\n  82: 0 // 82 ->  0 ... 65536 -> 0 (omitted)\n\n};\n/* These formats technically refer to Accounting formats with no equivalent */\n\nvar SSF_default_str = {\n  //  5 -- Currency,   0 decimal, black negative\n  5: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  //  6 -- Currency,   0 decimal, red   negative\n  6: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  //  7 -- Currency,   2 decimal, black negative\n  7: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  //  8 -- Currency,   2 decimal, red   negative\n  8: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  // 41 -- Accounting, 0 decimal, No Symbol\n  41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n  // 42 -- Accounting, 0 decimal, $  Symbol\n  42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n  // 43 -- Accounting, 2 decimal, No Symbol\n  43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n  // 44 -- Accounting, 2 decimal, $  Symbol\n  44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x\n/*:number*/\n, D\n/*:number*/\n, mixed\n/*:?boolean*/\n)\n/*:Array<number>*/\n{\n  var sgn = x < 0 ? -1 : 1;\n  var B = x * sgn;\n  var P_2 = 0,\n      P_1 = 1,\n      P = 0;\n  var Q_2 = 1,\n      Q_1 = 0,\n      Q = 0;\n  var A = Math.floor(B);\n\n  while (Q_1 < D) {\n    A = Math.floor(B);\n    P = A * P_1 + P_2;\n    Q = A * Q_1 + Q_2;\n    if (B - A < 0.00000005) break;\n    B = 1 / (B - A);\n    P_2 = P_1;\n    P_1 = P;\n    Q_2 = Q_1;\n    Q_1 = Q;\n  }\n\n  if (Q > D) {\n    if (Q_1 > D) {\n      Q = Q_2;\n      P = P_2;\n    } else {\n      Q = Q_1;\n      P = P_1;\n    }\n  }\n\n  if (!mixed) return [0, sgn * P, Q];\n  var q = Math.floor(sgn * P / Q);\n  return [q, sgn * P - q * Q, Q];\n}\n\nfunction SSF_parse_date_code(v\n/*:number*/\n, opts\n/*:?any*/\n, b2\n/*:?boolean*/\n) {\n  if (v > 2958465 || v < 0) return null;\n  var date = v | 0,\n      time = Math.floor(86400 * (v - date)),\n      dow = 0;\n  var dout = [];\n  var out = {\n    D: date,\n    T: time,\n    u: 86400 * (v - date) - time,\n    y: 0,\n    m: 0,\n    d: 0,\n    H: 0,\n    M: 0,\n    S: 0,\n    q: 0\n  };\n  if (Math.abs(out.u) < 1e-6) out.u = 0;\n  if (opts && opts.date1904) date += 1462;\n\n  if (out.u > 0.9999) {\n    out.u = 0;\n\n    if (++time == 86400) {\n      out.T = time = 0;\n      ++date;\n      ++out.D;\n    }\n  }\n\n  if (date === 60) {\n    dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n    dow = 3;\n  } else if (date === 0) {\n    dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n    dow = 6;\n  } else {\n    if (date > 60) --date;\n    /* 1 = Jan 1 1900 in Gregorian */\n\n    var d = new Date(1900, 0, 1);\n    d.setDate(d.getDate() + date - 1);\n    dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n    dow = d.getDay();\n    if (date < 60) dow = (dow + 6) % 7;\n    if (b2) dow = SSF_fix_hijri(d, dout);\n  }\n\n  out.y = dout[0];\n  out.m = dout[1];\n  out.d = dout[2];\n  out.S = time % 60;\n  time = Math.floor(time / 60);\n  out.M = time % 60;\n  time = Math.floor(time / 60);\n  out.H = time;\n  out.q = dow;\n  return out;\n}\n\nvar SSFbasedate = /*#__PURE__*/new Date(1899, 11, 31, 0, 0, 0);\nvar SSFdnthresh = /*#__PURE__*/SSFbasedate.getTime();\nvar SSFbase1904 = /*#__PURE__*/new Date(1900, 2, 1, 0, 0, 0);\n\nfunction datenum_local(v\n/*:Date*/\n, date1904\n/*:?boolean*/\n)\n/*:number*/\n{\n  var epoch = /*#__PURE__*/v.getTime();\n  if (date1904) epoch -= 1461 * 24 * 60 * 60 * 1000;else if (v >= SSFbase1904) epoch += 24 * 60 * 60 * 1000;\n  return (epoch - (SSFdnthresh + ( /*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/SSFbasedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\n}\n/* ECMA-376 18.8.30 numFmt*/\n\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n\n/* exponent >= -9 and <= 9 */\n\n\nfunction SSF_strip_decimal(o\n/*:string*/\n)\n/*:string*/\n{\n  return o.indexOf(\".\") == -1 ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n/* General Exponential always shows 2 digits exp and trims the mantissa */\n\n\nfunction SSF_normalize_exp(o\n/*:string*/\n)\n/*:string*/\n{\n  if (o.indexOf(\"E\") == -1) return o;\n  return o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/, \"$1E\").replace(/(E[+-])(\\d)$/, \"$10$2\");\n}\n/* exponent >= -9 and <= 9 */\n\n\nfunction SSF_small_exp(v\n/*:number*/\n)\n/*:string*/\n{\n  var w = v < 0 ? 12 : 11;\n  var o = SSF_strip_decimal(v.toFixed(12));\n  if (o.length <= w) return o;\n  o = v.toPrecision(10);\n  if (o.length <= w) return o;\n  return v.toExponential(5);\n}\n/* exponent >= 11 or <= -10 likely exponential */\n\n\nfunction SSF_large_exp(v\n/*:number*/\n)\n/*:string*/\n{\n  var o = SSF_strip_decimal(v.toFixed(11));\n  return o.length > (v < 0 ? 12 : 11) || o === \"0\" || o === \"-0\" ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v\n/*:number*/\n)\n/*:string*/\n{\n  var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n      o;\n  if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = SSF_small_exp(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = SSF_large_exp(v);\n  return SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\n\n\nfunction SSF_general(v\n/*:any*/\n, opts\n/*:any*/\n) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? \"TRUE\" : \"FALSE\";\n\n    case 'number':\n      return (v | 0) === v ? v.toString(10) : SSF_general_num(v);\n\n    case 'undefined':\n      return \"\";\n\n    case 'object':\n      if (v == null) return \"\";\n      if (v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);\n  }\n\n  throw new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date\n/*:Date*/\n, o\n/*:[number, number, number]*/\n) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if (date < 60) dow = (dow + 6) % 7;\n  return dow;\n} //var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\n\n\nfunction SSF_write_date(type\n/*:number*/\n, fmt\n/*:string*/\n, val, ss0\n/*:?number*/\n)\n/*:string*/\n{\n  var o = \"\",\n      ss = 0,\n      tt = 0,\n      y = val.y,\n      out,\n      outl = 0;\n\n  switch (type) {\n    case 98:\n      /* 'b' buddhist year */\n      y = val.y + 543;\n\n    /* falls through */\n\n    case 121:\n      /* 'y' year */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = y % 100;\n          outl = 2;\n          break;\n\n        default:\n          out = y % 10000;\n          outl = 4;\n          break;\n      }\n\n      break;\n\n    case 109:\n      /* 'm' month */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.m;\n          outl = fmt.length;\n          break;\n\n        case 3:\n          return months[val.m - 1][1];\n\n        case 5:\n          return months[val.m - 1][0];\n\n        default:\n          return months[val.m - 1][2];\n      }\n\n      break;\n\n    case 100:\n      /* 'd' day */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.d;\n          outl = fmt.length;\n          break;\n\n        case 3:\n          return days[val.q][0];\n\n        default:\n          return days[val.q][1];\n      }\n\n      break;\n\n    case 104:\n      /* 'h' 12-hour */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = 1 + (val.H + 11) % 12;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad hour format: ' + fmt;\n      }\n\n      break;\n\n    case 72:\n      /* 'H' 24-hour */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.H;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad hour format: ' + fmt;\n      }\n\n      break;\n\n    case 77:\n      /* 'M' minutes */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.M;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad minute format: ' + fmt;\n      }\n\n      break;\n\n    case 115:\n      /* 's' seconds */\n      if (fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n      if (val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\n      /*::if(!ss0) ss0 = 0; */\n\n      if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n      ss = Math.round(tt * (val.S + val.u));\n      if (ss >= 60 * tt) ss = 0;\n      if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n      o = pad0(ss, 2 + ss0);\n      if (fmt === 'ss') return o.substr(0, 2);\n      return \".\" + o.substr(2, fmt.length - 1);\n\n    case 90:\n      /* 'Z' absolute time */\n      switch (fmt) {\n        case '[h]':\n        case '[hh]':\n          out = val.D * 24 + val.H;\n          break;\n\n        case '[m]':\n        case '[mm]':\n          out = (val.D * 24 + val.H) * 60 + val.M;\n          break;\n\n        case '[s]':\n        case '[ss]':\n          out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n          break;\n\n        default:\n          throw 'bad abstime format: ' + fmt;\n      }\n\n      outl = fmt.length === 3 ? 1 : 2;\n      break;\n\n    case 101:\n      /* 'e' era */\n      out = y;\n      outl = 1;\n      break;\n  }\n\n  var outstr = outl > 0 ? pad0(out, outl) : \"\";\n  return outstr;\n}\n/*jshint -W086 */\n\n/*jshint +W086 */\n\n\nfunction commaify(s\n/*:string*/\n)\n/*:string*/\n{\n  var w = 3;\n  if (s.length <= w) return s;\n  var j = s.length % w,\n      o = s.substr(0, j);\n\n  for (; j != s.length; j += w) {\n    o += (o.length > 0 ? \",\" : \"\") + s.substr(j, w);\n  }\n\n  return o;\n}\n\nvar pct1 = /%/g;\n\nfunction write_num_pct(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n}\n\nfunction write_num_cm(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var idx = fmt.length - 1;\n\n  while (fmt.charCodeAt(idx - 1) === 44) {\n    --idx;\n  }\n\n  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n}\n\nfunction write_num_exp(fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var o\n  /*:string*/\n  ;\n  var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n  if (fmt.match(/^#+0.0E\\+0$/)) {\n    if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp(fmt, -val);\n    var period = fmt.indexOf(\".\");\n    if (period === -1) period = fmt.indexOf('E');\n    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n    if (ee < 0) ee += period;\n    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n    if (o.indexOf(\"e\") === -1) {\n      var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n      if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n\n      while (o.substr(0, 2) === \"0.\") {\n        o = o.charAt(0) + o.substr(2, period) + \".\" + o.substr(2 + period);\n        o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n      }\n\n      o = o.replace(/\\+-/, \"-\");\n    }\n\n    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n      return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n    });\n  } else o = val.toExponential(idx);\n\n  if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n  if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n  return o.replace(\"e\", \"E\");\n}\n\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n\nfunction write_num_f1(r\n/*:Array<string>*/\n, aval\n/*:number*/\n, sign\n/*:string*/\n)\n/*:string*/\n{\n  var den = parseInt(r[4], 10),\n      rr = Math.round(aval * den),\n      base = Math.floor(rr / den);\n  var myn = rr - base * den,\n      myd = den;\n  return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n}\n\nfunction write_num_f2(r\n/*:Array<string>*/\n, aval\n/*:number*/\n, sign\n/*:string*/\n)\n/*:string*/\n{\n  return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\n\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\n\nfunction hashq(str\n/*:string*/\n)\n/*:string*/\n{\n  var o = \"\",\n      cc;\n\n  for (var i = 0; i != str.length; ++i) {\n    switch (cc = str.charCodeAt(i)) {\n      case 35:\n        break;\n\n      case 63:\n        o += \" \";\n        break;\n\n      case 48:\n        o += \"0\";\n        break;\n\n      default:\n        o += String.fromCharCode(cc);\n    }\n  }\n\n  return o;\n}\n\nfunction rnd(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var dd = Math.pow(10, d);\n  return \"\" + Math.round(val * dd) / dd;\n}\n\nfunction dec(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:number*/\n{\n  var _frac = val - Math.floor(val),\n      dd = Math.pow(10, d);\n\n  if (d < ('' + Math.round(_frac * dd)).length) return 0;\n  return Math.round(_frac * dd);\n}\n\nfunction carry(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:number*/\n{\n  if (d < ('' + Math.round((val - Math.floor(val)) * Math.pow(10, d))).length) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction flr(val\n/*:number*/\n)\n/*:string*/\n{\n  if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n  return \"\" + Math.floor(val);\n}\n\nfunction write_num_flt(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n    if (val >= 0) return write_num_flt('n', ffmt, val);\n    return '(' + write_num_flt('n', ffmt, -val) + ')';\n  }\n\n  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n  if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n  if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n  if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n  var o;\n  var r\n  /*:?Array<string>*/\n  ,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n  if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n\n  if (fmt.match(/^[#?]+$/)) {\n    o = pad0r(val, 0);\n    if (o === \"0\") o = \"\";\n    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(frac1)) return write_num_f1(r, aval, sign);\n  if (fmt.match(/^#+0+$/)) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n\n  if (r = fmt.match(dec1)) {\n    o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1])).replace(/\\.(\\d*)$/, function ($$, $1) {\n      return \".\" + $1 + fill(\"0\", hashq(\n      /*::(*/\n      r\n      /*::||[\"\"])*/\n      [1]).length - $1.length);\n    });\n    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n  }\n\n  fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n  if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n    return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n  }\n\n  if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(pad0r(aval, 0));\n\n  if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + (Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n  }\n\n  if (r = fmt.match(/^#,#*,#0/)) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n  if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n    o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n    ri = 0;\n    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n      return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n    }));\n  }\n\n  if (fmt.match(phone)) {\n    o = write_num_flt(type, \"##########\", val);\n    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n  }\n\n  var oa = \"\";\n\n  if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(\n    /*::String(*/\n    r[4]\n    /*::)*/\n    .length, 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n    o = \"\" + sign;\n    oa = write_num(\"n\",\n    /*::String(*/\n    r[1]\n    /*::)*/\n    , ff[1]);\n    if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n    o += oa +\n    /*::String(*/\n    r[2]\n    /*::)*/\n    + \"/\" +\n    /*::String(*/\n    r[3]\n    /*::)*/\n    ;\n    oa = rpad_(ff[2], ri);\n    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n    o += oa;\n    return o;\n  }\n\n  if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n  }\n\n  if (r = fmt.match(/^[#0?]+$/)) {\n    o = pad0r(val, 0);\n    if (fmt.length <= o.length) return o;\n    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) {\n    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n    ri = o.indexOf(\".\");\n    var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n  }\n\n  if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n    ri = dec(val, r[1].length);\n    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n      return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n    }) + \".\" + pad0(ri, r[1].length);\n  }\n\n  switch (fmt) {\n    case \"###,##0.00\":\n      return write_num_flt(type, \"#,##0.00\", val);\n\n    case \"###,###\":\n    case \"##,###\":\n    case \"#,###\":\n      var x = commaify(pad0r(aval, 0));\n      return x !== \"0\" ? sign + x : \"\";\n\n    case \"###,###.00\":\n      return write_num_flt(type, \"###,##0.00\", val).replace(/^0\\./, \".\");\n\n    case \"#,###.00\":\n      return write_num_flt(type, \"#,##0.00\", val).replace(/^0\\./, \".\");\n  }\n\n  throw new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num_cm2(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var idx = fmt.length - 1;\n\n  while (fmt.charCodeAt(idx - 1) === 44) {\n    --idx;\n  }\n\n  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n}\n\nfunction write_num_pct2(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n}\n\nfunction write_num_exp2(fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var o\n  /*:string*/\n  ;\n  var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n  if (fmt.match(/^#+0.0E\\+0$/)) {\n    if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp2(fmt, -val);\n    var period = fmt.indexOf(\".\");\n    if (period === -1) period = fmt.indexOf('E');\n    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n    if (ee < 0) ee += period;\n    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n    if (!o.match(/[Ee]/)) {\n      var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n      if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n      o = o.replace(/\\+-/, \"-\");\n    }\n\n    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n      return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n    });\n  } else o = val.toExponential(idx);\n\n  if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n  if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n  return o.replace(\"e\", \"E\");\n}\n\nfunction write_num_int(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n    if (val >= 0) return write_num_int('n', ffmt, val);\n    return '(' + write_num_int('n', ffmt, -val) + ')';\n  }\n\n  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n  if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n  if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n  if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n  var o;\n  var r\n  /*:?Array<string>*/\n  ,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n  if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n\n  if (fmt.match(/^[#?]+$/)) {\n    o = \"\" + val;\n    if (val === 0) o = \"\";\n    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(frac1)) return write_num_f2(r, aval, sign);\n  if (fmt.match(/^#+0+$/)) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n\n  if (r = fmt.match(dec1)) {\n    /*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n    o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1]));\n    o = o.replace(/\\.(\\d*)$/, function ($$, $1) {\n      /*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n      return \".\" + $1 + fill(\"0\", hashq(r[1]).length - $1.length);\n    });\n    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n  }\n\n  fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n  if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n    return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n  }\n\n  if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(\"\" + aval);\n\n  if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n  }\n\n  if (r = fmt.match(/^#,#*,#0/)) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n  if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n    o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n    ri = 0;\n    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n      return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n    }));\n  }\n\n  if (fmt.match(phone)) {\n    o = write_num_int(type, \"##########\", val);\n    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n  }\n\n  var oa = \"\";\n\n  if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(\n    /*::String(*/\n    r[4]\n    /*::)*/\n    .length, 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n    o = \"\" + sign;\n    oa = write_num(\"n\",\n    /*::String(*/\n    r[1]\n    /*::)*/\n    , ff[1]);\n    if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n    o += oa +\n    /*::String(*/\n    r[2]\n    /*::)*/\n    + \"/\" +\n    /*::String(*/\n    r[3]\n    /*::)*/\n    ;\n    oa = rpad_(ff[2], ri);\n    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n    o += oa;\n    return o;\n  }\n\n  if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n  }\n\n  if (r = fmt.match(/^[#0?]+$/)) {\n    o = \"\" + val;\n    if (fmt.length <= o.length) return o;\n    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(/^([#0]+)\\.([#0]+)$/)) {\n    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n    ri = o.indexOf(\".\");\n    var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n  }\n\n  if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n      return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n    }) + \".\" + pad0(0, r[1].length);\n  }\n\n  switch (fmt) {\n    case \"###,###\":\n    case \"##,###\":\n    case \"#,###\":\n      var x = commaify(\"\" + aval);\n      return x !== \"0\" ? sign + x : \"\";\n\n    default:\n      if (fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0, fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n  }\n\n  throw new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\n\nfunction SSF_split_fmt(fmt\n/*:string*/\n)\n/*:Array<string>*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  var in_str = false\n  /*, cc*/\n  ;\n\n  for (var i = 0, j = 0; i < fmt.length; ++i) {\n    switch (\n    /*cc=*/\n    fmt.charCodeAt(i)) {\n      case 34:\n        /* '\"' */\n        in_str = !in_str;\n        break;\n\n      case 95:\n      case 42:\n      case 92:\n        /* '_' '*' '\\\\' */\n        ++i;\n        break;\n\n      case 59:\n        /* ';' */\n        out[out.length] = fmt.substr(j, i - j);\n        j = i + 1;\n    }\n  }\n\n  out[out.length] = fmt.substr(j);\n  if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n  return out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\n\nfunction fmt_is_date(fmt\n/*:string*/\n)\n/*:boolean*/\n{\n  var i = 0,\n\n  /*cc = 0,*/\n  c = \"\",\n      o = \"\";\n\n  while (i < fmt.length) {\n    switch (c = fmt.charAt(i)) {\n      case 'G':\n        if (SSF_isgeneral(fmt, i)) i += 6;\n        i++;\n        break;\n\n      case '\"':\n        for (;\n        /*cc=*/\n        fmt.charCodeAt(++i) !== 34 && i < fmt.length;) {\n          /*empty*/\n        }\n\n        ++i;\n        break;\n\n      case '\\\\':\n        i += 2;\n        break;\n\n      case '_':\n        i += 2;\n        break;\n\n      case '@':\n        ++i;\n        break;\n\n      case 'B':\n      case 'b':\n        if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") return true;\n\n      /* falls through */\n\n      case 'M':\n      case 'D':\n      case 'Y':\n      case 'H':\n      case 'S':\n      case 'E':\n      /* falls through */\n\n      case 'm':\n      case 'd':\n      case 'y':\n      case 'h':\n      case 's':\n      case 'e':\n      case 'g':\n        return true;\n\n      case 'A':\n      case 'a':\n      case '上':\n        if (fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n        if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n        if (fmt.substr(i, 5).toUpperCase() === \"上午/下午\") return true;\n        ++i;\n        break;\n\n      case '[':\n        o = c;\n\n        while (fmt.charAt(i++) !== ']' && i < fmt.length) {\n          o += fmt.charAt(i);\n        }\n\n        if (o.match(SSF_abstime)) return true;\n        break;\n\n      case '.':\n      /* falls through */\n\n      case '0':\n      case '#':\n        while (i < fmt.length && (\"0#?.,E+-%\".indexOf(c = fmt.charAt(++i)) > -1 || c == '\\\\' && fmt.charAt(i + 1) == \"-\" && \"0#\".indexOf(fmt.charAt(i + 2)) > -1)) {\n          /* empty */\n        }\n\n        break;\n\n      case '?':\n        while (fmt.charAt(++i) === c) {\n          /* empty */\n        }\n\n        break;\n\n      case '*':\n        ++i;\n        if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n        break;\n\n      case '(':\n      case ')':\n        ++i;\n        break;\n\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '8':\n      case '9':\n        while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) {\n          /* empty */\n        }\n\n        break;\n\n      case ' ':\n        ++i;\n        break;\n\n      default:\n        ++i;\n        break;\n    }\n  }\n\n  return false;\n}\n\nfunction eval_fmt(fmt\n/*:string*/\n, v\n/*:any*/\n, opts\n/*:any*/\n, flen\n/*:number*/\n) {\n  var out = [],\n      o = \"\",\n      i = 0,\n      c = \"\",\n      lst = 't',\n      dt,\n      j,\n      cc;\n  var hr = 'H';\n  /* Tokenize */\n\n  while (i < fmt.length) {\n    switch (c = fmt.charAt(i)) {\n      case 'G':\n        /* General */\n        if (!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n        out[out.length] = {\n          t: 'G',\n          v: 'General'\n        };\n        i += 7;\n        break;\n\n      case '\"':\n        /* Literal text */\n        for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) {\n          o += String.fromCharCode(cc);\n        }\n\n        out[out.length] = {\n          t: 't',\n          v: o\n        };\n        ++i;\n        break;\n\n      case '\\\\':\n        var w = fmt.charAt(++i),\n            t = w === \"(\" || w === \")\" ? w : 't';\n        out[out.length] = {\n          t: t,\n          v: w\n        };\n        ++i;\n        break;\n\n      case '_':\n        out[out.length] = {\n          t: 't',\n          v: \" \"\n        };\n        i += 2;\n        break;\n\n      case '@':\n        /* Text Placeholder */\n        out[out.length] = {\n          t: 'T',\n          v: v\n        };\n        ++i;\n        break;\n\n      case 'B':\n      case 'b':\n        if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") {\n          if (dt == null) {\n            dt = SSF_parse_date_code(v, opts, fmt.charAt(i + 1) === \"2\");\n            if (dt == null) return \"\";\n          }\n\n          out[out.length] = {\n            t: 'X',\n            v: fmt.substr(i, 2)\n          };\n          lst = c;\n          i += 2;\n          break;\n        }\n\n      /* falls through */\n\n      case 'M':\n      case 'D':\n      case 'Y':\n      case 'H':\n      case 'S':\n      case 'E':\n        c = c.toLowerCase();\n\n      /* falls through */\n\n      case 'm':\n      case 'd':\n      case 'y':\n      case 'h':\n      case 's':\n      case 'e':\n      case 'g':\n        if (v < 0) return \"\";\n\n        if (dt == null) {\n          dt = SSF_parse_date_code(v, opts);\n          if (dt == null) return \"\";\n        }\n\n        o = c;\n\n        while (++i < fmt.length && fmt.charAt(i).toLowerCase() === c) {\n          o += c;\n        }\n\n        if (c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n        if (c === 'h') c = hr;\n        out[out.length] = {\n          t: c,\n          v: o\n        };\n        lst = c;\n        break;\n\n      case 'A':\n      case 'a':\n      case '上':\n        var q = {\n          t: c,\n          v: c\n        };\n        if (dt == null) dt = SSF_parse_date_code(v, opts);\n\n        if (fmt.substr(i, 3).toUpperCase() === \"A/P\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n          q.t = 'T';\n          hr = 'h';\n          i += 3;\n        } else if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n          q.t = 'T';\n          i += 5;\n          hr = 'h';\n        } else if (fmt.substr(i, 5).toUpperCase() === \"上午/下午\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"下午\" : \"上午\";\n          q.t = 'T';\n          i += 5;\n          hr = 'h';\n        } else {\n          q.t = \"t\";\n          ++i;\n        }\n\n        if (dt == null && q.t === 'T') return \"\";\n        out[out.length] = q;\n        lst = c;\n        break;\n\n      case '[':\n        o = c;\n\n        while (fmt.charAt(i++) !== ']' && i < fmt.length) {\n          o += fmt.charAt(i);\n        }\n\n        if (o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\n        if (o.match(SSF_abstime)) {\n          if (dt == null) {\n            dt = SSF_parse_date_code(v, opts);\n            if (dt == null) return \"\";\n          }\n\n          out[out.length] = {\n            t: 'Z',\n            v: o.toLowerCase()\n          };\n          lst = o.charAt(1);\n        } else if (o.indexOf(\"$\") > -1) {\n          o = (o.match(/\\$([^-\\[\\]]*)/) || [])[1] || \"$\";\n          if (!fmt_is_date(fmt)) out[out.length] = {\n            t: 't',\n            v: o\n          };\n        }\n\n        break;\n\n      /* Numbers */\n\n      case '.':\n        if (dt != null) {\n          o = c;\n\n          while (++i < fmt.length && (c = fmt.charAt(i)) === \"0\") {\n            o += c;\n          }\n\n          out[out.length] = {\n            t: 's',\n            v: o\n          };\n          break;\n        }\n\n      /* falls through */\n\n      case '0':\n      case '#':\n        o = c;\n\n        while (++i < fmt.length && \"0#?.,E+-%\".indexOf(c = fmt.charAt(i)) > -1) {\n          o += c;\n        }\n\n        out[out.length] = {\n          t: 'n',\n          v: o\n        };\n        break;\n\n      case '?':\n        o = c;\n\n        while (fmt.charAt(++i) === c) {\n          o += c;\n        }\n\n        out[out.length] = {\n          t: c,\n          v: o\n        };\n        lst = c;\n        break;\n\n      case '*':\n        ++i;\n        if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n        break;\n      // **\n\n      case '(':\n      case ')':\n        out[out.length] = {\n          t: flen === 1 ? 't' : c,\n          v: c\n        };\n        ++i;\n        break;\n\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '8':\n      case '9':\n        o = c;\n\n        while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) {\n          o += fmt.charAt(i);\n        }\n\n        out[out.length] = {\n          t: 'D',\n          v: o\n        };\n        break;\n\n      case ' ':\n        out[out.length] = {\n          t: c,\n          v: c\n        };\n        ++i;\n        break;\n\n      case '$':\n        out[out.length] = {\n          t: 't',\n          v: '$'\n        };\n        ++i;\n        break;\n\n      default:\n        if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n        out[out.length] = {\n          t: 't',\n          v: c\n        };\n        ++i;\n        break;\n    }\n  }\n  /* Scan for date/time parts */\n\n\n  var bt = 0,\n      ss0 = 0,\n      ssm;\n\n  for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n    switch (out[i].t) {\n      case 'h':\n      case 'H':\n        out[i].t = hr;\n        lst = 'h';\n        if (bt < 1) bt = 1;\n        break;\n\n      case 's':\n        if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n        if (bt < 3) bt = 3;\n\n      /* falls through */\n\n      case 'd':\n      case 'y':\n      case 'M':\n      case 'e':\n        lst = out[i].t;\n        break;\n\n      case 'm':\n        if (lst === 's') {\n          out[i].t = 'M';\n          if (bt < 2) bt = 2;\n        }\n\n        break;\n\n      case 'X':\n        /*if(out[i].v === \"B2\");*/\n        break;\n\n      case 'Z':\n        if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n        if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n        if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n    }\n  }\n  /* time rounding depends on presence of minute / second / usec fields */\n\n\n  switch (bt) {\n    case 0:\n      break;\n\n    case 1:\n      /*::if(!dt) break;*/\n      if (dt.u >= 0.5) {\n        dt.u = 0;\n        ++dt.S;\n      }\n\n      if (dt.S >= 60) {\n        dt.S = 0;\n        ++dt.M;\n      }\n\n      if (dt.M >= 60) {\n        dt.M = 0;\n        ++dt.H;\n      }\n\n      break;\n\n    case 2:\n      /*::if(!dt) break;*/\n      if (dt.u >= 0.5) {\n        dt.u = 0;\n        ++dt.S;\n      }\n\n      if (dt.S >= 60) {\n        dt.S = 0;\n        ++dt.M;\n      }\n\n      break;\n  }\n  /* replace fields */\n\n\n  var nstr = \"\",\n      jj;\n\n  for (i = 0; i < out.length; ++i) {\n    switch (out[i].t) {\n      case 't':\n      case 'T':\n      case ' ':\n      case 'D':\n        break;\n\n      case 'X':\n        out[i].v = \"\";\n        out[i].t = \";\";\n        break;\n\n      case 'd':\n      case 'm':\n      case 'y':\n      case 'h':\n      case 'H':\n      case 'M':\n      case 's':\n      case 'e':\n      case 'b':\n      case 'Z':\n        /*::if(!dt) throw \"unreachable\"; */\n        out[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n        out[i].t = 't';\n        break;\n\n      case 'n':\n      case '?':\n        jj = i + 1;\n\n        while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n          out[i].v += out[jj].v;\n          out[jj] = {\n            v: \"\",\n            t: \";\"\n          };\n          ++jj;\n        }\n\n        nstr += out[i].v;\n        i = jj - 1;\n        break;\n\n      case 'G':\n        out[i].t = 't';\n        out[i].v = SSF_general(v, opts);\n        break;\n    }\n  }\n\n  var vv = \"\",\n      myv,\n      ostr;\n\n  if (nstr.length > 0) {\n    if (nstr.charCodeAt(0) == 40)\n      /* '(' */\n      {\n        myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n        ostr = write_num('n', nstr, myv);\n      } else {\n      myv = v < 0 && flen > 1 ? -v : v;\n      ostr = write_num('n', nstr, myv);\n\n      if (myv < 0 && out[0] && out[0].t == 't') {\n        ostr = ostr.substr(1);\n        out[0].v = \"-\" + out[0].v;\n      }\n    }\n\n    jj = ostr.length - 1;\n    var decpt = out.length;\n\n    for (i = 0; i < out.length; ++i) {\n      if (out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) {\n        decpt = i;\n        break;\n      }\n    }\n\n    var lasti = out.length;\n\n    if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n      for (i = out.length - 1; i >= 0; --i) {\n        if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\n        if (jj >= out[i].v.length - 1) {\n          jj -= out[i].v.length;\n          out[i].v = ostr.substr(jj + 1, out[i].v.length);\n        } else if (jj < 0) out[i].v = \"\";else {\n          out[i].v = ostr.substr(0, jj + 1);\n          jj = -1;\n        }\n\n        out[i].t = 't';\n        lasti = i;\n      }\n\n      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n    } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n      jj = ostr.indexOf(\".\") - 1;\n\n      for (i = decpt; i >= 0; --i) {\n        if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n        vv = out[i].v.substr(j + 1);\n\n        for (; j >= 0; --j) {\n          if (jj >= 0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n        }\n\n        out[i].v = vv;\n        out[i].t = 't';\n        lasti = i;\n      }\n\n      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n      jj = ostr.indexOf(\".\") + 1;\n\n      for (i = decpt; i < out.length; ++i) {\n        if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n        vv = out[i].v.substr(0, j);\n\n        for (; j < out[i].v.length; ++j) {\n          if (jj < ostr.length) vv += ostr.charAt(jj++);\n        }\n\n        out[i].v = vv;\n        out[i].t = 't';\n        lasti = i;\n      }\n    }\n  }\n\n  for (i = 0; i < out.length; ++i) {\n    if (out[i] != null && 'n?'.indexOf(out[i].t) > -1) {\n      myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n      out[i].v = write_num(out[i].t, out[i].v, myv);\n      out[i].t = 't';\n    }\n  }\n\n  var retval = \"\";\n\n  for (i = 0; i !== out.length; ++i) {\n    if (out[i] != null) retval += out[i].v;\n  }\n\n  return retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\n\nfunction chkcond(v, rr) {\n  if (rr == null) return false;\n  var thresh = parseFloat(rr[2]);\n\n  switch (rr[1]) {\n    case \"=\":\n      if (v == thresh) return true;\n      break;\n\n    case \">\":\n      if (v > thresh) return true;\n      break;\n\n    case \"<\":\n      if (v < thresh) return true;\n      break;\n\n    case \"<>\":\n      if (v != thresh) return true;\n      break;\n\n    case \">=\":\n      if (v >= thresh) return true;\n      break;\n\n    case \"<=\":\n      if (v <= thresh) return true;\n      break;\n  }\n\n  return false;\n}\n\nfunction choose_fmt(f\n/*:string*/\n, v\n/*:any*/\n) {\n  var fmt = SSF_split_fmt(f);\n  var l = fmt.length,\n      lat = fmt[l - 1].indexOf(\"@\");\n  if (l < 4 && lat > -1) --l;\n  if (fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n  if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n\n  switch (fmt.length) {\n    case 1:\n      fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n      break;\n\n    case 2:\n      fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n      break;\n\n    case 3:\n      fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n      break;\n  }\n\n  var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n  if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\n  if (fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n    var m1 = fmt[0].match(cfregex2);\n    var m2 = fmt[1].match(cfregex2);\n    return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n  }\n\n  return [l, ff];\n}\n\nfunction SSF_format(fmt\n/*:string|number*/\n, v\n/*:any*/\n, o\n/*:?any*/\n) {\n  if (o == null) o = {};\n  var sfmt = \"\";\n\n  switch (typeof fmt) {\n    case \"string\":\n      if (fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;else sfmt = fmt;\n      break;\n\n    case \"number\":\n      if (fmt == 14 && o.dateNF) sfmt = o.dateNF;else sfmt = (o.table != null ? o.table\n      /*:any*/\n      : table_fmt)[fmt];\n      if (sfmt == null) sfmt = o.table && o.table[SSF_default_map[fmt]] || table_fmt[SSF_default_map[fmt]];\n      if (sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n      break;\n  }\n\n  if (SSF_isgeneral(sfmt, 0)) return SSF_general(v, o);\n  if (v instanceof Date) v = datenum_local(v, o.date1904);\n  var f = choose_fmt(sfmt, v);\n  if (SSF_isgeneral(f[1])) return SSF_general(v, o);\n  if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n  return eval_fmt(f[1], v, o, f[0]);\n}\n\nfunction SSF_load(fmt\n/*:string*/\n, idx\n/*:?number*/\n)\n/*:number*/\n{\n  if (typeof idx != 'number') {\n    idx = +idx || -1;\n    /*::if(typeof idx != 'number') return 0x188; */\n\n    for (var i = 0; i < 0x0188; ++i) {\n      /*::if(typeof idx != 'number') return 0x188; */\n      if (table_fmt[i] == undefined) {\n        if (idx < 0) idx = i;\n        continue;\n      }\n\n      if (table_fmt[i] == fmt) {\n        idx = i;\n        break;\n      }\n    }\n    /*::if(typeof idx != 'number') return 0x188; */\n\n\n    if (idx < 0) idx = 0x187;\n  }\n  /*::if(typeof idx != 'number') return 0x188; */\n\n\n  table_fmt[idx] = fmt;\n  return idx;\n}\n\nfunction make_ssf() {\n  table_fmt = SSF_init_table();\n}\n\nvar SSFImplicit\n/*{[number]:string}*/\n= {\n  \"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  \"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  \"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  \"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  \"23\": 'General',\n  \"24\": 'General',\n  \"25\": 'General',\n  \"26\": 'General',\n  \"27\": 'm/d/yy',\n  \"28\": 'm/d/yy',\n  \"29\": 'm/d/yy',\n  \"30\": 'm/d/yy',\n  \"31\": 'm/d/yy',\n  \"32\": 'h:mm:ss',\n  \"33\": 'h:mm:ss',\n  \"34\": 'h:mm:ss',\n  \"35\": 'h:mm:ss',\n  \"36\": 'm/d/yy',\n  \"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n  \"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n  \"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n  \"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n  \"50\": 'm/d/yy',\n  \"51\": 'm/d/yy',\n  \"52\": 'm/d/yy',\n  \"53\": 'm/d/yy',\n  \"54\": 'm/d/yy',\n  \"55\": 'm/d/yy',\n  \"56\": 'm/d/yy',\n  \"57\": 'm/d/yy',\n  \"58\": 'm/d/yy',\n  \"59\": '0',\n  \"60\": '0.00',\n  \"61\": '#,##0',\n  \"62\": '#,##0.00',\n  \"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  \"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  \"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  \"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  \"67\": '0%',\n  \"68\": '0.00%',\n  \"69\": '# ?/?',\n  \"70\": '# ??/??',\n  \"71\": 'm/d/yy',\n  \"72\": 'm/d/yy',\n  \"73\": 'd-mmm-yy',\n  \"74\": 'd-mmm',\n  \"75\": 'mmm-yy',\n  \"76\": 'h:mm',\n  \"77\": 'h:mm:ss',\n  \"78\": 'm/d/yy h:mm',\n  \"79\": 'mm:ss',\n  \"80\": '[h]:mm:ss',\n  \"81\": 'mmss.0'\n}\n/*:any*/\n;\n/* dateNF parse TODO: move to SSF */\n\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\n\nfunction dateNF_regex(dateNF\n/*:string|number*/\n)\n/*:RegExp*/\n{\n  var fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n  fmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n  return new RegExp(\"^\" + fmt + \"$\");\n}\n\nfunction dateNF_fix(str\n/*:string*/\n, dateNF\n/*:string*/\n, match\n/*:Array<string>*/\n)\n/*:string*/\n{\n  var Y = -1,\n      m = -1,\n      d = -1,\n      H = -1,\n      M = -1,\n      S = -1;\n  (dateNF.match(dateNFregex) || []).forEach(function (n, i) {\n    var v = parseInt(match[i + 1], 10);\n\n    switch (n.toLowerCase().charAt(0)) {\n      case 'y':\n        Y = v;\n        break;\n\n      case 'd':\n        d = v;\n        break;\n\n      case 'h':\n        H = v;\n        break;\n\n      case 's':\n        S = v;\n        break;\n\n      case 'm':\n        if (H >= 0) M = v;else m = v;\n        break;\n    }\n  });\n\n  if (S >= 0 && M == -1 && m >= 0) {\n    M = m;\n    m = -1;\n  }\n\n  var datestr = (\"\" + (Y >= 0 ? Y : new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m >= 1 ? m : 1)).slice(-2) + \"-\" + (\"00\" + (d >= 1 ? d : 1)).slice(-2);\n  if (datestr.length == 7) datestr = \"0\" + datestr;\n  if (datestr.length == 8) datestr = \"20\" + datestr;\n  var timestr = (\"00\" + (H >= 0 ? H : 0)).slice(-2) + \":\" + (\"00\" + (M >= 0 ? M : 0)).slice(-2) + \":\" + (\"00\" + (S >= 0 ? S : 0)).slice(-2);\n  if (H == -1 && M == -1 && S == -1) return datestr;\n  if (Y == -1 && m == -1 && d == -1) return timestr;\n  return datestr + \"T\" + timestr;\n}\n/*::\ndeclare var ReadShift:any;\ndeclare var CheckField:any;\ndeclare var prep_blob:any;\ndeclare var __readUInt32LE:any;\ndeclare var __readInt32LE:any;\ndeclare var __toBuffer:any;\ndeclare var __utf16le:any;\ndeclare var bconcat:any;\ndeclare var s2a:any;\ndeclare var chr0:any;\ndeclare var chr1:any;\ndeclare var has_buf:boolean;\ndeclare var new_buf:any;\ndeclare var new_raw_buf:any;\ndeclare var new_unsafe_buf:any;\ndeclare var Buffer_from:any;\n*/\n\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*jshint eqnull:true */\n\n/*exported CFB */\n\n/*global Uint8Array:false, Uint16Array:false */\n\n/*::\ntype SectorEntry = {\n\tname?:string;\n\tnodes?:Array<number>;\n\tdata:RawBytes;\n};\ntype SectorList = {\n\t[k:string|number]:SectorEntry;\n\tname:?string;\n\tfat_addrs:Array<number>;\n\tssz:number;\n}\ntype CFBFiles = {[n:string]:CFBEntry};\n*/\n\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*exported CRC32 */\n\n\nvar CRC32 = /*#__PURE__*/function () {\n  var CRC32 = {};\n  CRC32.version = '1.2.0';\n  /* see perf/crc32table.js */\n\n  /*global Int32Array */\n\n  function signed_crc_table()\n  /*:any*/\n  {\n    var c = 0,\n        table\n    /*:Array<number>*/\n    = new Array(256);\n\n    for (var n = 0; n != 256; ++n) {\n      c = n;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      table[n] = c;\n    }\n\n    return typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n  }\n\n  var T0 = signed_crc_table();\n\n  function slice_by_16_tables(T) {\n    var c = 0,\n        v = 0,\n        n = 0,\n        table\n    /*:Array<number>*/\n    = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096);\n\n    for (n = 0; n != 256; ++n) {\n      table[n] = T[n];\n    }\n\n    for (n = 0; n != 256; ++n) {\n      v = T[n];\n\n      for (c = 256 + n; c < 4096; c += 256) {\n        v = table[c] = v >>> 8 ^ T[v & 0xFF];\n      }\n    }\n\n    var out = [];\n\n    for (n = 1; n != 16; ++n) {\n      out[n - 1] = typeof Int32Array !== 'undefined' ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n    }\n\n    return out;\n  }\n\n  var TT = slice_by_16_tables(T0);\n  var T1 = TT[0],\n      T2 = TT[1],\n      T3 = TT[2],\n      T4 = TT[3],\n      T5 = TT[4];\n  var T6 = TT[5],\n      T7 = TT[6],\n      T8 = TT[7],\n      T9 = TT[8],\n      Ta = TT[9];\n  var Tb = TT[10],\n      Tc = TT[11],\n      Td = TT[12],\n      Te = TT[13],\n      Tf = TT[14];\n\n  function crc32_bstr(bstr\n  /*:string*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed\n    /*:: ? 0 : 0 */\n    ^ -1;\n\n    for (var i = 0, L = bstr.length; i < L;) {\n      C = C >>> 8 ^ T0[(C ^ bstr.charCodeAt(i++)) & 0xFF];\n    }\n\n    return ~C;\n  }\n\n  function crc32_buf(B\n  /*:Uint8Array|Array<number>*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed\n    /*:: ? 0 : 0 */\n    ^ -1,\n        L = B.length - 15,\n        i = 0;\n\n    for (; i < L;) {\n      C = Tf[B[i++] ^ C & 255] ^ Te[B[i++] ^ C >> 8 & 255] ^ Td[B[i++] ^ C >> 16 & 255] ^ Tc[B[i++] ^ C >>> 24] ^ Tb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^ T7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^ T3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n    }\n\n    L += 15;\n\n    while (i < L) {\n      C = C >>> 8 ^ T0[(C ^ B[i++]) & 0xFF];\n    }\n\n    return ~C;\n  }\n\n  function crc32_str(str\n  /*:string*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed ^ -1;\n\n    for (var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n      c = str.charCodeAt(i++);\n\n      if (c < 0x80) {\n        C = C >>> 8 ^ T0[(C ^ c) & 0xFF];\n      } else if (c < 0x800) {\n        C = C >>> 8 ^ T0[(C ^ (192 | c >> 6 & 31)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n      } else if (c >= 0xD800 && c < 0xE000) {\n        c = (c & 1023) + 64;\n        d = str.charCodeAt(i++) & 1023;\n        C = C >>> 8 ^ T0[(C ^ (240 | c >> 8 & 7)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c >> 2 & 63)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | d >> 6 & 15 | (c & 3) << 4)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | d & 63)) & 0xFF];\n      } else {\n        C = C >>> 8 ^ T0[(C ^ (224 | c >> 12 & 15)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c >> 6 & 63)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n      }\n    }\n\n    return ~C;\n  }\n\n  CRC32.table = T0;\n  CRC32.bstr = crc32_bstr;\n  CRC32.buf = crc32_buf;\n  CRC32.str = crc32_str;\n  return CRC32;\n}();\n/* [MS-CFB] v20171201 */\n\n\nvar CFB = /*#__PURE__*/function _CFB() {\n  var exports = {};\n  exports.version = '1.2.1';\n  /* [MS-CFB] 2.6.4 */\n\n  function namecmp(l\n  /*:string*/\n  , r\n  /*:string*/\n  )\n  /*:number*/\n  {\n    var L = l.split(\"/\"),\n        R = r.split(\"/\");\n\n    for (var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n      if (c = L[i].length - R[i].length) return c;\n      if (L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n    }\n\n    return L.length - R.length;\n  }\n\n  function dirname(p\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (p.charAt(p.length - 1) == \"/\") return p.slice(0, -1).indexOf(\"/\") === -1 ? p : dirname(p.slice(0, -1));\n    var c = p.lastIndexOf(\"/\");\n    return c === -1 ? p : p.slice(0, c + 1);\n  }\n\n  function filename(p\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n    var c = p.lastIndexOf(\"/\");\n    return c === -1 ? p : p.slice(c + 1);\n  }\n  /* -------------------------------------------------------------------------- */\n\n  /* DOS Date format:\n     high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n     add 1980 to stored year\n     stored second should be doubled\n  */\n\n  /* write JS date to buf as a DOS date */\n\n\n  function write_dos_date(buf\n  /*:CFBlob*/\n  , date\n  /*:Date|string*/\n  ) {\n    if (typeof date === \"string\") date = new Date(date);\n    var hms\n    /*:number*/\n    = date.getHours();\n    hms = hms << 6 | date.getMinutes();\n    hms = hms << 5 | date.getSeconds() >>> 1;\n    buf.write_shift(2, hms);\n    var ymd\n    /*:number*/\n    = date.getFullYear() - 1980;\n    ymd = ymd << 4 | date.getMonth() + 1;\n    ymd = ymd << 5 | date.getDate();\n    buf.write_shift(2, ymd);\n  }\n  /* read four bytes from buf and interpret as a DOS date */\n\n\n  function parse_dos_date(buf\n  /*:CFBlob*/\n  )\n  /*:Date*/\n  {\n    var hms = buf.read_shift(2) & 0xFFFF;\n    var ymd = buf.read_shift(2) & 0xFFFF;\n    var val = new Date();\n    var d = ymd & 0x1F;\n    ymd >>>= 5;\n    var m = ymd & 0x0F;\n    ymd >>>= 4;\n    val.setMilliseconds(0);\n    val.setFullYear(ymd + 1980);\n    val.setMonth(m - 1);\n    val.setDate(d);\n    var S = hms & 0x1F;\n    hms >>>= 5;\n    var M = hms & 0x3F;\n    hms >>>= 6;\n    val.setHours(hms);\n    val.setMinutes(M);\n    val.setSeconds(S << 1);\n    return val;\n  }\n\n  function parse_extra_field(blob\n  /*:CFBlob*/\n  )\n  /*:any*/\n  {\n    prep_blob(blob, 0);\n    var o =\n    /*::(*/\n    {}\n    /*:: :any)*/\n    ;\n    var flags = 0;\n\n    while (blob.l <= blob.length - 4) {\n      var type = blob.read_shift(2);\n      var sz = blob.read_shift(2),\n          tgt = blob.l + sz;\n      var p = {};\n\n      switch (type) {\n        /* UNIX-style Timestamps */\n        case 0x5455:\n          {\n            flags = blob.read_shift(1);\n            if (flags & 1) p.mtime = blob.read_shift(4);\n            /* for some reason, CD flag corresponds to LFH */\n\n            if (sz > 5) {\n              if (flags & 2) p.atime = blob.read_shift(4);\n              if (flags & 4) p.ctime = blob.read_shift(4);\n            }\n\n            if (p.mtime) p.mt = new Date(p.mtime * 1000);\n          }\n          break;\n      }\n\n      blob.l = tgt;\n      o[type] = p;\n    }\n\n    return o;\n  }\n\n  var fs\n  /*:: = require('fs'); */\n  ;\n\n  function get_fs() {\n    return fs || (fs = {});\n  }\n\n  function parse(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    if (file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\n    if ((file[0] | 0x20) == 0x6d && (file[1] | 0x20) == 0x69) return parse_mad(file, options);\n    if (file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\n    var mver = 3;\n    var ssz = 512;\n    var nmfs = 0; // number of mini FAT sectors\n\n    var difat_sec_cnt = 0;\n    var dir_start = 0;\n    var minifat_start = 0;\n    var difat_start = 0;\n    var fat_addrs\n    /*:Array<number>*/\n    = []; // locations of FAT sectors\n\n    /* [MS-CFB] 2.2 Compound File Header */\n\n    var blob\n    /*:CFBlob*/\n    =\n    /*::(*/\n    file.slice(0, 512)\n    /*:: :any)*/\n    ;\n    prep_blob(blob, 0);\n    /* major version */\n\n    var mv = check_get_mver(blob);\n    mver = mv[0];\n\n    switch (mver) {\n      case 3:\n        ssz = 512;\n        break;\n\n      case 4:\n        ssz = 4096;\n        break;\n\n      case 0:\n        if (mv[1] == 0) return parse_zip(file, options);\n\n      /* falls through */\n\n      default:\n        throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n    }\n    /* reprocess header */\n\n\n    if (ssz !== 512) {\n      blob =\n      /*::(*/\n      file.slice(0, ssz)\n      /*:: :any)*/\n      ;\n      prep_blob(blob, 28\n      /* blob.l */\n      );\n    }\n    /* Save header for final object */\n\n\n    var header\n    /*:RawBytes*/\n    = file.slice(0, ssz);\n    check_shifts(blob, mver); // Number of Directory Sectors\n\n    var dir_cnt\n    /*:number*/\n    = blob.read_shift(4, 'i');\n    if (mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt); // Number of FAT Sectors\n\n    blob.l += 4; // First Directory Sector Location\n\n    dir_start = blob.read_shift(4, 'i'); // Transaction Signature\n\n    blob.l += 4; // Mini Stream Cutoff Size\n\n    blob.chk('00100000', 'Mini Stream Cutoff Size: '); // First Mini FAT Sector Location\n\n    minifat_start = blob.read_shift(4, 'i'); // Number of Mini FAT Sectors\n\n    nmfs = blob.read_shift(4, 'i'); // First DIFAT sector location\n\n    difat_start = blob.read_shift(4, 'i'); // Number of DIFAT Sectors\n\n    difat_sec_cnt = blob.read_shift(4, 'i'); // Grab FAT Sector Locations\n\n    for (var q = -1, j = 0; j < 109; ++j) {\n      /* 109 = (512 - blob.l)>>>2; */\n      q = blob.read_shift(4, 'i');\n      if (q < 0) break;\n      fat_addrs[j] = q;\n    }\n    /** Break the file up into sectors */\n\n\n    var sectors\n    /*:Array<RawBytes>*/\n    = sectorify(file, ssz);\n    sleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n    /** Chains */\n\n    var sector_list\n    /*:SectorList*/\n    = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n    sector_list[dir_start].name = \"!Directory\";\n    if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n    sector_list[fat_addrs[0]].name = \"!FAT\";\n    sector_list.fat_addrs = fat_addrs;\n    sector_list.ssz = ssz;\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n    var files\n    /*:CFBFiles*/\n    = {},\n        Paths\n    /*:Array<string>*/\n    = [],\n        FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n    build_full_paths(FileIndex, FullPaths, Paths);\n    Paths.shift();\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    }; // $FlowIgnore\n\n    if (options && options.raw) o.raw = {\n      header: header,\n      sectors: sectors\n    };\n    return o;\n  } // parse\n\n  /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n\n\n  function check_get_mver(blob\n  /*:CFBlob*/\n  )\n  /*:[number, number]*/\n  {\n    if (blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0]; // header signature 8\n\n    blob.chk(HEADER_SIGNATURE, 'Header Signature: '); // clsid 16\n    //blob.chk(HEADER_CLSID, 'CLSID: ');\n\n    blob.l += 16; // minor version 2\n\n    var mver\n    /*:number*/\n    = blob.read_shift(2, 'u');\n    return [blob.read_shift(2, 'u'), mver];\n  }\n\n  function check_shifts(blob\n  /*:CFBlob*/\n  , mver\n  /*:number*/\n  )\n  /*:void*/\n  {\n    var shift = 0x09; // Byte Order\n    //blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\n    blob.l += 2; // Sector Shift\n\n    switch (shift = blob.read_shift(2)) {\n      case 0x09:\n        if (mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift);\n        break;\n\n      case 0x0c:\n        if (mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift);\n        break;\n\n      default:\n        throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n    } // Mini Sector Shift\n\n\n    blob.chk('0600', 'Mini Sector Shift: '); // Reserved\n\n    blob.chk('000000000000', 'Reserved: ');\n  }\n  /** Break the file up into sectors */\n\n\n  function sectorify(file\n  /*:RawBytes*/\n  , ssz\n  /*:number*/\n  )\n  /*:Array<RawBytes>*/\n  {\n    var nsectors = Math.ceil(file.length / ssz) - 1;\n    var sectors\n    /*:Array<RawBytes>*/\n    = [];\n\n    for (var i = 1; i < nsectors; ++i) {\n      sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n    }\n\n    sectors[nsectors - 1] = file.slice(nsectors * ssz);\n    return sectors;\n  }\n  /* [MS-CFB] 2.6.4 Red-Black Tree */\n\n\n  function build_full_paths(FI\n  /*:CFBFileIndex*/\n  , FP\n  /*:Array<string>*/\n  , Paths\n  /*:Array<string>*/\n  )\n  /*:void*/\n  {\n    var i = 0,\n        L = 0,\n        R = 0,\n        C = 0,\n        j = 0,\n        pl = Paths.length;\n    var dad\n    /*:Array<number>*/\n    = [],\n        q\n    /*:Array<number>*/\n    = [];\n\n    for (; i < pl; ++i) {\n      dad[i] = q[i] = i;\n      FP[i] = Paths[i];\n    }\n\n    for (; j < q.length; ++j) {\n      i = q[j];\n      L = FI[i].L;\n      R = FI[i].R;\n      C = FI[i].C;\n\n      if (dad[i] === i) {\n        if (L !== -1\n        /*NOSTREAM*/\n        && dad[L] !== L) dad[i] = dad[L];\n        if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n      }\n\n      if (C !== -1\n      /*NOSTREAM*/\n      ) dad[C] = i;\n\n      if (L !== -1 && i != dad[i]) {\n        dad[L] = dad[i];\n        if (q.lastIndexOf(L) < j) q.push(L);\n      }\n\n      if (R !== -1 && i != dad[i]) {\n        dad[R] = dad[i];\n        if (q.lastIndexOf(R) < j) q.push(R);\n      }\n    }\n\n    for (i = 1; i < pl; ++i) {\n      if (dad[i] === i) {\n        if (R !== -1\n        /*NOSTREAM*/\n        && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n      }\n    }\n\n    for (i = 1; i < pl; ++i) {\n      if (FI[i].type === 0\n      /* unknown */\n      ) continue;\n      j = i;\n      if (j != dad[j]) do {\n        j = dad[j];\n        FP[i] = FP[j] + \"/\" + FP[i];\n      } while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n      dad[i] = -1;\n    }\n\n    FP[0] += \"/\";\n\n    for (i = 1; i < pl; ++i) {\n      if (FI[i].type !== 2\n      /* stream */\n      ) FP[i] += \"/\";\n    }\n  }\n\n  function get_mfat_entry(entry\n  /*:CFBEntry*/\n  , payload\n  /*:RawBytes*/\n  , mini\n  /*:?RawBytes*/\n  )\n  /*:CFBlob*/\n  {\n    var start = entry.start,\n        size = entry.size; //return (payload.slice(start*MSSZ, start*MSSZ + size)/*:any*/);\n\n    var o = [];\n    var idx = start;\n\n    while (mini && size > 0 && idx >= 0) {\n      o.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n      size -= MSSZ;\n      idx = __readInt32LE(mini, idx * 4);\n    }\n\n    if (o.length === 0) return new_buf(0)\n    /*:any*/\n    ;\n    return bconcat(o).slice(0, entry.size)\n    /*:any*/\n    ;\n  }\n  /** Chase down the rest of the DIFAT chain to build a comprehensive list\n      DIFAT chains by storing the next sector number as the last 32 bits */\n\n\n  function sleuth_fat(idx\n  /*:number*/\n  , cnt\n  /*:number*/\n  , sectors\n  /*:Array<RawBytes>*/\n  , ssz\n  /*:number*/\n  , fat_addrs)\n  /*:void*/\n  {\n    var q\n    /*:number*/\n    = ENDOFCHAIN;\n\n    if (idx === ENDOFCHAIN) {\n      if (cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n    } else if (idx !== -1\n    /*FREESECT*/\n    ) {\n      var sector = sectors[idx],\n          m = (ssz >>> 2) - 1;\n      if (!sector) return;\n\n      for (var i = 0; i < m; ++i) {\n        if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n        fat_addrs.push(q);\n      }\n\n      sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n    }\n  }\n  /** Follow the linked list of sectors for a given starting point */\n\n\n  function get_sector_list(sectors\n  /*:Array<RawBytes>*/\n  , start\n  /*:number*/\n  , fat_addrs\n  /*:Array<number>*/\n  , ssz\n  /*:number*/\n  , chkd\n  /*:?Array<boolean>*/\n  )\n  /*:SectorEntry*/\n  {\n    var buf\n    /*:Array<number>*/\n    = [],\n        buf_chain\n    /*:Array<any>*/\n    = [];\n    if (!chkd) chkd = [];\n    var modulus = ssz - 1,\n        j = 0,\n        jj = 0;\n\n    for (j = start; j >= 0;) {\n      chkd[j] = true;\n      buf[buf.length] = j;\n      buf_chain.push(sectors[j]);\n      var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n      jj = j * 4 & modulus;\n      if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n      if (!sectors[addr]) break;\n      j = __readInt32LE(sectors[addr], jj);\n    }\n\n    return {\n      nodes: buf,\n      data: __toBuffer([buf_chain])\n    };\n  }\n  /** Chase down the sector linked lists */\n\n\n  function make_sector_list(sectors\n  /*:Array<RawBytes>*/\n  , dir_start\n  /*:number*/\n  , fat_addrs\n  /*:Array<number>*/\n  , ssz\n  /*:number*/\n  )\n  /*:SectorList*/\n  {\n    var sl = sectors.length,\n        sector_list\n    /*:SectorList*/\n    = []\n    /*:any*/\n    ;\n    var chkd\n    /*:Array<boolean>*/\n    = [],\n        buf\n    /*:Array<number>*/\n    = [],\n        buf_chain\n    /*:Array<RawBytes>*/\n    = [];\n    var modulus = ssz - 1,\n        i = 0,\n        j = 0,\n        k = 0,\n        jj = 0;\n\n    for (i = 0; i < sl; ++i) {\n      buf = []\n      /*:Array<number>*/\n      ;\n      k = i + dir_start;\n      if (k >= sl) k -= sl;\n      if (chkd[k]) continue;\n      buf_chain = [];\n      var seen = [];\n\n      for (j = k; j >= 0;) {\n        seen[j] = true;\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr\n        /*:number*/\n        = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n        if (!sectors[addr]) break;\n        j = __readInt32LE(sectors[addr], jj);\n        if (seen[j]) break;\n      }\n\n      sector_list[k] = {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      }\n      /*:SectorEntry*/\n      ;\n    }\n\n    return sector_list;\n  }\n  /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n\n  function read_directory(dir_start\n  /*:number*/\n  , sector_list\n  /*:SectorList*/\n  , sectors\n  /*:Array<RawBytes>*/\n  , Paths\n  /*:Array<string>*/\n  , nmfs, files, FileIndex, mini) {\n    var minifat_store = 0,\n        pl = Paths.length ? 2 : 0;\n    var sector = sector_list[dir_start].data;\n    var i = 0,\n        namelen = 0,\n        name;\n\n    for (; i < sector.length; i += 128) {\n      var blob\n      /*:CFBlob*/\n      =\n      /*::(*/\n      sector.slice(i, i + 128)\n      /*:: :any)*/\n      ;\n      prep_blob(blob, 64);\n      namelen = blob.read_shift(2);\n      name = __utf16le(blob, 0, namelen - pl);\n      Paths.push(name);\n      var o\n      /*:CFBEntry*/\n      = {\n        name: name,\n        type: blob.read_shift(1),\n        color: blob.read_shift(1),\n        L: blob.read_shift(4, 'i'),\n        R: blob.read_shift(4, 'i'),\n        C: blob.read_shift(4, 'i'),\n        clsid: blob.read_shift(16),\n        state: blob.read_shift(4, 'i'),\n        start: 0,\n        size: 0\n      };\n      var ctime\n      /*:number*/\n      = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n      if (ctime !== 0) o.ct = read_date(blob, blob.l - 8);\n      var mtime\n      /*:number*/\n      = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n      if (mtime !== 0) o.mt = read_date(blob, blob.l - 8);\n      o.start = blob.read_shift(4, 'i');\n      o.size = blob.read_shift(4, 'i');\n\n      if (o.size < 0 && o.start < 0) {\n        o.size = o.type = 0;\n        o.start = ENDOFCHAIN;\n        o.name = \"\";\n      }\n\n      if (o.type === 5) {\n        /* root */\n        minifat_store = o.start;\n        if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n        /*minifat_size = o.size;*/\n      } else if (o.size >= 4096\n      /* MSCSZ */\n      ) {\n        o.storage = 'fat';\n        if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n        sector_list[o.start].name = o.name;\n        o.content = sector_list[o.start].data.slice(0, o.size)\n        /*:any*/\n        ;\n      } else {\n        o.storage = 'minifat';\n        if (o.size < 0) o.size = 0;else if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n          o.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini] || {}).data);\n        }\n      }\n\n      if (o.content) prep_blob(o.content, 0);\n      files[name] = o;\n      FileIndex.push(o);\n    }\n  }\n\n  function read_date(blob\n  /*:RawBytes|CFBlob*/\n  , offset\n  /*:number*/\n  )\n  /*:Date*/\n  {\n    return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n  }\n\n  function read_file(filename\n  /*:string*/\n  , options\n  /*:CFBReadOpts*/\n  ) {\n    get_fs();\n    return parse(fs.readFileSync(filename), options);\n  }\n\n  function read(blob\n  /*:RawBytes|string*/\n  , options\n  /*:CFBReadOpts*/\n  ) {\n    var type = options && options.type;\n\n    if (!type) {\n      if (has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n    }\n\n    switch (type || \"base64\") {\n      case \"file\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a filename when type='file'\"; */\n        return read_file(blob, options);\n\n      case \"base64\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a base64-encoded binary string when type='file'\"; */\n        return parse(s2a(Base64_decode(blob)), options);\n\n      case \"binary\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a binary string when type='file'\"; */\n        return parse(s2a(blob), options);\n    }\n\n    return parse(\n    /*::typeof blob == 'string' ? new Buffer(blob, 'utf-8') : */\n    blob, options);\n  }\n\n  function init_cfb(cfb\n  /*:CFBContainer*/\n  , opts\n  /*:?any*/\n  )\n  /*:void*/\n  {\n    var o = opts || {},\n        root = o.root || \"Root Entry\";\n    if (!cfb.FullPaths) cfb.FullPaths = [];\n    if (!cfb.FileIndex) cfb.FileIndex = [];\n    if (cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\n    if (cfb.FullPaths.length === 0) {\n      cfb.FullPaths[0] = root + \"/\";\n      cfb.FileIndex[0] = {\n        name: root,\n        type: 5\n      }\n      /*:any*/\n      ;\n    }\n\n    if (o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n    seed_cfb(cfb);\n  }\n\n  function seed_cfb(cfb\n  /*:CFBContainer*/\n  )\n  /*:void*/\n  {\n    var nm = \"\\x01Sh33tJ5\";\n    if (CFB.find(cfb, \"/\" + nm)) return;\n    var p = new_buf(4);\n    p[0] = 55;\n    p[1] = p[3] = 50;\n    p[2] = 54;\n    cfb.FileIndex.push({\n      name: nm,\n      type: 2,\n      content: p,\n      size: 4,\n      L: 69,\n      R: 69,\n      C: 69\n    }\n    /*:any*/\n    );\n    cfb.FullPaths.push(cfb.FullPaths[0] + nm);\n    rebuild_cfb(cfb);\n  }\n\n  function rebuild_cfb(cfb\n  /*:CFBContainer*/\n  , f\n  /*:?boolean*/\n  )\n  /*:void*/\n  {\n    init_cfb(cfb);\n    var gc = false,\n        s = false;\n\n    for (var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n      var _file = cfb.FileIndex[i];\n\n      switch (_file.type) {\n        case 0:\n          if (s) gc = true;else {\n            cfb.FileIndex.pop();\n            cfb.FullPaths.pop();\n          }\n          break;\n\n        case 1:\n        case 2:\n        case 5:\n          s = true;\n          if (isNaN(_file.R * _file.L * _file.C)) gc = true;\n          if (_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n          break;\n\n        default:\n          gc = true;\n          break;\n      }\n    }\n\n    if (!gc && !f) return;\n    var now = new Date(1987, 1, 19),\n        j = 0; // Track which names exist\n\n    var fullPaths = Object.create ? Object.create(null) : {};\n    var data\n    /*:Array<[string, CFBEntry]>*/\n    = [];\n\n    for (i = 0; i < cfb.FullPaths.length; ++i) {\n      fullPaths[cfb.FullPaths[i]] = true;\n      if (cfb.FileIndex[i].type === 0) continue;\n      data.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n    }\n\n    for (i = 0; i < data.length; ++i) {\n      var dad = dirname(data[i][0]);\n      s = fullPaths[dad];\n\n      if (!s) {\n        data.push([dad, {\n          name: filename(dad).replace(\"/\", \"\"),\n          type: 1,\n          clsid: HEADER_CLSID,\n          ct: now,\n          mt: now,\n          content: null\n        }\n        /*:any*/\n        ]); // Add name to set\n\n        fullPaths[dad] = true;\n      }\n    }\n\n    data.sort(function (x, y) {\n      return namecmp(x[0], y[0]);\n    });\n    cfb.FullPaths = [];\n    cfb.FileIndex = [];\n\n    for (i = 0; i < data.length; ++i) {\n      cfb.FullPaths[i] = data[i][0];\n      cfb.FileIndex[i] = data[i][1];\n    }\n\n    for (i = 0; i < data.length; ++i) {\n      var elt = cfb.FileIndex[i];\n      var nm = cfb.FullPaths[i];\n      elt.name = filename(nm).replace(\"/\", \"\");\n      elt.L = elt.R = elt.C = -(elt.color = 1);\n      elt.size = elt.content ? elt.content.length : 0;\n      elt.start = 0;\n      elt.clsid = elt.clsid || HEADER_CLSID;\n\n      if (i === 0) {\n        elt.C = data.length > 1 ? 1 : -1;\n        elt.size = 0;\n        elt.type = 5;\n      } else if (nm.slice(-1) == \"/\") {\n        for (j = i + 1; j < data.length; ++j) {\n          if (dirname(cfb.FullPaths[j]) == nm) break;\n        }\n\n        elt.C = j >= data.length ? -1 : j;\n\n        for (j = i + 1; j < data.length; ++j) {\n          if (dirname(cfb.FullPaths[j]) == dirname(nm)) break;\n        }\n\n        elt.R = j >= data.length ? -1 : j;\n        elt.type = 1;\n      } else {\n        if (dirname(cfb.FullPaths[i + 1] || \"\") == dirname(nm)) elt.R = i + 1;\n        elt.type = 2;\n      }\n    }\n  }\n\n  function _write(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes|string*/\n  {\n    var _opts = options || {};\n    /* MAD is order-sensitive, skip rebuild and sort */\n\n\n    if (_opts.fileType == 'mad') return write_mad(cfb, _opts);\n    rebuild_cfb(cfb);\n\n    switch (_opts.fileType) {\n      case 'zip':\n        return write_zip(cfb, _opts);\n      //case 'mad': return write_mad(cfb, _opts);\n    }\n\n    var L = function (cfb\n    /*:CFBContainer*/\n    )\n    /*:Array<number>*/\n    {\n      var mini_size = 0,\n          fat_size = 0;\n\n      for (var i = 0; i < cfb.FileIndex.length; ++i) {\n        var file = cfb.FileIndex[i];\n        if (!file.content) continue;\n        /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n        var flen = file.content.length;\n\n        if (flen > 0) {\n          if (flen < 0x1000) mini_size += flen + 0x3F >> 6;else fat_size += flen + 0x01FF >> 9;\n        }\n      }\n\n      var dir_cnt = cfb.FullPaths.length + 3 >> 2;\n      var mini_cnt = mini_size + 7 >> 3;\n      var mfat_cnt = mini_size + 0x7F >> 7;\n      var fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n      var fat_cnt = fat_base + 0x7F >> 7;\n      var difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n\n      while (fat_base + fat_cnt + difat_cnt + 0x7F >> 7 > fat_cnt) {\n        difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n      }\n\n      var L = [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n      cfb.FileIndex[0].size = mini_size << 6;\n      L[7] = (cfb.FileIndex[0].start = L[0] + L[1] + L[2] + L[3] + L[4] + L[5]) + (L[6] + 7 >> 3);\n      return L;\n    }(cfb);\n\n    var o = new_buf(L[7] << 9);\n    var i = 0,\n        T = 0;\n    {\n      for (i = 0; i < 8; ++i) {\n        o.write_shift(1, HEADER_SIG[i]);\n      }\n\n      for (i = 0; i < 8; ++i) {\n        o.write_shift(2, 0);\n      }\n\n      o.write_shift(2, 0x003E);\n      o.write_shift(2, 0x0003);\n      o.write_shift(2, 0xFFFE);\n      o.write_shift(2, 0x0009);\n      o.write_shift(2, 0x0006);\n\n      for (i = 0; i < 3; ++i) {\n        o.write_shift(2, 0);\n      }\n\n      o.write_shift(4, 0);\n      o.write_shift(4, L[2]);\n      o.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n      o.write_shift(4, 0);\n      o.write_shift(4, 1 << 12);\n      o.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1 : ENDOFCHAIN);\n      o.write_shift(4, L[3]);\n      o.write_shift(-4, L[1] ? L[0] - 1 : ENDOFCHAIN);\n      o.write_shift(4, L[1]);\n\n      for (i = 0; i < 109; ++i) {\n        o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n      }\n    }\n\n    if (L[1]) {\n      for (T = 0; T < L[1]; ++T) {\n        for (; i < 236 + T * 127; ++i) {\n          o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n        }\n\n        o.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n      }\n    }\n\n    var chainit = function chainit(w\n    /*:number*/\n    )\n    /*:void*/\n    {\n      for (T += w; i < T - 1; ++i) {\n        o.write_shift(-4, i + 1);\n      }\n\n      if (w) {\n        ++i;\n        o.write_shift(-4, ENDOFCHAIN);\n      }\n    };\n\n    T = i = 0;\n\n    for (T += L[1]; i < T; ++i) {\n      o.write_shift(-4, consts.DIFSECT);\n    }\n\n    for (T += L[2]; i < T; ++i) {\n      o.write_shift(-4, consts.FATSECT);\n    }\n\n    chainit(L[3]);\n    chainit(L[4]);\n    var j\n    /*:number*/\n    = 0,\n        flen\n    /*:number*/\n    = 0;\n    var file\n    /*:CFBEntry*/\n    = cfb.FileIndex[0];\n\n    for (; j < cfb.FileIndex.length; ++j) {\n      file = cfb.FileIndex[j];\n      if (!file.content) continue;\n      /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n      flen = file.content.length;\n      if (flen < 0x1000) continue;\n      file.start = T;\n      chainit(flen + 0x01FF >> 9);\n    }\n\n    chainit(L[6] + 7 >> 3);\n\n    while (o.l & 0x1FF) {\n      o.write_shift(-4, consts.ENDOFCHAIN);\n    }\n\n    T = i = 0;\n\n    for (j = 0; j < cfb.FileIndex.length; ++j) {\n      file = cfb.FileIndex[j];\n      if (!file.content) continue;\n      /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n      flen = file.content.length;\n      if (!flen || flen >= 0x1000) continue;\n      file.start = T;\n      chainit(flen + 0x3F >> 6);\n    }\n\n    while (o.l & 0x1FF) {\n      o.write_shift(-4, consts.ENDOFCHAIN);\n    }\n\n    for (i = 0; i < L[4] << 2; ++i) {\n      var nm = cfb.FullPaths[i];\n\n      if (!nm || nm.length === 0) {\n        for (j = 0; j < 17; ++j) {\n          o.write_shift(4, 0);\n        }\n\n        for (j = 0; j < 3; ++j) {\n          o.write_shift(4, -1);\n        }\n\n        for (j = 0; j < 12; ++j) {\n          o.write_shift(4, 0);\n        }\n\n        continue;\n      }\n\n      file = cfb.FileIndex[i];\n      if (i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\n      var _nm\n      /*:string*/\n      = i === 0 && _opts.root || file.name;\n\n      flen = 2 * (_nm.length + 1);\n      o.write_shift(64, _nm, \"utf16le\");\n      o.write_shift(2, flen);\n      o.write_shift(1, file.type);\n      o.write_shift(1, file.color);\n      o.write_shift(-4, file.L);\n      o.write_shift(-4, file.R);\n      o.write_shift(-4, file.C);\n      if (!file.clsid) for (j = 0; j < 4; ++j) {\n        o.write_shift(4, 0);\n      } else o.write_shift(16, file.clsid, \"hex\");\n      o.write_shift(4, file.state || 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, file.start);\n      o.write_shift(4, file.size);\n      o.write_shift(4, 0);\n    }\n\n    for (i = 1; i < cfb.FileIndex.length; ++i) {\n      file = cfb.FileIndex[i];\n      /*:: if(!file.content) throw new Error(\"unreachable\"); */\n\n      if (file.size >= 0x1000) {\n        o.l = file.start + 1 << 9;\n\n        if (has_buf && Buffer.isBuffer(file.content)) {\n          file.content.copy(o, o.l, 0, file.size); // o is a 0-filled Buffer so just set next offset\n\n          o.l += file.size + 511 & -512;\n        } else {\n          for (j = 0; j < file.size; ++j) {\n            o.write_shift(1, file.content[j]);\n          }\n\n          for (; j & 0x1FF; ++j) {\n            o.write_shift(1, 0);\n          }\n        }\n      }\n    }\n\n    for (i = 1; i < cfb.FileIndex.length; ++i) {\n      file = cfb.FileIndex[i];\n      /*:: if(!file.content) throw new Error(\"unreachable\"); */\n\n      if (file.size > 0 && file.size < 0x1000) {\n        if (has_buf && Buffer.isBuffer(file.content)) {\n          file.content.copy(o, o.l, 0, file.size); // o is a 0-filled Buffer so just set next offset\n\n          o.l += file.size + 63 & -64;\n        } else {\n          for (j = 0; j < file.size; ++j) {\n            o.write_shift(1, file.content[j]);\n          }\n\n          for (; j & 0x3F; ++j) {\n            o.write_shift(1, 0);\n          }\n        }\n      }\n    }\n\n    if (has_buf) {\n      o.l = o.length;\n    } else {\n      // When using Buffer, already 0-filled\n      while (o.l < o.length) {\n        o.write_shift(1, 0);\n      }\n    }\n\n    return o;\n  }\n  /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n\n\n  function find(cfb\n  /*:CFBContainer*/\n  , path\n  /*:string*/\n  )\n  /*:?CFBEntry*/\n  {\n    var UCFullPaths\n    /*:Array<string>*/\n    = cfb.FullPaths.map(function (x) {\n      return x.toUpperCase();\n    });\n    var UCPaths\n    /*:Array<string>*/\n    = UCFullPaths.map(function (x) {\n      var y = x.split(\"/\");\n      return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)];\n    });\n    var k\n    /*:boolean*/\n    = false;\n\n    if (path.charCodeAt(0) === 47\n    /* \"/\" */\n    ) {\n      k = true;\n      path = UCFullPaths[0].slice(0, -1) + path;\n    } else k = path.indexOf(\"/\") !== -1;\n\n    var UCPath\n    /*:string*/\n    = path.toUpperCase();\n    var w\n    /*:number*/\n    = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n    if (w !== -1) return cfb.FileIndex[w];\n    var m = !UCPath.match(chr1);\n    UCPath = UCPath.replace(chr0, '');\n    if (m) UCPath = UCPath.replace(chr1, '!');\n\n    for (w = 0; w < UCFullPaths.length; ++w) {\n      if ((m ? UCFullPaths[w].replace(chr1, '!') : UCFullPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n      if ((m ? UCPaths[w].replace(chr1, '!') : UCPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n    }\n\n    return null;\n  }\n  /** CFB Constants */\n\n\n  var MSSZ = 64;\n  /* Mini Sector Size = 1<<6 */\n  //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n\n  /* 2.1 Compound File Sector Numbers and Types */\n\n  var ENDOFCHAIN = -2;\n  /* 2.2 Compound File Header */\n\n  var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n  var HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\n  var HEADER_CLSID = '00000000000000000000000000000000';\n  var consts = {\n    /* 2.1 Compund File Sector Numbers and Types */\n    MAXREGSECT: -6,\n    DIFSECT: -4,\n    FATSECT: -3,\n    ENDOFCHAIN: ENDOFCHAIN,\n    FREESECT: -1,\n\n    /* 2.2 Compound File Header */\n    HEADER_SIGNATURE: HEADER_SIGNATURE,\n    HEADER_MINOR_VERSION: '3e00',\n    MAXREGSID: -6,\n    NOSTREAM: -1,\n    HEADER_CLSID: HEADER_CLSID,\n\n    /* 2.6.1 Compound File Directory Entry */\n    EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n  };\n\n  function write_file(cfb\n  /*:CFBContainer*/\n  , filename\n  /*:string*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:void*/\n  {\n    get_fs();\n\n    var o = _write(cfb, options);\n    /*:: if(typeof Buffer == 'undefined' || !Buffer.isBuffer(o) || !(o instanceof Buffer)) throw new Error(\"unreachable\"); */\n\n\n    fs.writeFileSync(filename, o);\n  }\n\n  function a2s(o\n  /*:RawBytes*/\n  )\n  /*:string*/\n  {\n    var out = new Array(o.length);\n\n    for (var i = 0; i < o.length; ++i) {\n      out[i] = String.fromCharCode(o[i]);\n    }\n\n    return out.join(\"\");\n  }\n\n  function write(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes|string*/\n  {\n    var o = _write(cfb, options);\n\n    switch (options && options.type || \"buffer\") {\n      case \"file\":\n        get_fs();\n        fs.writeFileSync(options.filename, o\n        /*:any*/\n        );\n        return o;\n\n      case \"binary\":\n        return typeof o == \"string\" ? o : a2s(o);\n\n      case \"base64\":\n        return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\n      case \"buffer\":\n        if (has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\n      /* falls through */\n\n      case \"array\":\n        return typeof o == \"string\" ? s2a(o) : o;\n    }\n\n    return o;\n  }\n  /* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\n\n\n  var _zlib;\n\n  function use_zlib(zlib) {\n    try {\n      var InflateRaw = zlib.InflateRaw;\n      var InflRaw = new InflateRaw();\n\n      InflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\n      if (InflRaw.bytesRead) _zlib = zlib;else throw new Error(\"zlib does not expose bytesRead\");\n    } catch (e) {\n      console.error(\"cannot use native zlib: \" + (e.message || e));\n    }\n  }\n\n  function _inflateRawSync(payload, usz) {\n    if (!_zlib) return _inflate(payload, usz);\n    var InflateRaw = _zlib.InflateRaw;\n    var InflRaw = new InflateRaw();\n\n    var out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\n    payload.l += InflRaw.bytesRead;\n    return out;\n  }\n\n  function _deflateRawSync(payload) {\n    return _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n  }\n\n  var CLEN_ORDER = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];\n  /*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\n\n  var LEN_LN = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258];\n  /*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\n\n  var DST_LN = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];\n\n  function bit_swap_8(n) {\n    var t = (n << 1 | n << 11) & 0x22110 | (n << 5 | n << 15) & 0x88440;\n    return (t >> 16 | t >> 8 | t) & 0xFF;\n  }\n\n  var use_typed_arrays = typeof Uint8Array !== 'undefined';\n  var bitswap8 = use_typed_arrays ? new Uint8Array(1 << 8) : [];\n\n  for (var q = 0; q < 1 << 8; ++q) {\n    bitswap8[q] = bit_swap_8(q);\n  }\n\n  function bit_swap_n(n, b) {\n    var rev = bitswap8[n & 0xFF];\n    if (b <= 8) return rev >>> 8 - b;\n    rev = rev << 8 | bitswap8[n >> 8 & 0xFF];\n    if (b <= 16) return rev >>> 16 - b;\n    rev = rev << 8 | bitswap8[n >> 16 & 0xFF];\n    return rev >>> 24 - b;\n  }\n  /* helpers for unaligned bit reads */\n\n\n  function read_bits_2(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 6 ? 0 : buf[h + 1] << 8)) >>> w & 0x03;\n  }\n\n  function read_bits_3(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 5 ? 0 : buf[h + 1] << 8)) >>> w & 0x07;\n  }\n\n  function read_bits_4(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 4 ? 0 : buf[h + 1] << 8)) >>> w & 0x0F;\n  }\n\n  function read_bits_5(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 3 ? 0 : buf[h + 1] << 8)) >>> w & 0x1F;\n  }\n\n  function read_bits_7(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 1 ? 0 : buf[h + 1] << 8)) >>> w & 0x7F;\n  }\n  /* works up to n = 3 * 8 + 1 = 25 */\n\n\n  function read_bits_n(buf, bl, n) {\n    var w = bl & 7,\n        h = bl >>> 3,\n        f = (1 << n) - 1;\n    var v = buf[h] >>> w;\n    if (n < 8 - w) return v & f;\n    v |= buf[h + 1] << 8 - w;\n    if (n < 16 - w) return v & f;\n    v |= buf[h + 2] << 16 - w;\n    if (n < 24 - w) return v & f;\n    v |= buf[h + 3] << 24 - w;\n    return v & f;\n  }\n  /* helpers for unaligned bit writes */\n\n\n  function write_bits_3(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    if (w <= 5) buf[h] |= (v & 7) << w;else {\n      buf[h] |= v << w & 0xFF;\n      buf[h + 1] = (v & 7) >> 8 - w;\n    }\n    return bl + 3;\n  }\n\n  function write_bits_1(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v = (v & 1) << w;\n    buf[h] |= v;\n    return bl + 1;\n  }\n\n  function write_bits_8(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v <<= w;\n    buf[h] |= v & 0xFF;\n    v >>>= 8;\n    buf[h + 1] = v;\n    return bl + 8;\n  }\n\n  function write_bits_16(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v <<= w;\n    buf[h] |= v & 0xFF;\n    v >>>= 8;\n    buf[h + 1] = v & 0xFF;\n    buf[h + 2] = v >>> 8;\n    return bl + 16;\n  }\n  /* until ArrayBuffer#realloc is a thing, fake a realloc */\n\n\n  function realloc(b, sz\n  /*:number*/\n  ) {\n    var L = b.length,\n        M = 2 * L > sz ? 2 * L : sz + 5,\n        i = 0;\n    if (L >= sz) return b;\n\n    if (has_buf) {\n      var o = new_unsafe_buf(M); // $FlowIgnore\n\n      if (b.copy) b.copy(o);else for (; i < b.length; ++i) {\n        o[i] = b[i];\n      }\n      return o;\n    } else if (use_typed_arrays) {\n      var a = new Uint8Array(M);\n      if (a.set) a.set(b);else for (; i < L; ++i) {\n        a[i] = b[i];\n      }\n      return a;\n    }\n\n    b.length = M;\n    return b;\n  }\n  /* zero-filled arrays for older browsers */\n\n\n  function zero_fill_array(n) {\n    var o = new Array(n);\n\n    for (var i = 0; i < n; ++i) {\n      o[i] = 0;\n    }\n\n    return o;\n  }\n  /* build tree (used for literals and lengths) */\n\n\n  function build_tree(clens, cmap, MAX\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var maxlen = 1,\n        w = 0,\n        i = 0,\n        j = 0,\n        ccode = 0,\n        L = clens.length;\n    var bl_count = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\n    for (i = 0; i < 32; ++i) {\n      bl_count[i] = 0;\n    }\n\n    for (i = L; i < MAX; ++i) {\n      clens[i] = 0;\n    }\n\n    L = clens.length;\n    var ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n    /* build code tree */\n\n    for (i = 0; i < L; ++i) {\n      bl_count[w = clens[i]]++;\n      if (maxlen < w) maxlen = w;\n      ctree[i] = 0;\n    }\n\n    bl_count[0] = 0;\n\n    for (i = 1; i <= maxlen; ++i) {\n      bl_count[i + 16] = ccode = ccode + bl_count[i - 1] << 1;\n    }\n\n    for (i = 0; i < L; ++i) {\n      ccode = clens[i];\n      if (ccode != 0) ctree[i] = bl_count[ccode + 16]++;\n    }\n    /* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\n\n    var cleni = 0;\n\n    for (i = 0; i < L; ++i) {\n      cleni = clens[i];\n\n      if (cleni != 0) {\n        ccode = bit_swap_n(ctree[i], maxlen) >> maxlen - cleni;\n\n        for (j = (1 << maxlen + 4 - cleni) - 1; j >= 0; --j) {\n          cmap[ccode | j << cleni] = cleni & 15 | i << 4;\n        }\n      }\n    }\n\n    return maxlen;\n  }\n  /* Fixed Huffman */\n\n\n  var fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\n  var fix_dmap = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\n  if (!use_typed_arrays) {\n    for (var i = 0; i < 512; ++i) {\n      fix_lmap[i] = 0;\n    }\n\n    for (i = 0; i < 32; ++i) {\n      fix_dmap[i] = 0;\n    }\n  }\n\n  (function () {\n    var dlens\n    /*:Array<number>*/\n    = [];\n    var i = 0;\n\n    for (; i < 32; i++) {\n      dlens.push(5);\n    }\n\n    build_tree(dlens, fix_dmap, 32);\n    var clens\n    /*:Array<number>*/\n    = [];\n    i = 0;\n\n    for (; i <= 143; i++) {\n      clens.push(8);\n    }\n\n    for (; i <= 255; i++) {\n      clens.push(9);\n    }\n\n    for (; i <= 279; i++) {\n      clens.push(7);\n    }\n\n    for (; i <= 287; i++) {\n      clens.push(8);\n    }\n\n    build_tree(clens, fix_lmap, 288);\n  })();\n\n  var _deflateRaw = /*#__PURE__*/function _deflateRawIIFE() {\n    var DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n    var j = 0,\n        k = 0;\n\n    for (; j < DST_LN.length - 1; ++j) {\n      for (; k < DST_LN[j + 1]; ++k) {\n        DST_LN_RE[k] = j;\n      }\n    }\n\n    for (; k < 32768; ++k) {\n      DST_LN_RE[k] = 29;\n    }\n\n    var LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\n    for (j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n      for (; k < LEN_LN[j + 1]; ++k) {\n        LEN_LN_RE[k] = j;\n      }\n    }\n\n    function write_stored(data, out) {\n      var boff = 0;\n\n      while (boff < data.length) {\n        var L = Math.min(0xFFFF, data.length - boff);\n        var h = boff + L == data.length;\n        out.write_shift(1, +h);\n        out.write_shift(2, L);\n        out.write_shift(2, ~L & 0xFFFF);\n\n        while (L-- > 0) {\n          out[out.l++] = data[boff++];\n        }\n      }\n\n      return out.l;\n    }\n    /* Fixed Huffman */\n\n\n    function write_huff_fixed(data, out) {\n      var bl = 0;\n      var boff = 0;\n      var addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\n      while (boff < data.length) {\n        var L =\n        /* data.length - boff; */\n        Math.min(0xFFFF, data.length - boff);\n        /* write a stored block for short data */\n\n        if (L < 10) {\n          bl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\n          if (bl & 7) bl += 8 - (bl & 7);\n          out.l = bl / 8 | 0;\n          out.write_shift(2, L);\n          out.write_shift(2, ~L & 0xFFFF);\n\n          while (L-- > 0) {\n            out[out.l++] = data[boff++];\n          }\n\n          bl = out.l * 8;\n          continue;\n        }\n\n        bl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\n        var hash = 0;\n\n        while (L-- > 0) {\n          var d = data[boff];\n          hash = (hash << 5 ^ d) & 0x7FFF;\n          var match = -1,\n              mlen = 0;\n\n          if (match = addrs[hash]) {\n            match |= boff & ~0x7FFF;\n            if (match > boff) match -= 0x8000;\n            if (match < boff) while (data[match + mlen] == data[boff + mlen] && mlen < 250) {\n              ++mlen;\n            }\n          }\n\n          if (mlen > 2) {\n            /* Copy Token  */\n            d = LEN_LN_RE[mlen];\n            if (d <= 22) bl = write_bits_8(out, bl, bitswap8[d + 1] >> 1) - 1;else {\n              write_bits_8(out, bl, 3);\n              bl += 5;\n              write_bits_8(out, bl, bitswap8[d - 23] >> 5);\n              bl += 3;\n            }\n            var len_eb = d < 8 ? 0 : d - 4 >> 2;\n\n            if (len_eb > 0) {\n              write_bits_16(out, bl, mlen - LEN_LN[d]);\n              bl += len_eb;\n            }\n\n            d = DST_LN_RE[boff - match];\n            bl = write_bits_8(out, bl, bitswap8[d] >> 3);\n            bl -= 3;\n            var dst_eb = d < 4 ? 0 : d - 2 >> 1;\n\n            if (dst_eb > 0) {\n              write_bits_16(out, bl, boff - match - DST_LN[d]);\n              bl += dst_eb;\n            }\n\n            for (var q = 0; q < mlen; ++q) {\n              addrs[hash] = boff & 0x7FFF;\n              hash = (hash << 5 ^ data[boff]) & 0x7FFF;\n              ++boff;\n            }\n\n            L -= mlen - 1;\n          } else {\n            /* Literal Token */\n            if (d <= 143) d = d + 48;else bl = write_bits_1(out, bl, 1);\n            bl = write_bits_8(out, bl, bitswap8[d]);\n            addrs[hash] = boff & 0x7FFF;\n            ++boff;\n          }\n        }\n\n        bl = write_bits_8(out, bl, 0) - 1;\n      }\n\n      out.l = (bl + 7) / 8 | 0;\n      return out.l;\n    }\n\n    return function _deflateRaw(data, out) {\n      if (data.length < 8) return write_stored(data, out);\n      return write_huff_fixed(data, out);\n    };\n  }();\n\n  function _deflate(data) {\n    var buf = new_buf(50 + Math.floor(data.length * 1.1));\n\n    var off = _deflateRaw(data, buf);\n\n    return buf.slice(0, off);\n  }\n  /* modified inflate function also moves original read head */\n\n\n  var dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n  var dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n  var dyn_cmap = use_typed_arrays ? new Uint16Array(128) : zero_fill_array(128);\n  var dyn_len_1 = 1,\n      dyn_len_2 = 1;\n  /* 5.5.3 Expanding Huffman Codes */\n\n  function dyn(data, boff\n  /*:number*/\n  ) {\n    /* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n    var _HLIT = read_bits_5(data, boff) + 257;\n\n    boff += 5;\n\n    var _HDIST = read_bits_5(data, boff) + 1;\n\n    boff += 5;\n\n    var _HCLEN = read_bits_4(data, boff) + 4;\n\n    boff += 4;\n    var w = 0;\n    /* grab and store code lengths */\n\n    var clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n    var ctree = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n    var maxlen = 1;\n    var bl_count = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n    var next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n    var L = clens.length;\n    /* 19 */\n\n    for (var i = 0; i < _HCLEN; ++i) {\n      clens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n      if (maxlen < w) maxlen = w;\n      bl_count[w]++;\n      boff += 3;\n    }\n    /* build code tree */\n\n\n    var ccode = 0;\n    bl_count[0] = 0;\n\n    for (i = 1; i <= maxlen; ++i) {\n      next_code[i] = ccode = ccode + bl_count[i - 1] << 1;\n    }\n\n    for (i = 0; i < L; ++i) {\n      if ((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n    }\n    /* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\n\n    var cleni = 0;\n\n    for (i = 0; i < L; ++i) {\n      cleni = clens[i];\n\n      if (cleni != 0) {\n        ccode = bitswap8[ctree[i]] >> 8 - cleni;\n\n        for (var j = (1 << 7 - cleni) - 1; j >= 0; --j) {\n          dyn_cmap[ccode | j << cleni] = cleni & 7 | i << 3;\n        }\n      }\n    }\n    /* read literal and dist codes at once */\n\n\n    var hcodes\n    /*:Array<number>*/\n    = [];\n    maxlen = 1;\n\n    for (; hcodes.length < _HLIT + _HDIST;) {\n      ccode = dyn_cmap[read_bits_7(data, boff)];\n      boff += ccode & 7;\n\n      switch (ccode >>>= 3) {\n        case 16:\n          w = 3 + read_bits_2(data, boff);\n          boff += 2;\n          ccode = hcodes[hcodes.length - 1];\n\n          while (w-- > 0) {\n            hcodes.push(ccode);\n          }\n\n          break;\n\n        case 17:\n          w = 3 + read_bits_3(data, boff);\n          boff += 3;\n\n          while (w-- > 0) {\n            hcodes.push(0);\n          }\n\n          break;\n\n        case 18:\n          w = 11 + read_bits_7(data, boff);\n          boff += 7;\n\n          while (w-- > 0) {\n            hcodes.push(0);\n          }\n\n          break;\n\n        default:\n          hcodes.push(ccode);\n          if (maxlen < ccode) maxlen = ccode;\n          break;\n      }\n    }\n    /* build literal / length trees */\n\n\n    var h1 = hcodes.slice(0, _HLIT),\n        h2 = hcodes.slice(_HLIT);\n\n    for (i = _HLIT; i < 286; ++i) {\n      h1[i] = 0;\n    }\n\n    for (i = _HDIST; i < 30; ++i) {\n      h2[i] = 0;\n    }\n\n    dyn_len_1 = build_tree(h1, dyn_lmap, 286);\n    dyn_len_2 = build_tree(h2, dyn_dmap, 30);\n    return boff;\n  }\n  /* return [ data, bytesRead ] */\n\n\n  function inflate(data, usz\n  /*:number*/\n  ) {\n    /* shortcircuit for empty buffer [0x03, 0x00] */\n    if (data[0] == 3 && !(data[1] & 0x3)) {\n      return [new_raw_buf(usz), 2];\n    }\n    /* bit offset */\n\n\n    var boff = 0;\n    /* header includes final bit and type bits */\n\n    var header = 0;\n    var outbuf = new_unsafe_buf(usz ? usz : 1 << 18);\n    var woff = 0;\n    var OL = outbuf.length >>> 0;\n    var max_len_1 = 0,\n        max_len_2 = 0;\n\n    while ((header & 1) == 0) {\n      header = read_bits_3(data, boff);\n      boff += 3;\n\n      if (header >>> 1 == 0) {\n        /* Stored block */\n        if (boff & 7) boff += 8 - (boff & 7);\n        /* 2 bytes sz, 2 bytes bit inverse */\n\n        var sz = data[boff >>> 3] | data[(boff >>> 3) + 1] << 8;\n        boff += 32;\n        /* push sz bytes */\n\n        if (sz > 0) {\n          if (!usz && OL < woff + sz) {\n            outbuf = realloc(outbuf, woff + sz);\n            OL = outbuf.length;\n          }\n\n          while (sz-- > 0) {\n            outbuf[woff++] = data[boff >>> 3];\n            boff += 8;\n          }\n        }\n\n        continue;\n      } else if (header >> 1 == 1) {\n        /* Fixed Huffman */\n        max_len_1 = 9;\n        max_len_2 = 5;\n      } else {\n        /* Dynamic Huffman */\n        boff = dyn(data, boff);\n        max_len_1 = dyn_len_1;\n        max_len_2 = dyn_len_2;\n      }\n\n      for (;;) {\n        // while(true) is apparently out of vogue in modern JS circles\n        if (!usz && OL < woff + 32767) {\n          outbuf = realloc(outbuf, woff + 32767);\n          OL = outbuf.length;\n        }\n        /* ingest code and move read head */\n\n\n        var bits = read_bits_n(data, boff, max_len_1);\n        var code = header >>> 1 == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n        boff += code & 15;\n        code >>>= 4;\n        /* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\n        if ((code >>> 8 & 0xFF) === 0) outbuf[woff++] = code;else if (code == 256) break;else {\n          code -= 257;\n          var len_eb = code < 8 ? 0 : code - 4 >> 2;\n          if (len_eb > 5) len_eb = 0;\n          var tgt = woff + LEN_LN[code];\n          /* length extra bits */\n\n          if (len_eb > 0) {\n            tgt += read_bits_n(data, boff, len_eb);\n            boff += len_eb;\n          }\n          /* dist code */\n\n\n          bits = read_bits_n(data, boff, max_len_2);\n          code = header >>> 1 == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n          boff += code & 15;\n          code >>>= 4;\n          var dst_eb = code < 4 ? 0 : code - 2 >> 1;\n          var dst = DST_LN[code];\n          /* dist extra bits */\n\n          if (dst_eb > 0) {\n            dst += read_bits_n(data, boff, dst_eb);\n            boff += dst_eb;\n          }\n          /* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\n\n          if (!usz && OL < tgt) {\n            outbuf = realloc(outbuf, tgt + 100);\n            OL = outbuf.length;\n          }\n\n          while (woff < tgt) {\n            outbuf[woff] = outbuf[woff - dst];\n            ++woff;\n          }\n        }\n      }\n    }\n\n    if (usz) return [outbuf, boff + 7 >>> 3];\n    return [outbuf.slice(0, woff), boff + 7 >>> 3];\n  }\n\n  function _inflate(payload, usz) {\n    var data = payload.slice(payload.l || 0);\n    var out = inflate(data, usz);\n    payload.l += out[1];\n    return out[0];\n  }\n\n  function warn_or_throw(wrn, msg) {\n    if (wrn) {\n      if (typeof console !== 'undefined') console.error(msg);\n    } else throw new Error(msg);\n  }\n\n  function parse_zip(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    var blob\n    /*:CFBlob*/\n    =\n    /*::(*/\n    file\n    /*:: :any)*/\n    ;\n    prep_blob(blob, 0);\n    var FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    };\n    init_cfb(o, {\n      root: options.root\n    });\n    /* find end of central directory, start just after signature */\n\n    var i = blob.length - 4;\n\n    while ((blob[i] != 0x50 || blob[i + 1] != 0x4b || blob[i + 2] != 0x05 || blob[i + 3] != 0x06) && i >= 0) {\n      --i;\n    }\n\n    blob.l = i + 4;\n    /* parse end of central directory */\n\n    blob.l += 4;\n    var fcnt = blob.read_shift(2);\n    blob.l += 6;\n    var start_cd = blob.read_shift(4);\n    /* parse central directory */\n\n    blob.l = start_cd;\n\n    for (i = 0; i < fcnt; ++i) {\n      /* trust local file header instead of CD entry */\n      blob.l += 20;\n      var csz = blob.read_shift(4);\n      var usz = blob.read_shift(4);\n      var namelen = blob.read_shift(2);\n      var efsz = blob.read_shift(2);\n      var fcsz = blob.read_shift(2);\n      blob.l += 8;\n      var offset = blob.read_shift(4);\n      var EF = parse_extra_field(\n      /*::(*/\n      blob.slice(blob.l + namelen, blob.l + namelen + efsz)\n      /*:: :any)*/\n      );\n      blob.l += namelen + efsz + fcsz;\n      var L = blob.l;\n      blob.l = offset + 4;\n      parse_local_file(blob, csz, usz, o, EF);\n      blob.l = L;\n    }\n\n    return o;\n  }\n  /* head starts just after local file header signature */\n\n\n  function parse_local_file(blob\n  /*:CFBlob*/\n  , csz\n  /*:number*/\n  , usz\n  /*:number*/\n  , o\n  /*:CFBContainer*/\n  , EF) {\n    /* [local file header] */\n    blob.l += 2;\n    var flags = blob.read_shift(2);\n    var meth = blob.read_shift(2);\n    var date = parse_dos_date(blob);\n    if (flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n    var crc32 = blob.read_shift(4);\n\n    var _csz = blob.read_shift(4);\n\n    var _usz = blob.read_shift(4);\n\n    var namelen = blob.read_shift(2);\n    var efsz = blob.read_shift(2); // TODO: flags & (1<<11) // UTF8\n\n    var name = \"\";\n\n    for (var i = 0; i < namelen; ++i) {\n      name += String.fromCharCode(blob[blob.l++]);\n    }\n\n    if (efsz) {\n      var ef = parse_extra_field(\n      /*::(*/\n      blob.slice(blob.l, blob.l + efsz)\n      /*:: :any)*/\n      );\n      if ((ef[0x5455] || {}).mt) date = ef[0x5455].mt;\n      if (((EF || {})[0x5455] || {}).mt) date = EF[0x5455].mt;\n    }\n\n    blob.l += efsz;\n    /* [encryption header] */\n\n    /* [file data] */\n\n    var data = blob.slice(blob.l, blob.l + _csz);\n\n    switch (meth) {\n      case 8:\n        data = _inflateRawSync(blob, _usz);\n        break;\n\n      case 0:\n        break;\n      // TODO: scan for magic number\n\n      default:\n        throw new Error(\"Unsupported ZIP Compression method \" + meth);\n    }\n    /* [data descriptor] */\n\n\n    var wrn = false;\n\n    if (flags & 8) {\n      crc32 = blob.read_shift(4);\n\n      if (crc32 == 0x08074b50) {\n        crc32 = blob.read_shift(4);\n        wrn = true;\n      }\n\n      _csz = blob.read_shift(4);\n      _usz = blob.read_shift(4);\n    }\n\n    if (_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n    if (_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz); //var _crc32 = CRC32.buf(data, 0);\n    //if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\n    cfb_add(o, name, data, {\n      unsafe: true,\n      mt: date\n    });\n  }\n\n  function write_zip(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes*/\n  {\n    var _opts = options || {};\n\n    var out = [],\n        cdirs = [];\n    var o\n    /*:CFBlob*/\n    = new_buf(1);\n    var method = _opts.compression ? 8 : 0,\n        flags = 0;\n    var i = 0,\n        j = 0;\n    var start_cd = 0,\n        fcnt = 0;\n    var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n    var crcs = [];\n    var sz_cd = 0;\n\n    for (i = 1; i < cfb.FullPaths.length; ++i) {\n      fp = cfb.FullPaths[i].slice(root.length);\n      fi = cfb.FileIndex[i];\n      if (!fi.size || !fi.content || fp == \"\\x01Sh33tJ5\") continue;\n      var start = start_cd;\n      /* TODO: CP437 filename */\n\n      var namebuf = new_buf(fp.length);\n\n      for (j = 0; j < fp.length; ++j) {\n        namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n      }\n\n      namebuf = namebuf.slice(0, namebuf.l);\n      crcs[fcnt] = CRC32.buf(\n      /*::((*/\n      fi.content\n      /*::||[]):any)*/\n      , 0);\n      var outbuf = fi.content\n      /*::||[]*/\n      ;\n      if (method == 8) outbuf = _deflateRawSync(outbuf);\n      /* local file header */\n\n      o = new_buf(30);\n      o.write_shift(4, 0x04034b50);\n      o.write_shift(2, 20);\n      o.write_shift(2, flags);\n      o.write_shift(2, method);\n      /* TODO: last mod file time/date */\n\n      if (fi.mt) write_dos_date(o, fi.mt);else o.write_shift(4, 0);\n      o.write_shift(-4, crcs[fcnt]);\n      o.write_shift(4, outbuf.length);\n      o.write_shift(4,\n      /*::(*/\n      fi.content\n      /*::||[])*/\n      .length);\n      o.write_shift(2, namebuf.length);\n      o.write_shift(2, 0);\n      start_cd += o.length;\n      out.push(o);\n      start_cd += namebuf.length;\n      out.push(namebuf);\n      /* TODO: extra fields? */\n\n      /* TODO: encryption header ? */\n\n      start_cd += outbuf.length;\n      out.push(outbuf);\n      /* central directory */\n\n      o = new_buf(46);\n      o.write_shift(4, 0x02014b50);\n      o.write_shift(2, 0);\n      o.write_shift(2, 20);\n      o.write_shift(2, flags);\n      o.write_shift(2, method);\n      o.write_shift(4, 0);\n      /* TODO: last mod file time/date */\n\n      o.write_shift(-4, crcs[fcnt]);\n      o.write_shift(4, outbuf.length);\n      o.write_shift(4,\n      /*::(*/\n      fi.content\n      /*::||[])*/\n      .length);\n      o.write_shift(2, namebuf.length);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, start);\n      sz_cd += o.l;\n      cdirs.push(o);\n      sz_cd += namebuf.length;\n      cdirs.push(namebuf);\n      ++fcnt;\n    }\n    /* end of central directory */\n\n\n    o = new_buf(22);\n    o.write_shift(4, 0x06054b50);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, fcnt);\n    o.write_shift(2, fcnt);\n    o.write_shift(4, sz_cd);\n    o.write_shift(4, start_cd);\n    o.write_shift(2, 0);\n    return bconcat([bconcat(out\n    /*:any*/\n    ), bconcat(cdirs), o]\n    /*:any*/\n    );\n  }\n\n  var ContentTypeMap = {\n    \"htm\": \"text/html\",\n    \"xml\": \"text/xml\",\n    \"gif\": \"image/gif\",\n    \"jpg\": \"image/jpeg\",\n    \"png\": \"image/png\",\n    \"mso\": \"application/x-mso\",\n    \"thmx\": \"application/vnd.ms-officetheme\",\n    \"sh33tj5\": \"application/octet-stream\"\n  }\n  /*:any*/\n  ;\n\n  function get_content_type(fi\n  /*:CFBEntry*/\n  , fp\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (fi.ctype) return fi.ctype;\n    var ext = fi.name || \"\",\n        m = ext.match(/\\.([^\\.]+)$/);\n    if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n    if (fp) {\n      m = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n      if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n    }\n\n    return \"application/octet-stream\";\n  }\n  /* 76 character chunks TODO: intertwine encoding */\n\n\n  function write_base64_76(bstr\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var data = Base64_encode(bstr);\n    var o = [];\n\n    for (var i = 0; i < data.length; i += 76) {\n      o.push(data.slice(i, i + 76));\n    }\n\n    return o.join(\"\\r\\n\") + \"\\r\\n\";\n  }\n  /*\n  Rules for QP:\n  \t- escape =## applies for all non-display characters and literal \"=\"\n  \t- space or tab at end of line must be encoded\n  \t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n  \t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n  \n  TODO: Some files from word appear to write line extensions with bare equals:\n  \n  ```\n  <table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n  =\"70%\"\n  ```\n  */\n\n\n  function write_quoted_printable(text\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function (c) {\n      var w = c.charCodeAt(0).toString(16).toUpperCase();\n      return \"=\" + (w.length == 1 ? \"0\" + w : w);\n    });\n    encoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n    if (encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n    encoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n    var o\n    /*:Array<string>*/\n    = [],\n        split = encoded.split(\"\\r\\n\");\n\n    for (var si = 0; si < split.length; ++si) {\n      var str = split[si];\n\n      if (str.length == 0) {\n        o.push(\"\");\n        continue;\n      }\n\n      for (var i = 0; i < str.length;) {\n        var end = 76;\n        var tmp = str.slice(i, i + end);\n        if (tmp.charAt(end - 1) == \"=\") end--;else if (tmp.charAt(end - 2) == \"=\") end -= 2;else if (tmp.charAt(end - 3) == \"=\") end -= 3;\n        tmp = str.slice(i, i + end);\n        i += end;\n        if (i < str.length) tmp += \"=\";\n        o.push(tmp);\n      }\n    }\n\n    return o.join(\"\\r\\n\");\n  }\n\n  function parse_quoted_printable(data\n  /*:Array<string>*/\n  )\n  /*:RawBytes*/\n  {\n    var o = [];\n    /* unify long lines */\n\n    for (var di = 0; di < data.length; ++di) {\n      var line = data[di];\n\n      while (di <= data.length && line.charAt(line.length - 1) == \"=\") {\n        line = line.slice(0, line.length - 1) + data[++di];\n      }\n\n      o.push(line);\n    }\n    /* decode */\n\n\n    for (var oi = 0; oi < o.length; ++oi) {\n      o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function ($$) {\n        return String.fromCharCode(parseInt($$.slice(1), 16));\n      });\n    }\n\n    return s2a(o.join(\"\\r\\n\"));\n  }\n\n  function parse_mime(cfb\n  /*:CFBContainer*/\n  , data\n  /*:Array<string>*/\n  , root\n  /*:string*/\n  )\n  /*:void*/\n  {\n    var fname = \"\",\n        cte = \"\",\n        ctype = \"\",\n        fdata;\n    var di = 0;\n\n    for (; di < 10; ++di) {\n      var line = data[di];\n      if (!line || line.match(/^\\s*$/)) break;\n      var m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n      if (m) switch (m[1].toLowerCase()) {\n        case \"content-location\":\n          fname = m[2].trim();\n          break;\n\n        case \"content-type\":\n          ctype = m[2].trim();\n          break;\n\n        case \"content-transfer-encoding\":\n          cte = m[2].trim();\n          break;\n      }\n    }\n\n    ++di;\n\n    switch (cte.toLowerCase()) {\n      case 'base64':\n        fdata = s2a(Base64_decode(data.slice(di).join(\"\")));\n        break;\n\n      case 'quoted-printable':\n        fdata = parse_quoted_printable(data.slice(di));\n        break;\n\n      default:\n        throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n    }\n\n    var file = cfb_add(cfb, fname.slice(root.length), fdata, {\n      unsafe: true\n    });\n    if (ctype) file.ctype = ctype;\n  }\n\n  function parse_mad(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    if (a2s(file.slice(0, 13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n    var root = options && options.root || \"\"; // $FlowIgnore\n\n    var data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n    var di = 0,\n        row = \"\";\n    /* if root is not specified, scan for the common prefix */\n\n    for (di = 0; di < data.length; ++di) {\n      row = data[di];\n      if (!/^Content-Location:/i.test(row)) continue;\n      row = row.slice(row.indexOf(\"file\"));\n      if (!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n      if (row.slice(0, root.length) == root) continue;\n\n      while (root.length > 0) {\n        root = root.slice(0, root.length - 1);\n        root = root.slice(0, root.lastIndexOf(\"/\") + 1);\n        if (row.slice(0, root.length) == root) break;\n      }\n    }\n\n    var mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n    if (!mboundary) throw new Error(\"MAD cannot find boundary\");\n    var boundary = \"--\" + (mboundary[1] || \"\");\n    var FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    };\n    init_cfb(o);\n    var start_di,\n        fcnt = 0;\n\n    for (di = 0; di < data.length; ++di) {\n      var line = data[di];\n      if (line !== boundary && line !== boundary + \"--\") continue;\n      if (fcnt++) parse_mime(o, data.slice(start_di, di), root);\n      start_di = di;\n    }\n\n    return o;\n  }\n\n  function write_mad(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:string*/\n  {\n    var opts = options || {};\n    var boundary = opts.boundary || \"SheetJS\";\n    boundary = '------=' + boundary;\n    var out = ['MIME-Version: 1.0', 'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"', '', '', ''];\n    var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n\n    for (var i = 1; i < cfb.FullPaths.length; ++i) {\n      fp = cfb.FullPaths[i].slice(root.length);\n      fi = cfb.FileIndex[i];\n      if (!fi.size || !fi.content || fp == \"\\x01Sh33tJ5\") continue;\n      /* Normalize filename */\n\n      fp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function (c) {\n        return \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n      }).replace(/[\\u0080-\\uFFFF]/g, function (u) {\n        return \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n      });\n      /* Extract content as binary string */\n\n      var ca = fi.content; // $FlowIgnore\n\n      var cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n      /* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\n      var dispcnt = 0,\n          L = Math.min(1024, cstr.length),\n          cc = 0;\n\n      for (var csl = 0; csl <= L; ++csl) {\n        if ((cc = cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n      }\n\n      var qp = dispcnt >= L * 4 / 5;\n      out.push(boundary);\n      out.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n      out.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n      out.push('Content-Type: ' + get_content_type(fi, fp));\n      out.push('');\n      out.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n    }\n\n    out.push(boundary + '--\\r\\n');\n    return out.join(\"\\r\\n\");\n  }\n\n  function cfb_new(opts\n  /*:?any*/\n  )\n  /*:CFBContainer*/\n  {\n    var o\n    /*:CFBContainer*/\n    = {}\n    /*:any*/\n    ;\n    init_cfb(o, opts);\n    return o;\n  }\n\n  function cfb_add(cfb\n  /*:CFBContainer*/\n  , name\n  /*:string*/\n  , content\n  /*:?RawBytes*/\n  , opts\n  /*:?any*/\n  )\n  /*:CFBEntry*/\n  {\n    var unsafe = opts && opts.unsafe;\n    if (!unsafe) init_cfb(cfb);\n    var file = !unsafe && CFB.find(cfb, name);\n\n    if (!file) {\n      var fpath\n      /*:string*/\n      = cfb.FullPaths[0];\n      if (name.slice(0, fpath.length) == fpath) fpath = name;else {\n        if (fpath.slice(-1) != \"/\") fpath += \"/\";\n        fpath = (fpath + name).replace(\"//\", \"/\");\n      }\n      file = {\n        name: filename(name),\n        type: 2\n      }\n      /*:any*/\n      ;\n      cfb.FileIndex.push(file);\n      cfb.FullPaths.push(fpath);\n      if (!unsafe) CFB.utils.cfb_gc(cfb);\n    }\n    /*:: if(!file) throw new Error(\"unreachable\"); */\n\n\n    file.content = content\n    /*:any*/\n    ;\n    file.size = content ? content.length : 0;\n\n    if (opts) {\n      if (opts.CLSID) file.clsid = opts.CLSID;\n      if (opts.mt) file.mt = opts.mt;\n      if (opts.ct) file.ct = opts.ct;\n    }\n\n    return file;\n  }\n\n  function cfb_del(cfb\n  /*:CFBContainer*/\n  , name\n  /*:string*/\n  )\n  /*:boolean*/\n  {\n    init_cfb(cfb);\n    var file = CFB.find(cfb, name);\n    if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) {\n      if (cfb.FileIndex[j] == file) {\n        cfb.FileIndex.splice(j, 1);\n        cfb.FullPaths.splice(j, 1);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function cfb_mov(cfb\n  /*:CFBContainer*/\n  , old_name\n  /*:string*/\n  , new_name\n  /*:string*/\n  )\n  /*:boolean*/\n  {\n    init_cfb(cfb);\n    var file = CFB.find(cfb, old_name);\n    if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) {\n      if (cfb.FileIndex[j] == file) {\n        cfb.FileIndex[j].name = filename(new_name);\n        cfb.FullPaths[j] = new_name;\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function cfb_gc(cfb\n  /*:CFBContainer*/\n  )\n  /*:void*/\n  {\n    rebuild_cfb(cfb, true);\n  }\n\n  exports.find = find;\n  exports.read = read;\n  exports.parse = parse;\n  exports.write = write;\n  exports.writeFile = write_file;\n  exports.utils = {\n    cfb_new: cfb_new,\n    cfb_add: cfb_add,\n    cfb_del: cfb_del,\n    cfb_mov: cfb_mov,\n    cfb_gc: cfb_gc,\n    ReadShift: ReadShift,\n    CheckField: CheckField,\n    prep_blob: prep_blob,\n    bconcat: bconcat,\n    use_zlib: use_zlib,\n    _deflateRaw: _deflate,\n    _inflateRaw: _inflate,\n    consts: consts\n  };\n  return exports;\n}();\n/* read binary data from file */\n\n\nfunction read_binary(path\n/*:string*/\n) {\n  if (typeof Deno !== 'undefined') return Deno.readFileSync(path); // $FlowIgnore\n\n  if (typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try {\n    // extendscript\n    // $FlowIgnore\n    var infile = File(path);\n    infile.open(\"r\");\n    infile.encoding = \"binary\";\n    var data = infile.read();\n    infile.close();\n    return data;\n  } catch (e) {\n    if (!e.message || !e.message.match(/onstruct/)) throw e;\n  }\n  throw new Error(\"Cannot access file \" + path);\n}\n\nfunction keys(o\n/*:any*/\n)\n/*:Array<any>*/\n{\n  var ks = Object.keys(o),\n      o2 = [];\n\n  for (var i = 0; i < ks.length; ++i) {\n    if (Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n  }\n\n  return o2;\n}\n\nfunction evert(obj\n/*:any*/\n)\n/*:EvertType*/\n{\n  var o = []\n  /*:any*/\n  ,\n      K = keys(obj);\n\n  for (var i = 0; i !== K.length; ++i) {\n    o[obj[K[i]]] = K[i];\n  }\n\n  return o;\n}\n\nvar basedate = /*#__PURE__*/new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\n\nfunction datenum(v\n/*:Date*/\n, date1904\n/*:?boolean*/\n)\n/*:number*/\n{\n  var epoch = /*#__PURE__*/v.getTime();\n  if (date1904) epoch -= 1462 * 24 * 60 * 60 * 1000;\n  var dnthresh = /*#__PURE__*/basedate.getTime() + ( /*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\n  return (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n}\n\nvar refdate = /*#__PURE__*/new Date();\nvar dnthresh = /*#__PURE__*/basedate.getTime() + ( /*#__PURE__*/refdate.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\nvar refoffset = /*#__PURE__*/refdate.getTimezoneOffset();\n\nfunction numdate(v\n/*:number*/\n)\n/*:Date*/\n{\n  var out = new Date();\n  out.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\n\n  if (out.getTimezoneOffset() !== refoffset) {\n    out.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 60000);\n  }\n\n  return out;\n}\n/* ISO 8601 Duration */\n\n\nfunction parse_isodur(s) {\n  var sec = 0,\n      mt = 0,\n      time = false;\n  var m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n  if (!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\n  for (var i = 1; i != m.length; ++i) {\n    if (!m[i]) continue;\n    mt = 1;\n    if (i > 3) time = true;\n\n    switch (m[i].slice(m[i].length - 1)) {\n      case 'Y':\n        throw new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length - 1));\n\n      case 'D':\n        mt *= 24;\n\n      /* falls through */\n\n      case 'H':\n        mt *= 60;\n\n      /* falls through */\n\n      case 'M':\n        if (!time) throw new Error(\"Unsupported ISO Duration Field: M\");else mt *= 60;\n    }\n\n    sec += mt * parseInt(m[i], 10);\n  }\n\n  return sec;\n}\n\nvar good_pd_date_1 = /*#__PURE__*/new Date('2017-02-19T19:06:09.000Z');\nvar good_pd_date = /*#__PURE__*/isNaN( /*#__PURE__*/good_pd_date_1.getFullYear()) ? /*#__PURE__*/new Date('2/19/17') : good_pd_date_1;\nvar good_pd = /*#__PURE__*/good_pd_date.getFullYear() == 2017;\n/* parses a date as a local date */\n\nfunction parseDate(str\n/*:string|Date*/\n, fixdate\n/*:?number*/\n)\n/*:Date*/\n{\n  var d = new Date(str);\n\n  if (good_pd) {\n    /*:: if(fixdate == null) fixdate = 0; */\n    if (fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);else if (fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\n    return d;\n  }\n\n  if (str instanceof Date) return str;\n\n  if (good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\n    var s = d.getFullYear();\n    if (str.indexOf(\"\" + s) > -1) return d;\n    d.setFullYear(d.getFullYear() + 100);\n    return d;\n  }\n\n  var n = str.match(/\\d+/g) || [\"2017\", \"2\", \"19\", \"0\", \"0\", \"0\"];\n  var out = new Date(+n[0], +n[1] - 1, +n[2], +n[3] || 0, +n[4] || 0, +n[5] || 0);\n  if (str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\n  return out;\n}\n\nfunction cc2str(arr\n/*:Array<number>*/\n, debomit)\n/*:string*/\n{\n  if (has_buf && Buffer.isBuffer(arr)) {\n    if (debomit) {\n      if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n      if (arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n    }\n\n    return arr.toString(\"binary\");\n  }\n\n  if (typeof TextDecoder !== \"undefined\") try {\n    if (debomit) {\n      if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n      if (arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n    }\n\n    var rev = {\n      \"\\u20AC\": \"\\x80\",\n      \"\\u201A\": \"\\x82\",\n      \"\\u0192\": \"\\x83\",\n      \"\\u201E\": \"\\x84\",\n      \"\\u2026\": \"\\x85\",\n      \"\\u2020\": \"\\x86\",\n      \"\\u2021\": \"\\x87\",\n      \"\\u02C6\": \"\\x88\",\n      \"\\u2030\": \"\\x89\",\n      \"\\u0160\": \"\\x8a\",\n      \"\\u2039\": \"\\x8b\",\n      \"\\u0152\": \"\\x8c\",\n      \"\\u017D\": \"\\x8e\",\n      \"\\u2018\": \"\\x91\",\n      \"\\u2019\": \"\\x92\",\n      \"\\u201C\": \"\\x93\",\n      \"\\u201D\": \"\\x94\",\n      \"\\u2022\": \"\\x95\",\n      \"\\u2013\": \"\\x96\",\n      \"\\u2014\": \"\\x97\",\n      \"\\u02DC\": \"\\x98\",\n      \"\\u2122\": \"\\x99\",\n      \"\\u0161\": \"\\x9a\",\n      \"\\u203A\": \"\\x9b\",\n      \"\\u0153\": \"\\x9c\",\n      \"\\u017E\": \"\\x9e\",\n      \"\\u0178\": \"\\x9f\"\n    };\n    if (Array.isArray(arr)) arr = new Uint8Array(arr);\n    return new TextDecoder(\"latin1\").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function (c) {\n      return rev[c] || c;\n    });\n  } catch (e) {}\n  var o = [];\n\n  for (var i = 0; i != arr.length; ++i) {\n    o.push(String.fromCharCode(arr[i]));\n  }\n\n  return o.join(\"\");\n}\n\nfunction dup(o\n/*:any*/\n)\n/*:any*/\n{\n  if (typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n  if (typeof o != 'object' || o == null) return o;\n  if (o instanceof Date) return new Date(o.getTime());\n  var out = {};\n\n  for (var k in o) {\n    if (Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n  }\n\n  return out;\n}\n\nfunction fill(c\n/*:string*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  var o = \"\";\n\n  while (o.length < l) {\n    o += c;\n  }\n\n  return o;\n}\n/* TODO: stress test */\n\n\nfunction fuzzynum(s\n/*:string*/\n)\n/*:number*/\n{\n  var v\n  /*:number*/\n  = Number(s);\n  if (!isNaN(v)) return isFinite(v) ? v : NaN;\n  if (!/\\d/.test(s)) return v;\n  var wt = 1;\n  var ss = s.replace(/([\\d]),([\\d])/g, \"$1$2\").replace(/[$]/g, \"\").replace(/[%]/g, function () {\n    wt *= 100;\n    return \"\";\n  });\n  if (!isNaN(v = Number(ss))) return v / wt;\n  ss = ss.replace(/[(](.*)[)]/, function ($$, $1) {\n    wt = -wt;\n    return $1;\n  });\n  if (!isNaN(v = Number(ss))) return v / wt;\n  return v;\n}\n\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\n\nfunction fuzzydate(s\n/*:string*/\n)\n/*:Date*/\n{\n  var o = new Date(s),\n      n = new Date(NaN);\n  var y = o.getYear(),\n      m = o.getMonth(),\n      d = o.getDate();\n  if (isNaN(d)) return n;\n  var lower = s.toLowerCase();\n\n  if (lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n    lower = lower.replace(/[^a-z]/g, \"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/, \"\");\n    if (lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n  } else if (lower.match(/[a-z]/)) return n;\n\n  if (y < 0 || y > 8099) return n;\n  if ((m > 0 || d > 1) && y != 101) return o;\n  if (s.match(/[^-0-9:,\\/\\\\]/)) return n;\n  return o;\n}\n\nvar split_regex = /*#__PURE__*/function () {\n  var safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n  return function split_regex(str\n  /*:string*/\n  , re, def\n  /*:string*/\n  )\n  /*:Array<string>*/\n  {\n    if (safe_split_regex || typeof re == \"string\") return str.split(re);\n    var p = str.split(re),\n        o = [p[0]];\n\n    for (var i = 1; i < p.length; ++i) {\n      o.push(def);\n      o.push(p[i]);\n    }\n\n    return o;\n  };\n}();\n\nfunction getdatastr(data)\n/*:?string*/\n{\n  if (!data) return null;\n  if (data.content && data.type) return cc2str(data.content, true);\n  if (data.data) return debom(data.data);\n  if (data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n  if (data.asBinary) return debom(data.asBinary());\n  if (data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\n  return null;\n}\n\nfunction getdatabin(data) {\n  if (!data) return null;\n  if (data.data) return char_codes(data.data);\n  if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\n  if (data._data && data._data.getContent) {\n    var o = data._data.getContent();\n\n    if (typeof o == \"string\") return char_codes(o);\n    return Array.prototype.slice.call(o);\n  }\n\n  if (data.content && data.type) return data.content;\n  return null;\n}\n\nfunction getdata(data) {\n  return data && data.name.slice(-4) === \".bin\" ? getdatabin(data) : getdatastr(data);\n}\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n\n/* OASIS does not comment on filename case sensitivity */\n\n\nfunction safegetzipfile(zip, file\n/*:string*/\n) {\n  var k = zip.FullPaths || keys(zip.files);\n  var f = file.toLowerCase().replace(/[\\/]/g, '\\\\'),\n      g = f.replace(/\\\\/g, '\\/');\n\n  for (var i = 0; i < k.length; ++i) {\n    var n = k[i].replace(/^Root Entry[\\/]/, \"\").toLowerCase();\n    if (f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n  }\n\n  return null;\n}\n\nfunction getzipfile(zip, file\n/*:string*/\n) {\n  var o = safegetzipfile(zip, file);\n  if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n  return o;\n}\n\nfunction getzipdata(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:any*/\n{\n  if (!safe) return getdata(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipdata(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction getzipstr(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:?string*/\n{\n  if (!safe) return getdatastr(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipstr(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction getzipbin(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:any*/\n{\n  if (!safe) return getdatabin(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipbin(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction zipentries(zip) {\n  var k = zip.FullPaths || keys(zip.files),\n      o = [];\n\n  for (var i = 0; i < k.length; ++i) {\n    if (k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n  }\n\n  return o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n  if (zip.FullPaths) {\n    if (typeof content == \"string\") {\n      var res;\n      if (has_buf) res = Buffer_from(content);\n      /* TODO: investigate performance in Edge 13 */\n      //else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n      else res = utf8decode(content);\n      return CFB.utils.cfb_add(zip, path, res);\n    }\n\n    CFB.utils.cfb_add(zip, path, content);\n  } else zip.file(path, content);\n}\n\nfunction zip_read(d, o) {\n  switch (o.type) {\n    case \"base64\":\n      return CFB.read(d, {\n        type: \"base64\"\n      });\n\n    case \"binary\":\n      return CFB.read(d, {\n        type: \"binary\"\n      });\n\n    case \"buffer\":\n    case \"array\":\n      return CFB.read(d, {\n        type: \"buffer\"\n      });\n  }\n\n  throw new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path\n/*:string*/\n, base\n/*:string*/\n)\n/*:string*/\n{\n  if (path.charAt(0) == \"/\") return path.slice(1);\n  var result = base.split('/');\n  if (base.slice(-1) != \"/\") result.pop(); // folder path\n\n  var target = path.split('/');\n\n  while (target.length !== 0) {\n    var step = target.shift();\n    if (step === '..') result.pop();else if (step !== '.') result.push(step);\n  }\n\n  return result.join('/');\n}\n\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg = /([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1 = /<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg,\n    tagregex2 = /<[^>]*>/g;\nvar tagregex = /*#__PURE__*/XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex = /<\\w*:/,\n    nsregex2 = /<(\\/?)\\w+:/;\n\nfunction parsexmltag(tag\n/*:string*/\n, skip_root\n/*:?boolean*/\n, skip_LC\n/*:?boolean*/\n)\n/*:any*/\n{\n  var z = {}\n  /*:any*/\n  ;\n  var eq = 0,\n      c = 0;\n\n  for (; eq !== tag.length; ++eq) {\n    if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n  }\n\n  if (!skip_root) z[0] = tag.slice(0, eq);\n  if (eq === tag.length) return z;\n  var m = tag.match(attregexg),\n      j = 0,\n      v = \"\",\n      i = 0,\n      q = \"\",\n      cc = \"\",\n      quot = 1;\n  if (m) for (i = 0; i != m.length; ++i) {\n    cc = m[i];\n\n    for (c = 0; c != cc.length; ++c) {\n      if (cc.charCodeAt(c) === 61) break;\n    }\n\n    q = cc.slice(0, c).trim();\n\n    while (cc.charCodeAt(c + 1) == 32) {\n      ++c;\n    }\n\n    quot = (eq = cc.charCodeAt(c + 1)) == 34 || eq == 39 ? 1 : 0;\n    v = cc.slice(c + 1 + quot, cc.length - quot);\n\n    for (j = 0; j != q.length; ++j) {\n      if (q.charCodeAt(j) === 58) break;\n    }\n\n    if (j === q.length) {\n      if (q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\n      z[q] = v;\n      if (!skip_LC) z[q.toLowerCase()] = v;\n    } else {\n      var k = (j === 5 && q.slice(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.slice(j + 1);\n      if (z[k] && q.slice(j - 3, j) == \"ext\") continue; // from ods\n\n      z[k] = v;\n      if (!skip_LC) z[k.toLowerCase()] = v;\n    }\n  }\n  return z;\n}\n\nfunction strip_ns(x\n/*:string*/\n)\n/*:string*/\n{\n  return x.replace(nsregex2, \"<$1\");\n}\n\nvar encodings = {\n  '&quot;': '\"',\n  '&apos;': \"'\",\n  '&gt;': '>',\n  '&lt;': '<',\n  '&amp;': '&'\n};\nvar rencoding = /*#__PURE__*/evert(encodings); //var rencstr = \"&<>'\\\"\".split(\"\");\n// TODO: CP remap (need to read file version to determine OS)\n\nvar unescapexml\n/*:StringConv*/\n= /*#__PURE__*/function () {\n  /* 22.4.2.4 bstr (Basic String) */\n  var encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig,\n      coderegex = /_x([\\da-fA-F]{4})_/ig;\n  return function unescapexml(text\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var s = text + '',\n        i = s.indexOf(\"<![CDATA[\");\n    if (i == -1) return s.replace(encregex, function ($$, $1) {\n      return encodings[$$] || String.fromCharCode(parseInt($1, $$.indexOf(\"x\") > -1 ? 16 : 10)) || $$;\n    }).replace(coderegex, function (m, c) {\n      return String.fromCharCode(parseInt(c, 16));\n    });\n    var j = s.indexOf(\"]]>\");\n    return unescapexml(s.slice(0, i)) + s.slice(i + 9, j) + unescapexml(s.slice(j + 3));\n  };\n}();\n\nvar decregex = /[&<>'\"]/g;\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\n\nfunction escapehtml(text\n/*:string*/\n)\n/*:string*/\n{\n  var s = text + '';\n  return s.replace(decregex, function (y) {\n    return rencoding[y];\n  }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex, function (s) {\n    return \"&#x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \";\";\n  });\n}\n/* TODO: handle codepages */\n\n\nvar xlml_fixstr\n/*:StringConv*/\n= /*#__PURE__*/function () {\n  var entregex = /&#(\\d+);/g;\n\n  function entrepl($$\n  /*:string*/\n  , $1\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return String.fromCharCode(parseInt($1, 10));\n  }\n\n  return function xlml_fixstr(str\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return str.replace(entregex, entrepl);\n  };\n}();\n\nfunction parsexmlbool(value\n/*:any*/\n)\n/*:boolean*/\n{\n  switch (value) {\n    case 1:\n    case true:\n    case '1':\n    case 'true':\n    case 'TRUE':\n      return true;\n\n    /* case '0': case 'false': case 'FALSE':*/\n\n    default:\n      return false;\n  }\n}\n\nfunction utf8reada(orig\n/*:string*/\n)\n/*:string*/\n{\n  var out = \"\",\n      i = 0,\n      c = 0,\n      d = 0,\n      e = 0,\n      f = 0,\n      w = 0;\n\n  while (i < orig.length) {\n    c = orig.charCodeAt(i++);\n\n    if (c < 128) {\n      out += String.fromCharCode(c);\n      continue;\n    }\n\n    d = orig.charCodeAt(i++);\n\n    if (c > 191 && c < 224) {\n      f = (c & 31) << 6;\n      f |= d & 63;\n      out += String.fromCharCode(f);\n      continue;\n    }\n\n    e = orig.charCodeAt(i++);\n\n    if (c < 240) {\n      out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n      continue;\n    }\n\n    f = orig.charCodeAt(i++);\n    w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n    out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n    out += String.fromCharCode(0xDC00 + (w & 1023));\n  }\n\n  return out;\n}\n\nfunction utf8readb(data) {\n  var out = new_raw_buf(2 * data.length),\n      w,\n      i,\n      j = 1,\n      k = 0,\n      ww = 0,\n      c;\n\n  for (i = 0; i < data.length; i += j) {\n    j = 1;\n    if ((c = data.charCodeAt(i)) < 128) w = c;else if (c < 224) {\n      w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);\n      j = 2;\n    } else if (c < 240) {\n      w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);\n      j = 3;\n    } else {\n      j = 4;\n      w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\n      w -= 65536;\n      ww = 0xD800 + (w >>> 10 & 1023);\n      w = 0xDC00 + (w & 1023);\n    }\n\n    if (ww !== 0) {\n      out[k++] = ww & 255;\n      out[k++] = ww >>> 8;\n      ww = 0;\n    }\n\n    out[k++] = w % 256;\n    out[k++] = w >>> 8;\n  }\n\n  return out.slice(0, k).toString('ucs2');\n}\n\nfunction utf8readc(data) {\n  return Buffer_from(data, 'binary').toString('utf8');\n}\n\nvar utf8corpus = \"foo bar baz\\xE2\\x98\\x83\\xF0\\x9F\\x8D\\xA3\";\nvar utf8read = has_buf && ( /*#__PURE__*/utf8readc(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readc || /*#__PURE__*/utf8readb(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readb) || utf8reada;\nvar utf8write\n/*:StringConv*/\n= has_buf ? function (data) {\n  return Buffer_from(data, 'utf8').toString(\"binary\");\n} : function (orig\n/*:string*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [],\n      i = 0,\n      c = 0,\n      d = 0;\n\n  while (i < orig.length) {\n    c = orig.charCodeAt(i++);\n\n    switch (true) {\n      case c < 128:\n        out.push(String.fromCharCode(c));\n        break;\n\n      case c < 2048:\n        out.push(String.fromCharCode(192 + (c >> 6)));\n        out.push(String.fromCharCode(128 + (c & 63)));\n        break;\n\n      case c >= 55296 && c < 57344:\n        c -= 55296;\n        d = orig.charCodeAt(i++) - 56320 + (c << 10);\n        out.push(String.fromCharCode(240 + (d >> 18 & 7)));\n        out.push(String.fromCharCode(144 + (d >> 12 & 63)));\n        out.push(String.fromCharCode(128 + (d >> 6 & 63)));\n        out.push(String.fromCharCode(128 + (d & 63)));\n        break;\n\n      default:\n        out.push(String.fromCharCode(224 + (c >> 12)));\n        out.push(String.fromCharCode(128 + (c >> 6 & 63)));\n        out.push(String.fromCharCode(128 + (c & 63)));\n    }\n  }\n\n  return out.join(\"\");\n}; // matches <foo>...</foo> extracts content\n\nvar matchtag = /*#__PURE__*/function () {\n  var mtcache\n  /*:{[k:string]:RegExp}*/\n  = {}\n  /*:any*/\n  ;\n  return function matchtag(f\n  /*:string*/\n  , g\n  /*:?string*/\n  )\n  /*:RegExp*/\n  {\n    var t = f + \"|\" + (g || \"\");\n    if (mtcache[t]) return mtcache[t];\n    return mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + '(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?' + f + '>', g || \"\"\n    /*:any*/\n    );\n  };\n}();\n\nvar htmldecode\n/*:{(s:string):string}*/\n= /*#__PURE__*/function () {\n  var entities\n  /*:Array<[RegExp, string]>*/\n  = [['nbsp', ' '], ['middot', '·'], ['quot', '\"'], ['apos', \"'\"], ['gt', '>'], ['lt', '<'], ['amp', '&']].map(function (x\n  /*:[string, string]*/\n  ) {\n    return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]];\n  });\n  return function htmldecode(str\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var o = str // Remove new lines and spaces from start of content\n    .replace(/^[\\t\\n\\r ]+/, \"\") // Remove new lines and spaces from end of content\n    .replace(/[\\t\\n\\r ]+$/, \"\") // Added line which removes any white space characters after and before html tags\n    .replace(/>\\s+/g, \">\").replace(/\\s+</g, \"<\") // Replace remaining new lines and spaces with space\n    .replace(/[\\t\\n\\r ]+/g, \" \") // Replace <br> tags with new lines\n    .replace(/<\\s*[bB][rR]\\s*\\/?>/g, \"\\n\") // Strip HTML elements\n    .replace(/<[^>]*>/g, \"\");\n\n    for (var i = 0; i < entities.length; ++i) {\n      o = o.replace(entities[i][0], entities[i][1]);\n    }\n\n    return o;\n  };\n}();\n\nvar vtregex = /*#__PURE__*/function () {\n  var vt_cache = {};\n  return function vt_regex(bt) {\n    if (vt_cache[bt] !== undefined) return vt_cache[bt];\n    return vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g');\n  };\n}();\n\nvar vtvregex = /<\\/?(?:vt:)?variant>/g,\n    vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\n\nfunction parseVector(data\n/*:string*/\n, opts)\n/*:Array<{v:string,t:string}>*/\n{\n  var h = parsexmltag(data);\n  var matches\n  /*:Array<string>*/\n  = data.match(vtregex(h.baseType)) || [];\n  var res\n  /*:Array<any>*/\n  = [];\n\n  if (matches.length != h.size) {\n    if (opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n    return res;\n  }\n\n  matches.forEach(function (x\n  /*:string*/\n  ) {\n    var v = x.replace(vtvregex, \"\").match(vtmregex);\n    if (v) res.push({\n      v: utf8read(v[2]),\n      t: v[1]\n    });\n  });\n  return res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\n\nfunction wxt_helper(h)\n/*:string*/\n{\n  return keys(h).map(function (k) {\n    return \" \" + k + '=\"' + h[k] + '\"';\n  }).join(\"\");\n}\n\nfunction writextag(f\n/*:string*/\n, g\n/*:?string*/\n, h) {\n  return '<' + f + (h != null ? wxt_helper(h) : \"\") + (g != null ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';\n}\n\nfunction xlml_normalize(d)\n/*:string*/\n{\n  if (has_buf &&\n  /*::typeof Buffer !== \"undefined\" && d != null && d instanceof Buffer &&*/\n  Buffer.isBuffer(d)) return d.toString('utf8');\n  if (typeof d === 'string') return d;\n  /* duktape */\n\n  if (typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n  throw new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags */\n\n\nvar xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/mg; //var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\nvar XMLNS = {\n  CORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n  CUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n  EXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n  CT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n  RELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n  TCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n  'dc': 'http://purl.org/dc/elements/1.1/',\n  'dcterms': 'http://purl.org/dc/terms/',\n  'dcmitype': 'http://purl.org/dc/dcmitype/',\n  'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n  'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n  'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n  'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n  'xsd': 'http://www.w3.org/2001/XMLSchema'\n}\n/*:any*/\n;\nvar XMLNS_main = ['http://schemas.openxmlformats.org/spreadsheetml/2006/main', 'http://purl.oclc.org/ooxml/spreadsheetml/main', 'http://schemas.microsoft.com/office/excel/2006/main', 'http://schemas.microsoft.com/office/excel/2006/2'];\n\nfunction read_double_le(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  var s = 1 - 2 * (b[idx + 7] >>> 7);\n  var e = ((b[idx + 7] & 0x7f) << 4) + (b[idx + 6] >>> 4 & 0x0f);\n  var m = b[idx + 6] & 0x0f;\n\n  for (var i = 5; i >= 0; --i) {\n    m = m * 256 + b[idx + i];\n  }\n\n  if (e == 0x7ff) return m == 0 ? s * Infinity : NaN;\n  if (e == 0) e = -1022;else {\n    e -= 1023;\n    m += Math.pow(2, 52);\n  }\n  return s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b\n/*:RawBytes|CFBlob*/\n, v\n/*:number*/\n, idx\n/*:number*/\n) {\n  var bs = (v < 0 || 1 / v == -Infinity ? 1 : 0) << 7,\n      e = 0,\n      m = 0;\n  var av = bs ? -v : v;\n\n  if (!isFinite(av)) {\n    e = 0x7ff;\n    m = isNaN(v) ? 0x6969 : 0;\n  } else if (av == 0) e = m = 0;else {\n    e = Math.floor(Math.log(av) / Math.LN2);\n    m = av * Math.pow(2, 52 - e);\n\n    if (e <= -1023 && (!isFinite(m) || m < Math.pow(2, 52))) {\n      e = -1022;\n    } else {\n      m -= Math.pow(2, 52);\n      e += 1023;\n    }\n  }\n\n  for (var i = 0; i <= 5; ++i, m /= 256) {\n    b[idx + i] = m & 0xff;\n  }\n\n  b[idx + 6] = (e & 0x0f) << 4 | m & 0xf;\n  b[idx + 7] = e >> 4 | bs;\n}\n\nvar ___toBuffer = function ___toBuffer(bufs\n/*:Array<Array<RawBytes> >*/\n)\n/*:RawBytes*/\n{\n  var x = [],\n      w = 10240;\n\n  for (var i = 0; i < bufs[0].length; ++i) {\n    if (bufs[0][i]) for (var j = 0, L = bufs[0][i].length; j < L; j += w) {\n      x.push.apply(x, bufs[0][i].slice(j, j + w));\n    }\n  }\n\n  return x;\n};\n\nvar __toBuffer = has_buf ? function (bufs) {\n  return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0].map(function (x) {\n    return Buffer.isBuffer(x) ? x : Buffer_from(x);\n  })) : ___toBuffer(bufs);\n} : ___toBuffer;\n\nvar ___utf16le = function ___utf16le(b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n)\n/*:string*/\n{\n  var ss\n  /*:Array<string>*/\n  = [];\n\n  for (var i = s; i < e; i += 2) {\n    ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n  }\n\n  return ss.join(\"\").replace(chr0, '');\n};\n\nvar __utf16le = has_buf ? function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n)\n/*:string*/\n{\n  if (!Buffer.isBuffer(b)\n  /*:: || !(b instanceof Buffer)*/\n  ) return ___utf16le(b, s, e);\n  return b.toString('utf16le', s, e).replace(chr0, '')\n  /*.replace(chr1,'!')*/\n  ;\n} : ___utf16le;\n\nvar ___hexlify = function ___hexlify(b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  var ss\n  /*:Array<string>*/\n  = [];\n\n  for (var i = s; i < s + l; ++i) {\n    ss.push((\"0\" + b[i].toString(16)).slice(-2));\n  }\n\n  return ss.join(\"\");\n};\n\nvar __hexlify = has_buf ? function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  return Buffer.isBuffer(b)\n  /*:: && b instanceof Buffer*/\n  ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n} : ___hexlify;\n\nvar ___utf8 = function ___utf8(b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n) {\n  var ss = [];\n\n  for (var i = s; i < e; i++) {\n    ss.push(String.fromCharCode(__readUInt8(b, i)));\n  }\n\n  return ss.join(\"\");\n};\n\nvar __utf8 = has_buf ? function utf8_b(b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n) {\n  return Buffer.isBuffer(b)\n  /*:: && (b instanceof Buffer)*/\n  ? b.toString('utf8', s, e) : ___utf8(b, s, e);\n} : ___utf8;\n\nvar ___lpstr = function ___lpstr(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function ___cpstr(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function ___lpwstr(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = 2 * __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf16le(b, i + 4, i + 4 + len) : \"\";\n};\n\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function ___8lpp4(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len) : \"\";\n};\n\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function ___double(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n) {\n  return read_double_le(b, idx);\n};\n\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) {\n  return Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n};\n\nif (has_buf\n/*:: && typeof Buffer !== 'undefined'*/\n) {\n  __lpstr = function lpstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpstr(b, i);\n    var len = b.readUInt32LE(i);\n    return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  __cpstr = function cpstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___cpstr(b, i);\n    var len = b.readUInt32LE(i);\n    return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  __lpwstr = function lpwstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpwstr(b, i);\n    var len = 2 * b.readUInt32LE(i);\n    return b.toString('utf16le', i + 4, i + 4 + len - 1);\n  };\n\n  __lpp4 = function lpp4_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpp4(b, i);\n    var len = b.readUInt32LE(i);\n    return b.toString('utf16le', i + 4, i + 4 + len);\n  };\n\n  __8lpp4 = function lpp4_8b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___8lpp4(b, i);\n    var len = b.readUInt32LE(i);\n    return b.toString('utf8', i + 4, i + 4 + len);\n  };\n\n  __double = function double_(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (Buffer.isBuffer(b)\n    /*::&& b instanceof Buffer*/\n    ) return b.readDoubleLE(i);\n    return ___double(b, i);\n  };\n\n  is_buf = function is_buf_b(a) {\n    return Buffer.isBuffer(a) || Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n  };\n}\n\nvar __readUInt8 = function __readUInt8(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx];\n};\n\nvar __readUInt16LE = function __readUInt16LE(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 1] * (1 << 8) + b[idx];\n};\n\nvar __readInt16LE = function __readInt16LE(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  var u = b[idx + 1] * (1 << 8) + b[idx];\n  return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n};\n\nvar __readUInt32LE = function __readUInt32LE(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n};\n\nvar __readInt32LE = function __readInt32LE(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n};\n\nvar __readInt32BE = function __readInt32BE(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx] << 24 | b[idx + 1] << 16 | b[idx + 2] << 8 | b[idx + 3];\n};\n\nfunction ReadShift(size\n/*:number*/\n, t\n/*:?string*/\n)\n/*:number|string*/\n{\n  var o = \"\",\n      oI\n  /*:: :number = 0*/\n  ,\n      oR,\n      oo = [],\n      w,\n      vv,\n      i,\n      loc;\n\n  switch (t) {\n    case 'dbcs':\n      loc = this.l;\n      if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");else for (i = 0; i < size; ++i) {\n        o += String.fromCharCode(__readUInt16LE(this, loc));\n        loc += 2;\n      }\n      size *= 2;\n      break;\n\n    case 'utf8':\n      o = __utf8(this, this.l, this.l + size);\n      break;\n\n    case 'utf16le':\n      size *= 2;\n      o = __utf16le(this, this.l, this.l + size);\n      break;\n\n    case 'wstr':\n      return ReadShift.call(this, size, 'dbcs');\n\n    /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\n    case 'lpstr-ansi':\n      o = __lpstr(this, this.l);\n      size = 4 + __readUInt32LE(this, this.l);\n      break;\n\n    case 'lpstr-cp':\n      o = __cpstr(this, this.l);\n      size = 4 + __readUInt32LE(this, this.l);\n      break;\n\n    /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\n    case 'lpwstr':\n      o = __lpwstr(this, this.l);\n      size = 4 + 2 * __readUInt32LE(this, this.l);\n      break;\n\n    /* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\n    case 'lpp4':\n      size = 4 + __readUInt32LE(this, this.l);\n      o = __lpp4(this, this.l);\n      if (size & 0x02) size += 2;\n      break;\n\n    /* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\n    case '8lpp4':\n      size = 4 + __readUInt32LE(this, this.l);\n      o = __8lpp4(this, this.l);\n      if (size & 0x03) size += 4 - (size & 0x03);\n      break;\n\n    case 'cstr':\n      size = 0;\n      o = \"\";\n\n      while ((w = __readUInt8(this, this.l + size++)) !== 0) {\n        oo.push(_getchar(w));\n      }\n\n      o = oo.join(\"\");\n      break;\n\n    case '_wstr':\n      size = 0;\n      o = \"\";\n\n      while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n        oo.push(_getchar(w));\n        size += 2;\n      }\n\n      size += 2;\n      o = oo.join(\"\");\n      break;\n\n    /* sbcs and dbcs support continue records in the SST way TODO codepages */\n\n    case 'dbcs-cont':\n      o = \"\";\n      loc = this.l;\n\n      for (i = 0; i < size; ++i) {\n        if (this.lens && this.lens.indexOf(loc) !== -1) {\n          w = __readUInt8(this, loc);\n          this.l = loc + 1;\n          vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n          return oo.join(\"\") + vv;\n        }\n\n        oo.push(_getchar(__readUInt16LE(this, loc)));\n        loc += 2;\n      }\n\n      o = oo.join(\"\");\n      size *= 2;\n      break;\n\n    case 'cpstr':\n    /* falls through */\n\n    case 'sbcs-cont':\n      o = \"\";\n      loc = this.l;\n\n      for (i = 0; i != size; ++i) {\n        if (this.lens && this.lens.indexOf(loc) !== -1) {\n          w = __readUInt8(this, loc);\n          this.l = loc + 1;\n          vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n          return oo.join(\"\") + vv;\n        }\n\n        oo.push(_getchar(__readUInt8(this, loc)));\n        loc += 1;\n      }\n\n      o = oo.join(\"\");\n      break;\n\n    default:\n      switch (size) {\n        case 1:\n          oI = __readUInt8(this, this.l);\n          this.l++;\n          return oI;\n\n        case 2:\n          oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n          this.l += 2;\n          return oI;\n\n        case 4:\n        case -4:\n          if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n            oI = (size > 0 ? __readInt32LE : __readInt32BE)(this, this.l);\n            this.l += 4;\n            return oI;\n          } else {\n            oR = __readUInt32LE(this, this.l);\n            this.l += 4;\n          }\n\n          return oR;\n\n        case 8:\n        case -8:\n          if (t === 'f') {\n            if (size == 8) oR = __double(this, this.l);else oR = __double([this[this.l + 7], this[this.l + 6], this[this.l + 5], this[this.l + 4], this[this.l + 3], this[this.l + 2], this[this.l + 1], this[this.l + 0]], 0);\n            this.l += 8;\n            return oR;\n          } else size = 8;\n\n        /* falls through */\n\n        case 16:\n          o = __hexlify(this, this.l, size);\n          break;\n      }\n\n  }\n\n  this.l += size;\n  return o;\n}\n\nvar __writeUInt32LE = function __writeUInt32LE(b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >>> 8 & 0xFF;\n  b[idx + 2] = val >>> 16 & 0xFF;\n  b[idx + 3] = val >>> 24 & 0xFF;\n};\n\nvar __writeInt32LE = function __writeInt32LE(b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >> 8 & 0xFF;\n  b[idx + 2] = val >> 16 & 0xFF;\n  b[idx + 3] = val >> 24 & 0xFF;\n};\n\nvar __writeUInt16LE = function __writeUInt16LE(b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >>> 8 & 0xFF;\n};\n\nfunction WriteShift(t\n/*:number*/\n, val\n/*:string|number*/\n, f\n/*:?string*/\n)\n/*:any*/\n{\n  var size = 0,\n      i = 0;\n\n  if (f === 'dbcs') {\n    /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n    for (i = 0; i != val.length; ++i) {\n      __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n    }\n\n    size = 2 * val.length;\n  } else if (f === 'sbcs') {\n    {\n      /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n      val = val.replace(/[^\\x00-\\x7F]/g, \"_\");\n      /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\n      for (i = 0; i != val.length; ++i) {\n        this[this.l + i] = val.charCodeAt(i) & 0xFF;\n      }\n    }\n    size = val.length;\n  } else if (f === 'hex') {\n    for (; i < t; ++i) {\n      /*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n      this[this.l++] = parseInt(val.slice(2 * i, 2 * i + 2), 16) || 0;\n    }\n\n    return this;\n  } else if (f === 'utf16le') {\n    /*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n    var end\n    /*:number*/\n    = Math.min(this.l + t, this.length);\n\n    for (i = 0; i < Math.min(val.length, t); ++i) {\n      var cc = val.charCodeAt(i);\n      this[this.l++] = cc & 0xff;\n      this[this.l++] = cc >> 8;\n    }\n\n    while (this.l < end) {\n      this[this.l++] = 0;\n    }\n\n    return this;\n  } else\n    /*:: if(typeof val === 'number') */\n    switch (t) {\n      case 1:\n        size = 1;\n        this[this.l] = val & 0xFF;\n        break;\n\n      case 2:\n        size = 2;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        break;\n\n      case 3:\n        size = 3;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 2] = val & 0xFF;\n        break;\n\n      case 4:\n        size = 4;\n\n        __writeUInt32LE(this, val, this.l);\n\n        break;\n\n      case 8:\n        size = 8;\n\n        if (f === 'f') {\n          write_double_le(this, val, this.l);\n          break;\n        }\n\n      /* falls through */\n\n      case 16:\n        break;\n\n      case -4:\n        size = 4;\n\n        __writeInt32LE(this, val, this.l);\n\n        break;\n    }\n\n  this.l += size;\n  return this;\n}\n\nfunction CheckField(hexstr\n/*:string*/\n, fld\n/*:string*/\n)\n/*:void*/\n{\n  var m = __hexlify(this, this.l, hexstr.length >> 1);\n\n  if (m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n  this.l += hexstr.length >> 1;\n}\n\nfunction prep_blob(blob, pos\n/*:number*/\n)\n/*:void*/\n{\n  blob.l = pos;\n  blob.read_shift =\n  /*::(*/\n  ReadShift\n  /*:: :any)*/\n  ;\n  blob.chk = CheckField;\n  blob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length\n/*:: :number, opts?:any */\n) {\n  blob.l += length;\n}\n\nfunction new_buf(sz\n/*:number*/\n)\n/*:Block*/\n{\n  var o = new_raw_buf(sz);\n  prep_blob(o, 0);\n  return o;\n}\n/* [MS-XLSB] 2.1.4 Record */\n\n\nfunction recordhopper(data, cb\n/*:RecordHopperCB*/\n, opts\n/*:?any*/\n) {\n  if (!data) return;\n  var tmpbyte, cntbyte, length;\n  prep_blob(data, data.l || 0);\n  var L = data.length,\n      RT = 0,\n      tgt = 0;\n\n  while (data.l < L) {\n    RT = data.read_shift(1);\n    if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\n    var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n    tmpbyte = data.read_shift(1);\n    length = tmpbyte & 0x7F;\n\n    for (cntbyte = 1; cntbyte < 4 && tmpbyte & 0x80; ++cntbyte) {\n      length += ((tmpbyte = data.read_shift(1)) & 0x7F) << 7 * cntbyte;\n    }\n\n    tgt = data.l + length;\n    var d = R.f && R.f(data, length, opts);\n    data.l = tgt;\n    if (cb(d, R, RT)) return;\n  }\n}\n/* control buffer usage for fixed-length buffers */\n\n\nfunction buf_array()\n/*:BufArray*/\n{\n  var bufs\n  /*:Array<Block>*/\n  = [],\n      blksz = has_buf ? 256 : 2048;\n\n  var newblk = function ba_newblk(sz\n  /*:number*/\n  )\n  /*:Block*/\n  {\n    var o\n    /*:Block*/\n    = new_buf(sz)\n    /*:any*/\n    ;\n    prep_blob(o, 0);\n    return o;\n  };\n\n  var curbuf\n  /*:Block*/\n  = newblk(blksz);\n\n  var endbuf = function ba_endbuf() {\n    if (!curbuf) return;\n\n    if (curbuf.length > curbuf.l) {\n      curbuf = curbuf.slice(0, curbuf.l);\n      curbuf.l = curbuf.length;\n    }\n\n    if (curbuf.length > 0) bufs.push(curbuf);\n    curbuf = null;\n  };\n\n  var next = function ba_next(sz\n  /*:number*/\n  )\n  /*:Block*/\n  {\n    if (curbuf && sz < curbuf.length - curbuf.l) return curbuf;\n    endbuf();\n    return curbuf = newblk(Math.max(sz + 1, blksz));\n  };\n\n  var end = function ba_end() {\n    endbuf();\n    return bconcat(bufs);\n  };\n\n  var push = function ba_push(buf) {\n    endbuf();\n    curbuf = buf;\n    if (curbuf.l == null) curbuf.l = curbuf.length;\n    next(blksz);\n  };\n\n  return {\n    next: next,\n    push: push,\n    end: end,\n    _bufs: bufs\n  }\n  /*:any*/\n  ;\n}\n/* XLS ranges enforced */\n\n\nfunction shift_cell_xls(cell\n/*:CellAddress*/\n, tgt\n/*:any*/\n, opts\n/*:?any*/\n)\n/*:CellAddress*/\n{\n  var out = dup(cell);\n\n  if (tgt.s) {\n    if (out.cRel) out.c += tgt.s.c;\n    if (out.rRel) out.r += tgt.s.r;\n  } else {\n    if (out.cRel) out.c += tgt.c;\n    if (out.rRel) out.r += tgt.r;\n  }\n\n  if (!opts || opts.biff < 12) {\n    while (out.c >= 0x100) {\n      out.c -= 0x100;\n    }\n\n    while (out.r >= 0x10000) {\n      out.r -= 0x10000;\n    }\n  }\n\n  return out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n  var out = dup(cell);\n  out.s = shift_cell_xls(out.s, range.s, opts);\n  out.e = shift_cell_xls(out.e, range.s, opts);\n  return out;\n}\n\nfunction encode_cell_xls(c\n/*:CellAddress*/\n, biff\n/*:number*/\n)\n/*:string*/\n{\n  if (c.cRel && c.c < 0) {\n    c = dup(c);\n\n    while (c.c < 0) {\n      c.c += biff > 8 ? 0x4000 : 0x100;\n    }\n  }\n\n  if (c.rRel && c.r < 0) {\n    c = dup(c);\n\n    while (c.r < 0) {\n      c.r += biff > 8 ? 0x100000 : biff > 5 ? 0x10000 : 0x4000;\n    }\n  }\n\n  var s = encode_cell(c);\n  if (!c.cRel && c.cRel != null) s = fix_col(s);\n  if (!c.rRel && c.rRel != null) s = fix_row(s);\n  return s;\n}\n\nfunction encode_range_xls(r, opts)\n/*:string*/\n{\n  if (r.s.r == 0 && !r.s.rRel) {\n    if (r.e.r == (opts.biff >= 12 ? 0xFFFFF : opts.biff >= 8 ? 0x10000 : 0x4000) && !r.e.rRel) {\n      return (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n    }\n  }\n\n  if (r.s.c == 0 && !r.s.cRel) {\n    if (r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n      return (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n    }\n  }\n\n  return encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\n\nfunction decode_row(rowstr\n/*:string*/\n)\n/*:number*/\n{\n  return parseInt(unfix_row(rowstr), 10) - 1;\n}\n\nfunction encode_row(row\n/*:number*/\n)\n/*:string*/\n{\n  return \"\" + (row + 1);\n}\n\nfunction fix_row(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n}\n\nfunction unfix_row(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/\\$(\\d+)$/, \"$1\");\n}\n\nfunction decode_col(colstr\n/*:string*/\n)\n/*:number*/\n{\n  var c = unfix_col(colstr),\n      d = 0,\n      i = 0;\n\n  for (; i !== c.length; ++i) {\n    d = 26 * d + c.charCodeAt(i) - 64;\n  }\n\n  return d - 1;\n}\n\nfunction encode_col(col\n/*:number*/\n)\n/*:string*/\n{\n  if (col < 0) throw new Error(\"invalid column \" + col);\n  var s = \"\";\n\n  for (++col; col; col = Math.floor((col - 1) / 26)) {\n    s = String.fromCharCode((col - 1) % 26 + 65) + s;\n  }\n\n  return s;\n}\n\nfunction fix_col(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/^([A-Z])/, \"$$$1\");\n}\n\nfunction unfix_col(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/^\\$([A-Z])/, \"$1\");\n}\n\nfunction split_cell(cstr\n/*:string*/\n)\n/*:Array<string>*/\n{\n  return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n} //function decode_cell(cstr/*:string*/)/*:CellAddress*/ { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\n\n\nfunction decode_cell(cstr\n/*:string*/\n)\n/*:CellAddress*/\n{\n  var R = 0,\n      C = 0;\n\n  for (var i = 0; i < cstr.length; ++i) {\n    var cc = cstr.charCodeAt(i);\n    if (cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);else if (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n  }\n\n  return {\n    c: C - 1,\n    r: R - 1\n  };\n} //function encode_cell(cell/*:CellAddress*/)/*:string*/ { return encode_col(cell.c) + encode_row(cell.r); }\n\n\nfunction encode_cell(cell\n/*:CellAddress*/\n)\n/*:string*/\n{\n  var col = cell.c + 1;\n  var s = \"\";\n\n  for (; col; col = (col - 1) / 26 | 0) {\n    s = String.fromCharCode((col - 1) % 26 + 65) + s;\n  }\n\n  return s + (cell.r + 1);\n}\n\nfunction decode_range(range\n/*:string*/\n)\n/*:Range*/\n{\n  var idx = range.indexOf(\":\");\n  if (idx == -1) return {\n    s: decode_cell(range),\n    e: decode_cell(range)\n  };\n  return {\n    s: decode_cell(range.slice(0, idx)),\n    e: decode_cell(range.slice(idx + 1))\n  };\n}\n/*# if only one arg, it is assumed to be a Range.  If 2 args, both are cell addresses */\n\n\nfunction encode_range(cs\n/*:CellAddrSpec|Range*/\n, ce\n/*:?CellAddrSpec*/\n)\n/*:string*/\n{\n  if (typeof ce === 'undefined' || typeof ce === 'number') {\n    /*:: if(!(cs instanceof Range)) throw \"unreachable\"; */\n    return encode_range(cs.s, cs.e);\n  }\n  /*:: if((cs instanceof Range)) throw \"unreachable\"; */\n\n\n  if (typeof cs !== 'string') cs = encode_cell(cs\n  /*:any*/\n  );\n  if (typeof ce !== 'string') ce = encode_cell(ce\n  /*:any*/\n  );\n  /*:: if(typeof cs !== 'string') throw \"unreachable\"; */\n\n  /*:: if(typeof ce !== 'string') throw \"unreachable\"; */\n\n  return cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range\n/*:string*/\n)\n/*:Range*/\n{\n  var o = {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var idx = 0,\n      i = 0,\n      cc = 0;\n  var len = range.length;\n\n  for (idx = 0; i < len; ++i) {\n    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n    idx = 26 * idx + cc;\n  }\n\n  o.s.c = --idx;\n\n  for (idx = 0; i < len; ++i) {\n    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n    idx = 10 * idx + cc;\n  }\n\n  o.s.r = --idx;\n\n  if (i === len || cc != 10) {\n    o.e.c = o.s.c;\n    o.e.r = o.s.r;\n    return o;\n  }\n\n  ++i;\n\n  for (idx = 0; i != len; ++i) {\n    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n    idx = 26 * idx + cc;\n  }\n\n  o.e.c = --idx;\n\n  for (idx = 0; i != len; ++i) {\n    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n    idx = 10 * idx + cc;\n  }\n\n  o.e.r = --idx;\n  return o;\n}\n\nfunction safe_format_cell(cell\n/*:Cell*/\n, v\n/*:any*/\n) {\n  var q = cell.t == 'd' && v instanceof Date;\n  if (cell.z != null) try {\n    return cell.w = SSF_format(cell.z, q ? datenum(v) : v);\n  } catch (e) {}\n\n  try {\n    return cell.w = SSF_format((cell.XF || {}).numFmtId || (q ? 14 : 0), q ? datenum(v) : v);\n  } catch (e) {\n    return '' + v;\n  }\n}\n\nfunction format_cell(cell\n/*:Cell*/\n, v\n/*:any*/\n, o\n/*:any*/\n) {\n  if (cell == null || cell.t == null || cell.t == 'z') return \"\";\n  if (cell.w !== undefined) return cell.w;\n  if (cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n  if (cell.t == \"e\") return BErr[cell.v] || cell.v;\n  if (v == undefined) return safe_format_cell(cell, cell.v);\n  return safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet\n/*:Worksheet*/\n, opts)\n/*:Workbook*/\n{\n  var n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n  var sheets = {};\n  sheets[n] = sheet;\n  return {\n    SheetNames: [n],\n    Sheets: sheets\n  };\n}\n\nfunction sheet_add_aoa(_ws\n/*:?Worksheet*/\n, data\n/*:AOA*/\n, opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var o = opts || {};\n  var dense = _ws ? Array.isArray(_ws) : o.dense;\n  var ws\n  /*:Worksheet*/\n  = _ws || (dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  );\n  var _R = 0,\n      _C = 0;\n\n  if (ws && o.origin != null) {\n    if (typeof o.origin == 'number') _R = o.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\n      _R = _origin.r;\n      _C = _origin.c;\n    }\n    if (!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n  }\n\n  var range\n  /*:Range*/\n  = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  }\n  /*:any*/\n  ;\n\n  if (ws['!ref']) {\n    var _range = safe_decode_range(ws['!ref']);\n\n    range.s.c = _range.s.c;\n    range.s.r = _range.s.r;\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n    if (_R == -1) range.e.r = _R = _range.e.r + 1;\n  }\n\n  for (var R = 0; R != data.length; ++R) {\n    if (!data[R]) continue;\n    if (!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\n    for (var C = 0; C != data[R].length; ++C) {\n      if (typeof data[R][C] === 'undefined') continue;\n      var cell\n      /*:Cell*/\n      = {\n        v: data[R][C]\n      }\n      /*:any*/\n      ;\n\n      var __R = _R + R,\n          __C = _C + C;\n\n      if (range.s.r > __R) range.s.r = __R;\n      if (range.s.c > __C) range.s.c = __C;\n      if (range.e.r < __R) range.e.r = __R;\n      if (range.e.c < __C) range.e.c = __C;\n      if (data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];else {\n        if (Array.isArray(cell.v)) {\n          cell.f = data[R][C][1];\n          cell.v = cell.v[0];\n        }\n\n        if (cell.v === null) {\n          if (cell.f) cell.t = 'n';else if (o.nullError) {\n            cell.t = 'e';\n            cell.v = 0;\n          } else if (!o.sheetStubs) continue;else cell.t = 'z';\n        } else if (typeof cell.v === 'number') cell.t = 'n';else if (typeof cell.v === 'boolean') cell.t = 'b';else if (cell.v instanceof Date) {\n          cell.z = o.dateNF || table_fmt[14];\n\n          if (o.cellDates) {\n            cell.t = 'd';\n            cell.w = SSF_format(cell.z, datenum(cell.v));\n          } else {\n            cell.t = 'n';\n            cell.v = datenum(cell.v);\n            cell.w = SSF_format(cell.z, cell.v);\n          }\n        } else cell.t = 's';\n      }\n\n      if (dense) {\n        if (!ws[__R]) ws[__R] = [];\n        if (ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;\n        ws[__R][__C] = cell;\n      } else {\n        var cell_ref = encode_cell({\n          c: __C,\n          r: __R\n        }\n        /*:any*/\n        );\n        if (ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n        ws[cell_ref] = cell;\n      }\n    }\n  }\n\n  if (range.s.c < 10000000) ws['!ref'] = encode_range(range);\n  return ws;\n}\n\nfunction aoa_to_sheet(data\n/*:AOA*/\n, opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  return sheet_add_aoa(null, data, opts);\n}\n\nfunction parse_Int32LE(data) {\n  return data.read_shift(4, 'i');\n}\n/* [MS-XLSB] 2.5.168 */\n\n\nfunction parse_XLWideString(data\n/*::, length*/\n)\n/*:string*/\n{\n  var cchCharacters = data.read_shift(4);\n  return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data/*::, length*/)/*:string*/ {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\n\n\nfunction parse_StrRun(data) {\n  return {\n    ich: data.read_shift(2),\n    ifnt: data.read_shift(2)\n  };\n}\n/* [MS-XLSB] 2.5.121 */\n\n\nfunction parse_RichStr(data, length\n/*:number*/\n)\n/*:XLString*/\n{\n  var start = data.l;\n  var flags = data.read_shift(1);\n  var str = parse_XLWideString(data);\n  var rgsStrRun = [];\n  var z = {\n    t: str,\n    h: str\n  }\n  /*:any*/\n  ;\n\n  if ((flags & 1) !== 0) {\n    /* fRichStr */\n\n    /* TODO: formatted string */\n    var dwSizeStrRun = data.read_shift(4);\n\n    for (var i = 0; i != dwSizeStrRun; ++i) {\n      rgsStrRun.push(parse_StrRun(data));\n    }\n\n    z.r = rgsStrRun;\n  } else z.r = [{\n    ich: 0,\n    ifnt: 0\n  }]; //if((flags & 2) !== 0) { /* fExtStr */\n  //\t/* TODO: phonetic string */\n  //}\n\n\n  data.l = start + length;\n  return z;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\n\n\nvar parse_BrtCommentText = parse_RichStr;\n/* [MS-XLSB] 2.5.9 */\n\nfunction parse_XLSBCell(data)\n/*:any*/\n{\n  var col = data.read_shift(4);\n  var iStyleRef = data.read_shift(2);\n  iStyleRef += data.read_shift(1) << 16;\n  data.l++; //var fPhShow = data.read_shift(1);\n\n  return {\n    c: col,\n    iStyleRef: iStyleRef\n  };\n}\n/* Short XLSB Cell does not include column */\n\n\nfunction parse_XLSBShortCell(data)\n/*:any*/\n{\n  var iStyleRef = data.read_shift(2);\n  iStyleRef += data.read_shift(1) << 16;\n  data.l++; //var fPhShow = data.read_shift(1);\n\n  return {\n    c: -1,\n    iStyleRef: iStyleRef\n  };\n}\n/* [MS-XLSB] 2.5.21 */\n\n\nvar parse_XLSBCodeName = parse_XLWideString;\n/* [MS-XLSB] 2.5.166 */\n\nfunction parse_XLNullableWideString(data\n/*::, length*/\n)\n/*:string*/\n{\n  var cchCharacters = data.read_shift(4);\n  return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\n/* [MS-XLSB] 2.5.165 */\n\n\nvar parse_XLNameWideString = parse_XLWideString; //var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\n\nvar parse_RelID = parse_XLNullableWideString;\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\n\nfunction parse_RkNumber(data)\n/*:number*/\n{\n  var b = data.slice(data.l, data.l + 4);\n  var fX100 = b[0] & 1,\n      fInt = b[0] & 2;\n  data.l += 4;\n  var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0] & 0xFC, b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n  return fX100 ? RK / 100 : RK;\n}\n/* [MS-XLSB] 2.5.117 RfX */\n\n\nfunction parse_RfX(data\n/*::, length*/\n)\n/*:Range*/\n{\n  var cell\n  /*:Range*/\n  = {\n    s: {},\n    e: {}\n  }\n  /*:any*/\n  ;\n  cell.s.r = data.read_shift(4);\n  cell.e.r = data.read_shift(4);\n  cell.s.c = data.read_shift(4);\n  cell.e.c = data.read_shift(4);\n  return cell;\n}\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\n\n\nvar parse_UncheckedRfX = parse_RfX;\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx/*:string*/) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\n\nfunction parse_Xnum(data\n/*::, length*/\n) {\n  if (data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n  return data.read_shift(8, 'f');\n}\n/* [MS-XLSB] 2.4.324 BrtColor */\n\n\nfunction parse_BrtColor(data\n/*::, length*/\n) {\n  var out = {};\n  var d = data.read_shift(1); //var fValidRGB = d & 1;\n\n  var xColorType = d >>> 1;\n  var index = data.read_shift(1);\n  var nTS = data.read_shift(2, 'i');\n  var bR = data.read_shift(1);\n  var bG = data.read_shift(1);\n  var bB = data.read_shift(1);\n  data.l++; //var bAlpha = data.read_shift(1);\n\n  switch (xColorType) {\n    case 0:\n      out.auto = 1;\n      break;\n\n    case 1:\n      out.index = index;\n      var icv = XLSIcv[index];\n      /* automatic pseudo index 81 */\n\n      if (icv) out.rgb = rgb2Hex(icv);\n      break;\n\n    case 2:\n      /* if(!fValidRGB) throw new Error(\"invalid\"); */\n      out.rgb = rgb2Hex([bR, bG, bB]);\n      break;\n\n    case 3:\n      out.theme = index;\n      break;\n  }\n\n  if (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n  return out;\n}\n/* [MS-XLSB] 2.5.52 */\n\n\nfunction parse_FontFlags(data\n/*::, length, opts*/\n) {\n  var d = data.read_shift(1);\n  data.l++;\n  var out = {\n    fBold: d & 0x01,\n    fItalic: d & 0x02,\n    fUnderline: d & 0x04,\n    fStrikeout: d & 0x08,\n    fOutline: d & 0x10,\n    fShadow: d & 0x20,\n    fCondense: d & 0x40,\n    fExtend: d & 0x80\n  };\n  return out;\n}\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\n\n\nfunction parse_ClipboardFormatOrString(o, w\n/*:number*/\n)\n/*:string*/\n{\n  // $FlowIgnore\n  var ClipFmt = {\n    2: \"BITMAP\",\n    3: \"METAFILEPICT\",\n    8: \"DIB\",\n    14: \"ENHMETAFILE\"\n  };\n  var m\n  /*:number*/\n  = o.read_shift(4);\n\n  switch (m) {\n    case 0x00000000:\n      return \"\";\n\n    case 0xffffffff:\n    case 0xfffffffe:\n      return ClipFmt[o.read_shift(4)] || \"\";\n  }\n\n  if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n  o.l -= 4;\n  return o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\n\nfunction parse_ClipboardFormatOrAnsiString(o) {\n  return parse_ClipboardFormatOrString(o, 1);\n}\n\nfunction parse_ClipboardFormatOrUnicodeString(o) {\n  return parse_ClipboardFormatOrString(o, 2);\n}\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\n\n\nvar VT_I2 = 0x0002;\nvar VT_I4 = 0x0003; //var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\n\nvar VT_BOOL = 0x000B;\nvar VT_VARIANT = 0x000C; //var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\n\nvar VT_UI4 = 0x0013; //var VT_LPWSTR   = 0x001F;\n\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB = 0x0041; //var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\n\nvar VT_CF = 0x0047;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR = 0x101E; //var VT_ARRAY    = 0x2000;\n\nvar VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n\nvar VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\nvar VT_CUSTOM = [VT_STRING, VT_USTR];\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n\nvar DocSummaryPIDDSI = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'CodePage',\n    t: VT_I2\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'Category',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PresentationFormat',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'ByteCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'LineCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'ParagraphCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'SlideCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'NoteCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'HiddenCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0a\n  /*::]*/\n  : {\n    n: 'MultimediaClipCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0b\n  /*::]*/\n  : {\n    n: 'ScaleCrop',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x0c\n  /*::]*/\n  : {\n    n: 'HeadingPairs',\n    t: VT_VECTOR_VARIANT\n    /* VT_VECTOR | VT_VARIANT */\n\n  },\n\n  /*::[*/\n  0x0d\n  /*::]*/\n  : {\n    n: 'TitlesOfParts',\n    t: VT_VECTOR_LPSTR\n    /* VT_VECTOR | VT_LPSTR */\n\n  },\n\n  /*::[*/\n  0x0e\n  /*::]*/\n  : {\n    n: 'Manager',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x0f\n  /*::]*/\n  : {\n    n: 'Company',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'LinksUpToDate',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'CharacterCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'SharedDoc',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x16\n  /*::]*/\n  : {\n    n: 'HyperlinksChanged',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : {\n    n: 'AppVersion',\n    t: VT_I4,\n    p: 'version'\n  },\n\n  /*::[*/\n  0x18\n  /*::]*/\n  : {\n    n: 'DigSig',\n    t: VT_BLOB\n  },\n\n  /*::[*/\n  0x1A\n  /*::]*/\n  : {\n    n: 'ContentType',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1B\n  /*::]*/\n  : {\n    n: 'ContentStatus',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1C\n  /*::]*/\n  : {\n    n: 'Language',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'Version',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {},\n\n  /* [MS-OLEPS] 2.18 */\n\n  /*::[*/\n  0x80000000\n  /*::]*/\n  : {\n    n: 'Locale',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x80000003\n  /*::]*/\n  : {\n    n: 'Behavior',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x72627262\n  /*::]*/\n  : {}\n};\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n\nvar SummaryPIDSI = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'CodePage',\n    t: VT_I2\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'Title',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'Subject',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'Author',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'Keywords',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'Comments',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'Template',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'LastAuthor',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'RevNumber',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'EditTime',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'LastPrinted',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : {\n    n: 'CreatedDate',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'ModifiedDate',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : {\n    n: 'PageCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'WordCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'CharCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'Thumbnail',\n    t: VT_CF\n  },\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : {\n    n: 'Application',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'DocSecurity',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {},\n\n  /* [MS-OLEPS] 2.18 */\n\n  /*::[*/\n  0x80000000\n  /*::]*/\n  : {\n    n: 'Locale',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x80000003\n  /*::]*/\n  : {\n    n: 'Behavior',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x72627262\n  /*::]*/\n  : {}\n};\n/* [MS-XLS] 2.4.63 Country/Region codes */\n\nvar CountryEnum = {\n  /*::[*/\n  0x0001\n  /*::]*/\n  : \"US\",\n  // United States\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : \"CA\",\n  // Canada\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : \"\",\n  // Latin America (except Brazil)\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : \"RU\",\n  // Russia\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : \"EG\",\n  // Egypt\n\n  /*::[*/\n  0x001E\n  /*::]*/\n  : \"GR\",\n  // Greece\n\n  /*::[*/\n  0x001F\n  /*::]*/\n  : \"NL\",\n  // Netherlands\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : \"BE\",\n  // Belgium\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : \"FR\",\n  // France\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : \"ES\",\n  // Spain\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : \"HU\",\n  // Hungary\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : \"IT\",\n  // Italy\n\n  /*::[*/\n  0x0029\n  /*::]*/\n  : \"CH\",\n  // Switzerland\n\n  /*::[*/\n  0x002B\n  /*::]*/\n  : \"AT\",\n  // Austria\n\n  /*::[*/\n  0x002C\n  /*::]*/\n  : \"GB\",\n  // United Kingdom\n\n  /*::[*/\n  0x002D\n  /*::]*/\n  : \"DK\",\n  // Denmark\n\n  /*::[*/\n  0x002E\n  /*::]*/\n  : \"SE\",\n  // Sweden\n\n  /*::[*/\n  0x002F\n  /*::]*/\n  : \"NO\",\n  // Norway\n\n  /*::[*/\n  0x0030\n  /*::]*/\n  : \"PL\",\n  // Poland\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : \"DE\",\n  // Germany\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : \"MX\",\n  // Mexico\n\n  /*::[*/\n  0x0037\n  /*::]*/\n  : \"BR\",\n  // Brazil\n\n  /*::[*/\n  0x003d\n  /*::]*/\n  : \"AU\",\n  // Australia\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : \"NZ\",\n  // New Zealand\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : \"TH\",\n  // Thailand\n\n  /*::[*/\n  0x0051\n  /*::]*/\n  : \"JP\",\n  // Japan\n\n  /*::[*/\n  0x0052\n  /*::]*/\n  : \"KR\",\n  // Korea\n\n  /*::[*/\n  0x0054\n  /*::]*/\n  : \"VN\",\n  // Viet Nam\n\n  /*::[*/\n  0x0056\n  /*::]*/\n  : \"CN\",\n  // China\n\n  /*::[*/\n  0x005A\n  /*::]*/\n  : \"TR\",\n  // Turkey\n\n  /*::[*/\n  0x0069\n  /*::]*/\n  : \"JS\",\n  // Ramastan\n\n  /*::[*/\n  0x00D5\n  /*::]*/\n  : \"DZ\",\n  // Algeria\n\n  /*::[*/\n  0x00D8\n  /*::]*/\n  : \"MA\",\n  // Morocco\n\n  /*::[*/\n  0x00DA\n  /*::]*/\n  : \"LY\",\n  // Libya\n\n  /*::[*/\n  0x015F\n  /*::]*/\n  : \"PT\",\n  // Portugal\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : \"IS\",\n  // Iceland\n\n  /*::[*/\n  0x0166\n  /*::]*/\n  : \"FI\",\n  // Finland\n\n  /*::[*/\n  0x01A4\n  /*::]*/\n  : \"CZ\",\n  // Czech Republic\n\n  /*::[*/\n  0x0376\n  /*::]*/\n  : \"TW\",\n  // Taiwan\n\n  /*::[*/\n  0x03C1\n  /*::]*/\n  : \"LB\",\n  // Lebanon\n\n  /*::[*/\n  0x03C2\n  /*::]*/\n  : \"JO\",\n  // Jordan\n\n  /*::[*/\n  0x03C3\n  /*::]*/\n  : \"SY\",\n  // Syria\n\n  /*::[*/\n  0x03C4\n  /*::]*/\n  : \"IQ\",\n  // Iraq\n\n  /*::[*/\n  0x03C5\n  /*::]*/\n  : \"KW\",\n  // Kuwait\n\n  /*::[*/\n  0x03C6\n  /*::]*/\n  : \"SA\",\n  // Saudi Arabia\n\n  /*::[*/\n  0x03CB\n  /*::]*/\n  : \"AE\",\n  // United Arab Emirates\n\n  /*::[*/\n  0x03CC\n  /*::]*/\n  : \"IL\",\n  // Israel\n\n  /*::[*/\n  0x03CE\n  /*::]*/\n  : \"QA\",\n  // Qatar\n\n  /*::[*/\n  0x03D5\n  /*::]*/\n  : \"IR\",\n  // Iran\n\n  /*::[*/\n  0xFFFF\n  /*::]*/\n  : \"US\" // United States\n\n};\n/* [MS-XLS] 2.5.127 */\n\nvar XLSFillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n\nfunction rgbify(arr\n/*:Array<number>*/\n)\n/*:Array<[number, number, number]>*/\n{\n  return arr.map(function (x) {\n    return [x >> 16 & 255, x >> 8 & 255, x & 255];\n  });\n}\n/* [MS-XLS] 2.5.161 */\n\n/* [MS-XLSB] 2.5.75 Icv */\n\n\nvar _XLSIcv = /*#__PURE__*/rgbify([\n/* Color Constants */\n0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF,\n/* Overridable Defaults */\n0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333,\n/* Other entries to appease BIFF8/12 */\n0xFFFFFF,\n/* 0x40 icvForeground ?? */\n0x000000,\n/* 0x41 icvBackground ?? */\n0x000000,\n/* 0x42 icvFrame ?? */\n0x000000,\n/* 0x43 icv3D ?? */\n0x000000,\n/* 0x44 icv3DText ?? */\n0x000000,\n/* 0x45 icv3DHilite ?? */\n0x000000,\n/* 0x46 icv3DShadow ?? */\n0x000000,\n/* 0x47 icvHilite ?? */\n0x000000,\n/* 0x48 icvCtlText ?? */\n0x000000,\n/* 0x49 icvCtlScrl ?? */\n0x000000,\n/* 0x4A icvCtlInv ?? */\n0x000000,\n/* 0x4B icvCtlBody ?? */\n0x000000,\n/* 0x4C icvCtlFrame ?? */\n0x000000,\n/* 0x4D icvCtlFore ?? */\n0x000000,\n/* 0x4E icvCtlBack ?? */\n0x000000,\n/* 0x4F icvCtlNeutral */\n0x000000,\n/* 0x50 icvInfoBk ?? */\n0x000000\n/* 0x51 icvInfoText ?? */\n]);\n\nvar XLSIcv = /*#__PURE__*/dup(_XLSIcv);\n/* [MS-XLSB] 2.5.97.2 */\n\nvar BErr = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : \"#NULL!\",\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : \"#DIV/0!\",\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : \"#VALUE!\",\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : \"#REF!\",\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : \"#NAME?\",\n\n  /*::[*/\n  0x24\n  /*::]*/\n  : \"#NUM!\",\n\n  /*::[*/\n  0x2A\n  /*::]*/\n  : \"#N/A\",\n\n  /*::[*/\n  0x2B\n  /*::]*/\n  : \"#GETTING_DATA\",\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : \"#WTF?\"\n}; //var RBErr = evert_num(BErr);\n\nvar RBErr = {\n  \"#NULL!\": 0x00,\n  \"#DIV/0!\": 0x07,\n  \"#VALUE!\": 0x0F,\n  \"#REF!\": 0x17,\n  \"#NAME?\": 0x1D,\n  \"#NUM!\": 0x24,\n  \"#N/A\": 0x2A,\n  \"#GETTING_DATA\": 0x2B,\n  \"#WTF?\": 0xFF\n};\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n\n/* 12.3 Part Summary <SpreadsheetML> */\n\n/* 14.2 Part Summary <DrawingML> */\n\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\n\nvar ct2type\n/*{[string]:string}*/\n= {\n  /* Workbook */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n  \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n  \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n  \"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n  /* Worksheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n  \"application/vnd.ms-excel.worksheet\": \"sheets\",\n  \"application/vnd.ms-excel.binIndexWs\": \"TODO\",\n\n  /* Binary Index */\n\n  /* Chartsheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n  \"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n  /* Macrosheet */\n  \"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n  \"application/vnd.ms-excel.macrosheet\": \"macros\",\n  \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n  \"application/vnd.ms-excel.binIndexMs\": \"TODO\",\n\n  /* Binary Index */\n\n  /* Dialogsheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n  \"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n  /* Shared Strings */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n  \"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n  /* Styles */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n  \"application/vnd.ms-excel.styles\": \"styles\",\n\n  /* File Properties */\n  \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n  \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n  \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n  /* Custom Data Properties */\n  \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n  /* Comments */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n  \"application/vnd.ms-excel.comments\": \"comments\",\n  \"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n  \"application/vnd.ms-excel.person+xml\": \"people\",\n\n  /* Metadata (Stock/Geography and Dynamic Array) */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n  \"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n  /* PivotTable */\n  \"application/vnd.ms-excel.pivotTable\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n  /* Chart Objects */\n  \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n  /* Chart Colors */\n  \"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n  /* Chart Style */\n  \"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n  /* Chart Advanced */\n  \"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n  /* Calculation Chain */\n  \"application/vnd.ms-excel.calcChain\": \"calcchains\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n  /* Printer Settings */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n  /* ActiveX */\n  \"application/vnd.ms-office.activeX\": \"TODO\",\n  \"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n  /* Custom Toolbars */\n  \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n  /* External Data Connections */\n  \"application/vnd.ms-excel.connections\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n  /* External Links */\n  \"application/vnd.ms-excel.externalLink\": \"links\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n  /* PivotCache */\n  \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n  \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n  /* Query Table */\n  \"application/vnd.ms-excel.queryTable\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n  /* Shared Workbook */\n  \"application/vnd.ms-excel.userNames\": \"TODO\",\n  \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n  \"application/vnd.ms-excel.revisionLog\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n  /* Single Cell Table */\n  \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n  /* Slicer */\n  \"application/vnd.ms-excel.slicer\": \"TODO\",\n  \"application/vnd.ms-excel.slicerCache\": \"TODO\",\n  \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n  \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n  /* Sort Map */\n  \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n  /* Table */\n  \"application/vnd.ms-excel.table\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n  /* Themes */\n  \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n  /* Theme Override */\n  \"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n  /* Timeline */\n  \"application/vnd.ms-excel.Timeline+xml\": \"TODO\",\n\n  /* verify */\n  \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\",\n\n  /* verify */\n\n  /* VBA */\n  \"application/vnd.ms-office.vbaProject\": \"vba\",\n  \"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n  /* Volatile Dependencies */\n  \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n  /* Control Properties */\n  \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n  /* Data Model */\n  \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n  /* Survey */\n  \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n  /* Drawing */\n  \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n  /* VML */\n  \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n  \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n  \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n  /* Image */\n  \"image/png\": \"TODO\",\n  \"sheet\": \"js\"\n}\n/*:any*/\n;\n\nfunction new_ct()\n/*:any*/\n{\n  return {\n    workbooks: [],\n    sheets: [],\n    charts: [],\n    dialogs: [],\n    macros: [],\n    rels: [],\n    strs: [],\n    comments: [],\n    threadedcomments: [],\n    links: [],\n    coreprops: [],\n    extprops: [],\n    custprops: [],\n    themes: [],\n    styles: [],\n    calcchains: [],\n    vba: [],\n    drawings: [],\n    metadata: [],\n    people: [],\n    TODO: [],\n    xmlns: \"\"\n  }\n  /*:any*/\n  ;\n}\n\nfunction parse_ct(data\n/*:?string*/\n) {\n  var ct = new_ct();\n  if (!data || !data.match) return ct;\n  var ctext = {};\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0].replace(nsregex, \"<\")) {\n      case '<?xml':\n        break;\n\n      case '<Types':\n        ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]];\n        break;\n\n      case '<Default':\n        ctext[y.Extension] = y.ContentType;\n        break;\n\n      case '<Override':\n        if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n        break;\n    }\n  });\n  if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n  ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n  ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n  ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n  ct.defaults = ctext;\n  delete ct.calcchains;\n  return ct;\n}\n/* 9.3 Relationships */\n\n\nvar RELS = {\n  WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n  SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n  HLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n  VML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n  XPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n  XMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n  XLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n  CXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n  CXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n  CMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n  CORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n  EXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n  CUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n  SST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n  STY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n  THEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n  CHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n  CHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n  CS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n  WS: [\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\", \"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"],\n  DS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n  MS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n  IMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n  DRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n  XLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n  TCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n  PEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n  VBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n}\n/*:any*/\n;\n/* 9.3.3 Representing Relationships */\n\nfunction get_rels_path(file\n/*:string*/\n)\n/*:string*/\n{\n  var n = file.lastIndexOf(\"/\");\n  return file.slice(0, n + 1) + '_rels/' + file.slice(n + 1) + \".rels\";\n}\n\nfunction parse_rels(data\n/*:?string*/\n, currentFilePath\n/*:string*/\n) {\n  var rels = {\n    \"!id\": {}\n  };\n  if (!data) return rels;\n\n  if (currentFilePath.charAt(0) !== '/') {\n    currentFilePath = '/' + currentFilePath;\n  }\n\n  var hash = {};\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n    /* 9.3.2.2 OPC_Relationships */\n\n    if (y[0] === '<Relationship') {\n      var rel = {};\n      rel.Type = y.Type;\n      rel.Target = y.Target;\n      rel.Id = y.Id;\n      if (y.TargetMode) rel.TargetMode = y.TargetMode;\n      var canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n      rels[canonictarget] = rel;\n      hash[y.Id] = rel;\n    }\n  });\n  rels[\"!id\"] = hash;\n  return rels;\n}\n/* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n\n/* Part 3 Section 4 Manifest File */\n\n\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\n\nfunction parse_manifest(d, opts) {\n  var str = xlml_normalize(d);\n  var Rn;\n  var FEtag;\n\n  while (Rn = xlmlregex.exec(str)) {\n    switch (Rn[3]) {\n      case 'manifest':\n        break;\n      // 4.2 <manifest:manifest>\n\n      case 'file-entry':\n        // 4.3 <manifest:file-entry>\n        FEtag = parsexmltag(Rn[0], false);\n        if (FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n        break;\n\n      case 'encryption-data': // 4.4 <manifest:encryption-data>\n\n      case 'algorithm': // 4.5 <manifest:algorithm>\n\n      case 'start-key-generation': // 4.6 <manifest:start-key-generation>\n\n      case 'key-derivation':\n        // 4.7 <manifest:key-derivation>\n        throw new Error(\"Unsupported ODS Encryption\");\n\n      default:\n        if (opts && opts.WTF) throw Rn;\n    }\n  }\n}\n/* ECMA-376 Part II 11.1 Core Properties Part */\n\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\nvar CORE_PROPS\n/*:Array<Array<string> >*/\n= [[\"cp:category\", \"Category\"], [\"cp:contentStatus\", \"ContentStatus\"], [\"cp:keywords\", \"Keywords\"], [\"cp:lastModifiedBy\", \"LastAuthor\"], [\"cp:lastPrinted\", \"LastPrinted\"], [\"cp:revision\", \"RevNumber\"], [\"cp:version\", \"Version\"], [\"dc:creator\", \"Author\"], [\"dc:description\", \"Comments\"], [\"dc:identifier\", \"Identifier\"], [\"dc:language\", \"Language\"], [\"dc:subject\", \"Subject\"], [\"dc:title\", \"Title\"], [\"dcterms:created\", \"CreatedDate\", 'date'], [\"dcterms:modified\", \"ModifiedDate\", 'date']];\n\nvar CORE_PROPS_REGEX\n/*:Array<RegExp>*/\n= /*#__PURE__*/function () {\n  var r = new Array(CORE_PROPS.length);\n\n  for (var i = 0; i < CORE_PROPS.length; ++i) {\n    var f = CORE_PROPS[i];\n    var g = \"(?:\" + f[0].slice(0, f[0].indexOf(\":\")) + \":)\" + f[0].slice(f[0].indexOf(\":\") + 1);\n    r[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n  }\n\n  return r;\n}();\n\nfunction parse_core_props(data) {\n  var p = {};\n  data = utf8read(data);\n\n  for (var i = 0; i < CORE_PROPS.length; ++i) {\n    var f = CORE_PROPS[i],\n        cur = data.match(CORE_PROPS_REGEX[i]);\n    if (cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n    if (f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n  }\n\n  return p;\n}\n/* 15.2.12.3 Extended File Properties Part */\n\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\nvar EXT_PROPS\n/*:Array<Array<string> >*/\n= [[\"Application\", \"Application\", \"string\"], [\"AppVersion\", \"AppVersion\", \"string\"], [\"Company\", \"Company\", \"string\"], [\"DocSecurity\", \"DocSecurity\", \"string\"], [\"Manager\", \"Manager\", \"string\"], [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"], [\"SharedDoc\", \"SharedDoc\", \"bool\"], [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"], [\"ScaleCrop\", \"ScaleCrop\", \"bool\"], [\"HeadingPairs\", \"HeadingPairs\", \"raw\"], [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]];\n\nfunction load_props_pairs(HP\n/*:string|Array<Array<any>>*/\n, TOP, props, opts) {\n  var v = [];\n  if (typeof HP == \"string\") v = parseVector(HP, opts);else for (var j = 0; j < HP.length; ++j) {\n    v = v.concat(HP[j].map(function (hp) {\n      return {\n        v: hp\n      };\n    }));\n  }\n  var parts = typeof TOP == \"string\" ? parseVector(TOP, opts).map(function (x) {\n    return x.v;\n  }) : TOP;\n  var idx = 0,\n      len = 0;\n  if (parts.length > 0) for (var i = 0; i !== v.length; i += 2) {\n    len = +v[i + 1].v;\n\n    switch (v[i].v) {\n      case \"Worksheets\":\n      case \"工作表\":\n      case \"Листы\":\n      case \"أوراق العمل\":\n      case \"ワークシート\":\n      case \"גליונות עבודה\":\n      case \"Arbeitsblätter\":\n      case \"Çalışma Sayfaları\":\n      case \"Feuilles de calcul\":\n      case \"Fogli di lavoro\":\n      case \"Folhas de cálculo\":\n      case \"Planilhas\":\n      case \"Regneark\":\n      case \"Hojas de cálculo\":\n      case \"Werkbladen\":\n        props.Worksheets = len;\n        props.SheetNames = parts.slice(idx, idx + len);\n        break;\n\n      case \"Named Ranges\":\n      case \"Rangos con nombre\":\n      case \"名前付き一覧\":\n      case \"Benannte Bereiche\":\n      case \"Navngivne områder\":\n        props.NamedRanges = len;\n        props.DefinedNames = parts.slice(idx, idx + len);\n        break;\n\n      case \"Charts\":\n      case \"Diagramme\":\n        props.Chartsheets = len;\n        props.ChartNames = parts.slice(idx, idx + len);\n        break;\n    }\n\n    idx += len;\n  }\n}\n\nfunction parse_ext_props(data, p, opts) {\n  var q = {};\n  if (!p) p = {};\n  data = utf8read(data);\n  EXT_PROPS.forEach(function (f) {\n    var xml = (data.match(matchtag(f[0])) || [])[1];\n\n    switch (f[2]) {\n      case \"string\":\n        if (xml) p[f[1]] = unescapexml(xml);\n        break;\n\n      case \"bool\":\n        p[f[1]] = xml === \"true\";\n        break;\n\n      case \"raw\":\n        var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n        if (cur && cur.length > 0) q[f[1]] = cur[1];\n        break;\n    }\n  });\n  if (q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n  return p;\n}\n/* 15.2.12.2 Custom File Properties Part */\n\n\nvar custregex = /<[^>]+>[^<]*/g;\n\nfunction parse_cust_props(data\n/*:string*/\n, opts) {\n  var p = {},\n      name = \"\";\n  var m = data.match(custregex);\n  if (m) for (var i = 0; i != m.length; ++i) {\n    var x = m[i],\n        y = parsexmltag(x);\n\n    switch (y[0]) {\n      case '<?xml':\n        break;\n\n      case '<Properties':\n        break;\n\n      case '<property':\n        name = unescapexml(y.name);\n        break;\n\n      case '</property>':\n        name = null;\n        break;\n\n      default:\n        if (x.indexOf('<vt:') === 0) {\n          var toks = x.split('>');\n          var type = toks[0].slice(4),\n              text = toks[1];\n          /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\n          switch (type) {\n            case 'lpstr':\n            case 'bstr':\n            case 'lpwstr':\n              p[name] = unescapexml(text);\n              break;\n\n            case 'bool':\n              p[name] = parsexmlbool(text);\n              break;\n\n            case 'i1':\n            case 'i2':\n            case 'i4':\n            case 'i8':\n            case 'int':\n            case 'uint':\n              p[name] = parseInt(text, 10);\n              break;\n\n            case 'r4':\n            case 'r8':\n            case 'decimal':\n              p[name] = parseFloat(text);\n              break;\n\n            case 'filetime':\n            case 'date':\n              p[name] = parseDate(text);\n              break;\n\n            case 'cy':\n            case 'error':\n              p[name] = unescapexml(text);\n              break;\n\n            default:\n              if (type.slice(-1) == '/') break;\n              if (opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n          }\n        } else if (x.slice(0, 2) === \"</\") ;else if (opts.WTF) throw new Error(x);\n\n    }\n  }\n  return p;\n}\n/* Common Name -> XLML Name */\n\n\nvar XLMLDocPropsMap = {\n  Title: 'Title',\n  Subject: 'Subject',\n  Author: 'Author',\n  Keywords: 'Keywords',\n  Comments: 'Description',\n  LastAuthor: 'LastAuthor',\n  RevNumber: 'Revision',\n  Application: 'AppName',\n\n  /* TotalTime: 'TotalTime', */\n  LastPrinted: 'LastPrinted',\n  CreatedDate: 'Created',\n  ModifiedDate: 'LastSaved',\n\n  /* Pages */\n\n  /* Words */\n\n  /* Characters */\n  Category: 'Category',\n\n  /* PresentationFormat */\n  Manager: 'Manager',\n  Company: 'Company',\n\n  /* Guid */\n\n  /* HyperlinkBase */\n\n  /* Bytes */\n\n  /* Lines */\n\n  /* Paragraphs */\n\n  /* CharactersWithSpaces */\n  AppVersion: 'Version',\n  ContentStatus: 'ContentStatus',\n\n  /* NOTE: missing from schema */\n  Identifier: 'Identifier',\n\n  /* NOTE: missing from schema */\n  Language: 'Language'\n  /* NOTE: missing from schema */\n\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag\n/*:string*/\n, val) {\n  if (!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n  tag = evert_XLMLDPM[tag] || tag;\n  Props[tag] = val;\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n\n\nfunction parse_FILETIME(blob) {\n  var dwLowDateTime = blob.read_shift(4),\n      dwHighDateTime = blob.read_shift(4);\n  return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n}\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n\n\nfunction parse_lpstr(blob, type, pad\n/*:?number*/\n) {\n  var start = blob.l;\n  var str = blob.read_shift(0, 'lpstr-cp');\n  if (pad) while (blob.l - start & 3) {\n    ++blob.l;\n  }\n  return str;\n}\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n\n\nfunction parse_lpwstr(blob, type, pad) {\n  var str = blob.read_shift(0, 'lpwstr');\n  if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n  return str;\n}\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n\n\nfunction parse_VtStringBase(blob, stringType, pad) {\n  if (stringType === 0x1F\n  /*VT_LPWSTR*/\n  ) return parse_lpwstr(blob);\n  return parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t\n/*:number*/\n, pad\n/*:?boolean*/\n) {\n  return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n}\n\nfunction parse_VtUnalignedString(blob, t\n/*:number*/\n) {\n  if (!t) throw new Error(\"VtUnalignedString must have positive length\");\n  return parse_VtStringBase(blob, t, 0);\n}\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\n\n\nfunction parse_VtVecLpwstrValue(blob)\n/*:Array<string>*/\n{\n  var length = blob.read_shift(4);\n  var ret\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i != length; ++i) {\n    var start = blob.l;\n    ret[i] = blob.read_shift(0, 'lpwstr').replace(chr0, '');\n    if (blob.l - start & 0x02) blob.l += 2;\n  }\n\n  return ret;\n}\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n\n\nfunction parse_VtVecUnalignedLpstrValue(blob)\n/*:Array<string>*/\n{\n  var length = blob.read_shift(4);\n  var ret\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i != length; ++i) {\n    ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0, '');\n  }\n\n  return ret;\n}\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n\n\nfunction parse_VtHeadingPair(blob) {\n  var start = blob.l;\n  var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n  if (blob[blob.l] == 0x00 && blob[blob.l + 1] == 0x00 && blob.l - start & 0x02) blob.l += 2;\n  var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n  return [headingString, headerParts];\n}\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n\n\nfunction parse_VtVecHeadingPairValue(blob) {\n  var cElements = blob.read_shift(4);\n  var out = [];\n\n  for (var i = 0; i < cElements / 2; ++i) {\n    out.push(parse_VtHeadingPair(blob));\n  }\n\n  return out;\n}\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n\n\nfunction parse_dictionary(blob, CodePage) {\n  var cnt = blob.read_shift(4);\n  var dict\n  /*:{[number]:string}*/\n  = {}\n  /*:any*/\n  ;\n\n  for (var j = 0; j != cnt; ++j) {\n    var pid = blob.read_shift(4);\n    var len = blob.read_shift(4);\n    dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n    if (CodePage === 0x4B0 && len % 2) blob.l += 2;\n  }\n\n  if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n  return dict;\n}\n/* [MS-OLEPS] 2.9 BLOB */\n\n\nfunction parse_BLOB(blob) {\n  var size = blob.read_shift(4);\n  var bytes = blob.slice(blob.l, blob.l + size);\n  blob.l += size;\n  if ((size & 3) > 0) blob.l += 4 - (size & 3) & 3;\n  return bytes;\n}\n/* [MS-OLEPS] 2.11 ClipboardData */\n\n\nfunction parse_ClipboardData(blob) {\n  // TODO\n  var o = {};\n  o.Size = blob.read_shift(4); //o.Format = blob.read_shift(4);\n\n  blob.l += o.Size + 3 - (o.Size - 1) % 4;\n  return o;\n}\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\n\n\nfunction parse_TypedPropertyValue(blob, type\n/*:number*/\n, _opts)\n/*:any*/\n{\n  var t = blob.read_shift(2),\n      ret,\n      opts = _opts || {};\n  blob.l += 2;\n  if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\n  switch (type === VT_VARIANT ? t : type) {\n    case 0x02\n    /*VT_I2*/\n    :\n      ret = blob.read_shift(2, 'i');\n      if (!opts.raw) blob.l += 2;\n      return ret;\n\n    case 0x03\n    /*VT_I4*/\n    :\n      ret = blob.read_shift(4, 'i');\n      return ret;\n\n    case 0x0B\n    /*VT_BOOL*/\n    :\n      return blob.read_shift(4) !== 0x0;\n\n    case 0x13\n    /*VT_UI4*/\n    :\n      ret = blob.read_shift(4);\n      return ret;\n\n    case 0x1E\n    /*VT_LPSTR*/\n    :\n      return parse_lpstr(blob, t, 4).replace(chr0, '');\n\n    case 0x1F\n    /*VT_LPWSTR*/\n    :\n      return parse_lpwstr(blob);\n\n    case 0x40\n    /*VT_FILETIME*/\n    :\n      return parse_FILETIME(blob);\n\n    case 0x41\n    /*VT_BLOB*/\n    :\n      return parse_BLOB(blob);\n\n    case 0x47\n    /*VT_CF*/\n    :\n      return parse_ClipboardData(blob);\n\n    case 0x50\n    /*VT_STRING*/\n    :\n      return parse_VtString(blob, t, !opts.raw).replace(chr0, '');\n\n    case 0x51\n    /*VT_USTR*/\n    :\n      return parse_VtUnalignedString(blob, t\n      /*, 4*/\n      ).replace(chr0, '');\n\n    case 0x100C\n    /*VT_VECTOR|VT_VARIANT*/\n    :\n      return parse_VtVecHeadingPairValue(blob);\n\n    case 0x101E\n    /*VT_VECTOR|VT_LPSTR*/\n    :\n    case 0x101F\n    /*VT_VECTOR|VT_LPWSTR*/\n    :\n      return t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\n    default:\n      throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n  }\n}\n/* [MS-OLEPS] 2.20 PropertySet */\n\n\nfunction parse_PropertySet(blob, PIDSI) {\n  var start_addr = blob.l;\n  var size = blob.read_shift(4);\n  var NumProps = blob.read_shift(4);\n  var Props = [],\n      i = 0;\n  var CodePage = 0;\n  var Dictionary = -1,\n      DictObj\n  /*:{[number]:string}*/\n  = {}\n  /*:any*/\n  ;\n\n  for (i = 0; i != NumProps; ++i) {\n    var PropID = blob.read_shift(4);\n    var Offset = blob.read_shift(4);\n    Props[i] = [PropID, Offset + start_addr];\n  }\n\n  Props.sort(function (x, y) {\n    return x[1] - y[1];\n  });\n  var PropH = {};\n\n  for (i = 0; i != NumProps; ++i) {\n    if (blob.l !== Props[i][1]) {\n      var fail = true;\n      if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n        case 0x02\n        /*VT_I2*/\n        :\n          if (blob.l + 2 === Props[i][1]) {\n            blob.l += 2;\n            fail = false;\n          }\n\n          break;\n\n        case 0x50\n        /*VT_STRING*/\n        :\n          if (blob.l <= Props[i][1]) {\n            blob.l = Props[i][1];\n            fail = false;\n          }\n\n          break;\n\n        case 0x100C\n        /*VT_VECTOR|VT_VARIANT*/\n        :\n          if (blob.l <= Props[i][1]) {\n            blob.l = Props[i][1];\n            fail = false;\n          }\n\n          break;\n      }\n\n      if ((!PIDSI || i == 0) && blob.l <= Props[i][1]) {\n        fail = false;\n        blob.l = Props[i][1];\n      }\n\n      if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n    }\n\n    if (PIDSI) {\n      var piddsi = PIDSI[Props[i][0]];\n      PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n        raw: true\n      });\n      if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n      if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n        case 0:\n          PropH[piddsi.n] = 1252;\n\n        /* falls through */\n\n        case 874:\n        case 932:\n        case 936:\n        case 949:\n        case 950:\n        case 1250:\n        case 1251:\n        case 1253:\n        case 1254:\n        case 1255:\n        case 1256:\n        case 1257:\n        case 1258:\n        case 10000:\n        case 1200:\n        case 1201:\n        case 1252:\n        case 65000:\n        case -536:\n        case 65001:\n        case -535:\n          set_cp(CodePage = PropH[piddsi.n] >>> 0 & 0xFFFF);\n          break;\n\n        default:\n          throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n      }\n    } else {\n      if (Props[i][0] === 0x1) {\n        CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2)\n        /*:number*/\n        ;\n        set_cp(CodePage);\n\n        if (Dictionary !== -1) {\n          var oldpos = blob.l;\n          blob.l = Props[Dictionary][1];\n          DictObj = parse_dictionary(blob, CodePage);\n          blob.l = oldpos;\n        }\n      } else if (Props[i][0] === 0) {\n        if (CodePage === 0) {\n          Dictionary = i;\n          blob.l = Props[i + 1][1];\n          continue;\n        }\n\n        DictObj = parse_dictionary(blob, CodePage);\n      } else {\n        var name = DictObj[Props[i][0]];\n        var val;\n        /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\n        switch (blob[blob.l]) {\n          case 0x41\n          /*VT_BLOB*/\n          :\n            blob.l += 4;\n            val = parse_BLOB(blob);\n            break;\n\n          case 0x1E\n          /*VT_LPSTR*/\n          :\n            blob.l += 4;\n            val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n            break;\n\n          case 0x1F\n          /*VT_LPWSTR*/\n          :\n            blob.l += 4;\n            val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n            break;\n\n          case 0x03\n          /*VT_I4*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(4, 'i');\n            break;\n\n          case 0x13\n          /*VT_UI4*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(4);\n            break;\n\n          case 0x05\n          /*VT_R8*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(8, 'f');\n            break;\n\n          case 0x0B\n          /*VT_BOOL*/\n          :\n            blob.l += 4;\n            val = parsebool(blob, 4);\n            break;\n\n          case 0x40\n          /*VT_FILETIME*/\n          :\n            blob.l += 4;\n            val = parseDate(parse_FILETIME(blob));\n            break;\n\n          default:\n            throw new Error(\"unparsed value: \" + blob[blob.l]);\n        }\n\n        PropH[name] = val;\n      }\n    }\n  }\n\n  blob.l = start_addr + size;\n  /* step ahead to skip padding */\n\n  return PropH;\n}\n/* [MS-OLEPS] 2.21 PropertySetStream */\n\n\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n  var blob = file.content;\n  if (!blob) return {}\n  /*:any*/\n  ;\n  prep_blob(blob, 0);\n  var NumSets,\n      FMTID0,\n      FMTID1,\n      Offset0,\n      Offset1 = 0;\n  blob.chk('feff', 'Byte Order: ');\n  /*var vers = */\n\n  blob.read_shift(2); // TODO: check version\n\n  var SystemIdentifier = blob.read_shift(4);\n  var CLSID = blob.read_shift(16);\n  if (CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n  NumSets = blob.read_shift(4);\n  if (NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n  FMTID0 = blob.read_shift(16);\n  Offset0 = blob.read_shift(4);\n  if (NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);else if (NumSets === 2) {\n    FMTID1 = blob.read_shift(16);\n    Offset1 = blob.read_shift(4);\n  }\n  var PSet0 = parse_PropertySet(blob, PIDSI);\n  var rval = {\n    SystemIdentifier: SystemIdentifier\n  }\n  /*:any*/\n  ;\n\n  for (var y in PSet0) {\n    rval[y] = PSet0[y];\n  } //rval.blob = blob;\n\n\n  rval.FMTID = FMTID0; //rval.PSet0 = PSet0;\n\n  if (NumSets === 1) return rval;\n  if (Offset1 - blob.l == 2) blob.l += 2;\n  if (blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n  var PSet1;\n\n  try {\n    PSet1 = parse_PropertySet(blob, null);\n  } catch (e) {\n    /* empty */\n  }\n\n  for (y in PSet1) {\n    rval[y] = PSet1[y];\n  }\n\n  rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\n  return rval;\n}\n\nfunction parsenoop2(blob, length) {\n  blob.read_shift(length);\n  return null;\n}\n\nfunction parslurp(blob, length, cb) {\n  var arr = [],\n      target = blob.l + length;\n\n  while (blob.l < target) {\n    arr.push(cb(blob, target - blob.l));\n  }\n\n  if (target !== blob.l) throw new Error(\"Slurp error\");\n  return arr;\n}\n\nfunction parsebool(blob, length\n/*:number*/\n) {\n  return blob.read_shift(length) === 0x1;\n}\n\nfunction parseuint16(blob\n/*::, length:?number, opts:?any*/\n) {\n  return blob.read_shift(2, 'u');\n}\n\nfunction parseuint16a(blob, length\n/*:: :?number, opts:?any*/\n) {\n  return parslurp(blob, length, parseuint16);\n}\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\n\n\nfunction parse_Bes(blob\n/*::, length*/\n) {\n  var v = blob.read_shift(1),\n      t = blob.read_shift(1);\n  return t === 0x01 ? v : v === 0x01;\n}\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n\n\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n  var cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n  var encoding = 'sbcs-cont';\n  if (opts && opts.biff >= 8) ;\n\n  if (!opts || opts.biff == 8) {\n    var fHighByte = blob.read_shift(1);\n\n    if (fHighByte) {\n      encoding = 'dbcs-cont';\n    }\n  } else if (opts.biff == 12) {\n    encoding = 'wstr';\n  }\n\n  if (opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n  var o = cch ? blob.read_shift(cch, encoding) : \"\";\n  return o;\n}\n/* 2.5.293 XLUnicodeRichExtendedString */\n\n\nfunction parse_XLUnicodeRichExtendedString(blob) {\n  var cch = blob.read_shift(2),\n      flags = blob.read_shift(1);\n  var\n  /*fHighByte = flags & 0x1,*/\n  fExtSt = flags & 0x4,\n      fRichSt = flags & 0x8;\n  var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\n  var cRun = 0,\n      cbExtRst;\n  var z = {};\n  if (fRichSt) cRun = blob.read_shift(2);\n  if (fExtSt) cbExtRst = blob.read_shift(4);\n  var encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n  var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n  if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\n  if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n\n  z.t = msg;\n\n  if (!fRichSt) {\n    z.raw = \"<t>\" + z.t + \"</t>\";\n    z.r = z.t;\n  }\n\n  return z;\n}\n/* 2.5.296 XLUnicodeStringNoCch */\n\n\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n  var retval;\n\n  if (opts) {\n    if (opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n    if (opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n  }\n\n  var fHighByte = blob.read_shift(1);\n\n  if (fHighByte === 0) {\n    retval = blob.read_shift(cch, 'sbcs-cont');\n  } else {\n    retval = blob.read_shift(cch, 'dbcs-cont');\n  }\n\n  return retval;\n}\n/* 2.5.294 XLUnicodeString */\n\n\nfunction parse_XLUnicodeString(blob, length, opts) {\n  var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\n\n\nfunction parse_XLUnicodeString2(blob, length, opts) {\n  if (opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n  var cch = blob.read_shift(1);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return blob.read_shift(cch, opts.biff <= 4 || !blob.lens ? 'cpstr' : 'sbcs-cont');\n}\n/* [MS-XLS] 2.5.61 ControlInfo */\n\n\nfunction parse_ControlInfo(blob\n/*::, length, opts*/\n) {\n  var flags = blob.read_shift(1);\n  blob.l++;\n  var accel = blob.read_shift(2);\n  blob.l += 2;\n  return [flags, accel];\n}\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n\n\nfunction parse_URLMoniker(blob\n/*::, length, opts*/\n) {\n  var len = blob.read_shift(4),\n      start = blob.l;\n  var extra = false;\n\n  if (len > 24) {\n    /* look ahead */\n    blob.l += len - 24;\n    if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n    blob.l = start;\n  }\n\n  var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n  if (extra) blob.l += 24;\n  return url;\n}\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n\n\nfunction parse_FileMoniker(blob\n/*::, length*/\n) {\n  var cAnti = blob.read_shift(2);\n  var preamble = \"\";\n\n  while (cAnti-- > 0) {\n    preamble += \"../\";\n  }\n\n  var ansiPath = blob.read_shift(0, 'lpstr-ansi');\n  blob.l += 2; //var endServer = blob.read_shift(2);\n\n  if (blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n  var sz = blob.read_shift(4);\n  if (sz === 0) return preamble + ansiPath.replace(/\\\\/g, \"/\");\n  var bytes = blob.read_shift(4);\n  if (blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n  var unicodePath = blob.read_shift(bytes >> 1, 'utf16le').replace(chr0, \"\");\n  return preamble + unicodePath;\n}\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n\n\nfunction parse_HyperlinkMoniker(blob, length) {\n  var clsid = blob.read_shift(16);\n\n  switch (clsid) {\n    case \"e0c9ea79f9bace118c8200aa004ba90b\":\n      return parse_URLMoniker(blob);\n\n    case \"0303000000000000c000000000000046\":\n      return parse_FileMoniker(blob);\n\n    default:\n      throw new Error(\"Unsupported Moniker \" + clsid);\n  }\n}\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n\n\nfunction parse_HyperlinkString(blob\n/*::, length*/\n) {\n  var len = blob.read_shift(4);\n  var o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n  return o;\n}\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\n\n\nfunction parse_Hyperlink(blob, length)\n/*:Hyperlink*/\n{\n  var end = blob.l + length;\n  var sVer = blob.read_shift(4);\n  if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n  var flags = blob.read_shift(2);\n  blob.l += 2;\n  var displayName,\n      targetFrameName,\n      moniker,\n      oleMoniker,\n      Loc = \"\",\n      guid,\n      fileTime;\n  if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n  if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n  if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n  if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n  if (flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n  if (flags & 0x0020) guid = blob.read_shift(16);\n  if (flags & 0x0040) fileTime = parse_FILETIME(blob\n  /*, 8*/\n  );\n  blob.l = end;\n  var target = targetFrameName || moniker || oleMoniker || \"\";\n  if (target && Loc) target += \"#\" + Loc;\n  if (!target) target = \"#\" + Loc;\n  if (flags & 0x0002 && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n  var out = {\n    Target: target\n  }\n  /*:any*/\n  ;\n  if (guid) out.guid = guid;\n  if (fileTime) out.time = fileTime;\n  if (displayName) out.Tooltip = displayName;\n  return out;\n}\n/* 2.5.178 LongRGBA */\n\n\nfunction parse_LongRGBA(blob\n/*::, length*/\n) {\n  var r = blob.read_shift(1),\n      g = blob.read_shift(1),\n      b = blob.read_shift(1),\n      a = blob.read_shift(1);\n  return [r, g, b, a];\n}\n/* 2.5.177 LongRGB */\n\n\nfunction parse_LongRGB(blob, length) {\n  var x = parse_LongRGBA(blob);\n  x[3] = 0;\n  return x;\n}\n/* [MS-XLS] 2.5.19 */\n\n\nfunction parse_XLSCell(blob\n/*::, length*/\n)\n/*:Cell*/\n{\n  var rw = blob.read_shift(2); // 0-indexed\n\n  var col = blob.read_shift(2);\n  var ixfe = blob.read_shift(2);\n  return {\n    r: rw,\n    c: col,\n    ixfe: ixfe\n  }\n  /*:any*/\n  ;\n}\n/* [MS-XLS] 2.5.134 */\n\n\nfunction parse_frtHeader(blob) {\n  var rt = blob.read_shift(2);\n  var flags = blob.read_shift(2); // TODO: parse these flags\n\n  blob.l += 8;\n  return {\n    type: rt,\n    flags: flags\n  };\n}\n\nfunction parse_OptXLUnicodeString(blob, length, opts) {\n  return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n}\n/* [MS-XLS] 2.5.344 */\n\n\nfunction parse_XTI(blob, length, opts) {\n  var w = opts.biff > 8 ? 4 : 2;\n  var iSupBook = blob.read_shift(w),\n      itabFirst = blob.read_shift(w, 'i'),\n      itabLast = blob.read_shift(w, 'i');\n  return [iSupBook, itabFirst, itabLast];\n}\n/* [MS-XLS] 2.5.218 */\n\n\nfunction parse_RkRec(blob) {\n  var ixfe = blob.read_shift(2);\n  var RK = parse_RkNumber(blob);\n  return [ixfe, RK];\n}\n/* [MS-XLS] 2.5.1 */\n\n\nfunction parse_AddinUdf(blob, length, opts) {\n  blob.l += 4;\n  length -= 4;\n  var l = blob.l + length;\n  var udfName = parse_ShortXLUnicodeString(blob, length, opts);\n  var cb = blob.read_shift(2);\n  l -= blob.l;\n  if (cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n  blob.l += cb;\n  return udfName;\n}\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\n\n\nfunction parse_Ref8U(blob\n/*::, length*/\n) {\n  var rwFirst = blob.read_shift(2);\n  var rwLast = blob.read_shift(2);\n  var colFirst = blob.read_shift(2);\n  var colLast = blob.read_shift(2);\n  return {\n    s: {\n      c: colFirst,\n      r: rwFirst\n    },\n    e: {\n      c: colLast,\n      r: rwLast\n    }\n  };\n}\n/* [MS-XLS] 2.5.211 */\n\n\nfunction parse_RefU(blob\n/*::, length*/\n) {\n  var rwFirst = blob.read_shift(2);\n  var rwLast = blob.read_shift(2);\n  var colFirst = blob.read_shift(1);\n  var colLast = blob.read_shift(1);\n  return {\n    s: {\n      c: colFirst,\n      r: rwFirst\n    },\n    e: {\n      c: colLast,\n      r: rwLast\n    }\n  };\n}\n/* [MS-XLS] 2.5.207 */\n\n\nvar parse_Ref = parse_RefU;\n/* [MS-XLS] 2.5.143 */\n\nfunction parse_FtCmo(blob\n/*::, length*/\n) {\n  blob.l += 4;\n  var ot = blob.read_shift(2);\n  var id = blob.read_shift(2);\n  var flags = blob.read_shift(2);\n  blob.l += 12;\n  return [id, ot, flags];\n}\n/* [MS-XLS] 2.5.149 */\n\n\nfunction parse_FtNts(blob) {\n  var out = {};\n  blob.l += 4;\n  blob.l += 16; // GUID TODO\n\n  out.fSharedNote = blob.read_shift(2);\n  blob.l += 4;\n  return out;\n}\n/* [MS-XLS] 2.5.142 */\n\n\nfunction parse_FtCf(blob) {\n  var out = {};\n  blob.l += 4;\n  blob.cf = blob.read_shift(2);\n  return out;\n}\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\n\n\nfunction parse_FtSkip(blob) {\n  blob.l += 2;\n  blob.l += blob.read_shift(2);\n}\n\nvar FtTab = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtEnd */\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtMacro */\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtButton */\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtGmo */\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : parse_FtCf,\n\n  /* FtCf */\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtPioGrbit */\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtPictFmla */\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCbls */\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtRbo */\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtSbs */\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : parse_FtNts,\n\n  /* FtNts */\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtSbsFmla */\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtGboData */\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtEdoData */\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtRboData */\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCblsData */\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtLbsData */\n\n  /*::[*/\n  0x14\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCblsFmla */\n\n  /*::[*/\n  0x15\n  /*::]*/\n  : parse_FtCmo\n};\n\nfunction parse_FtArray(blob, length\n/*::, ot*/\n) {\n  var tgt = blob.l + length;\n  var fts = [];\n\n  while (blob.l < tgt) {\n    var ft = blob.read_shift(2);\n    blob.l -= 2;\n\n    try {\n      fts.push(FtTab[ft](blob, tgt - blob.l));\n    } catch (e) {\n      blob.l = tgt;\n      return fts;\n    }\n  }\n\n  if (blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\n  return fts;\n}\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\n\n\nfunction parse_BOF(blob, length) {\n  var o = {\n    BIFFVer: 0,\n    dt: 0\n  };\n  o.BIFFVer = blob.read_shift(2);\n  length -= 2;\n\n  if (length >= 2) {\n    o.dt = blob.read_shift(2);\n    blob.l -= 2;\n  }\n\n  switch (o.BIFFVer) {\n    case 0x0600:\n    /* BIFF8 */\n\n    case 0x0500:\n    /* BIFF5 */\n\n    case 0x0400:\n    /* BIFF4 */\n\n    case 0x0300:\n    /* BIFF3 */\n\n    case 0x0200:\n    /* BIFF2 */\n\n    case 0x0002:\n    case 0x0007:\n      /* BIFF2 */\n      break;\n\n    default:\n      if (length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n  }\n\n  blob.read_shift(length);\n  return o;\n}\n/* [MS-XLS] 2.4.146 */\n\n\nfunction parse_InterfaceHdr(blob, length) {\n  if (length === 0) return 0x04b0;\n  if (blob.read_shift(2) !== 0x04b0) ;\n  return 0x04b0;\n}\n/* [MS-XLS] 2.4.349 */\n\n\nfunction parse_WriteAccess(blob, length, opts) {\n  if (opts.enc) {\n    blob.l += length;\n    return \"\";\n  }\n\n  var l = blob.l; // TODO: make sure XLUnicodeString doesnt overrun\n\n  var UserName = parse_XLUnicodeString2(blob, 0, opts);\n  blob.read_shift(length + l - blob.l);\n  return UserName;\n}\n/* [MS-XLS] 2.4.351 */\n\n\nfunction parse_WsBool(blob, length, opts) {\n  var flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n  return {\n    fDialog: flags & 0x10,\n    fBelow: flags & 0x40,\n    fRight: flags & 0x80\n  };\n}\n/* [MS-XLS] 2.4.28 */\n\n\nfunction parse_BoundSheet8(blob, length, opts) {\n  var pos = blob.read_shift(4);\n  var hidden = blob.read_shift(1) & 0x03;\n  var dt = blob.read_shift(1);\n\n  switch (dt) {\n    case 0:\n      dt = 'Worksheet';\n      break;\n\n    case 1:\n      dt = 'Macrosheet';\n      break;\n\n    case 2:\n      dt = 'Chartsheet';\n      break;\n\n    case 6:\n      dt = 'VBAModule';\n      break;\n  }\n\n  var name = parse_ShortXLUnicodeString(blob, 0, opts);\n  if (name.length === 0) name = \"Sheet1\";\n  return {\n    pos: pos,\n    hs: hidden,\n    dt: dt,\n    name: name\n  };\n}\n/* [MS-XLS] 2.4.265 TODO */\n\n\nfunction parse_SST(blob, length)\n/*:SST*/\n{\n  var end = blob.l + length;\n  var cnt = blob.read_shift(4);\n  var ucnt = blob.read_shift(4);\n  var strs\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n\n  for (var i = 0; i != ucnt && blob.l < end; ++i) {\n    strs.push(parse_XLUnicodeRichExtendedString(blob));\n  }\n\n  strs.Count = cnt;\n  strs.Unique = ucnt;\n  return strs;\n}\n/* [MS-XLS] 2.4.107 */\n\n\nfunction parse_ExtSST(blob, length) {\n  var extsst = {};\n  extsst.dsst = blob.read_shift(2);\n  blob.l += length - 2;\n  return extsst;\n}\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\n\n\nfunction parse_Row(blob) {\n  var z = {}\n  /*:any*/\n  ;\n  z.r = blob.read_shift(2);\n  z.c = blob.read_shift(2);\n  z.cnt = blob.read_shift(2) - z.c;\n  var miyRw = blob.read_shift(2);\n  blob.l += 4; // reserved(2), unused(2)\n\n  var flags = blob.read_shift(1); // various flags\n\n  blob.l += 3; // reserved(8), ixfe(12), flags(4)\n\n  if (flags & 0x07) z.level = flags & 0x07; // collapsed: flags & 0x10\n\n  if (flags & 0x20) z.hidden = true;\n  if (flags & 0x40) z.hpt = miyRw / 20;\n  return z;\n}\n/* [MS-XLS] 2.4.125 */\n\n\nfunction parse_ForceFullCalculation(blob) {\n  var header = parse_frtHeader(blob);\n  if (header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n  var fullcalc = blob.read_shift(4);\n  return fullcalc !== 0x0;\n}\n/* [MS-XLS] 2.4.215 rt */\n\n\nfunction parse_RecalcId(blob) {\n  blob.read_shift(2);\n  return blob.read_shift(4);\n}\n/* [MS-XLS] 2.4.87 */\n\n\nfunction parse_DefaultRowHeight(blob, length, opts) {\n  var f = 0;\n\n  if (!(opts && opts.biff == 2)) {\n    f = blob.read_shift(2);\n  }\n\n  var miyRw = blob.read_shift(2);\n\n  if (opts && opts.biff == 2) {\n    f = 1 - (miyRw >> 15);\n    miyRw &= 0x7fff;\n  }\n\n  var fl = {\n    Unsynced: f & 1,\n    DyZero: (f & 2) >> 1,\n    ExAsc: (f & 4) >> 2,\n    ExDsc: (f & 8) >> 3\n  };\n  return [fl, miyRw];\n}\n/* [MS-XLS] 2.4.345 TODO */\n\n\nfunction parse_Window1(blob) {\n  var xWn = blob.read_shift(2),\n      yWn = blob.read_shift(2),\n      dxWn = blob.read_shift(2),\n      dyWn = blob.read_shift(2);\n  var flags = blob.read_shift(2),\n      iTabCur = blob.read_shift(2),\n      iTabFirst = blob.read_shift(2);\n  var ctabSel = blob.read_shift(2),\n      wTabRatio = blob.read_shift(2);\n  return {\n    Pos: [xWn, yWn],\n    Dim: [dxWn, dyWn],\n    Flags: flags,\n    CurTab: iTabCur,\n    FirstTab: iTabFirst,\n    Selected: ctabSel,\n    TabRatio: wTabRatio\n  };\n}\n/* [MS-XLS] 2.4.346 TODO */\n\n\nfunction parse_Window2(blob, length, opts) {\n  if (opts && opts.biff >= 2 && opts.biff < 5) return {};\n  var f = blob.read_shift(2);\n  return {\n    RTL: f & 0x40\n  };\n}\n/* [MS-XLS] 2.4.189 TODO */\n\n\nfunction\n  /*blob, length, opts*/\nparse_Pane() {}\n/* [MS-XLS] 2.4.122 TODO */\n\n\nfunction parse_Font(blob, length, opts) {\n  var o\n  /*:any*/\n  = {\n    dyHeight: blob.read_shift(2),\n    fl: blob.read_shift(2)\n  };\n\n  switch (opts && opts.biff || 8) {\n    case 2:\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 2;\n      break;\n\n    default:\n      blob.l += 10;\n      break;\n  }\n\n  o.name = parse_ShortXLUnicodeString(blob, 0, opts);\n  return o;\n}\n/* [MS-XLS] 2.4.149 */\n\n\nfunction parse_LabelSst(blob) {\n  var cell = parse_XLSCell(blob);\n  cell.isst = blob.read_shift(4);\n  return cell;\n}\n/* [MS-XLS] 2.4.148 */\n\n\nfunction parse_Label(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n  var target = blob.l + length;\n  var cell = parse_XLSCell(blob);\n  if (opts.biff == 2) blob.l++;\n  var str = parse_XLUnicodeString(blob, target - blob.l, opts);\n  cell.val = str;\n  return cell;\n}\n/* [MS-XLS] 2.4.126 Number Formats */\n\n\nfunction parse_Format(blob, length, opts) {\n  var numFmtId = blob.read_shift(2);\n  var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n  return [numFmtId, fmtstr];\n}\n\nvar parse_BIFF2Format = parse_XLUnicodeString2;\n/* [MS-XLS] 2.4.90 */\n\nfunction parse_Dimensions(blob, length, opts) {\n  var end = blob.l + length;\n  var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n  var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n  var c = blob.read_shift(2),\n      C = blob.read_shift(2);\n  blob.l = end;\n  return {\n    s: {\n      r: r,\n      c: c\n    },\n    e: {\n      r: R,\n      c: C\n    }\n  };\n}\n/* [MS-XLS] 2.4.220 */\n\n\nfunction parse_RK(blob) {\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var rkrec = parse_RkRec(blob);\n  return {\n    r: rw,\n    c: col,\n    ixfe: rkrec[0],\n    rknum: rkrec[1]\n  };\n}\n/* [MS-XLS] 2.4.175 */\n\n\nfunction parse_MulRk(blob, length) {\n  var target = blob.l + length - 2;\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var rkrecs = [];\n\n  while (blob.l < target) {\n    rkrecs.push(parse_RkRec(blob));\n  }\n\n  if (blob.l !== target) throw new Error(\"MulRK read error\");\n  var lastcol = blob.read_shift(2);\n  if (rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n  return {\n    r: rw,\n    c: col,\n    C: lastcol,\n    rkrec: rkrecs\n  };\n}\n/* [MS-XLS] 2.4.174 */\n\n\nfunction parse_MulBlank(blob, length) {\n  var target = blob.l + length - 2;\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var ixfes = [];\n\n  while (blob.l < target) {\n    ixfes.push(blob.read_shift(2));\n  }\n\n  if (blob.l !== target) throw new Error(\"MulBlank read error\");\n  var lastcol = blob.read_shift(2);\n  if (ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n  return {\n    r: rw,\n    c: col,\n    C: lastcol,\n    ixfe: ixfes\n  };\n}\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\n\n\nfunction parse_CellStyleXF(blob, length, style, opts) {\n  var o = {};\n  var a = blob.read_shift(4),\n      b = blob.read_shift(4);\n  var c = blob.read_shift(4),\n      d = blob.read_shift(2);\n  o.patternType = XLSFillPattern[c >> 26];\n  if (!opts.cellStyles) return o;\n  o.alc = a & 0x07;\n  o.fWrap = a >> 3 & 0x01;\n  o.alcV = a >> 4 & 0x07;\n  o.fJustLast = a >> 7 & 0x01;\n  o.trot = a >> 8 & 0xFF;\n  o.cIndent = a >> 16 & 0x0F;\n  o.fShrinkToFit = a >> 20 & 0x01;\n  o.iReadOrder = a >> 22 & 0x02;\n  o.fAtrNum = a >> 26 & 0x01;\n  o.fAtrFnt = a >> 27 & 0x01;\n  o.fAtrAlc = a >> 28 & 0x01;\n  o.fAtrBdr = a >> 29 & 0x01;\n  o.fAtrPat = a >> 30 & 0x01;\n  o.fAtrProt = a >> 31 & 0x01;\n  o.dgLeft = b & 0x0F;\n  o.dgRight = b >> 4 & 0x0F;\n  o.dgTop = b >> 8 & 0x0F;\n  o.dgBottom = b >> 12 & 0x0F;\n  o.icvLeft = b >> 16 & 0x7F;\n  o.icvRight = b >> 23 & 0x7F;\n  o.grbitDiag = b >> 30 & 0x03;\n  o.icvTop = c & 0x7F;\n  o.icvBottom = c >> 7 & 0x7F;\n  o.icvDiag = c >> 14 & 0x7F;\n  o.dgDiag = c >> 21 & 0x0F;\n  o.icvFore = d & 0x7F;\n  o.icvBack = d >> 7 & 0x7F;\n  o.fsxButton = d >> 14 & 0x01;\n  return o;\n} //function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\n\n\nfunction parse_XF(blob, length, opts) {\n  var o = {};\n  o.ifnt = blob.read_shift(2);\n  o.numFmtId = blob.read_shift(2);\n  o.flags = blob.read_shift(2);\n  o.fStyle = o.flags >> 2 & 0x01;\n  length -= 6;\n  o.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n  return o;\n}\n/* [MS-XLS] 2.4.134 */\n\n\nfunction parse_Guts(blob) {\n  blob.l += 4;\n  var out = [blob.read_shift(2), blob.read_shift(2)];\n  if (out[0] !== 0) out[0]--;\n  if (out[1] !== 0) out[1]--;\n  if (out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n  return out;\n}\n/* [MS-XLS] 2.4.24 */\n\n\nfunction parse_BoolErr(blob, length, opts) {\n  var cell = parse_XLSCell(blob);\n  if (opts.biff == 2 || length == 9) ++blob.l;\n  var val = parse_Bes(blob);\n  cell.val = val;\n  cell.t = val === true || val === false ? 'b' : 'e';\n  return cell;\n}\n/* [MS-XLS] 2.4.180 Number */\n\n\nfunction parse_Number(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n  var cell = parse_XLSCell(blob);\n  var xnum = parse_Xnum(blob);\n  cell.val = xnum;\n  return cell;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\n\nfunction parse_SupBook(blob, length, opts) {\n  var end = blob.l + length;\n  var ctab = blob.read_shift(2);\n  var cch = blob.read_shift(2);\n  opts.sbcch = cch;\n  if (cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n  if (cch < 0x01 || cch > 0xff) throw new Error(\"Unexpected SupBook type: \" + cch);\n  var virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n  /* TODO: 2.5.277 Virtual Path */\n\n  var rgst = [];\n\n  while (end > blob.l) {\n    rgst.push(parse_XLUnicodeString(blob));\n  }\n\n  return [cch, ctab, virtPath, rgst];\n}\n/* [MS-XLS] 2.4.105 TODO */\n\n\nfunction parse_ExternName(blob, length, opts) {\n  var flags = blob.read_shift(2);\n  var body;\n  var o = {\n    fBuiltIn: flags & 0x01,\n    fWantAdvise: flags >>> 1 & 0x01,\n    fWantPict: flags >>> 2 & 0x01,\n    fOle: flags >>> 3 & 0x01,\n    fOleLink: flags >>> 4 & 0x01,\n    cf: flags >>> 5 & 0x3FF,\n    fIcon: flags >>> 15 & 0x01\n  }\n  /*:any*/\n  ;\n  if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2, opts); //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\n  o.body = body || blob.read_shift(length - 2);\n  if (typeof body === \"string\") o.Name = body;\n  return o;\n}\n/* [MS-XLS] 2.4.150 TODO */\n\n\nvar XLSLblBuiltIn = [\"_xlnm.Consolidate_Area\", \"_xlnm.Auto_Open\", \"_xlnm.Auto_Close\", \"_xlnm.Extract\", \"_xlnm.Database\", \"_xlnm.Criteria\", \"_xlnm.Print_Area\", \"_xlnm.Print_Titles\", \"_xlnm.Recorder\", \"_xlnm.Data_Form\", \"_xlnm.Auto_Activate\", \"_xlnm.Auto_Deactivate\", \"_xlnm.Sheet_Title\", \"_xlnm._FilterDatabase\"];\n\nfunction parse_Lbl(blob, length, opts) {\n  var target = blob.l + length;\n  var flags = blob.read_shift(2);\n  var chKey = blob.read_shift(1);\n  var cch = blob.read_shift(1);\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  var itab = 0;\n\n  if (!opts || opts.biff >= 5) {\n    if (opts.biff != 5) blob.l += 2;\n    itab = blob.read_shift(2);\n    if (opts.biff == 5) blob.l += 2;\n    blob.l += 4;\n  }\n\n  var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n  if (flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n  var npflen = target - blob.l;\n  if (opts && opts.biff == 2) --npflen;\n  /*jshint -W018 */\n\n  var rgce = target == blob.l || cce === 0 || !(npflen > 0) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n  /*jshint +W018 */\n\n  return {\n    chKey: chKey,\n    Name: name,\n    itab: itab,\n    rgce: rgce\n  };\n}\n/* [MS-XLS] 2.4.106 TODO: verify filename encoding */\n\n\nfunction parse_ExternSheet(blob, length, opts) {\n  if (opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n  var o = [],\n      target = blob.l + length,\n      len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\n  while (len-- !== 0) {\n    o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n  } // [iSupBook, itabFirst, itabLast];\n\n\n  if (blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n  return o;\n}\n\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n  if (blob[blob.l + 1] == 0x03) blob[blob.l]++;\n  var o = parse_ShortXLUnicodeString(blob, length, opts);\n  return o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n/* [MS-XLS] 2.4.176 TODO: check older biff */\n\n\nfunction parse_NameCmt(blob, length, opts) {\n  if (opts.biff < 8) {\n    blob.l += length;\n    return;\n  }\n\n  var cchName = blob.read_shift(2);\n  var cchComment = blob.read_shift(2);\n  var name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n  var comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n  return [name, comment];\n}\n/* [MS-XLS] 2.4.260 */\n\n\nfunction parse_ShrFmla(blob, length, opts) {\n  var ref = parse_RefU(blob);\n  blob.l++;\n  var cUse = blob.read_shift(1);\n  length -= 8;\n  return [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n/* [MS-XLS] 2.4.4 TODO */\n\n\nfunction parse_Array(blob, length, opts) {\n  var ref = parse_Ref(blob);\n  /* TODO: fAlwaysCalc */\n\n  switch (opts.biff) {\n    case 2:\n      blob.l++;\n      length -= 7;\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 2;\n      length -= 8;\n      break;\n\n    default:\n      blob.l += 6;\n      length -= 12;\n  }\n\n  return [ref, parse_ArrayParsedFormula(blob, length, opts)];\n}\n/* [MS-XLS] 2.4.173 */\n\n\nfunction parse_MTRSettings(blob) {\n  var fMTREnabled = blob.read_shift(4) !== 0x00;\n  var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n  var cUserThreadCount = blob.read_shift(4);\n  return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n/* [MS-XLS] 2.5.186 TODO: BIFF5 */\n\n\nfunction parse_NoteSh(blob, length, opts) {\n  if (opts.biff < 8) return;\n  var row = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var flags = blob.read_shift(2),\n      idObj = blob.read_shift(2);\n  var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n  if (opts.biff < 8) blob.read_shift(1);\n  return [{\n    r: row,\n    c: col\n  }, stAuthor, idObj, flags];\n}\n/* [MS-XLS] 2.4.179 */\n\n\nfunction parse_Note(blob, length, opts) {\n  /* TODO: Support revisions */\n  return parse_NoteSh(blob, length, opts);\n}\n/* [MS-XLS] 2.4.168 */\n\n\nfunction parse_MergeCells(blob, length)\n/*:Array<Range>*/\n{\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var cmcs = blob.read_shift(2);\n\n  while (cmcs--) {\n    merges.push(parse_Ref8U(blob));\n  }\n\n  return merges;\n}\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\n\n\nfunction parse_Obj(blob, length, opts) {\n  if (opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n  var cmo = parse_FtCmo(blob); // id, ot, flags\n\n  var fts = parse_FtArray(blob, length - 22, cmo[1]);\n  return {\n    cmo: cmo,\n    ft: fts\n  };\n}\n/* from older spec */\n\n\nvar parse_BIFF5OT = {\n  0x08: function _(blob, length) {\n    var tgt = blob.l + length;\n    blob.l += 10; // todo\n\n    var cf = blob.read_shift(2);\n    blob.l += 4;\n    blob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\n    blob.l += 2;\n    blob.l += 2; //var grbit = blob.read_shift(2);\n\n    blob.l += 4;\n    var cchName = blob.read_shift(1);\n    blob.l += cchName; // TODO: stName\n\n    blob.l = tgt; // TODO: fmla\n\n    return {\n      fmt: cf\n    };\n  }\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n  blob.l += 4; //var cnt = blob.read_shift(4);\n\n  var ot = blob.read_shift(2);\n  var id = blob.read_shift(2);\n  var grbit = blob.read_shift(2);\n  blob.l += 2; //var colL = blob.read_shift(2);\n\n  blob.l += 2; //var dxL = blob.read_shift(2);\n\n  blob.l += 2; //var rwT = blob.read_shift(2);\n\n  blob.l += 2; //var dyT = blob.read_shift(2);\n\n  blob.l += 2; //var colR = blob.read_shift(2);\n\n  blob.l += 2; //var dxR = blob.read_shift(2);\n\n  blob.l += 2; //var rwB = blob.read_shift(2);\n\n  blob.l += 2; //var dyB = blob.read_shift(2);\n\n  blob.l += 2; //var cbMacro = blob.read_shift(2);\n\n  blob.l += 6;\n  length -= 36;\n  var fts = [];\n  fts.push((parse_BIFF5OT[ot] || parsenoop)(blob, length, opts));\n  return {\n    cmo: [id, ot, grbit],\n    ft: fts\n  };\n}\n/* [MS-XLS] 2.4.329 TODO: parse properly */\n\n\nfunction parse_TxO(blob, length, opts) {\n  var s = blob.l;\n  var texts = \"\";\n\n  try {\n    blob.l += 4;\n    var ot = (opts.lastobj || {\n      cmo: [0, 0]\n    }).cmo[1];\n    var controlInfo; // eslint-disable-line no-unused-vars\n\n    if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\n    var cchText = blob.read_shift(2);\n    /*var cbRuns = */\n\n    blob.read_shift(2);\n    /*var ifntEmpty = */\n\n    parseuint16(blob, 2);\n    var len = blob.read_shift(2);\n    blob.l += len; //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n    for (var i = 1; i < blob.lens.length - 1; ++i) {\n      if (blob.l - s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n      var hdr = blob[blob.l];\n      var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n      texts += t;\n      if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n    }\n\n    if (texts.length !== cchText && texts.length !== cchText * 2) {\n      throw new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n    }\n\n    blob.l = s + length;\n    /* [MS-XLS] 2.5.272 TxORuns */\n    //\tvar rgTxoRuns = [];\n    //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n    //\tvar cchText2 = blob.read_shift(2);\n    //\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n    //\tblob.l += 6;\n    //\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\n    return {\n      t: texts\n    };\n  } catch (e) {\n    blob.l = s + length;\n    return {\n      t: texts\n    };\n  }\n}\n/* [MS-XLS] 2.4.140 */\n\n\nfunction parse_HLink(blob, length) {\n  var ref = parse_Ref8U(blob);\n  blob.l += 16;\n  /* CLSID */\n\n  var hlink = parse_Hyperlink(blob, length - 24);\n  return [ref, hlink];\n}\n/* [MS-XLS] 2.4.141 */\n\n\nfunction parse_HLinkTooltip(blob, length) {\n  blob.read_shift(2);\n  var ref = parse_Ref8U(blob);\n  var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n  wzTooltip = wzTooltip.replace(chr0, \"\");\n  return [ref, wzTooltip];\n}\n/* [MS-XLS] 2.4.63 */\n\n\nfunction parse_Country(blob)\n/*:[string|number, string|number]*/\n{\n  var o = [0, 0],\n      d;\n  d = blob.read_shift(2);\n  o[0] = CountryEnum[d] || d;\n  d = blob.read_shift(2);\n  o[1] = CountryEnum[d] || d;\n  return o;\n}\n/* [MS-XLS] 2.4.50 ClrtClient */\n\n\nfunction parse_ClrtClient(blob) {\n  var ccv = blob.read_shift(2);\n  var o = [];\n\n  while (ccv-- > 0) {\n    o.push(parse_LongRGB(blob));\n  }\n\n  return o;\n}\n/* [MS-XLS] 2.4.188 */\n\n\nfunction parse_Palette(blob) {\n  var ccv = blob.read_shift(2);\n  var o = [];\n\n  while (ccv-- > 0) {\n    o.push(parse_LongRGB(blob));\n  }\n\n  return o;\n}\n/* [MS-XLS] 2.4.354 */\n\n\nfunction parse_XFCRC(blob) {\n  blob.l += 2;\n  var o = {\n    cxfs: 0,\n    crc: 0\n  };\n  o.cxfs = blob.read_shift(2);\n  o.crc = blob.read_shift(4);\n  return o;\n}\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\n\n\nfunction parse_ColInfo(blob, length, opts) {\n  if (!opts.cellStyles) return parsenoop(blob, length);\n  var w = opts && opts.biff >= 12 ? 4 : 2;\n  var colFirst = blob.read_shift(w);\n  var colLast = blob.read_shift(w);\n  var coldx = blob.read_shift(w);\n  var ixfe = blob.read_shift(w);\n  var flags = blob.read_shift(2);\n  if (w == 2) blob.l += 2;\n  var o = {\n    s: colFirst,\n    e: colLast,\n    w: coldx,\n    ixfe: ixfe,\n    flags: flags\n  }\n  /*:any*/\n  ;\n  if (opts.biff >= 5 || !opts.biff) o.level = flags >> 8 & 0x7;\n  return o;\n}\n/* [MS-XLS] 2.4.257 */\n\n\nfunction parse_Setup(blob, length) {\n  var o = {};\n  if (length < 32) return o;\n  blob.l += 16;\n  o.header = parse_Xnum(blob);\n  o.footer = parse_Xnum(blob);\n  blob.l += 2;\n  return o;\n}\n/* [MS-XLS] 2.4.261 */\n\n\nfunction parse_ShtProps(blob, length, opts) {\n  var def = {\n    area: false\n  };\n\n  if (opts.biff != 5) {\n    blob.l += length;\n    return def;\n  }\n\n  var d = blob.read_shift(1);\n  blob.l += 3;\n  if (d & 0x10) def.area = true;\n  return def;\n}\n\nvar parse_Blank = parse_XLSCell;\n/* [MS-XLS] 2.4.20 Just the cell */\n\nvar parse_Scl = parseuint16a;\n/* [MS-XLS] 2.4.247 num, den */\n\nvar parse_String = parse_XLUnicodeString;\n/* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\n\nfunction parse_ImData(blob) {\n  var cf = blob.read_shift(2);\n  var env = blob.read_shift(2);\n  var lcb = blob.read_shift(4);\n  var o = {\n    fmt: cf,\n    env: env,\n    len: lcb,\n    data: blob.slice(blob.l, blob.l + lcb)\n  };\n  blob.l += lcb;\n  return o;\n}\n/* BIFF2_??? where ??? is the name from [XLS] */\n\n\nfunction parse_BIFF2STR(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 5) opts.biff = 2;\n  var cell = parse_XLSCell(blob);\n  ++blob.l;\n  var str = parse_XLUnicodeString2(blob, length - 7, opts);\n  cell.t = 'str';\n  cell.val = str;\n  return cell;\n}\n\nfunction parse_BIFF2NUM(blob\n/*::, length*/\n) {\n  var cell = parse_XLSCell(blob);\n  ++blob.l;\n  var num = parse_Xnum(blob);\n  cell.t = 'n';\n  cell.val = num;\n  return cell;\n}\n\nfunction parse_BIFF2INT(blob) {\n  var cell = parse_XLSCell(blob);\n  ++blob.l;\n  var num = blob.read_shift(2);\n  cell.t = 'n';\n  cell.val = num;\n  return cell;\n}\n\nfunction parse_BIFF2STRING(blob) {\n  var cch = blob.read_shift(1);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return blob.read_shift(cch, 'sbcs-cont');\n}\n/* TODO: convert to BIFF8 font struct */\n\n\nfunction parse_BIFF2FONTXTRA(blob, length) {\n  blob.l += 6; // unknown\n\n  blob.l += 2; // font weight \"bls\"\n\n  blob.l += 1; // charset\n\n  blob.l += 3; // unknown\n\n  blob.l += 1; // font family\n\n  blob.l += length - 13;\n}\n/* TODO: parse rich text runs */\n\n\nfunction parse_RString(blob, length, opts) {\n  var end = blob.l + length;\n  var cell = parse_XLSCell(blob);\n  var cch = blob.read_shift(2);\n  var str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n  blob.l = end;\n  cell.t = 'str';\n  cell.val = str;\n  return cell;\n}\n/* from js-harb (C) 2014-present  SheetJS */\n\n\nvar DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\n\nvar DBF = /*#__PURE__*/function () {\n  var dbf_codepage_map = {\n    /* Code Pages Supported by Visual FoxPro */\n\n    /*::[*/\n    0x01\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x02\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x03\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x04\n    /*::]*/\n    : 10000,\n\n    /*::[*/\n    0x64\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x65\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x66\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x67\n    /*::]*/\n    : 861,\n\n    /*::[*/\n    0x68\n    /*::]*/\n    : 895,\n\n    /*::[*/\n    0x69\n    /*::]*/\n    : 620,\n\n    /*::[*/\n    0x6A\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x6B\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0x78\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x79\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x7A\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x7B\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x7D\n    /*::]*/\n    : 1255,\n\n    /*::[*/\n    0x7E\n    /*::]*/\n    : 1256,\n\n    /*::[*/\n    0x96\n    /*::]*/\n    : 10007,\n\n    /*::[*/\n    0x97\n    /*::]*/\n    : 10029,\n\n    /*::[*/\n    0x98\n    /*::]*/\n    : 10006,\n\n    /*::[*/\n    0xC8\n    /*::]*/\n    : 1250,\n\n    /*::[*/\n    0xC9\n    /*::]*/\n    : 1251,\n\n    /*::[*/\n    0xCA\n    /*::]*/\n    : 1254,\n\n    /*::[*/\n    0xCB\n    /*::]*/\n    : 1253,\n\n    /* shapefile DBF extension */\n\n    /*::[*/\n    0x00\n    /*::]*/\n    : 20127,\n\n    /*::[*/\n    0x08\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0A\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x0B\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0D\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0E\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x0F\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x10\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x11\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x12\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x13\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x14\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x15\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x16\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x17\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x18\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x19\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x1A\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x1B\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x1C\n    /*::]*/\n    : 863,\n\n    /*::[*/\n    0x1D\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x1F\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x22\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x23\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x24\n    /*::]*/\n    : 860,\n\n    /*::[*/\n    0x25\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x26\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x37\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x40\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x4D\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x4E\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x4F\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x50\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x57\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x58\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x59\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x6C\n    /*::]*/\n    : 863,\n\n    /*::[*/\n    0x86\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x87\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x88\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0xCC\n    /*::]*/\n    : 1257,\n\n    /*::[*/\n    0xFF\n    /*::]*/\n    : 16969\n  };\n  var dbf_reverse_map = evert({\n    /*::[*/\n    0x01\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x02\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x03\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x04\n    /*::]*/\n    : 10000,\n\n    /*::[*/\n    0x64\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x65\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x66\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x67\n    /*::]*/\n    : 861,\n\n    /*::[*/\n    0x68\n    /*::]*/\n    : 895,\n\n    /*::[*/\n    0x69\n    /*::]*/\n    : 620,\n\n    /*::[*/\n    0x6A\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x6B\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0x78\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x79\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x7A\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x7B\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x7D\n    /*::]*/\n    : 1255,\n\n    /*::[*/\n    0x7E\n    /*::]*/\n    : 1256,\n\n    /*::[*/\n    0x96\n    /*::]*/\n    : 10007,\n\n    /*::[*/\n    0x97\n    /*::]*/\n    : 10029,\n\n    /*::[*/\n    0x98\n    /*::]*/\n    : 10006,\n\n    /*::[*/\n    0xC8\n    /*::]*/\n    : 1250,\n\n    /*::[*/\n    0xC9\n    /*::]*/\n    : 1251,\n\n    /*::[*/\n    0xCA\n    /*::]*/\n    : 1254,\n\n    /*::[*/\n    0xCB\n    /*::]*/\n    : 1253,\n\n    /*::[*/\n    0x00\n    /*::]*/\n    : 20127\n  });\n  /* TODO: find an actual specification */\n\n  function dbf_to_aoa(buf, opts)\n  /*:AOA*/\n  {\n    var out\n    /*:AOA*/\n    = [];\n    var d\n    /*:Block*/\n    = new_raw_buf(1)\n    /*:any*/\n    ;\n\n    switch (opts.type) {\n      case 'base64':\n        d = s2a(Base64_decode(buf));\n        break;\n\n      case 'binary':\n        d = s2a(buf);\n        break;\n\n      case 'buffer':\n      case 'array':\n        d = buf;\n        break;\n    }\n\n    prep_blob(d, 0);\n    /* header */\n\n    var ft = d.read_shift(1);\n    var memo = !!(ft & 0x88);\n    var vfp = false,\n        l7 = false;\n\n    switch (ft) {\n      case 0x02:\n        break;\n      // dBASE II\n\n      case 0x03:\n        break;\n      // dBASE III\n\n      case 0x30:\n        vfp = true;\n        memo = true;\n        break;\n      // VFP\n\n      case 0x31:\n        vfp = true;\n        memo = true;\n        break;\n      // VFP with autoincrement\n      // 0x43 dBASE IV SQL table files\n      // 0x63 dBASE IV SQL system files\n\n      case 0x83:\n        break;\n      // dBASE III with memo\n\n      case 0x8B:\n        break;\n      // dBASE IV with memo\n\n      case 0x8C:\n        l7 = true;\n        break;\n      // dBASE Level 7 with memo\n      // case 0xCB dBASE IV SQL table files with memo\n\n      case 0xF5:\n        break;\n      // FoxPro 2.x with memo\n      // case 0xFB FoxBASE\n\n      default:\n        throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n    }\n\n    var nrow = 0,\n        fpos = 0x0209;\n    if (ft == 0x02) nrow = d.read_shift(2);\n    d.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\n    if (ft != 0x02) nrow = d.read_shift(4);\n    if (nrow > 1048576) nrow = 1e6;\n    if (ft != 0x02) fpos = d.read_shift(2); // header length\n\n    var rlen = d.read_shift(2); // record length\n\n    var\n    /*flags = 0,*/\n    current_cp = opts.codepage || 1252;\n\n    if (ft != 0x02) {\n      // 20 reserved bytes\n      d.l += 16;\n      /*flags = */\n\n      d.read_shift(1); //if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n      /* codepage present in FoxPro and dBASE Level 7 */\n\n      if (d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n      d.l += 1;\n      d.l += 2;\n    }\n\n    if (l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\n    /*:: type DBFField = { name:string; len:number; type:string; } */\n\n    var fields\n    /*:Array<DBFField>*/\n    = [],\n        field\n    /*:DBFField*/\n    = {}\n    /*:any*/\n    ;\n    var hend = Math.min(d.length, ft == 0x02 ? 0x209 : fpos - 10 - (vfp ? 264 : 0));\n    var ww = l7 ? 32 : 11;\n\n    while (d.l < hend && d[d.l] != 0x0d) {\n      field = {}\n      /*:any*/\n      ;\n      field.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l + ww)).replace(/[\\u0000\\r\\n].*$/g, \"\");\n      d.l += ww;\n      field.type = String.fromCharCode(d.read_shift(1));\n      if (ft != 0x02 && !l7) field.offset = d.read_shift(4);\n      field.len = d.read_shift(1);\n      if (ft == 0x02) field.offset = d.read_shift(2);\n      field.dec = d.read_shift(1);\n      if (field.name.length) fields.push(field);\n      if (ft != 0x02) d.l += l7 ? 13 : 14;\n\n      switch (field.type) {\n        case 'B':\n          // Double (VFP) / Binary (dBASE L7)\n          if ((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n          break;\n\n        case 'G': // General (FoxPro and dBASE L7)\n\n        case 'P':\n          // Picture (FoxPro and dBASE L7)\n          if (opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n          break;\n\n        case '+': // Autoincrement (dBASE L7 only)\n\n        case '0': // _NullFlags (VFP only)\n\n        case '@': // Timestamp (dBASE L7 only)\n\n        case 'C': // Character (dBASE II)\n\n        case 'D': // Date (dBASE III)\n\n        case 'F': // Float (dBASE IV)\n\n        case 'I': // Long (VFP and dBASE L7)\n\n        case 'L': // Logical (dBASE II)\n\n        case 'M': // Memo (dBASE III)\n\n        case 'N': // Number (dBASE II)\n\n        case 'O': // Double (dBASE L7 only)\n\n        case 'T': // Datetime (VFP only)\n\n        case 'Y':\n          // Currency (VFP only)\n          break;\n\n        default:\n          throw new Error('Unknown Field Type: ' + field.type);\n      }\n    }\n\n    if (d[d.l] !== 0x0D) d.l = fpos - 1;\n    if (d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n    d.l = fpos;\n    /* data */\n\n    var R = 0,\n        C = 0;\n    out[0] = [];\n\n    for (C = 0; C != fields.length; ++C) {\n      out[0][C] = fields[C].name;\n    }\n\n    while (nrow-- > 0) {\n      if (d[d.l] === 0x2A) {\n        // TODO: record marked as deleted -- create a hidden row?\n        d.l += rlen;\n        continue;\n      }\n\n      ++d.l;\n      out[++R] = [];\n      C = 0;\n\n      for (C = 0; C != fields.length; ++C) {\n        var dd = d.slice(d.l, d.l + fields[C].len);\n        d.l += fields[C].len;\n        prep_blob(dd, 0);\n        var s = $cptable.utils.decode(current_cp, dd);\n\n        switch (fields[C].type) {\n          case 'C':\n            // NOTE: it is conventional to write '  /  /  ' for empty dates\n            if (s.trim().length) out[R][C] = s.replace(/\\s+$/, \"\");\n            break;\n\n          case 'D':\n            if (s.length === 8) out[R][C] = new Date(+s.slice(0, 4), +s.slice(4, 6) - 1, +s.slice(6, 8));else out[R][C] = s;\n            break;\n\n          case 'F':\n            out[R][C] = parseFloat(s.trim());\n            break;\n\n          case '+':\n          case 'I':\n            out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i');\n            break;\n\n          case 'L':\n            switch (s.trim().toUpperCase()) {\n              case 'Y':\n              case 'T':\n                out[R][C] = true;\n                break;\n\n              case 'N':\n              case 'F':\n                out[R][C] = false;\n                break;\n\n              case '':\n              case '?':\n                break;\n\n              default:\n                throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n            }\n\n            break;\n\n          case 'M':\n            /* TODO: handle memo files */\n            if (!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n            out[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10) : dd.read_shift(4));\n            break;\n\n          case 'N':\n            s = s.replace(/\\u0000/g, \"\").trim(); // NOTE: dBASE II interprets \"  .  \" as 0\n\n            if (s && s != \".\") out[R][C] = +s || 0;\n            break;\n\n          case '@':\n            // NOTE: dBASE specs appear to be incorrect\n            out[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n            break;\n\n          case 'T':\n            out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4));\n            break;\n\n          case 'Y':\n            out[R][C] = dd.read_shift(4, 'i') / 1e4 + dd.read_shift(4, 'i') / 1e4 * Math.pow(2, 32);\n            break;\n\n          case 'O':\n            out[R][C] = -dd.read_shift(-8, 'f');\n            break;\n\n          case 'B':\n            if (vfp && fields[C].len == 8) {\n              out[R][C] = dd.read_shift(8, 'f');\n              break;\n            }\n\n          /* falls through */\n\n          case 'G':\n          case 'P':\n            dd.l += fields[C].len;\n            break;\n\n          case '0':\n            if (fields[C].name === '_NullFlags') break;\n\n          /* falls through */\n\n          default:\n            throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n        }\n      }\n    }\n\n    if (ft != 0x02) if (d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l - 1) + \" of \" + d.length + \" \" + d[d.l - 1].toString(16));\n    if (opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n    opts.DBF = fields;\n    return out;\n  }\n\n  function dbf_to_sheet(buf, opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    if (!o.dateNF) o.dateNF = \"yyyymmdd\";\n    var ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n    ws[\"!cols\"] = o.DBF.map(function (field) {\n      return {\n        wch: field.len,\n        DBF: field\n      };\n    });\n    delete o.DBF;\n    return ws;\n  }\n\n  function dbf_to_workbook(buf, opts)\n  /*:Workbook*/\n  {\n    try {\n      return sheet_to_workbook(dbf_to_sheet(buf, opts), opts);\n    } catch (e) {\n      if (opts && opts.WTF) throw e;\n    }\n\n    return {\n      SheetNames: [],\n      Sheets: {}\n    };\n  }\n\n  var _RLEN = {\n    'B': 8,\n    'C': 250,\n    'L': 1,\n    'D': 8,\n    '?': 0,\n    '': 0\n  };\n\n  function sheet_to_dbf(ws\n  /*:Worksheet*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n    var ba = buf_array();\n    var aoa\n    /*:AOA*/\n    = sheet_to_json(ws, {\n      header: 1,\n      raw: true,\n      cellDates: true\n    });\n    var headers = aoa[0],\n        data = aoa.slice(1),\n        cols = ws[\"!cols\"] || [];\n    var i = 0,\n        j = 0,\n        hcnt = 0,\n        rlen = 1;\n\n    for (i = 0; i < headers.length; ++i) {\n      if (((cols[i] || {}).DBF || {}).name) {\n        headers[i] = cols[i].DBF.name;\n        ++hcnt;\n        continue;\n      }\n\n      if (headers[i] == null) continue;\n      ++hcnt;\n      if (typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n      if (typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + typeof headers[i] + \"|\");\n      if (headers.indexOf(headers[i]) !== i) for (j = 0; j < 1024; ++j) {\n        if (headers.indexOf(headers[i] + \"_\" + j) == -1) {\n          headers[i] += \"_\" + j;\n          break;\n        }\n      }\n    }\n\n    var range = safe_decode_range(ws['!ref']);\n    var coltypes\n    /*:Array<string>*/\n    = [];\n    var colwidths\n    /*:Array<number>*/\n    = [];\n    var coldecimals\n    /*:Array<number>*/\n    = [];\n\n    for (i = 0; i <= range.e.c - range.s.c; ++i) {\n      var guess = '',\n          _guess = '',\n          maxlen = 0;\n      var col\n      /*:Array<any>*/\n      = [];\n\n      for (j = 0; j < data.length; ++j) {\n        if (data[j][i] != null) col.push(data[j][i]);\n      }\n\n      if (col.length == 0 || headers[i] == null) {\n        coltypes[i] = '?';\n        continue;\n      }\n\n      for (j = 0; j < col.length; ++j) {\n        switch (typeof col[j]) {\n          /* TODO: check if L2 compat is desired */\n          case 'number':\n            _guess = 'B';\n            break;\n\n          case 'string':\n            _guess = 'C';\n            break;\n\n          case 'boolean':\n            _guess = 'L';\n            break;\n\n          case 'object':\n            _guess = col[j] instanceof Date ? 'D' : 'C';\n            break;\n\n          default:\n            _guess = 'C';\n        }\n\n        maxlen = Math.max(maxlen, String(col[j]).length);\n        guess = guess && guess != _guess ? 'C' : _guess; //if(guess == 'C') break;\n      }\n\n      if (maxlen > 250) maxlen = 250;\n      _guess = ((cols[i] || {}).DBF || {}).type;\n      /* TODO: more fine grained control over DBF type resolution */\n\n      if (_guess == 'C') {\n        if (cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n      }\n\n      if (guess == 'B' && _guess == 'N') {\n        guess = 'N';\n        coldecimals[i] = cols[i].DBF.dec;\n        maxlen = cols[i].DBF.len;\n      }\n\n      colwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : _RLEN[guess] || 0;\n      rlen += colwidths[i];\n      coltypes[i] = guess;\n    }\n\n    var h = ba.next(32);\n    h.write_shift(4, 0x13021130);\n    h.write_shift(4, data.length);\n    h.write_shift(2, 296 + 32 * hcnt);\n    h.write_shift(2, rlen);\n\n    for (i = 0; i < 4; ++i) {\n      h.write_shift(4, 0);\n    }\n\n    h.write_shift(4, 0x00000000 | (+dbf_reverse_map[\n    /*::String(*/\n    current_ansi\n    /*::)*/\n    ] || 0x03) << 8);\n\n    for (i = 0, j = 0; i < headers.length; ++i) {\n      if (headers[i] == null) continue;\n      var hf = ba.next(32);\n\n      var _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\n      hf.write_shift(1, _f, \"sbcs\");\n      hf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n      hf.write_shift(4, j);\n      hf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n      hf.write_shift(1, coldecimals[i] || 0);\n      hf.write_shift(1, 0x02);\n      hf.write_shift(4, 0);\n      hf.write_shift(1, 0);\n      hf.write_shift(4, 0);\n      hf.write_shift(4, 0);\n      j += colwidths[i] || _RLEN[coltypes[i]] || 0;\n    }\n\n    var hb = ba.next(264);\n    hb.write_shift(4, 0x0000000D);\n\n    for (i = 0; i < 65; ++i) {\n      hb.write_shift(4, 0x00000000);\n    }\n\n    for (i = 0; i < data.length; ++i) {\n      var rout = ba.next(rlen);\n      rout.write_shift(1, 0);\n\n      for (j = 0; j < headers.length; ++j) {\n        if (headers[j] == null) continue;\n\n        switch (coltypes[j]) {\n          case 'L':\n            rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46);\n            break;\n\n          case 'B':\n            rout.write_shift(8, data[i][j] || 0, 'f');\n            break;\n\n          case 'N':\n            var _n = \"0\";\n            if (typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j] || 0);\n\n            for (hcnt = 0; hcnt < colwidths[j] - _n.length; ++hcnt) {\n              rout.write_shift(1, 0x20);\n            }\n\n            rout.write_shift(1, _n, \"sbcs\");\n            break;\n\n          case 'D':\n            if (!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");else {\n              rout.write_shift(4, (\"0000\" + data[i][j].getFullYear()).slice(-4), \"sbcs\");\n              rout.write_shift(2, (\"00\" + (data[i][j].getMonth() + 1)).slice(-2), \"sbcs\");\n              rout.write_shift(2, (\"00\" + data[i][j].getDate()).slice(-2), \"sbcs\");\n            }\n            break;\n\n          case 'C':\n            var _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\n            rout.write_shift(1, _s, \"sbcs\");\n\n            for (hcnt = 0; hcnt < colwidths[j] - _s.length; ++hcnt) {\n              rout.write_shift(1, 0x20);\n            }\n\n            break;\n        }\n      } // data\n\n    }\n\n    ba.next(1).write_shift(1, 0x1A);\n    return ba.end();\n  }\n\n  return {\n    to_workbook: dbf_to_workbook,\n    to_sheet: dbf_to_sheet,\n    from_sheet: sheet_to_dbf\n  };\n}();\n\nvar SYLK = /*#__PURE__*/function () {\n  /* TODO: stress test sequences */\n  var sylk_escapes = {\n    AA: 'À',\n    BA: 'Á',\n    CA: 'Â',\n    DA: 195,\n    HA: 'Ä',\n    JA: 197,\n    AE: 'È',\n    BE: 'É',\n    CE: 'Ê',\n    HE: 'Ë',\n    AI: 'Ì',\n    BI: 'Í',\n    CI: 'Î',\n    HI: 'Ï',\n    AO: 'Ò',\n    BO: 'Ó',\n    CO: 'Ô',\n    DO: 213,\n    HO: 'Ö',\n    AU: 'Ù',\n    BU: 'Ú',\n    CU: 'Û',\n    HU: 'Ü',\n    Aa: 'à',\n    Ba: 'á',\n    Ca: 'â',\n    Da: 227,\n    Ha: 'ä',\n    Ja: 229,\n    Ae: 'è',\n    Be: 'é',\n    Ce: 'ê',\n    He: 'ë',\n    Ai: 'ì',\n    Bi: 'í',\n    Ci: 'î',\n    Hi: 'ï',\n    Ao: 'ò',\n    Bo: 'ó',\n    Co: 'ô',\n    Do: 245,\n    Ho: 'ö',\n    Au: 'ù',\n    Bu: 'ú',\n    Cu: 'û',\n    Hu: 'ü',\n    KC: 'Ç',\n    Kc: 'ç',\n    q: 'æ',\n    z: 'œ',\n    a: 'Æ',\n    j: 'Œ',\n    DN: 209,\n    Dn: 241,\n    Hy: 255,\n    S: 169,\n    c: 170,\n    R: 174,\n    \"B \": 180,\n\n    /*::[*/\n    0\n    /*::]*/\n    : 176,\n\n    /*::[*/\n    1\n    /*::]*/\n    : 177,\n\n    /*::[*/\n    2\n    /*::]*/\n    : 178,\n\n    /*::[*/\n    3\n    /*::]*/\n    : 179,\n\n    /*::[*/\n    5\n    /*::]*/\n    : 181,\n\n    /*::[*/\n    6\n    /*::]*/\n    : 182,\n\n    /*::[*/\n    7\n    /*::]*/\n    : 183,\n    Q: 185,\n    k: 186,\n    b: 208,\n    i: 216,\n    l: 222,\n    s: 240,\n    y: 248,\n    \"!\": 161,\n    '\"': 162,\n    \"#\": 163,\n    \"(\": 164,\n    \"%\": 165,\n    \"'\": 167,\n    \"H \": 168,\n    \"+\": 171,\n    \";\": 187,\n    \"<\": 188,\n    \"=\": 189,\n    \">\": 190,\n    \"?\": 191,\n    \"{\": 223\n  }\n  /*:any*/\n  ;\n  var sylk_char_regex = new RegExp(\"\\x1BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g, \"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\n  var sylk_char_fn = function sylk_char_fn(_, $1) {\n    var o = sylk_escapes[$1];\n    return typeof o == \"number\" ? _getansi(o) : o;\n  };\n\n  var decode_sylk_char = function decode_sylk_char($$, $1, $2) {\n    var newcc = $1.charCodeAt(0) - 0x20 << 4 | $2.charCodeAt(0) - 0x30;\n    return newcc == 59 ? $$ : _getansi(newcc);\n  };\n\n  sylk_escapes[\"|\"] = 254;\n  /* TODO: find an actual specification */\n\n  function sylk_to_aoa(d\n  /*:RawData*/\n  , opts)\n  /*:[AOA, Worksheet]*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return sylk_to_aoa_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return sylk_to_aoa_str(d, opts);\n\n      case 'buffer':\n        return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return sylk_to_aoa_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n\n  function sylk_to_aoa_str(str\n  /*:string*/\n  , opts)\n  /*:[AOA, Worksheet]*/\n  {\n    var records = str.split(/[\\n\\r]+/),\n        R = -1,\n        C = -1,\n        ri = 0,\n        rj = 0,\n        arr\n    /*:AOA*/\n    = [];\n    var formats\n    /*:Array<string>*/\n    = [];\n    var next_cell_format\n    /*:string|null*/\n    = null;\n    var sht = {},\n        rowinfo\n    /*:Array<RowInfo>*/\n    = [],\n        colinfo\n    /*:Array<ColInfo>*/\n    = [],\n        cw\n    /*:Array<string>*/\n    = [];\n    var Mval = 0,\n        j;\n    if (+opts.codepage >= 0) set_cp(+opts.codepage);\n\n    for (; ri !== records.length; ++ri) {\n      Mval = 0;\n      var rstr = records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n      var record = rstr.replace(/;;/g, \"\\0\").split(\";\").map(function (x) {\n        return x.replace(/\\u0000/g, \";\");\n      });\n      var RT = record[0],\n          val;\n      if (rstr.length > 0) switch (RT) {\n        case 'ID':\n          break;\n\n        /* header */\n\n        case 'E':\n          break;\n\n        /* EOF */\n\n        case 'B':\n          break;\n\n        /* dimensions */\n\n        case 'O':\n          break;\n\n        /* options? */\n\n        case 'W':\n          break;\n\n        /* window? */\n\n        case 'P':\n          if (record[1].charAt(0) == 'P') formats.push(rstr.slice(3).replace(/;;/g, \";\"));\n          break;\n\n        case 'C':\n          var C_seen_K = false,\n              C_seen_X = false,\n              C_seen_S = false,\n              C_seen_E = false,\n              _R = -1,\n              _C = -1;\n\n          for (rj = 1; rj < record.length; ++rj) {\n            switch (record[rj].charAt(0)) {\n              case 'A':\n                break;\n              // TODO: comment\n\n              case 'X':\n                C = parseInt(record[rj].slice(1)) - 1;\n                C_seen_X = true;\n                break;\n\n              case 'Y':\n                R = parseInt(record[rj].slice(1)) - 1;\n                if (!C_seen_X) C = 0;\n\n                for (j = arr.length; j <= R; ++j) {\n                  arr[j] = [];\n                }\n\n                break;\n\n              case 'K':\n                val = record[rj].slice(1);\n                if (val.charAt(0) === '\"') val = val.slice(1, val.length - 1);else if (val === 'TRUE') val = true;else if (val === 'FALSE') val = false;else if (!isNaN(fuzzynum(val))) {\n                  val = fuzzynum(val);\n                  if (next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);\n                } else if (!isNaN(fuzzydate(val).getDate())) {\n                  val = parseDate(val);\n                }\n                C_seen_K = true;\n                break;\n\n              case 'E':\n                C_seen_E = true;\n                var formula = rc_to_a1(record[rj].slice(1), {\n                  r: R,\n                  c: C\n                });\n                arr[R][C] = [arr[R][C], formula];\n                break;\n\n              case 'S':\n                C_seen_S = true;\n                arr[R][C] = [arr[R][C], \"S5S\"];\n                break;\n\n              case 'G':\n                break;\n              // unknown\n\n              case 'R':\n                _R = parseInt(record[rj].slice(1)) - 1;\n                break;\n\n              case 'C':\n                _C = parseInt(record[rj].slice(1)) - 1;\n                break;\n\n              default:\n                if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n            }\n          }\n\n          if (C_seen_K) {\n            if (arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;else arr[R][C] = val;\n            next_cell_format = null;\n          }\n\n          if (C_seen_S) {\n            if (C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n            var shrbase = _R > -1 && arr[_R][_C];\n            if (!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n            arr[R][C][1] = shift_formula_str(shrbase[1], {\n              r: R - _R,\n              c: C - _C\n            });\n          }\n\n          break;\n\n        case 'F':\n          var F_seen = 0;\n\n          for (rj = 1; rj < record.length; ++rj) {\n            switch (record[rj].charAt(0)) {\n              case 'X':\n                C = parseInt(record[rj].slice(1)) - 1;\n                ++F_seen;\n                break;\n\n              case 'Y':\n                R = parseInt(record[rj].slice(1)) - 1;\n                /*C = 0;*/\n\n                for (j = arr.length; j <= R; ++j) {\n                  arr[j] = [];\n                }\n\n                break;\n\n              case 'M':\n                Mval = parseInt(record[rj].slice(1)) / 20;\n                break;\n\n              case 'F':\n                break;\n\n              /* ??? */\n\n              case 'G':\n                break;\n\n              /* hide grid */\n\n              case 'P':\n                next_cell_format = formats[parseInt(record[rj].slice(1))];\n                break;\n\n              case 'S':\n                break;\n\n              /* cell style */\n\n              case 'D':\n                break;\n\n              /* column */\n\n              case 'N':\n                break;\n\n              /* font */\n\n              case 'W':\n                cw = record[rj].slice(1).split(\" \");\n\n                for (j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n                  Mval = parseInt(cw[2], 10);\n                  colinfo[j - 1] = Mval === 0 ? {\n                    hidden: true\n                  } : {\n                    wch: Mval\n                  };\n                  process_col(colinfo[j - 1]);\n                }\n\n                break;\n\n              case 'C':\n                /* default column format */\n                C = parseInt(record[rj].slice(1)) - 1;\n                if (!colinfo[C]) colinfo[C] = {};\n                break;\n\n              case 'R':\n                /* row properties */\n                R = parseInt(record[rj].slice(1)) - 1;\n                if (!rowinfo[R]) rowinfo[R] = {};\n\n                if (Mval > 0) {\n                  rowinfo[R].hpt = Mval;\n                  rowinfo[R].hpx = pt2px(Mval);\n                } else if (Mval === 0) rowinfo[R].hidden = true;\n\n                break;\n\n              default:\n                if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n            }\n          }\n\n          if (F_seen < 1) next_cell_format = null;\n          break;\n\n        default:\n          if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n      }\n    }\n\n    if (rowinfo.length > 0) sht['!rows'] = rowinfo;\n    if (colinfo.length > 0) sht['!cols'] = colinfo;\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return [arr, sht];\n  }\n\n  function sylk_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var aoasht = sylk_to_aoa(d, opts);\n    var aoa = aoasht[0],\n        ws = aoasht[1];\n    var o = aoa_to_sheet(aoa, opts);\n    keys(ws).forEach(function (k) {\n      o[k] = ws[k];\n    });\n    return o;\n  }\n\n  function sylk_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(sylk_to_sheet(d, opts), opts);\n  }\n\n  function write_ws_cell_sylk(cell\n  /*:Cell*/\n  , ws\n  /*:Worksheet*/\n  , R\n  /*:number*/\n  , C\n  /*:number*/\n\n  /*::, opts*/\n  )\n  /*:string*/\n  {\n    var o = \"C;Y\" + (R + 1) + \";X\" + (C + 1) + \";K\";\n\n    switch (cell.t) {\n      case 'n':\n        o += cell.v || 0;\n        if (cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {\n          r: R,\n          c: C\n        });\n        break;\n\n      case 'b':\n        o += cell.v ? \"TRUE\" : \"FALSE\";\n        break;\n\n      case 'e':\n        o += cell.w || cell.v;\n        break;\n\n      case 'd':\n        o += '\"' + (cell.w || cell.v) + '\"';\n        break;\n\n      case 's':\n        o += '\"' + cell.v.replace(/\"/g, \"\").replace(/;/g, \";;\") + '\"';\n        break;\n    }\n\n    return o;\n  }\n\n  function write_ws_cols_sylk(out, cols) {\n    cols.forEach(function (col, i) {\n      var rec = \"F;W\" + (i + 1) + \" \" + (i + 1) + \" \";\n      if (col.hidden) rec += \"0\";else {\n        if (typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n        if (typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n        if (typeof col.wch == 'number') rec += Math.round(col.wch);\n      }\n      if (rec.charAt(rec.length - 1) != \" \") out.push(rec);\n    });\n  }\n\n  function write_ws_rows_sylk(out\n  /*:Array<string>*/\n  , rows\n  /*:Array<RowInfo>*/\n  ) {\n    rows.forEach(function (row, i) {\n      var rec = \"F;\";\n      if (row.hidden) rec += \"M0;\";else if (row.hpt) rec += \"M\" + 20 * row.hpt + \";\";else if (row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n      if (rec.length > 2) out.push(rec + \"R\" + (i + 1));\n    });\n  }\n\n  function sheet_to_sylk(ws\n  /*:Worksheet*/\n  , opts\n  /*:?any*/\n  )\n  /*:string*/\n  {\n    var preamble\n    /*:Array<string>*/\n    = [\"ID;PWXL;N;E\"],\n        o\n    /*:Array<string>*/\n    = [];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n    var RS = \"\\r\\n\";\n    preamble.push(\"P;PGeneral\");\n    preamble.push(\"F;P0;DG0G8;M255\");\n    if (ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n    if (ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n    preamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c, r.s.r, r.e.c, r.e.r].join(\" \"));\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n        o.push(write_ws_cell_sylk(cell, ws, R, C));\n      }\n    }\n\n    return preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n  }\n\n  return {\n    to_workbook: sylk_to_workbook,\n    to_sheet: sylk_to_sheet,\n    from_sheet: sheet_to_sylk\n  };\n}();\n\nvar DIF = /*#__PURE__*/function () {\n  function dif_to_aoa(d\n  /*:RawData*/\n  , opts)\n  /*:AOA*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return dif_to_aoa_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return dif_to_aoa_str(d, opts);\n\n      case 'buffer':\n        return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return dif_to_aoa_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n\n  function dif_to_aoa_str(str\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr\n    /*:AOA*/\n    = [];\n\n    for (; ri !== records.length; ++ri) {\n      if (records[ri].trim() === 'BOT') {\n        arr[++R] = [];\n        C = 0;\n        continue;\n      }\n\n      if (R < 0) continue;\n      var metadata = records[ri].trim().split(\",\");\n      var type = metadata[0],\n          value = metadata[1];\n      ++ri;\n      var data = records[ri] || \"\";\n\n      while ((data.match(/[\"]/g) || []).length & 1 && ri < records.length - 1) {\n        data += \"\\n\" + records[++ri];\n      }\n\n      data = data.trim();\n\n      switch (+type) {\n        case -1:\n          if (data === 'BOT') {\n            arr[++R] = [];\n            C = 0;\n            continue;\n          } else if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\n          break;\n\n        case 0:\n          if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);else if (!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);else arr[R][C] = value;\n          ++C;\n          break;\n\n        case 1:\n          data = data.slice(1, data.length - 1);\n          data = data.replace(/\"\"/g, '\"');\n          if (data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n          arr[R][C++] = data !== '' ? data : null;\n          break;\n      }\n\n      if (data === 'EOD') break;\n    }\n\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return arr;\n  }\n\n  function dif_to_sheet(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    return aoa_to_sheet(dif_to_aoa(str, opts), opts);\n  }\n\n  function dif_to_workbook(str\n  /*:string*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(dif_to_sheet(str, opts), opts);\n  }\n\n  var sheet_to_dif = /*#__PURE__*/function () {\n    var push_field = function pf(o\n    /*:Array<string>*/\n    , topic\n    /*:string*/\n    , v\n    /*:number*/\n    , n\n    /*:number*/\n    , s\n    /*:string*/\n    ) {\n      o.push(topic);\n      o.push(v + \",\" + n);\n      o.push('\"' + s.replace(/\"/g, '\"\"') + '\"');\n    };\n\n    var push_value = function po(o\n    /*:Array<string>*/\n    , type\n    /*:number*/\n    , v\n    /*:any*/\n    , s\n    /*:string*/\n    ) {\n      o.push(type + \",\" + v);\n      o.push(type == 1 ? '\"' + s.replace(/\"/g, '\"\"') + '\"' : s);\n    };\n\n    return function sheet_to_dif(ws\n    /*:Worksheet*/\n\n    /*::, opts:?any*/\n    )\n    /*:string*/\n    {\n      var o\n      /*:Array<string>*/\n      = [];\n      var r = safe_decode_range(ws['!ref']),\n          cell\n      /*:Cell*/\n      ;\n      var dense = Array.isArray(ws);\n      push_field(o, \"TABLE\", 0, 1, \"sheetjs\");\n      push_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1, \"\");\n      push_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1, \"\");\n      push_field(o, \"DATA\", 0, 0, \"\");\n\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        push_value(o, -1, 0, \"BOT\");\n\n        for (var C = r.s.c; C <= r.e.c; ++C) {\n          var coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n\n          if (!cell) {\n            push_value(o, 1, 0, \"\");\n            continue;\n          }\n\n          switch (cell.t) {\n            case 'n':\n              var val = cell.w;\n              if (!val && cell.v != null) val = cell.v;\n\n              if (val == null) {\n                if (cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);else push_value(o, 1, 0, \"\");\n              } else push_value(o, 0, val, \"V\");\n\n              break;\n\n            case 'b':\n              push_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\n              break;\n\n            case 's':\n              push_value(o, 1, 0, isNaN(cell.v) ? cell.v : '=\"' + cell.v + '\"');\n              break;\n\n            case 'd':\n              if (!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n              push_value(o, 0, cell.w, \"V\");\n              break;\n\n            default:\n              push_value(o, 1, 0, \"\");\n          }\n        }\n      }\n\n      push_value(o, -1, 0, \"EOD\");\n      var RS = \"\\r\\n\";\n      var oo = o.join(RS); //while((oo.length & 0x7F) != 0) oo += \"\\0\";\n\n      return oo;\n    };\n  }();\n\n  return {\n    to_workbook: dif_to_workbook,\n    to_sheet: dif_to_sheet,\n    from_sheet: sheet_to_dif\n  };\n}();\n\nvar ETH = /*#__PURE__*/function () {\n  function decode(s\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return s.replace(/\\\\b/g, \"\\\\\").replace(/\\\\c/g, \":\").replace(/\\\\n/g, \"\\n\");\n  }\n\n  function encode(s\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g, \"\\\\n\");\n  }\n\n  function eth_to_aoa(str\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr\n    /*:AOA*/\n    = [];\n\n    for (; ri !== records.length; ++ri) {\n      var record = records[ri].trim().split(\":\");\n      if (record[0] !== 'cell') continue;\n      var addr = decode_cell(record[1]);\n      if (arr.length <= addr.r) for (R = arr.length; R <= addr.r; ++R) {\n        if (!arr[R]) arr[R] = [];\n      }\n      R = addr.r;\n      C = addr.c;\n\n      switch (record[2]) {\n        case 't':\n          arr[R][C] = decode(record[3]);\n          break;\n\n        case 'v':\n          arr[R][C] = +record[3];\n          break;\n\n        case 'vtf':\n          var _f = record[record.length - 1];\n\n        /* falls through */\n\n        case 'vtc':\n          switch (record[3]) {\n            case 'nl':\n              arr[R][C] = +record[4] ? true : false;\n              break;\n\n            default:\n              arr[R][C] = +record[4];\n              break;\n          }\n\n          if (record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n      }\n    }\n\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return arr;\n  }\n\n  function eth_to_sheet(d\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    return aoa_to_sheet(eth_to_aoa(d, opts), opts);\n  }\n\n  function eth_to_workbook(d\n  /*:string*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(eth_to_sheet(d, opts), opts);\n  }\n\n  var header = [\"socialcalc:version:1.5\", \"MIME-Version: 1.0\", \"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"].join(\"\\n\");\n  var sep = [\"--SocialCalcSpreadsheetControlSave\", \"Content-type: text/plain; charset=UTF-8\"].join(\"\\n\") + \"\\n\";\n  /* TODO: the other parts */\n\n  var meta = [\"# SocialCalc Spreadsheet Control Save\", \"part:sheet\"].join(\"\\n\");\n  var end = \"--SocialCalcSpreadsheetControlSave--\";\n\n  function sheet_to_eth_data(ws\n  /*:Worksheet*/\n  )\n  /*:string*/\n  {\n    if (!ws || !ws['!ref']) return \"\";\n    var o\n    /*:Array<string>*/\n    = [],\n        oo\n    /*:Array<string>*/\n    = [],\n        cell,\n        coord = \"\";\n    var r = decode_range(ws['!ref']);\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null || cell.t === 'z') continue;\n        oo = [\"cell\", coord, 't'];\n\n        switch (cell.t) {\n          case 's':\n          case 'str':\n            oo.push(encode(cell.v));\n            break;\n\n          case 'n':\n            if (!cell.f) {\n              oo[2] = 'v';\n              oo[3] = cell.v;\n            } else {\n              oo[2] = 'vtf';\n              oo[3] = 'n';\n              oo[4] = cell.v;\n              oo[5] = encode(cell.f);\n            }\n\n            break;\n\n          case 'b':\n            oo[2] = 'vt' + (cell.f ? 'f' : 'c');\n            oo[3] = 'nl';\n            oo[4] = cell.v ? \"1\" : \"0\";\n            oo[5] = encode(cell.f || (cell.v ? 'TRUE' : 'FALSE'));\n            break;\n\n          case 'd':\n            var t = datenum(parseDate(cell.v));\n            oo[2] = 'vtc';\n            oo[3] = 'nd';\n            oo[4] = \"\" + t;\n            oo[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n            break;\n\n          case 'e':\n            continue;\n        }\n\n        o.push(oo.join(\":\"));\n      }\n    }\n\n    o.push(\"sheet:c:\" + (r.e.c - r.s.c + 1) + \":r:\" + (r.e.r - r.s.r + 1) + \":tvf:1\");\n    o.push(\"valueformat:1:text-wiki\"); //o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\n    return o.join(\"\\n\");\n  }\n\n  function sheet_to_eth(ws\n  /*:Worksheet*/\n\n  /*::, opts:?any*/\n  )\n  /*:string*/\n  {\n    return [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\"); // return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n  }\n\n  return {\n    to_workbook: eth_to_workbook,\n    to_sheet: eth_to_sheet,\n    from_sheet: sheet_to_eth\n  };\n}();\n\nvar PRN = /*#__PURE__*/function () {\n  function set_text_arr(data\n  /*:string*/\n  , arr\n  /*:AOA*/\n  , R\n  /*:number*/\n  , C\n  /*:number*/\n  , o\n  /*:any*/\n  ) {\n    if (o.raw) arr[R][C] = data;else if (data === \"\") ;else if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);else if (!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);else arr[R][C] = data;\n  }\n\n  function prn_to_aoa_str(f\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var o = opts || {};\n    var arr\n    /*:AOA*/\n    = []\n    /*:any*/\n    ;\n    if (!f || f.length === 0) return arr;\n    var lines = f.split(/[\\r\\n]/);\n    var L = lines.length - 1;\n\n    while (L >= 0 && lines[L].length === 0) {\n      --L;\n    }\n\n    var start = 10,\n        idx = 0;\n    var R = 0;\n\n    for (; R <= L; ++R) {\n      idx = lines[R].indexOf(\" \");\n      if (idx == -1) idx = lines[R].length;else idx++;\n      start = Math.max(start, idx);\n    }\n\n    for (R = 0; R <= L; ++R) {\n      arr[R] = [];\n      /* TODO: confirm that widths are always 10 */\n\n      var C = 0;\n      set_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\n      for (C = 1; C <= (lines[R].length - start) / 10 + 1; ++C) {\n        set_text_arr(lines[R].slice(start + (C - 1) * 10, start + C * 10).trim(), arr, R, C, o);\n      }\n    }\n\n    if (o.sheetRows) arr = arr.slice(0, o.sheetRows);\n    return arr;\n  } // List of accepted CSV separators\n\n\n  var guess_seps = {\n    /*::[*/\n    0x2C\n    /*::]*/\n    : ',',\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : \"\\t\",\n\n    /*::[*/\n    0x3B\n    /*::]*/\n    : ';',\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : '|'\n  }; // CSV separator weights to be used in case of equal numbers\n\n  var guess_sep_weights = {\n    /*::[*/\n    0x2C\n    /*::]*/\n    : 3,\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : 2,\n\n    /*::[*/\n    0x3B\n    /*::]*/\n    : 1,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 0\n  };\n\n  function guess_sep(str) {\n    var cnt = {},\n        instr = false,\n        end = 0,\n        cc = 0;\n\n    for (; end < str.length; ++end) {\n      if ((cc = str.charCodeAt(end)) == 0x22) instr = !instr;else if (!instr && cc in guess_seps) cnt[cc] = (cnt[cc] || 0) + 1;\n    }\n\n    cc = [];\n\n    for (end in cnt) {\n      if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n        cc.push([cnt[end], end]);\n      }\n    }\n\n    if (!cc.length) {\n      cnt = guess_sep_weights;\n\n      for (end in cnt) {\n        if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n          cc.push([cnt[end], end]);\n        }\n      }\n    }\n\n    cc.sort(function (a, b) {\n      return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]];\n    });\n    return guess_seps[cc.pop()[1]] || 0x2C;\n  }\n\n  function dsv_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    var sep = \"\";\n    var ws\n    /*:Worksheet*/\n    = o.dense ? []\n    /*:any*/\n    : {}\n    /*:any*/\n    ;\n    var range\n    /*:Range*/\n    = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    }\n    /*:any*/\n    ;\n\n    if (str.slice(0, 4) == \"sep=\") {\n      // If the line ends in \\r\\n\n      if (str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10) {\n        sep = str.charAt(4);\n        str = str.slice(7);\n      } // If line ends in \\r OR \\n\n      else if (str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10) {\n        sep = str.charAt(4);\n        str = str.slice(6);\n      } else sep = guess_sep(str.slice(0, 1024));\n    } else if (o && o.FS) sep = o.FS;else sep = guess_sep(str.slice(0, 1024));\n\n    var R = 0,\n        C = 0,\n        v = 0;\n    var start = 0,\n        end = 0,\n        sepcc = sep.charCodeAt(0),\n        instr = false,\n        cc = 0,\n        startcc = str.charCodeAt(0);\n    str = str.replace(/\\r\\n/mg, \"\\n\");\n\n    var _re\n    /*:?RegExp*/\n    = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\n    function finish_cell() {\n      var s = str.slice(start, end);\n      var cell = {}\n      /*:any*/\n      ;\n      if (s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1, -1).replace(/\"\"/g, '\"');\n      if (s.length === 0) cell.t = 'z';else if (o.raw) {\n        cell.t = 's';\n        cell.v = s;\n      } else if (s.trim().length === 0) {\n        cell.t = 's';\n        cell.v = s;\n      } else if (s.charCodeAt(0) == 0x3D) {\n        if (s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) {\n          cell.t = 's';\n          cell.v = s.slice(2, -1).replace(/\"\"/g, '\"');\n        } else if (fuzzyfmla(s)) {\n          cell.t = 'n';\n          cell.f = s.slice(1);\n        } else {\n          cell.t = 's';\n          cell.v = s;\n        }\n      } else if (s == \"TRUE\") {\n        cell.t = 'b';\n        cell.v = true;\n      } else if (s == \"FALSE\") {\n        cell.t = 'b';\n        cell.v = false;\n      } else if (!isNaN(v = fuzzynum(s))) {\n        cell.t = 'n';\n        if (o.cellText !== false) cell.w = s;\n        cell.v = v;\n      } else if (!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\n        cell.z = o.dateNF || table_fmt[14];\n        var k = 0;\n\n        if (_re && s.match(_re)) {\n          s = dateNF_fix(s, o.dateNF, s.match(_re) || []);\n          k = 1;\n        }\n\n        if (o.cellDates) {\n          cell.t = 'd';\n          cell.v = parseDate(s, k);\n        } else {\n          cell.t = 'n';\n          cell.v = datenum(parseDate(s, k));\n        }\n\n        if (o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v) : cell.v);\n        if (!o.cellNF) delete cell.z;\n      } else {\n        cell.t = 's';\n        cell.v = s;\n      }\n      if (cell.t == 'z') ;else if (o.dense) {\n        if (!ws[R]) ws[R] = [];\n        ws[R][C] = cell;\n      } else ws[encode_cell({\n        c: C,\n        r: R\n      })] = cell;\n      start = end + 1;\n      startcc = str.charCodeAt(start);\n      if (range.e.c < C) range.e.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (cc == sepcc) ++C;else {\n        C = 0;\n        ++R;\n        if (o.sheetRows && o.sheetRows <= R) return true;\n      }\n    }\n\n    outer: for (; end < str.length; ++end) {\n      switch (cc = str.charCodeAt(end)) {\n        case 0x22:\n          if (startcc === 0x22) instr = !instr;\n          break;\n\n        case sepcc:\n        case 0x0a:\n        case 0x0d:\n          if (!instr && finish_cell()) break outer;\n          break;\n      }\n    }\n\n    if (end - start > 0) finish_cell();\n    ws['!ref'] = encode_range(range);\n    return ws;\n  }\n\n  function prn_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    if (!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n    if (opts.FS) return dsv_to_sheet_str(str, opts);\n    if (str.slice(0, 4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n    if (str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n    return aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n  }\n\n  function prn_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var str = \"\",\n        bytes = opts.type == 'string' ? [0, 0, 0, 0] : firstbyte(d, opts);\n\n    switch (opts.type) {\n      case 'base64':\n        str = Base64_decode(d);\n        break;\n\n      case 'binary':\n        str = d;\n        break;\n\n      case 'buffer':\n        if (opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n        else if (opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);else str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n        break;\n\n      case 'array':\n        str = cc2str(d);\n        break;\n\n      case 'string':\n        str = d;\n        break;\n\n      default:\n        throw new Error(\"Unrecognized type \" + opts.type);\n    }\n\n    if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));else if (opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);else if (opts.type == 'binary' && typeof $cptable !== 'undefined' && opts.codepage) str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591, str));\n    if (str.slice(0, 19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n    return prn_to_sheet_str(str, opts);\n  }\n\n  function prn_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(prn_to_sheet(d, opts), opts);\n  }\n\n  function sheet_to_prn(ws\n  /*:Worksheet*/\n\n  /*::, opts:?any*/\n  )\n  /*:string*/\n  {\n    var o\n    /*:Array<string>*/\n    = [];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      var oo\n      /*:Array<string>*/\n      = [];\n\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n\n        if (!cell || cell.v == null) {\n          oo.push(\"          \");\n          continue;\n        }\n\n        var w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0, 10);\n\n        while (w.length < 10) {\n          w += \" \";\n        }\n\n        oo.push(w + (C === 0 ? \" \" : \"\"));\n      }\n\n      o.push(oo.join(\"\"));\n    }\n\n    return o.join(\"\\n\");\n  }\n\n  return {\n    to_workbook: prn_to_workbook,\n    to_sheet: prn_to_sheet,\n    from_sheet: sheet_to_prn\n  };\n}();\n/* Excel defaults to SYLK but warns if data is not valid */\n\n\nfunction read_wb_ID(d, opts) {\n  var o = opts || {},\n      OLD_WTF = !!o.WTF;\n  o.WTF = true;\n\n  try {\n    var out = SYLK.to_workbook(d, o);\n    o.WTF = OLD_WTF;\n    return out;\n  } catch (e) {\n    o.WTF = OLD_WTF;\n    if (!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n    return PRN.to_workbook(d, opts);\n  }\n}\n\nvar WK_ = /*#__PURE__*/function () {\n  function lotushopper(data, cb\n  /*:RecordHopperCB*/\n  , opts\n  /*:any*/\n  ) {\n    if (!data) return;\n    prep_blob(data, data.l || 0);\n    var Enum = opts.Enum || WK1Enum;\n\n    while (data.l < data.length) {\n      var RT = data.read_shift(2);\n      var R = Enum[RT] || Enum[0xFFFF];\n      var length = data.read_shift(2);\n      var tgt = data.l + length;\n      var d = R.f && R.f(data, length, opts);\n      data.l = tgt;\n      if (cb(d, R, RT)) return;\n    }\n  }\n\n  function lotus_to_workbook(d\n  /*:RawData*/\n  , opts) {\n    switch (opts.type) {\n      case 'base64':\n        return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\n      case 'binary':\n        return lotus_to_workbook_buf(s2a(d), opts);\n\n      case 'buffer':\n      case 'array':\n        return lotus_to_workbook_buf(d, opts);\n    }\n\n    throw \"Unsupported type \" + opts.type;\n  }\n\n  function lotus_to_workbook_buf(d, opts)\n  /*:Workbook*/\n  {\n    if (!d) return d;\n    var o = opts || {};\n    var s\n    /*:Worksheet*/\n    = o.dense ? [] : {}\n    /*:any*/\n    ,\n        n = \"Sheet1\",\n        next_n = \"\",\n        sidx = 0;\n    var sheets = {},\n        snames = [],\n        realnames = [];\n    var refguess = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var sheetRows = o.sheetRows || 0;\n\n    if (d[2] == 0x00) {\n      if (d[3] == 0x08 || d[3] == 0x09) {\n        if (d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n      }\n    }\n\n    if (d[2] == 0x02) {\n      o.Enum = WK1Enum;\n      lotushopper(d, function (val, R, RT) {\n        switch (RT) {\n          case 0x00:\n            /* BOF */\n            o.vers = val;\n            if (val >= 0x1000) o.qpro = true;\n            break;\n\n          case 0x06:\n            refguess = val;\n            break;\n\n          /* RANGE */\n\n          case 0xCC:\n            if (val) next_n = val;\n            break;\n\n          /* SHEETNAMECS */\n\n          case 0xDE:\n            next_n = val;\n            break;\n\n          /* SHEETNAMELP */\n\n          case 0x0F:\n          /* LABEL */\n\n          case 0x33:\n            /* STRING */\n            if (!o.qpro) val[1].v = val[1].v.slice(1);\n\n          /* falls through */\n\n          case 0x0D:\n          /* INTEGER */\n\n          case 0x0E:\n          /* NUMBER */\n\n          case 0x10:\n            /* FORMULA */\n\n            /* TODO: actual translation of the format code */\n            if (RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n              val[1].z = o.dateNF || table_fmt[14];\n\n              if (o.cellDates) {\n                val[1].t = 'd';\n                val[1].v = numdate(val[1].v);\n              }\n            }\n\n            if (o.qpro) {\n              if (val[3] > sidx) {\n                s[\"!ref\"] = encode_range(refguess);\n                sheets[n] = s;\n                snames.push(n);\n                s = o.dense ? [] : {};\n                refguess = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n                sidx = val[3];\n                n = next_n || \"Sheet\" + (sidx + 1);\n                next_n = \"\";\n              }\n            }\n\n            var tmpcell = o.dense ? (s[val[0].r] || [])[val[0].c] : s[encode_cell(val[0])];\n\n            if (tmpcell) {\n              tmpcell.t = val[1].t;\n              tmpcell.v = val[1].v;\n              if (val[1].z != null) tmpcell.z = val[1].z;\n              if (val[1].f != null) tmpcell.f = val[1].f;\n              break;\n            }\n\n            if (o.dense) {\n              if (!s[val[0].r]) s[val[0].r] = [];\n              s[val[0].r][val[0].c] = val[1];\n            } else s[encode_cell(val[0])] = val[1];\n\n            break;\n        }\n      }, o);\n    } else if (d[2] == 0x1A || d[2] == 0x0E) {\n      o.Enum = WK3Enum;\n\n      if (d[2] == 0x0E) {\n        o.qpro = true;\n        d.l = 0;\n      }\n\n      lotushopper(d, function (val, R, RT) {\n        switch (RT) {\n          case 0xCC:\n            n = val;\n            break;\n\n          /* SHEETNAMECS */\n\n          case 0x16:\n            /* LABEL16 */\n            val[1].v = val[1].v.slice(1);\n\n          /* falls through */\n\n          case 0x17:\n          /* NUMBER17 */\n\n          case 0x18:\n          /* NUMBER18 */\n\n          case 0x19:\n          /* FORMULA19 */\n\n          case 0x25:\n          /* NUMBER25 */\n\n          case 0x27:\n          /* NUMBER27 */\n\n          case 0x28:\n            /* FORMULA28 */\n            if (val[3] > sidx) {\n              s[\"!ref\"] = encode_range(refguess);\n              sheets[n] = s;\n              snames.push(n);\n              s = o.dense ? [] : {};\n              refguess = {\n                s: {\n                  r: 0,\n                  c: 0\n                },\n                e: {\n                  r: 0,\n                  c: 0\n                }\n              };\n              sidx = val[3];\n              n = \"Sheet\" + (sidx + 1);\n            }\n\n            if (sheetRows > 0 && val[0].r >= sheetRows) break;\n\n            if (o.dense) {\n              if (!s[val[0].r]) s[val[0].r] = [];\n              s[val[0].r][val[0].c] = val[1];\n            } else s[encode_cell(val[0])] = val[1];\n\n            if (refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n            if (refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n            break;\n\n          case 0x1B:\n            /* XFORMAT */\n            if (val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n            break;\n\n          case 0x0601:\n            /* SHEETINFOQP */\n            realnames[val[0]] = val[1];\n            if (val[0] == sidx) n = val[1];\n            break;\n        }\n      }, o);\n    } else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\n    s[\"!ref\"] = encode_range(refguess);\n    sheets[next_n || n] = s;\n    snames.push(next_n || n);\n    if (!realnames.length) return {\n      SheetNames: snames,\n      Sheets: sheets\n    };\n    var osheets = {},\n        rnames = [];\n    /* TODO: verify no collisions */\n\n    for (var i = 0; i < realnames.length; ++i) {\n      if (sheets[snames[i]]) {\n        rnames.push(realnames[i] || snames[i]);\n        osheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n      } else {\n        rnames.push(realnames[i]);\n        osheets[realnames[i]] = {\n          \"!ref\": \"A1\"\n        };\n      }\n    }\n\n    return {\n      SheetNames: rnames,\n      Sheets: osheets\n    };\n  }\n\n  function sheet_to_wk1(ws\n  /*:Worksheet*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n    var ba = buf_array();\n    var range = safe_decode_range(ws[\"!ref\"]);\n    var dense = Array.isArray(ws);\n    var cols = [];\n    write_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n    write_biff_rec(ba, 0x06, write_RANGE(range));\n    var max_R = Math.min(range.e.r, 8191);\n\n    for (var R = range.s.r; R <= max_R; ++R) {\n      var rr = encode_row(R);\n\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        if (R === range.s.r) cols[C] = encode_col(C);\n        var ref = cols[C] + rr;\n        var cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (!cell || cell.t == \"z\") continue;\n        /* TODO: formula records */\n\n        if (cell.t == \"n\") {\n          if ((cell.v | 0) == cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell.v));else write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell.v));\n        } else {\n          var str = format_cell(cell);\n          write_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n        }\n      }\n    }\n\n    write_biff_rec(ba, 0x01);\n    return ba.end();\n  }\n\n  function book_to_wk3(wb\n  /*:Workbook*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n    var ba = buf_array();\n    write_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n    for (var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) {\n      if ((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n    }\n\n    var wsidx = 0;\n\n    for (i = 0; i < wb.SheetNames.length; ++i) {\n      var ws = wb.Sheets[wb.SheetNames[i]];\n      if (!ws || !ws[\"!ref\"]) continue;\n      var range = safe_decode_range(ws[\"!ref\"]);\n      var dense = Array.isArray(ws);\n      var cols = [];\n      var max_R = Math.min(range.e.r, 8191);\n\n      for (var R = range.s.r; R <= max_R; ++R) {\n        var rr = encode_row(R);\n\n        for (var C = range.s.c; C <= range.e.c; ++C) {\n          if (R === range.s.r) cols[C] = encode_col(C);\n          var ref = cols[C] + rr;\n          var cell = dense ? (ws[R] || [])[C] : ws[ref];\n          if (!cell || cell.t == \"z\") continue;\n          /* TODO: FORMULA19 NUMBER18 records */\n\n          if (cell.t == \"n\") {\n            write_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n          } else {\n            var str = format_cell(cell);\n            /* TODO: max len? */\n\n            write_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n          }\n        }\n      }\n\n      ++wsidx;\n    }\n\n    write_biff_rec(ba, 0x01);\n    return ba.end();\n  }\n\n  function write_BOF_WK1(v\n  /*:number*/\n  ) {\n    var out = new_buf(2);\n    out.write_shift(2, v);\n    return out;\n  }\n\n  function write_BOF_WK3(wb\n  /*:Workbook*/\n  ) {\n    var out = new_buf(26);\n    out.write_shift(2, 0x1000);\n    out.write_shift(2, 0x0004);\n    out.write_shift(4, 0x0000);\n    var rows = 0,\n        cols = 0,\n        wscnt = 0;\n\n    for (var i = 0; i < wb.SheetNames.length; ++i) {\n      var name = wb.SheetNames[i];\n      var ws = wb.Sheets[name];\n      if (!ws || !ws[\"!ref\"]) continue;\n      ++wscnt;\n      var range = decode_range(ws[\"!ref\"]);\n      if (rows < range.e.r) rows = range.e.r;\n      if (cols < range.e.c) cols = range.e.c;\n    }\n\n    if (rows > 8191) rows = 8191;\n    out.write_shift(2, rows);\n    out.write_shift(1, wscnt);\n    out.write_shift(1, cols);\n    out.write_shift(2, 0x00);\n    out.write_shift(2, 0x00);\n    out.write_shift(1, 0x01);\n    out.write_shift(1, 0x02);\n    out.write_shift(4, 0);\n    out.write_shift(4, 0);\n    return out;\n  }\n\n  function parse_RANGE(blob, length, opts) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n\n    if (length == 8 && opts.qpro) {\n      o.s.c = blob.read_shift(1);\n      blob.l++;\n      o.s.r = blob.read_shift(2);\n      o.e.c = blob.read_shift(1);\n      blob.l++;\n      o.e.r = blob.read_shift(2);\n      return o;\n    }\n\n    o.s.c = blob.read_shift(2);\n    o.s.r = blob.read_shift(2);\n    if (length == 12 && opts.qpro) blob.l += 2;\n    o.e.c = blob.read_shift(2);\n    o.e.r = blob.read_shift(2);\n    if (length == 12 && opts.qpro) blob.l += 2;\n    if (o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n    return o;\n  }\n\n  function write_RANGE(range) {\n    var out = new_buf(8);\n    out.write_shift(2, range.s.c);\n    out.write_shift(2, range.s.r);\n    out.write_shift(2, range.e.c);\n    out.write_shift(2, range.e.r);\n    return out;\n  }\n\n  function parse_cell(blob, length, opts) {\n    var o = [{\n      c: 0,\n      r: 0\n    }, {\n      t: 'n',\n      v: 0\n    }, 0, 0];\n\n    if (opts.qpro && opts.vers != 0x5120) {\n      o[0].c = blob.read_shift(1);\n      o[3] = blob.read_shift(1);\n      o[0].r = blob.read_shift(2);\n      blob.l += 2;\n    } else {\n      o[2] = blob.read_shift(1);\n      o[0].c = blob.read_shift(2);\n      o[0].r = blob.read_shift(2);\n    }\n\n    return o;\n  }\n\n  function parse_LABEL(blob, length, opts) {\n    var tgt = blob.l + length;\n    var o = parse_cell(blob, length, opts);\n    o[1].t = 's';\n\n    if (opts.vers == 0x5120) {\n      blob.l++;\n      var len = blob.read_shift(1);\n      o[1].v = blob.read_shift(len, 'utf8');\n      return o;\n    }\n\n    if (opts.qpro) blob.l++;\n    o[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n    return o;\n  }\n\n  function write_LABEL(R, C, s) {\n    /* TODO: encoding */\n    var o = new_buf(7 + s.length);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(1, 0x27); // ??\n\n    for (var i = 0; i < o.length; ++i) {\n      var cc = s.charCodeAt(i);\n      o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n    }\n\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  function parse_INTEGER(blob, length, opts) {\n    var o = parse_cell(blob, length, opts);\n    o[1].v = blob.read_shift(2, 'i');\n    return o;\n  }\n\n  function write_INTEGER(R, C, v) {\n    var o = new_buf(7);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(2, v, 'i');\n    return o;\n  }\n\n  function parse_NUMBER(blob, length, opts) {\n    var o = parse_cell(blob, length, opts);\n    o[1].v = blob.read_shift(8, 'f');\n    return o;\n  }\n\n  function write_NUMBER(R, C, v) {\n    var o = new_buf(13);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(8, v, 'f');\n    return o;\n  }\n\n  function parse_FORMULA(blob, length, opts) {\n    var tgt = blob.l + length;\n    var o = parse_cell(blob, length, opts);\n    /* TODO: formula */\n\n    o[1].v = blob.read_shift(8, 'f');\n    if (opts.qpro) blob.l = tgt;else {\n      var flen = blob.read_shift(2);\n      wk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n      blob.l += flen;\n    }\n    return o;\n  }\n\n  function wk1_parse_rc(B, V, col) {\n    var rel = V & 0x8000;\n    V &= ~0x8000;\n    V = (rel ? B : 0) + (V >= 0x2000 ? V - 0x4000 : V);\n    return (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n  }\n  /* var oprec = [\n  \t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n  \t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n  ]; */\n\n  /* TODO: flesh out */\n\n\n  var FuncTab = {\n    0x33: [\"FALSE\", 0],\n    0x34: [\"TRUE\", 0],\n    0x46: [\"LEN\", 1],\n    0x50: [\"SUM\", 69],\n    0x51: [\"AVERAGEA\", 69],\n    0x52: [\"COUNTA\", 69],\n    0x53: [\"MINA\", 69],\n    0x54: [\"MAXA\", 69],\n    0x6F: [\"T\", 1]\n  };\n  var BinOpTab = [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"\", \"+\", \"-\", \"*\", \"/\", \"^\", \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"<=\", \">=\", \"<\", \">\", \"\", \"\", \"\", \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"&\", \"\", \"\", \"\", \"\", \"\", \"\", \"\" // eslint-disable-line no-mixed-spaces-and-tabs\n  ];\n\n  function wk1_fmla_to_csf(blob, o) {\n    prep_blob(blob, 0);\n    var out = [],\n        argc = 0,\n        R = \"\",\n        C = \"\",\n        argL = \"\",\n        argR = \"\";\n\n    while (blob.l < blob.length) {\n      var cc = blob[blob.l++];\n\n      switch (cc) {\n        case 0x00:\n          out.push(blob.read_shift(8, 'f'));\n          break;\n\n        case 0x01:\n          {\n            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            out.push(C + R);\n          }\n          break;\n\n        case 0x02:\n          {\n            var c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            var r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            out.push(c + r + \":\" + C + R);\n          }\n          break;\n\n        case 0x03:\n          if (blob.l < blob.length) {\n            console.error(\"WK1 premature formula end\");\n            return;\n          }\n\n          break;\n\n        case 0x04:\n          out.push(\"(\" + out.pop() + \")\");\n          break;\n\n        case 0x05:\n          out.push(blob.read_shift(2));\n          break;\n\n        case 0x06:\n          {\n            /* TODO: text encoding */\n            var Z = \"\";\n\n            while (cc = blob[blob.l++]) {\n              Z += String.fromCharCode(cc);\n            }\n\n            out.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n          }\n          break;\n\n        case 0x08:\n          out.push(\"-\" + out.pop());\n          break;\n\n        case 0x17:\n          out.push(\"+\" + out.pop());\n          break;\n\n        case 0x16:\n          out.push(\"NOT(\" + out.pop() + \")\");\n          break;\n\n        case 0x14:\n        case 0x15:\n          {\n            argR = out.pop();\n            argL = out.pop();\n            out.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n          }\n          break;\n\n        default:\n          if (cc < 0x20 && BinOpTab[cc]) {\n            argR = out.pop();\n            argL = out.pop();\n            out.push(argL + BinOpTab[cc] + argR);\n          } else if (FuncTab[cc]) {\n            argc = FuncTab[cc][1];\n            if (argc == 69) argc = blob[blob.l++];\n\n            if (argc > out.length) {\n              console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\");\n              return;\n            }\n\n            var args = out.slice(-argc);\n            out.length -= argc;\n            out.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n          } else if (cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));else if (cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16)); // possible future functions ??\n          else return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\n      }\n    }\n\n    if (out.length == 1) o[1].f = \"\" + out[0];else console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n  }\n\n  function parse_cell_3(blob\n  /*::, length*/\n  ) {\n    var o = [{\n      c: 0,\n      r: 0\n    }, {\n      t: 'n',\n      v: 0\n    }, 0];\n    o[0].r = blob.read_shift(2);\n    o[3] = blob[blob.l++];\n    o[0].c = blob[blob.l++];\n    return o;\n  }\n\n  function parse_LABEL_16(blob, length) {\n    var o = parse_cell_3(blob);\n    o[1].t = 's';\n    o[1].v = blob.read_shift(length - 4, 'cstr');\n    return o;\n  }\n\n  function write_LABEL_16(R, C, wsidx, s) {\n    /* TODO: encoding */\n    var o = new_buf(6 + s.length);\n    o.write_shift(2, R);\n    o.write_shift(1, wsidx);\n    o.write_shift(1, C);\n    o.write_shift(1, 0x27);\n\n    for (var i = 0; i < s.length; ++i) {\n      var cc = s.charCodeAt(i);\n      o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n    }\n\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  function parse_NUMBER_18(blob, length) {\n    var o = parse_cell_3(blob);\n    o[1].v = blob.read_shift(2);\n    var v = o[1].v >> 1;\n\n    if (o[1].v & 0x1) {\n      switch (v & 0x07) {\n        case 0:\n          v = (v >> 3) * 5000;\n          break;\n\n        case 1:\n          v = (v >> 3) * 500;\n          break;\n\n        case 2:\n          v = (v >> 3) / 20;\n          break;\n\n        case 3:\n          v = (v >> 3) / 200;\n          break;\n\n        case 4:\n          v = (v >> 3) / 2000;\n          break;\n\n        case 5:\n          v = (v >> 3) / 20000;\n          break;\n\n        case 6:\n          v = (v >> 3) / 16;\n          break;\n\n        case 7:\n          v = (v >> 3) / 64;\n          break;\n      }\n    }\n\n    o[1].v = v;\n    return o;\n  }\n\n  function parse_NUMBER_17(blob, length) {\n    var o = parse_cell_3(blob);\n    var v1 = blob.read_shift(4);\n    var v2 = blob.read_shift(4);\n    var e = blob.read_shift(2);\n\n    if (e == 0xFFFF) {\n      if (v1 === 0 && v2 === 0xC0000000) {\n        o[1].t = \"e\";\n        o[1].v = 0x0F;\n      } // ERR -> #VALUE!\n      else if (v1 === 0 && v2 === 0xD0000000) {\n        o[1].t = \"e\";\n        o[1].v = 0x2A;\n      } // NA -> #N/A\n      else o[1].v = 0;\n\n      return o;\n    }\n\n    var s = e & 0x8000;\n    e = (e & 0x7FFF) - 16446;\n    o[1].v = (1 - s * 2) * (v2 * Math.pow(2, e + 32) + v1 * Math.pow(2, e));\n    return o;\n  }\n\n  function write_NUMBER_17(R, C, wsidx, v) {\n    var o = new_buf(14);\n    o.write_shift(2, R);\n    o.write_shift(1, wsidx);\n    o.write_shift(1, C);\n\n    if (v == 0) {\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(2, 0xFFFF);\n      return o;\n    }\n\n    var s = 0,\n        e = 0,\n        v1 = 0,\n        v2 = 0;\n\n    if (v < 0) {\n      s = 1;\n      v = -v;\n    }\n\n    e = Math.log2(v) | 0;\n    v /= Math.pow(2, e - 31);\n    v2 = v >>> 0;\n\n    if ((v2 & 0x80000000) == 0) {\n      v /= 2;\n      ++e;\n      v2 = v >>> 0;\n    }\n\n    v -= v2;\n    v2 |= 0x80000000;\n    v2 >>>= 0;\n    v *= Math.pow(2, 32);\n    v1 = v >>> 0;\n    o.write_shift(4, v1);\n    o.write_shift(4, v2);\n    e += 0x3FFF + (s ? 0x8000 : 0);\n    o.write_shift(2, e);\n    return o;\n  }\n\n  function parse_FORMULA_19(blob, length) {\n    var o = parse_NUMBER_17(blob);\n    blob.l += length - 14;\n    /* TODO: WK3 formula */\n\n    return o;\n  }\n\n  function parse_NUMBER_25(blob, length) {\n    var o = parse_cell_3(blob);\n    var v1 = blob.read_shift(4);\n    o[1].v = v1 >> 6;\n    return o;\n  }\n\n  function parse_NUMBER_27(blob, length) {\n    var o = parse_cell_3(blob);\n    var v1 = blob.read_shift(8, 'f');\n    o[1].v = v1;\n    return o;\n  }\n\n  function parse_FORMULA_28(blob, length) {\n    var o = parse_NUMBER_27(blob);\n    blob.l += length - 10;\n    /* TODO: formula */\n\n    return o;\n  }\n\n  function parse_SHEETNAMECS(blob, length) {\n    return blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n  }\n\n  function parse_SHEETNAMELP(blob, length) {\n    var len = blob[blob.l++];\n    if (len > length - 1) len = length - 1;\n    var o = \"\";\n\n    while (o.length < len) {\n      o += String.fromCharCode(blob[blob.l++]);\n    }\n\n    return o;\n  }\n\n  function parse_SHEETINFOQP(blob, length, opts) {\n    if (!opts.qpro || length < 21) return;\n    var id = blob.read_shift(1);\n    blob.l += 17;\n    blob.l += 1; //var len = blob.read_shift(1);\n\n    blob.l += 2;\n    var nm = blob.read_shift(length - 21, 'cstr');\n    return [id, nm];\n  }\n\n  function parse_XFORMAT(blob, length) {\n    var o = {},\n        tgt = blob.l + length;\n\n    while (blob.l < tgt) {\n      var dt = blob.read_shift(2);\n\n      if (dt == 0x36b0) {\n        o[dt] = [0, \"\"];\n        o[dt][0] = blob.read_shift(2);\n\n        while (blob[blob.l]) {\n          o[dt][1] += String.fromCharCode(blob[blob.l]);\n          blob.l++;\n        }\n\n        blob.l++;\n      } // TODO: 0x3a99 ??\n\n    }\n\n    return o;\n  }\n\n  function write_XFORMAT_SHEETNAME(name, wsidx) {\n    var out = new_buf(5 + name.length);\n    out.write_shift(2, 0x36b0);\n    out.write_shift(2, wsidx);\n\n    for (var i = 0; i < name.length; ++i) {\n      var cc = name.charCodeAt(i);\n      out[out.l++] = cc > 0x7F ? 0x5F : cc;\n    }\n\n    out[out.l++] = 0;\n    return out;\n  }\n\n  var WK1Enum = {\n    /*::[*/\n    0x0000\n    /*::]*/\n    : {\n      n: \"BOF\",\n      f: parseuint16\n    },\n\n    /*::[*/\n    0x0001\n    /*::]*/\n    : {\n      n: \"EOF\"\n    },\n\n    /*::[*/\n    0x0002\n    /*::]*/\n    : {\n      n: \"CALCMODE\"\n    },\n\n    /*::[*/\n    0x0003\n    /*::]*/\n    : {\n      n: \"CALCORDER\"\n    },\n\n    /*::[*/\n    0x0004\n    /*::]*/\n    : {\n      n: \"SPLIT\"\n    },\n\n    /*::[*/\n    0x0005\n    /*::]*/\n    : {\n      n: \"SYNC\"\n    },\n\n    /*::[*/\n    0x0006\n    /*::]*/\n    : {\n      n: \"RANGE\",\n      f: parse_RANGE\n    },\n\n    /*::[*/\n    0x0007\n    /*::]*/\n    : {\n      n: \"WINDOW1\"\n    },\n\n    /*::[*/\n    0x0008\n    /*::]*/\n    : {\n      n: \"COLW1\"\n    },\n\n    /*::[*/\n    0x0009\n    /*::]*/\n    : {\n      n: \"WINTWO\"\n    },\n\n    /*::[*/\n    0x000A\n    /*::]*/\n    : {\n      n: \"COLW2\"\n    },\n\n    /*::[*/\n    0x000B\n    /*::]*/\n    : {\n      n: \"NAME\"\n    },\n\n    /*::[*/\n    0x000C\n    /*::]*/\n    : {\n      n: \"BLANK\"\n    },\n\n    /*::[*/\n    0x000D\n    /*::]*/\n    : {\n      n: \"INTEGER\",\n      f: parse_INTEGER\n    },\n\n    /*::[*/\n    0x000E\n    /*::]*/\n    : {\n      n: \"NUMBER\",\n      f: parse_NUMBER\n    },\n\n    /*::[*/\n    0x000F\n    /*::]*/\n    : {\n      n: \"LABEL\",\n      f: parse_LABEL\n    },\n\n    /*::[*/\n    0x0010\n    /*::]*/\n    : {\n      n: \"FORMULA\",\n      f: parse_FORMULA\n    },\n\n    /*::[*/\n    0x0018\n    /*::]*/\n    : {\n      n: \"TABLE\"\n    },\n\n    /*::[*/\n    0x0019\n    /*::]*/\n    : {\n      n: \"ORANGE\"\n    },\n\n    /*::[*/\n    0x001A\n    /*::]*/\n    : {\n      n: \"PRANGE\"\n    },\n\n    /*::[*/\n    0x001B\n    /*::]*/\n    : {\n      n: \"SRANGE\"\n    },\n\n    /*::[*/\n    0x001C\n    /*::]*/\n    : {\n      n: \"FRANGE\"\n    },\n\n    /*::[*/\n    0x001D\n    /*::]*/\n    : {\n      n: \"KRANGE1\"\n    },\n\n    /*::[*/\n    0x0020\n    /*::]*/\n    : {\n      n: \"HRANGE\"\n    },\n\n    /*::[*/\n    0x0023\n    /*::]*/\n    : {\n      n: \"KRANGE2\"\n    },\n\n    /*::[*/\n    0x0024\n    /*::]*/\n    : {\n      n: \"PROTEC\"\n    },\n\n    /*::[*/\n    0x0025\n    /*::]*/\n    : {\n      n: \"FOOTER\"\n    },\n\n    /*::[*/\n    0x0026\n    /*::]*/\n    : {\n      n: \"HEADER\"\n    },\n\n    /*::[*/\n    0x0027\n    /*::]*/\n    : {\n      n: \"SETUP\"\n    },\n\n    /*::[*/\n    0x0028\n    /*::]*/\n    : {\n      n: \"MARGINS\"\n    },\n\n    /*::[*/\n    0x0029\n    /*::]*/\n    : {\n      n: \"LABELFMT\"\n    },\n\n    /*::[*/\n    0x002A\n    /*::]*/\n    : {\n      n: \"TITLES\"\n    },\n\n    /*::[*/\n    0x002B\n    /*::]*/\n    : {\n      n: \"SHEETJS\"\n    },\n\n    /*::[*/\n    0x002D\n    /*::]*/\n    : {\n      n: \"GRAPH\"\n    },\n\n    /*::[*/\n    0x002E\n    /*::]*/\n    : {\n      n: \"NGRAPH\"\n    },\n\n    /*::[*/\n    0x002F\n    /*::]*/\n    : {\n      n: \"CALCCOUNT\"\n    },\n\n    /*::[*/\n    0x0030\n    /*::]*/\n    : {\n      n: \"UNFORMATTED\"\n    },\n\n    /*::[*/\n    0x0031\n    /*::]*/\n    : {\n      n: \"CURSORW12\"\n    },\n\n    /*::[*/\n    0x0032\n    /*::]*/\n    : {\n      n: \"WINDOW\"\n    },\n\n    /*::[*/\n    0x0033\n    /*::]*/\n    : {\n      n: \"STRING\",\n      f: parse_LABEL\n    },\n\n    /*::[*/\n    0x0037\n    /*::]*/\n    : {\n      n: \"PASSWORD\"\n    },\n\n    /*::[*/\n    0x0038\n    /*::]*/\n    : {\n      n: \"LOCKED\"\n    },\n\n    /*::[*/\n    0x003C\n    /*::]*/\n    : {\n      n: \"QUERY\"\n    },\n\n    /*::[*/\n    0x003D\n    /*::]*/\n    : {\n      n: \"QUERYNAME\"\n    },\n\n    /*::[*/\n    0x003E\n    /*::]*/\n    : {\n      n: \"PRINT\"\n    },\n\n    /*::[*/\n    0x003F\n    /*::]*/\n    : {\n      n: \"PRINTNAME\"\n    },\n\n    /*::[*/\n    0x0040\n    /*::]*/\n    : {\n      n: \"GRAPH2\"\n    },\n\n    /*::[*/\n    0x0041\n    /*::]*/\n    : {\n      n: \"GRAPHNAME\"\n    },\n\n    /*::[*/\n    0x0042\n    /*::]*/\n    : {\n      n: \"ZOOM\"\n    },\n\n    /*::[*/\n    0x0043\n    /*::]*/\n    : {\n      n: \"SYMSPLIT\"\n    },\n\n    /*::[*/\n    0x0044\n    /*::]*/\n    : {\n      n: \"NSROWS\"\n    },\n\n    /*::[*/\n    0x0045\n    /*::]*/\n    : {\n      n: \"NSCOLS\"\n    },\n\n    /*::[*/\n    0x0046\n    /*::]*/\n    : {\n      n: \"RULER\"\n    },\n\n    /*::[*/\n    0x0047\n    /*::]*/\n    : {\n      n: \"NNAME\"\n    },\n\n    /*::[*/\n    0x0048\n    /*::]*/\n    : {\n      n: \"ACOMM\"\n    },\n\n    /*::[*/\n    0x0049\n    /*::]*/\n    : {\n      n: \"AMACRO\"\n    },\n\n    /*::[*/\n    0x004A\n    /*::]*/\n    : {\n      n: \"PARSE\"\n    },\n\n    /*::[*/\n    0x0066\n    /*::]*/\n    : {\n      n: \"PRANGES??\"\n    },\n\n    /*::[*/\n    0x0067\n    /*::]*/\n    : {\n      n: \"RRANGES??\"\n    },\n\n    /*::[*/\n    0x0068\n    /*::]*/\n    : {\n      n: \"FNAME??\"\n    },\n\n    /*::[*/\n    0x0069\n    /*::]*/\n    : {\n      n: \"MRANGES??\"\n    },\n\n    /*::[*/\n    0x00CC\n    /*::]*/\n    : {\n      n: \"SHEETNAMECS\",\n      f: parse_SHEETNAMECS\n    },\n\n    /*::[*/\n    0x00DE\n    /*::]*/\n    : {\n      n: \"SHEETNAMELP\",\n      f: parse_SHEETNAMELP\n    },\n\n    /*::[*/\n    0xFFFF\n    /*::]*/\n    : {\n      n: \"\"\n    }\n  };\n  var WK3Enum = {\n    /*::[*/\n    0x0000\n    /*::]*/\n    : {\n      n: \"BOF\"\n    },\n\n    /*::[*/\n    0x0001\n    /*::]*/\n    : {\n      n: \"EOF\"\n    },\n\n    /*::[*/\n    0x0002\n    /*::]*/\n    : {\n      n: \"PASSWORD\"\n    },\n\n    /*::[*/\n    0x0003\n    /*::]*/\n    : {\n      n: \"CALCSET\"\n    },\n\n    /*::[*/\n    0x0004\n    /*::]*/\n    : {\n      n: \"WINDOWSET\"\n    },\n\n    /*::[*/\n    0x0005\n    /*::]*/\n    : {\n      n: \"SHEETCELLPTR\"\n    },\n\n    /*::[*/\n    0x0006\n    /*::]*/\n    : {\n      n: \"SHEETLAYOUT\"\n    },\n\n    /*::[*/\n    0x0007\n    /*::]*/\n    : {\n      n: \"COLUMNWIDTH\"\n    },\n\n    /*::[*/\n    0x0008\n    /*::]*/\n    : {\n      n: \"HIDDENCOLUMN\"\n    },\n\n    /*::[*/\n    0x0009\n    /*::]*/\n    : {\n      n: \"USERRANGE\"\n    },\n\n    /*::[*/\n    0x000A\n    /*::]*/\n    : {\n      n: \"SYSTEMRANGE\"\n    },\n\n    /*::[*/\n    0x000B\n    /*::]*/\n    : {\n      n: \"ZEROFORCE\"\n    },\n\n    /*::[*/\n    0x000C\n    /*::]*/\n    : {\n      n: \"SORTKEYDIR\"\n    },\n\n    /*::[*/\n    0x000D\n    /*::]*/\n    : {\n      n: \"FILESEAL\"\n    },\n\n    /*::[*/\n    0x000E\n    /*::]*/\n    : {\n      n: \"DATAFILLNUMS\"\n    },\n\n    /*::[*/\n    0x000F\n    /*::]*/\n    : {\n      n: \"PRINTMAIN\"\n    },\n\n    /*::[*/\n    0x0010\n    /*::]*/\n    : {\n      n: \"PRINTSTRING\"\n    },\n\n    /*::[*/\n    0x0011\n    /*::]*/\n    : {\n      n: \"GRAPHMAIN\"\n    },\n\n    /*::[*/\n    0x0012\n    /*::]*/\n    : {\n      n: \"GRAPHSTRING\"\n    },\n\n    /*::[*/\n    0x0013\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0014\n    /*::]*/\n    : {\n      n: \"ERRCELL\"\n    },\n\n    /*::[*/\n    0x0015\n    /*::]*/\n    : {\n      n: \"NACELL\"\n    },\n\n    /*::[*/\n    0x0016\n    /*::]*/\n    : {\n      n: \"LABEL16\",\n      f: parse_LABEL_16\n    },\n\n    /*::[*/\n    0x0017\n    /*::]*/\n    : {\n      n: \"NUMBER17\",\n      f: parse_NUMBER_17\n    },\n\n    /*::[*/\n    0x0018\n    /*::]*/\n    : {\n      n: \"NUMBER18\",\n      f: parse_NUMBER_18\n    },\n\n    /*::[*/\n    0x0019\n    /*::]*/\n    : {\n      n: \"FORMULA19\",\n      f: parse_FORMULA_19\n    },\n\n    /*::[*/\n    0x001A\n    /*::]*/\n    : {\n      n: \"FORMULA1A\"\n    },\n\n    /*::[*/\n    0x001B\n    /*::]*/\n    : {\n      n: \"XFORMAT\",\n      f: parse_XFORMAT\n    },\n\n    /*::[*/\n    0x001C\n    /*::]*/\n    : {\n      n: \"DTLABELMISC\"\n    },\n\n    /*::[*/\n    0x001D\n    /*::]*/\n    : {\n      n: \"DTLABELCELL\"\n    },\n\n    /*::[*/\n    0x001E\n    /*::]*/\n    : {\n      n: \"GRAPHWINDOW\"\n    },\n\n    /*::[*/\n    0x001F\n    /*::]*/\n    : {\n      n: \"CPA\"\n    },\n\n    /*::[*/\n    0x0020\n    /*::]*/\n    : {\n      n: \"LPLAUTO\"\n    },\n\n    /*::[*/\n    0x0021\n    /*::]*/\n    : {\n      n: \"QUERY\"\n    },\n\n    /*::[*/\n    0x0022\n    /*::]*/\n    : {\n      n: \"HIDDENSHEET\"\n    },\n\n    /*::[*/\n    0x0023\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0025\n    /*::]*/\n    : {\n      n: \"NUMBER25\",\n      f: parse_NUMBER_25\n    },\n\n    /*::[*/\n    0x0026\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0027\n    /*::]*/\n    : {\n      n: \"NUMBER27\",\n      f: parse_NUMBER_27\n    },\n\n    /*::[*/\n    0x0028\n    /*::]*/\n    : {\n      n: \"FORMULA28\",\n      f: parse_FORMULA_28\n    },\n\n    /*::[*/\n    0x008E\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0093\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0096\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0097\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0098\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0099\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009B\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00A3\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00AE\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00AF\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B0\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B1\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B8\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B9\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BA\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BB\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BC\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00C3\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00C9\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CC\n    /*::]*/\n    : {\n      n: \"SHEETNAMECS\",\n      f: parse_SHEETNAMECS\n    },\n\n    /*::[*/\n    0x00CD\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CE\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CF\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00D0\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0100\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0103\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0104\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0105\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0106\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0107\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0109\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010B\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010E\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010F\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0180\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0185\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0186\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0189\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x018C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0200\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0202\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0201\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0204\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0205\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0280\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0281\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0282\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0283\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0284\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0285\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0286\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0287\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0288\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0292\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0293\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0294\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0295\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0296\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0299\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x029A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0300\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0304\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0601\n    /*::]*/\n    : {\n      n: \"SHEETINFOQP\",\n      f: parse_SHEETINFOQP\n    },\n\n    /*::[*/\n    0x0640\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0642\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0701\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0702\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0703\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0704\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0780\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0800\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0801\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0804\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0A80\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x2AF6\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x3231\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x6E49\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x6F44\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0xFFFF\n    /*::]*/\n    : {\n      n: \"\"\n    }\n  };\n  return {\n    sheet_to_wk1: sheet_to_wk1,\n    book_to_wk3: book_to_wk3,\n    to_workbook: lotus_to_workbook\n  };\n}();\n/* 18.4.7 rPr CT_RPrElt */\n\n\nfunction parse_rpr(rpr) {\n  var font = {},\n      m = rpr.match(tagregex),\n      i = 0;\n  var pass = false;\n  if (m) for (; i != m.length; ++i) {\n    var y = parsexmltag(m[i]);\n\n    switch (y[0].replace(/\\w*:/g, \"\")) {\n      /* 18.8.12 condense CT_BooleanProperty */\n\n      /* ** not required . */\n      case '<condense':\n        break;\n\n      /* 18.8.17 extend CT_BooleanProperty */\n\n      /* ** not required . */\n\n      case '<extend':\n        break;\n\n      /* 18.8.36 shadow CT_BooleanProperty */\n\n      /* ** not required . */\n\n      case '<shadow':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<shadow>':\n      case '<shadow/>':\n        font.shadow = 1;\n        break;\n\n      case '</shadow>':\n        break;\n\n      /* 18.4.1 charset CT_IntProperty TODO */\n\n      case '<charset':\n        if (y.val == '1') break;\n        font.cp = CS2CP[parseInt(y.val, 10)];\n        break;\n\n      /* 18.4.2 outline CT_BooleanProperty TODO */\n\n      case '<outline':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<outline>':\n      case '<outline/>':\n        font.outline = 1;\n        break;\n\n      case '</outline>':\n        break;\n\n      /* 18.4.5 rFont CT_FontName */\n\n      case '<rFont':\n        font.name = y.val;\n        break;\n\n      /* 18.4.11 sz CT_FontSize */\n\n      case '<sz':\n        font.sz = y.val;\n        break;\n\n      /* 18.4.10 strike CT_BooleanProperty */\n\n      case '<strike':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<strike>':\n      case '<strike/>':\n        font.strike = 1;\n        break;\n\n      case '</strike>':\n        break;\n\n      /* 18.4.13 u CT_UnderlineProperty */\n\n      case '<u':\n        if (!y.val) break;\n\n        switch (y.val) {\n          case 'double':\n            font.uval = \"double\";\n            break;\n\n          case 'singleAccounting':\n            font.uval = \"single-accounting\";\n            break;\n\n          case 'doubleAccounting':\n            font.uval = \"double-accounting\";\n            break;\n        }\n\n      /* falls through */\n\n      case '<u>':\n      case '<u/>':\n        font.u = 1;\n        break;\n\n      case '</u>':\n        break;\n\n      /* 18.8.2 b */\n\n      case '<b':\n        if (y.val == '0') break;\n\n      /* falls through */\n\n      case '<b>':\n      case '<b/>':\n        font.b = 1;\n        break;\n\n      case '</b>':\n        break;\n\n      /* 18.8.26 i */\n\n      case '<i':\n        if (y.val == '0') break;\n\n      /* falls through */\n\n      case '<i>':\n      case '<i/>':\n        font.i = 1;\n        break;\n\n      case '</i>':\n        break;\n\n      /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\n      case '<color':\n        if (y.rgb) font.color = y.rgb.slice(2, 8);\n        break;\n\n      case '<color>':\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* 18.8.18 family ST_FontFamily */\n\n      case '<family':\n        font.family = y.val;\n        break;\n\n      case '<family>':\n      case '<family/>':\n      case '</family>':\n        break;\n\n      /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\n      case '<vertAlign':\n        font.valign = y.val;\n        break;\n\n      case '<vertAlign>':\n      case '<vertAlign/>':\n      case '</vertAlign>':\n        break;\n\n      /* 18.8.35 scheme CT_FontScheme TODO */\n\n      case '<scheme':\n        break;\n\n      case '<scheme>':\n      case '<scheme/>':\n      case '</scheme>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n    }\n  }\n  return font;\n}\n\nvar parse_rs = /*#__PURE__*/function () {\n  var tregex = matchtag(\"t\"),\n      rpregex = matchtag(\"rPr\");\n  /* 18.4.4 r CT_RElt */\n\n  function parse_r(r) {\n    /* 18.4.12 t ST_Xstring */\n    var t = r.match(tregex)\n    /*, cp = 65001*/\n    ;\n    if (!t) return {\n      t: \"s\",\n      v: \"\"\n    };\n    var o\n    /*:Cell*/\n    = {\n      t: 's',\n      v: unescapexml(t[1])\n    }\n    /*:any*/\n    ;\n    var rpr = r.match(rpregex);\n    if (rpr) o.s = parse_rpr(rpr[1]);\n    return o;\n  }\n\n  var rregex = /<(?:\\w+:)?r>/g,\n      rend = /<\\/(?:\\w+:)?r>/;\n  return function parse_rs(rs) {\n    return rs.replace(rregex, \"\").split(rend).map(parse_r).filter(function (r) {\n      return r.v;\n    });\n  };\n}();\n/* Parse a list of <r> tags */\n\n\nvar rs_to_html = /*#__PURE__*/function parse_rs_factory() {\n  var nlregex = /(\\r\\n|\\n)/g;\n\n  function parse_rpr2(font, intro, outro) {\n    var style\n    /*:Array<string>*/\n    = [];\n    if (font.u) style.push(\"text-decoration: underline;\");\n    if (font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n    if (font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n    if (font.outline) style.push(\"text-effect: outline;\");\n    if (font.shadow) style.push(\"text-shadow: auto;\");\n    intro.push('<span style=\"' + style.join(\"\") + '\">');\n\n    if (font.b) {\n      intro.push(\"<b>\");\n      outro.push(\"</b>\");\n    }\n\n    if (font.i) {\n      intro.push(\"<i>\");\n      outro.push(\"</i>\");\n    }\n\n    if (font.strike) {\n      intro.push(\"<s>\");\n      outro.push(\"</s>\");\n    }\n\n    var align = font.valign || \"\";\n    if (align == \"superscript\" || align == \"super\") align = \"sup\";else if (align == \"subscript\") align = \"sub\";\n\n    if (align != \"\") {\n      intro.push(\"<\" + align + \">\");\n      outro.push(\"</\" + align + \">\");\n    }\n\n    outro.push(\"</span>\");\n    return font;\n  }\n  /* 18.4.4 r CT_RElt */\n\n\n  function r_to_html(r) {\n    var terms\n    /*:[Array<string>, string, Array<string>]*/\n    = [[], r.v, []];\n    if (!r.v) return \"\";\n    if (r.s) parse_rpr2(r.s, terms[0], terms[2]);\n    return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\n  }\n\n  return function parse_rs(rs) {\n    return rs.map(r_to_html).join(\"\");\n  };\n}();\n/* 18.4.8 si CT_Rst */\n\n\nvar sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g,\n    sirregex = /<(?:\\w+:)?r>/;\nvar sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\n\nfunction parse_si(x, opts) {\n  var html = opts ? opts.cellHTML : true;\n  var z = {};\n  if (!x) return {\n    t: \"\"\n  }; //var y;\n\n  /* 18.4.12 t ST_Xstring (Plaintext String) */\n  // TODO: is whitespace actually valid here?\n\n  if (x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n    z.t = unescapexml(utf8read(x.slice(x.indexOf(\">\") + 1).split(/<\\/(?:\\w+:)?t>/)[0] || \"\"));\n    z.r = utf8read(x);\n    if (html) z.h = escapehtml(z.t);\n  }\n  /* 18.4.4 r CT_RElt (Rich Text Run) */\n  else if (\n  /*y = */\n  x.match(sirregex)) {\n    z.r = utf8read(x);\n    z.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex) || []).join(\"\").replace(tagregex, \"\")));\n    if (html) z.h = rs_to_html(parse_rs(z.r));\n  }\n  /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\n  /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\n\n  return z;\n}\n/* 18.4 Shared String Table */\n\n\nvar sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\n\nfunction parse_sst_xml(data\n/*:string*/\n, opts)\n/*:SST*/\n{\n  var s\n  /*:SST*/\n  = []\n  /*:any*/\n  ,\n      ss = \"\";\n  if (!data) return s;\n  /* 18.4.9 sst CT_Sst */\n\n  var sst = data.match(sstr0);\n\n  if (sst) {\n    ss = sst[2].replace(sstr1, \"\").split(sstr2);\n\n    for (var i = 0; i != ss.length; ++i) {\n      var o = parse_si(ss[i].trim(), opts);\n      if (o != null) s[s.length] = o;\n    }\n\n    sst = parsexmltag(sst[1]);\n    s.Count = sst.count;\n    s.Unique = sst.uniqueCount;\n  }\n\n  return s;\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\n\n\nfunction parse_BrtBeginSst(data) {\n  return [data.read_shift(4), data.read_shift(4)];\n}\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\n\n\nfunction parse_sst_bin(data, opts)\n/*:SST*/\n{\n  var s\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n  var pass = false;\n  recordhopper(data, function hopper_sst(val, R, RT) {\n    switch (RT) {\n      case 0x009F:\n        /* BrtBeginSst */\n        s.Count = val[0];\n        s.Unique = val[1];\n        break;\n\n      case 0x0013:\n        /* BrtSSTItem */\n        s.push(val);\n        break;\n\n      case 0x00A0:\n        /* BrtEndSst */\n        return true;\n\n      case 0x0023:\n        /* BrtFRTBegin */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* BrtFRTEnd */\n        pass = false;\n        break;\n\n      default:\n        if (R.T) ;\n        if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return s;\n}\n\nfunction _JS2ANSI(str\n/*:string*/\n)\n/*:Array<number>*/\n{\n  var o\n  /*:Array<number>*/\n  = [],\n      oo = str.split(\"\");\n\n  for (var i = 0; i < oo.length; ++i) {\n    o[i] = oo[i].charCodeAt(0);\n  }\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.4 Version */\n\n\nfunction parse_CRYPTOVersion(blob, length\n/*:?number*/\n) {\n  var o\n  /*:any*/\n  = {};\n  o.Major = blob.read_shift(2);\n  o.Minor = blob.read_shift(2);\n  /*:: if(length == null) return o; */\n\n  if (length >= 4) blob.l += length - 4;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\n\n\nfunction parse_DataSpaceVersionInfo(blob) {\n  var o = {};\n  o.id = blob.read_shift(0, 'lpp4');\n  o.R = parse_CRYPTOVersion(blob, 4);\n  o.U = parse_CRYPTOVersion(blob, 4);\n  o.W = parse_CRYPTOVersion(blob, 4);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\n\n\nfunction parse_DataSpaceMapEntry(blob) {\n  var len = blob.read_shift(4);\n  var end = blob.l + len - 4;\n  var o = {};\n  var cnt = blob.read_shift(4);\n  var comps\n  /*:Array<{t:number, v:string}>*/\n  = [];\n  /* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\n  while (cnt-- > 0) {\n    comps.push({\n      t: blob.read_shift(4),\n      v: blob.read_shift(0, 'lpp4')\n    });\n  }\n\n  o.name = blob.read_shift(0, 'lpp4');\n  o.comps = comps;\n  if (blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\n\n\nfunction parse_DataSpaceMap(blob) {\n  var o = [];\n  blob.l += 4; // must be 0x8\n\n  var cnt = blob.read_shift(4);\n\n  while (cnt-- > 0) {\n    o.push(parse_DataSpaceMapEntry(blob));\n  }\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\n\n\nfunction parse_DataSpaceDefinition(blob)\n/*:Array<string>*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n  blob.l += 4; // must be 0x8\n\n  var cnt = blob.read_shift(4);\n\n  while (cnt-- > 0) {\n    o.push(blob.read_shift(0, 'lpp4'));\n  }\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\n\n\nfunction parse_TransformInfoHeader(blob) {\n  var o = {};\n  /*var len = */\n\n  blob.read_shift(4);\n  blob.l += 4; // must be 0x1\n\n  o.id = blob.read_shift(0, 'lpp4');\n  o.name = blob.read_shift(0, 'lpp4');\n  o.R = parse_CRYPTOVersion(blob, 4);\n  o.U = parse_CRYPTOVersion(blob, 4);\n  o.W = parse_CRYPTOVersion(blob, 4);\n  return o;\n}\n\nfunction parse_Primary(blob) {\n  /* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n  var hdr = parse_TransformInfoHeader(blob);\n  /* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\n  hdr.ename = blob.read_shift(0, '8lpp4');\n  hdr.blksz = blob.read_shift(4);\n  hdr.cmode = blob.read_shift(4);\n  if (blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n  return hdr;\n}\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n\n\nfunction parse_EncryptionHeader(blob, length\n/*:number*/\n) {\n  var tgt = blob.l + length;\n  var o = {};\n  o.Flags = blob.read_shift(4) & 0x3F;\n  blob.l += 4;\n  o.AlgID = blob.read_shift(4);\n  var valid = false;\n\n  switch (o.AlgID) {\n    case 0x660E:\n    case 0x660F:\n    case 0x6610:\n      valid = o.Flags == 0x24;\n      break;\n\n    case 0x6801:\n      valid = o.Flags == 0x04;\n      break;\n\n    case 0:\n      valid = o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24;\n      break;\n\n    default:\n      throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n  }\n\n  if (!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n  o.AlgIDHash = blob.read_shift(4);\n  o.KeySize = blob.read_shift(4);\n  o.ProviderType = blob.read_shift(4);\n  blob.l += 8;\n  o.CSPName = blob.read_shift(tgt - blob.l >> 1, 'utf16le');\n  blob.l = tgt;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n\n\nfunction parse_EncryptionVerifier(blob, length\n/*:number*/\n) {\n  var o = {},\n      tgt = blob.l + length;\n  blob.l += 4; // SaltSize must be 0x10\n\n  o.Salt = blob.slice(blob.l, blob.l + 16);\n  blob.l += 16;\n  o.Verifier = blob.slice(blob.l, blob.l + 16);\n  blob.l += 16;\n  /*var sz = */\n\n  blob.read_shift(4);\n  o.VerifierHash = blob.slice(blob.l, tgt);\n  blob.l = tgt;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\n\n\nfunction parse_EncryptionInfo(blob) {\n  var vers = parse_CRYPTOVersion(blob);\n\n  switch (vers.Minor) {\n    case 0x02:\n      return [vers.Minor, parse_EncInfoStd(blob)];\n\n    case 0x03:\n      return [vers.Minor, parse_EncInfoExt()];\n\n    case 0x04:\n      return [vers.Minor, parse_EncInfoAgl(blob)];\n  }\n\n  throw new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\n\n\nfunction parse_EncInfoStd(blob\n/*::, vers*/\n) {\n  var flags = blob.read_shift(4);\n  if ((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n  var sz = blob.read_shift(4); //var tgt = blob.l + sz;\n\n  var hdr = parse_EncryptionHeader(blob, sz);\n  var verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n  return {\n    t: \"Std\",\n    h: hdr,\n    v: verifier\n  };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\n\n\nfunction\n  /*::blob, vers*/\nparse_EncInfoExt() {\n  throw new Error(\"File is password-protected: ECMA-376 Extensible\");\n}\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\n\n\nfunction parse_EncInfoAgl(blob\n/*::, vers*/\n) {\n  var KeyData = [\"saltSize\", \"blockSize\", \"keyBits\", \"hashSize\", \"cipherAlgorithm\", \"cipherChaining\", \"hashAlgorithm\", \"saltValue\"];\n  blob.l += 4;\n  var xml = blob.read_shift(blob.length - blob.l, 'utf8');\n  var o = {};\n  xml.replace(tagregex, function xml_agile(x) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      case '<encryption':\n      case '</encryption>':\n        break;\n\n      case '<keyData':\n        KeyData.forEach(function (k) {\n          o[k] = y[k];\n        });\n        break;\n\n      case '<dataIntegrity':\n        o.encryptedHmacKey = y.encryptedHmacKey;\n        o.encryptedHmacValue = y.encryptedHmacValue;\n        break;\n\n      case '<keyEncryptors>':\n      case '<keyEncryptors':\n        o.encs = [];\n        break;\n\n      case '</keyEncryptors>':\n        break;\n\n      case '<keyEncryptor':\n        o.uri = y.uri;\n        break;\n\n      case '</keyEncryptor>':\n        break;\n\n      case '<encryptedKey':\n        o.encs.push(y);\n        break;\n\n      default:\n        throw y[0];\n    }\n  });\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n\n\nfunction parse_RC4CryptoHeader(blob, length\n/*:number*/\n) {\n  var o = {};\n  var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n  length -= 4;\n  if (vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n  if (vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n  o.Flags = blob.read_shift(4);\n  length -= 4;\n  var sz = blob.read_shift(4);\n  length -= 4;\n  o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n  length -= sz;\n  o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n\n\nfunction parse_RC4Header(blob\n/*::, length*/\n) {\n  var o = {};\n  var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n  if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n  o.Salt = blob.read_shift(16);\n  o.EncryptedVerifier = blob.read_shift(16);\n  o.EncryptedVerifierHash = blob.read_shift(16);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n\n\nfunction crypto_CreatePasswordVerifier_Method1(Password\n/*:string*/\n) {\n  var Verifier = 0x0000,\n      PasswordArray;\n\n  var PasswordDecoded = _JS2ANSI(Password);\n\n  var len = PasswordDecoded.length + 1,\n      i,\n      PasswordByte;\n  var Intermediate1, Intermediate2, Intermediate3;\n  PasswordArray = new_raw_buf(len);\n  PasswordArray[0] = PasswordDecoded.length;\n\n  for (i = 1; i != len; ++i) {\n    PasswordArray[i] = PasswordDecoded[i - 1];\n  }\n\n  for (i = len - 1; i >= 0; --i) {\n    PasswordByte = PasswordArray[i];\n    Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n    Intermediate2 = Verifier << 1 & 0x7FFF;\n    Intermediate3 = Intermediate1 | Intermediate2;\n    Verifier = Intermediate3 ^ PasswordByte;\n  }\n\n  return Verifier ^ 0xCE4B;\n}\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n\n\nvar crypto_CreateXorArray_Method1 = /*#__PURE__*/function () {\n  var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n  var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n  var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\n  var Ror = function Ror(Byte) {\n    return (Byte / 2 | Byte * 128) & 0xFF;\n  };\n\n  var XorRor = function XorRor(byte1, byte2) {\n    return Ror(byte1 ^ byte2);\n  };\n\n  var CreateXorKey_Method1 = function CreateXorKey_Method1(Password) {\n    var XorKey = InitialCode[Password.length - 1];\n    var CurrentElement = 0x68;\n\n    for (var i = Password.length - 1; i >= 0; --i) {\n      var Char = Password[i];\n\n      for (var j = 0; j != 7; ++j) {\n        if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n        Char *= 2;\n        --CurrentElement;\n      }\n    }\n\n    return XorKey;\n  };\n\n  return function (password\n  /*:string*/\n  ) {\n    var Password = _JS2ANSI(password);\n\n    var XorKey = CreateXorKey_Method1(Password);\n    var Index = Password.length;\n    var ObfuscationArray = new_raw_buf(16);\n\n    for (var i = 0; i != 16; ++i) {\n      ObfuscationArray[i] = 0x00;\n    }\n\n    var Temp, PasswordLastChar, PadIndex;\n\n    if ((Index & 1) === 1) {\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n      --Index;\n      Temp = XorKey & 0xFF;\n      PasswordLastChar = Password[Password.length - 1];\n      ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n    }\n\n    while (Index > 0) {\n      --Index;\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      --Index;\n      Temp = XorKey & 0xFF;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n    }\n\n    Index = 15;\n    PadIndex = 15 - Password.length;\n\n    while (PadIndex > 0) {\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n      --Index;\n      --PadIndex;\n      Temp = XorKey & 0xFF;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      --Index;\n      --PadIndex;\n    }\n\n    return ObfuscationArray;\n  };\n}();\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n\n\nvar crypto_DecryptData_Method1 = function crypto_DecryptData_Method1(password\n/*:string*/\n, Data, XorArrayIndex, XorArray, O) {\n  /* If XorArray is set, use it; if O is not set, make changes in-place */\n  if (!O) O = Data;\n  if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n  var Index, Value;\n\n  for (Index = 0; Index != Data.length; ++Index) {\n    Value = Data[Index];\n    Value ^= XorArray[XorArrayIndex];\n    Value = (Value >> 5 | Value << 3) & 0xFF;\n    O[Index] = Value;\n    ++XorArrayIndex;\n  }\n\n  return [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function crypto_MakeXorDecryptor(password\n/*:string*/\n) {\n  var XorArrayIndex = 0,\n      XorArray = crypto_CreateXorArray_Method1(password);\n  return function (Data) {\n    var O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n    XorArrayIndex = O[1];\n    return O[0];\n  };\n};\n/* 2.5.343 */\n\n\nfunction parse_XORObfuscation(blob, length, opts, out) {\n  var o = {\n    key: parseuint16(blob),\n    verificationBytes: parseuint16(blob)\n  }\n  /*:any*/\n  ;\n  if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n  out.valid = o.verificationBytes === o.verifier;\n  if (out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n  return o;\n}\n/* 2.4.117 */\n\n\nfunction parse_FilePassHeader(blob, length\n/*:number*/\n, oo) {\n  var o = oo || {};\n  o.Info = blob.read_shift(2);\n  blob.l -= 2;\n  if (o.Info === 1) o.Data = parse_RC4Header(blob);else o.Data = parse_RC4CryptoHeader(blob, length);\n  return o;\n}\n\nfunction parse_FilePass(blob, length\n/*:number*/\n, opts) {\n  var o = {\n    Type: opts.biff >= 8 ? blob.read_shift(2) : 0\n  }\n  /*:any*/\n  ;\n  /* wEncryptionType */\n\n  if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n  return o;\n}\n\nvar RTF = /*#__PURE__*/function () {\n  function rtf_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return rtf_to_sheet_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return rtf_to_sheet_str(d, opts);\n\n      case 'buffer':\n        return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return rtf_to_sheet_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n  /* TODO: this is a stub */\n\n\n  function rtf_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    var ws\n    /*:Worksheet*/\n    = o.dense ? []\n    /*:any*/\n    : {}\n    /*:any*/\n    ;\n    var rows = str.match(/\\\\trowd.*?\\\\row\\b/g);\n    if (!rows.length) throw new Error(\"RTF missing table\");\n    var range\n    /*:Range*/\n    = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: rows.length - 1\n      }\n    }\n    /*:any*/\n    ;\n    rows.forEach(function (rowtf, R) {\n      if (Array.isArray(ws)) ws[R] = [];\n      var rtfre = /\\\\\\w+\\b/g;\n      var last_index = 0;\n      var res;\n      var C = -1;\n\n      while (res = rtfre.exec(rowtf)) {\n        switch (res[0]) {\n          case \"\\\\cell\":\n            var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n            if (data[0] == \" \") data = data.slice(1);\n            ++C;\n\n            if (data.length) {\n              // TODO: value parsing, including codepage adjustments\n              var cell = {\n                v: data,\n                t: \"s\"\n              };\n              if (Array.isArray(ws)) ws[R][C] = cell;else ws[encode_cell({\n                r: R,\n                c: C\n              })] = cell;\n            }\n\n            break;\n        }\n\n        last_index = rtfre.lastIndex;\n      }\n\n      if (C > range.e.c) range.e.c = C;\n    });\n    ws['!ref'] = encode_range(range);\n    return ws;\n  }\n\n  function rtf_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(rtf_to_sheet(d, opts), opts);\n  }\n  /* TODO: this is a stub */\n\n\n  function sheet_to_rtf(ws\n  /*:Worksheet*/\n\n  /*::, opts*/\n  )\n  /*:string*/\n  {\n    var o = [\"{\\\\rtf1\\\\ansi\"];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      o.push(\"\\\\trowd\\\\trautofit1\");\n\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        o.push(\"\\\\cellx\" + (C + 1));\n      }\n\n      o.push(\"\\\\pard\\\\intbl\");\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n        o.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\n        o.push(\"\\\\cell\");\n      }\n\n      o.push(\"\\\\pard\\\\intbl\\\\row\");\n    }\n\n    return o.join(\"\") + \"}\";\n  }\n\n  return {\n    to_workbook: rtf_to_workbook,\n    to_sheet: rtf_to_sheet,\n    from_sheet: sheet_to_rtf\n  };\n}();\n\nfunction hex2RGB(h) {\n  var o = h.slice(h[0] === \"#\" ? 1 : 0).slice(0, 6);\n  return [parseInt(o.slice(0, 2), 16), parseInt(o.slice(2, 4), 16), parseInt(o.slice(4, 6), 16)];\n}\n\nfunction rgb2Hex(rgb) {\n  for (var i = 0, o = 1; i != 3; ++i) {\n    o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n  }\n\n  return o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n  var R = rgb[0] / 255,\n      G = rgb[1] / 255,\n      B = rgb[2] / 255;\n  var M = Math.max(R, G, B),\n      m = Math.min(R, G, B),\n      C = M - m;\n  if (C === 0) return [0, 0, R];\n  var H6 = 0,\n      S = 0,\n      L2 = M + m;\n  S = C / (L2 > 1 ? 2 - L2 : L2);\n\n  switch (M) {\n    case R:\n      H6 = ((G - B) / C + 6) % 6;\n      break;\n\n    case G:\n      H6 = (B - R) / C + 2;\n      break;\n\n    case B:\n      H6 = (R - G) / C + 4;\n      break;\n  }\n\n  return [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl) {\n  var H = hsl[0],\n      S = hsl[1],\n      L = hsl[2];\n  var C = S * 2 * (L < 0.5 ? L : 1 - L),\n      m = L - C / 2;\n  var rgb = [m, m, m],\n      h6 = 6 * H;\n  var X;\n  if (S !== 0) switch (h6 | 0) {\n    case 0:\n    case 6:\n      X = C * h6;\n      rgb[0] += C;\n      rgb[1] += X;\n      break;\n\n    case 1:\n      X = C * (2 - h6);\n      rgb[0] += X;\n      rgb[1] += C;\n      break;\n\n    case 2:\n      X = C * (h6 - 2);\n      rgb[1] += C;\n      rgb[2] += X;\n      break;\n\n    case 3:\n      X = C * (4 - h6);\n      rgb[1] += X;\n      rgb[2] += C;\n      break;\n\n    case 4:\n      X = C * (h6 - 4);\n      rgb[2] += C;\n      rgb[0] += X;\n      break;\n\n    case 5:\n      X = C * (6 - h6);\n      rgb[2] += X;\n      rgb[0] += C;\n      break;\n  }\n\n  for (var i = 0; i != 3; ++i) {\n    rgb[i] = Math.round(rgb[i] * 255);\n  }\n\n  return rgb;\n}\n/* 18.8.3 bgColor tint algorithm */\n\n\nfunction rgb_tint(hex, tint) {\n  if (tint === 0) return hex;\n  var hsl = rgb2HSL(hex2RGB(hex));\n  if (tint < 0) hsl[2] = hsl[2] * (1 + tint);else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n  return rgb2Hex(hsl2RGB(hsl));\n}\n/* 18.3.1.13 width calculations */\n\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\n\n\nvar DEF_MDW = 6,\n    MAX_MDW = 15,\n    MIN_MDW = 1,\n    MDW = DEF_MDW;\n\nfunction width2px(width) {\n  return Math.floor((width + Math.round(128 / MDW) / 256) * MDW);\n}\n\nfunction px2char(px) {\n  return Math.floor((px - 5) / MDW * 100 + 0.5) / 100;\n}\n\nfunction char2width(chr) {\n  return Math.round((chr * MDW + 5) / MDW * 256) / 256;\n} //function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\n\n\nfunction cycle_width(collw) {\n  return char2width(px2char(width2px(collw)));\n}\n/* XLSX/XLSB/XLS specify width in units of MDW */\n\n\nfunction find_mdw_colw(collw) {\n  var delta = Math.abs(collw - cycle_width(collw)),\n      _MDW = MDW;\n  if (delta > 0.005) for (MDW = MIN_MDW; MDW < MAX_MDW; ++MDW) {\n    if (Math.abs(collw - cycle_width(collw)) <= delta) {\n      delta = Math.abs(collw - cycle_width(collw));\n      _MDW = MDW;\n    }\n  }\n  MDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\n\nfunction process_col(coll\n/*:ColInfo*/\n) {\n  if (coll.width) {\n    coll.wpx = width2px(coll.width);\n    coll.wch = px2char(coll.wpx);\n    coll.MDW = MDW;\n  } else if (coll.wpx) {\n    coll.wch = px2char(coll.wpx);\n    coll.width = char2width(coll.wch);\n    coll.MDW = MDW;\n  } else if (typeof coll.wch == 'number') {\n    coll.width = char2width(coll.wch);\n    coll.wpx = width2px(coll.width);\n    coll.MDW = MDW;\n  }\n\n  if (coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96,\n    PPI = DEF_PPI;\n\nfunction px2pt(px) {\n  return px * 96 / PPI;\n}\n\nfunction pt2px(pt) {\n  return pt * PPI / 96;\n}\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n\n\nvar XLMLPatternTypeMap = {\n  \"None\": \"none\",\n  \"Solid\": \"solid\",\n  \"Gray50\": \"mediumGray\",\n  \"Gray75\": \"darkGray\",\n  \"Gray25\": \"lightGray\",\n  \"HorzStripe\": \"darkHorizontal\",\n  \"VertStripe\": \"darkVertical\",\n  \"ReverseDiagStripe\": \"darkDown\",\n  \"DiagStripe\": \"darkUp\",\n  \"DiagCross\": \"darkGrid\",\n  \"ThickDiagCross\": \"darkTrellis\",\n  \"ThinHorzStripe\": \"lightHorizontal\",\n  \"ThinVertStripe\": \"lightVertical\",\n  \"ThinReverseDiagStripe\": \"lightDown\",\n  \"ThinHorzCross\": \"lightGrid\"\n};\n/* 18.8.5 borders CT_Borders */\n\nfunction parse_borders(t, styles, themes, opts) {\n  styles.Borders = [];\n  var border = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<borders':\n      case '<borders>':\n      case '</borders>':\n        break;\n\n      /* 18.8.4 border CT_Border */\n\n      case '<border':\n      case '<border>':\n      case '<border/>':\n        border =\n        /*::(*/\n        {}\n        /*:: :any)*/\n        ;\n        if (y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n        if (y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n        styles.Borders.push(border);\n        break;\n\n      case '</border>':\n        break;\n\n      /* note: not in spec, appears to be CT_BorderPr */\n\n      case '<left/>':\n        break;\n\n      case '<left':\n      case '<left>':\n        break;\n\n      case '</left>':\n        break;\n\n      /* note: not in spec, appears to be CT_BorderPr */\n\n      case '<right/>':\n        break;\n\n      case '<right':\n      case '<right>':\n        break;\n\n      case '</right>':\n        break;\n\n      /* 18.8.43 top CT_BorderPr */\n\n      case '<top/>':\n        break;\n\n      case '<top':\n      case '<top>':\n        break;\n\n      case '</top>':\n        break;\n\n      /* 18.8.6 bottom CT_BorderPr */\n\n      case '<bottom/>':\n        break;\n\n      case '<bottom':\n      case '<bottom>':\n        break;\n\n      case '</bottom>':\n        break;\n\n      /* 18.8.13 diagonal CT_BorderPr */\n\n      case '<diagonal':\n      case '<diagonal>':\n      case '<diagonal/>':\n        break;\n\n      case '</diagonal>':\n        break;\n\n      /* 18.8.25 horizontal CT_BorderPr */\n\n      case '<horizontal':\n      case '<horizontal>':\n      case '<horizontal/>':\n        break;\n\n      case '</horizontal>':\n        break;\n\n      /* 18.8.44 vertical CT_BorderPr */\n\n      case '<vertical':\n      case '<vertical>':\n      case '<vertical/>':\n        break;\n\n      case '</vertical>':\n        break;\n\n      /* 18.8.37 start CT_BorderPr */\n\n      case '<start':\n      case '<start>':\n      case '<start/>':\n        break;\n\n      case '</start>':\n        break;\n\n      /* 18.8.16 end CT_BorderPr */\n\n      case '<end':\n      case '<end>':\n      case '<end/>':\n        break;\n\n      case '</end>':\n        break;\n\n      /* 18.8.? color CT_Color */\n\n      case '<color':\n      case '<color>':\n        break;\n\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n        }\n\n    }\n  });\n}\n/* 18.8.21 fills CT_Fills */\n\n\nfunction parse_fills(t, styles, themes, opts) {\n  styles.Fills = [];\n  var fill = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<fills':\n      case '<fills>':\n      case '</fills>':\n        break;\n\n      /* 18.8.20 fill CT_Fill */\n\n      case '<fill>':\n      case '<fill':\n      case '<fill/>':\n        fill = {};\n        styles.Fills.push(fill);\n        break;\n\n      case '</fill>':\n        break;\n\n      /* 18.8.24 gradientFill CT_GradientFill */\n\n      case '<gradientFill>':\n        break;\n\n      case '<gradientFill':\n      case '</gradientFill>':\n        styles.Fills.push(fill);\n        fill = {};\n        break;\n\n      /* 18.8.32 patternFill CT_PatternFill */\n\n      case '<patternFill':\n      case '<patternFill>':\n        if (y.patternType) fill.patternType = y.patternType;\n        break;\n\n      case '<patternFill/>':\n      case '</patternFill>':\n        break;\n\n      /* 18.8.3 bgColor CT_Color */\n\n      case '<bgColor':\n        if (!fill.bgColor) fill.bgColor = {};\n        if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n        if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n        /* Excel uses ARGB strings */\n\n        if (y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n        break;\n\n      case '<bgColor/>':\n      case '</bgColor>':\n        break;\n\n      /* 18.8.19 fgColor CT_Color */\n\n      case '<fgColor':\n        if (!fill.fgColor) fill.fgColor = {};\n        if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n        /* Excel uses ARGB strings */\n\n        if (y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n        break;\n\n      case '<fgColor/>':\n      case '</fgColor>':\n        break;\n\n      /* 18.8.38 stop CT_GradientStop */\n\n      case '<stop':\n      case '<stop/>':\n        break;\n\n      case '</stop>':\n        break;\n\n      /* 18.8.? color CT_Color */\n\n      case '<color':\n      case '<color/>':\n        break;\n\n      case '</color>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n        }\n\n    }\n  });\n}\n/* 18.8.23 fonts CT_Fonts */\n\n\nfunction parse_fonts(t, styles, themes, opts) {\n  styles.Fonts = [];\n  var font = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<fonts':\n      case '<fonts>':\n      case '</fonts>':\n        break;\n\n      /* 18.8.22 font CT_Font */\n\n      case '<font':\n      case '<font>':\n        break;\n\n      case '</font>':\n      case '<font/>':\n        styles.Fonts.push(font);\n        font = {};\n        break;\n\n      /* 18.8.29 name CT_FontName */\n\n      case '<name':\n        if (y.val) font.name = utf8read(y.val);\n        break;\n\n      case '<name/>':\n      case '</name>':\n        break;\n\n      /* 18.8.2  b CT_BooleanProperty */\n\n      case '<b':\n        font.bold = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<b/>':\n        font.bold = 1;\n        break;\n\n      /* 18.8.26 i CT_BooleanProperty */\n\n      case '<i':\n        font.italic = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<i/>':\n        font.italic = 1;\n        break;\n\n      /* 18.4.13 u CT_UnderlineProperty */\n\n      case '<u':\n        switch (y.val) {\n          case \"none\":\n            font.underline = 0x00;\n            break;\n\n          case \"single\":\n            font.underline = 0x01;\n            break;\n\n          case \"double\":\n            font.underline = 0x02;\n            break;\n\n          case \"singleAccounting\":\n            font.underline = 0x21;\n            break;\n\n          case \"doubleAccounting\":\n            font.underline = 0x22;\n            break;\n        }\n\n        break;\n\n      case '<u/>':\n        font.underline = 1;\n        break;\n\n      /* 18.4.10 strike CT_BooleanProperty */\n\n      case '<strike':\n        font.strike = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<strike/>':\n        font.strike = 1;\n        break;\n\n      /* 18.4.2  outline CT_BooleanProperty */\n\n      case '<outline':\n        font.outline = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<outline/>':\n        font.outline = 1;\n        break;\n\n      /* 18.8.36 shadow CT_BooleanProperty */\n\n      case '<shadow':\n        font.shadow = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<shadow/>':\n        font.shadow = 1;\n        break;\n\n      /* 18.8.12 condense CT_BooleanProperty */\n\n      case '<condense':\n        font.condense = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<condense/>':\n        font.condense = 1;\n        break;\n\n      /* 18.8.17 extend CT_BooleanProperty */\n\n      case '<extend':\n        font.extend = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<extend/>':\n        font.extend = 1;\n        break;\n\n      /* 18.4.11 sz CT_FontSize */\n\n      case '<sz':\n        if (y.val) font.sz = +y.val;\n        break;\n\n      case '<sz/>':\n      case '</sz>':\n        break;\n\n      /* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\n      case '<vertAlign':\n        if (y.val) font.vertAlign = y.val;\n        break;\n\n      case '<vertAlign/>':\n      case '</vertAlign>':\n        break;\n\n      /* 18.8.18 family CT_FontFamily */\n\n      case '<family':\n        if (y.val) font.family = parseInt(y.val, 10);\n        break;\n\n      case '<family/>':\n      case '</family>':\n        break;\n\n      /* 18.8.35 scheme CT_FontScheme */\n\n      case '<scheme':\n        if (y.val) font.scheme = y.val;\n        break;\n\n      case '<scheme/>':\n      case '</scheme>':\n        break;\n\n      /* 18.4.1 charset CT_IntProperty */\n\n      case '<charset':\n        if (y.val == '1') break;\n        y.codepage = CS2CP[parseInt(y.val, 10)];\n        break;\n\n      /* 18.?.? color CT_Color */\n\n      case '<color':\n        if (!font.color) font.color = {};\n        if (y.auto) font.color.auto = parsexmlbool(y.auto);\n        if (y.rgb) font.color.rgb = y.rgb.slice(-6);else if (y.indexed) {\n          font.color.index = parseInt(y.indexed, 10);\n          var icv = XLSIcv[font.color.index];\n          if (font.color.index == 81) icv = XLSIcv[1];\n          if (!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\n          font.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n        } else if (y.theme) {\n          font.color.theme = parseInt(y.theme, 10);\n          if (y.tint) font.color.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n          }\n        }\n        break;\n\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* note: sometimes mc:AlternateContent appears bare */\n\n      case '<AlternateContent':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n        }\n\n    }\n  });\n}\n/* 18.8.31 numFmts CT_NumFmts */\n\n\nfunction parse_numFmts(t, styles, opts) {\n  styles.NumberFmt = [];\n  var k\n  /*Array<number>*/\n  = keys(table_fmt)\n  /*:any*/\n  ;\n\n  for (var i = 0; i < k.length; ++i) {\n    styles.NumberFmt[k[i]] = table_fmt[k[i]];\n  }\n\n  var m = t[0].match(tagregex);\n  if (!m) return;\n\n  for (i = 0; i < m.length; ++i) {\n    var y = parsexmltag(m[i]);\n\n    switch (strip_ns(y[0])) {\n      case '<numFmts':\n      case '</numFmts>':\n      case '<numFmts/>':\n      case '<numFmts>':\n        break;\n\n      case '<numFmt':\n        {\n          var f = unescapexml(utf8read(y.formatCode)),\n              j = parseInt(y.numFmtId, 10);\n          styles.NumberFmt[j] = f;\n\n          if (j > 0) {\n            if (j > 0x188) {\n              for (j = 0x188; j > 0x3c; --j) {\n                if (styles.NumberFmt[j] == null) break;\n              }\n\n              styles.NumberFmt[j] = f;\n            }\n\n            SSF_load(f, j);\n          }\n        }\n        break;\n\n      case '</numFmt>':\n        break;\n\n      default:\n        if (opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n    }\n  }\n}\n/* 18.8.10 cellXfs CT_CellXfs */\n\n\nvar cellXF_uint = [\"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\"];\nvar cellXF_bool = [\"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\"];\n\nfunction parse_cellXfs(t, styles, opts) {\n  styles.CellXf = [];\n  var xf;\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x),\n        i = 0;\n\n    switch (strip_ns(y[0])) {\n      case '<cellXfs':\n      case '<cellXfs>':\n      case '<cellXfs/>':\n      case '</cellXfs>':\n        break;\n\n      /* 18.8.45 xf CT_Xf */\n\n      case '<xf':\n      case '<xf/>':\n        xf = y;\n        delete xf[0];\n\n        for (i = 0; i < cellXF_uint.length; ++i) {\n          if (xf[cellXF_uint[i]]) xf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n        }\n\n        for (i = 0; i < cellXF_bool.length; ++i) {\n          if (xf[cellXF_bool[i]]) xf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n        }\n\n        if (styles.NumberFmt && xf.numFmtId > 0x188) {\n          for (i = 0x188; i > 0x3c; --i) {\n            if (styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) {\n              xf.numFmtId = i;\n              break;\n            }\n          }\n        }\n\n        styles.CellXf.push(xf);\n        break;\n\n      case '</xf>':\n        break;\n\n      /* 18.8.1 alignment CT_CellAlignment */\n\n      case '<alignment':\n      case '<alignment/>':\n        var alignment = {};\n        if (y.vertical) alignment.vertical = y.vertical;\n        if (y.horizontal) alignment.horizontal = y.horizontal;\n        if (y.textRotation != null) alignment.textRotation = y.textRotation;\n        if (y.indent) alignment.indent = y.indent;\n        if (y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n        xf.alignment = alignment;\n        break;\n\n      case '</alignment>':\n        break;\n\n      /* 18.8.33 protection CT_CellProtection */\n\n      case '<protection':\n        break;\n\n      case '</protection>':\n      case '<protection/>':\n        break;\n\n      /* note: sometimes mc:AlternateContent appears bare */\n\n      case '<AlternateContent':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n        }\n\n    }\n  });\n}\n/* 18.8 Styles CT_Stylesheet*/\n\n\nvar parse_sty_xml = /*#__PURE__*/function make_pstyx() {\n  var numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\n  var cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\n  var fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\n  var fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\n  var bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n  return function parse_sty_xml(data, themes, opts) {\n    var styles = {};\n    if (!data) return styles;\n    data = data.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n    /* 18.8.39 styleSheet CT_Stylesheet */\n\n    var t;\n    /* 18.8.31 numFmts CT_NumFmts ? */\n\n    if (t = data.match(numFmtRegex)) parse_numFmts(t, styles, opts);\n    /* 18.8.23 fonts CT_Fonts ? */\n\n    if (t = data.match(fontsRegex)) parse_fonts(t, styles, themes, opts);\n    /* 18.8.21 fills CT_Fills ? */\n\n    if (t = data.match(fillsRegex)) parse_fills(t, styles, themes, opts);\n    /* 18.8.5  borders CT_Borders ? */\n\n    if (t = data.match(bordersRegex)) parse_borders(t, styles, themes, opts);\n    /* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\n    /* 18.8.8  cellStyles CT_CellStyles ? */\n\n    /* 18.8.10 cellXfs CT_CellXfs ? */\n\n    if (t = data.match(cellXfRegex)) parse_cellXfs(t, styles, opts);\n    /* 18.8.15 dxfs CT_Dxfs ? */\n\n    /* 18.8.42 tableStyles CT_TableStyles ? */\n\n    /* 18.8.11 colors CT_Colors ? */\n\n    /* 18.2.10 extLst CT_ExtensionList ? */\n\n    return styles;\n  };\n}();\n/* [MS-XLSB] 2.4.657 BrtFmt */\n\n\nfunction parse_BrtFmt(data, length\n/*:number*/\n) {\n  var numFmtId = data.read_shift(2);\n  var stFmtCode = parse_XLWideString(data);\n  return [numFmtId, stFmtCode];\n}\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\n\n\nfunction parse_BrtFont(data, length\n/*:number*/\n, opts) {\n  var out = {}\n  /*:any*/\n  ;\n  out.sz = data.read_shift(2) / 20;\n  var grbit = parse_FontFlags(data);\n  if (grbit.fItalic) out.italic = 1;\n  if (grbit.fCondense) out.condense = 1;\n  if (grbit.fExtend) out.extend = 1;\n  if (grbit.fShadow) out.shadow = 1;\n  if (grbit.fOutline) out.outline = 1;\n  if (grbit.fStrikeout) out.strike = 1;\n  var bls = data.read_shift(2);\n  if (bls === 0x02BC) out.bold = 1;\n\n  switch (data.read_shift(2)) {\n    /* case 0: out.vertAlign = \"baseline\"; break; */\n    case 1:\n      out.vertAlign = \"superscript\";\n      break;\n\n    case 2:\n      out.vertAlign = \"subscript\";\n      break;\n  }\n\n  var underline = data.read_shift(1);\n  if (underline != 0) out.underline = underline;\n  var family = data.read_shift(1);\n  if (family > 0) out.family = family;\n  var bCharSet = data.read_shift(1);\n  if (bCharSet > 0) out.charset = bCharSet;\n  data.l++;\n  out.color = parse_BrtColor(data);\n\n  switch (data.read_shift(1)) {\n    /* case 0: out.scheme = \"none\": break; */\n    case 1:\n      out.scheme = \"major\";\n      break;\n\n    case 2:\n      out.scheme = \"minor\";\n      break;\n  }\n\n  out.name = parse_XLWideString(data);\n  return out;\n}\n/* TODO: gradient fill representation */\n\n\nvar parse_BrtFill = parsenoop;\n/* [MS-XLSB] 2.4.824 BrtXF */\n\nfunction parse_BrtXF(data, length\n/*:number*/\n) {\n  var tgt = data.l + length;\n  var ixfeParent = data.read_shift(2);\n  var ifmt = data.read_shift(2);\n  data.l = tgt;\n  return {\n    ixfe: ixfeParent,\n    numFmtId: ifmt\n  };\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\n\n\nvar parse_BrtBorder = parsenoop;\n/* [MS-XLSB] 2.1.7.50 Styles */\n\nfunction parse_sty_bin(data, themes, opts) {\n  var styles = {};\n  styles.NumberFmt = []\n  /*:any*/\n  ;\n\n  for (var y in table_fmt) {\n    styles.NumberFmt[y] = table_fmt[y];\n  }\n\n  styles.CellXf = [];\n  styles.Fonts = [];\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false;\n  recordhopper(data, function hopper_sty(val, R, RT) {\n    switch (RT) {\n      case 0x002C:\n        /* BrtFmt */\n        styles.NumberFmt[val[0]] = val[1];\n        SSF_load(val[1], val[0]);\n        break;\n\n      case 0x002B:\n        /* BrtFont */\n        styles.Fonts.push(val);\n\n        if (val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n          val.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n        }\n\n        break;\n\n      case 0x0401:\n        /* BrtKnownFonts */\n        break;\n\n      case 0x002D:\n        /* BrtFill */\n        break;\n\n      case 0x002E:\n        /* BrtBorder */\n        break;\n\n      case 0x002F:\n        /* BrtXF */\n        if (state[state.length - 1] == 0x0269\n        /* BrtBeginCellXFs */\n        ) {\n          styles.CellXf.push(val);\n        }\n\n        break;\n\n      case 0x0030:\n      /* BrtStyle */\n\n      case 0x01FB:\n      /* BrtDXF */\n\n      case 0x023C:\n      /* BrtMRUColor */\n\n      case 0x01DB:\n        /* BrtIndexedColor */\n        break;\n\n      case 0x0493:\n      /* BrtDXF14 */\n\n      case 0x0836:\n      /* BrtDXF15 */\n\n      case 0x046A:\n      /* BrtSlicerStyleElement */\n\n      case 0x0200:\n      /* BrtTableStyleElement */\n\n      case 0x082F:\n      /* BrtTimelineStyleElement */\n\n      case 0x0C00:\n        /* BrtUid */\n        break;\n\n      case 0x0023:\n        /* BrtFRTBegin */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* BrtFRTEnd */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* BrtACBegin */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* BrtACEnd */\n        state.pop();\n        pass = false;\n        break;\n\n      default:\n        if (R.T > 0) state.push(RT);else if (R.T < 0) state.pop();else if (!pass || opts.WTF && state[state.length - 1] != 0x0025\n        /* BrtACBegin */\n        ) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return styles;\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\n\n\nvar XLSXThemeClrScheme = ['</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>', '</a:accent1>', '</a:accent2>', '</a:accent3>', '</a:accent4>', '</a:accent5>', '</a:accent6>', '</a:hlink>', '</a:folHlink>'];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\n\nfunction parse_clrScheme(t, themes, opts) {\n  themes.themeElements.clrScheme = [];\n  var color = {};\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0]) {\n      /* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n      case '<a:clrScheme':\n      case '</a:clrScheme>':\n        break;\n\n      /* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\n      case '<a:srgbClr':\n        color.rgb = y.val;\n        break;\n\n      /* 20.1.2.3.33 sysClr CT_SystemColor */\n\n      case '<a:sysClr':\n        color.rgb = y.lastClr;\n        break;\n\n      /* 20.1.4.1.1 accent1 (Accent 1) */\n\n      /* 20.1.4.1.2 accent2 (Accent 2) */\n\n      /* 20.1.4.1.3 accent3 (Accent 3) */\n\n      /* 20.1.4.1.4 accent4 (Accent 4) */\n\n      /* 20.1.4.1.5 accent5 (Accent 5) */\n\n      /* 20.1.4.1.6 accent6 (Accent 6) */\n\n      /* 20.1.4.1.9 dk1 (Dark 1) */\n\n      /* 20.1.4.1.10 dk2 (Dark 2) */\n\n      /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\n      /* 20.1.4.1.19 hlink (Hyperlink) */\n\n      /* 20.1.4.1.22 lt1 (Light 1) */\n\n      /* 20.1.4.1.23 lt2 (Light 2) */\n\n      case '<a:dk1>':\n      case '</a:dk1>':\n      case '<a:lt1>':\n      case '</a:lt1>':\n      case '<a:dk2>':\n      case '</a:dk2>':\n      case '<a:lt2>':\n      case '</a:lt2>':\n      case '<a:accent1>':\n      case '</a:accent1>':\n      case '<a:accent2>':\n      case '</a:accent2>':\n      case '<a:accent3>':\n      case '</a:accent3>':\n      case '<a:accent4>':\n      case '</a:accent4>':\n      case '<a:accent5>':\n      case '</a:accent5>':\n      case '<a:accent6>':\n      case '</a:accent6>':\n      case '<a:hlink>':\n      case '</a:hlink>':\n      case '<a:folHlink>':\n      case '</a:folHlink>':\n        if (y[0].charAt(1) === '/') {\n          themes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n          color = {};\n        } else {\n          color.name = y[0].slice(3, y[0].length - 1);\n        }\n\n        break;\n\n      default:\n        if (opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n    }\n  });\n}\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\n\n\nfunction\n  /*::t, themes, opts*/\nparse_fontScheme() {}\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\n\n\nfunction\n  /*::t, themes, opts*/\nparse_fmtScheme() {}\n\nvar clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n/* 20.1.6.10 themeElements CT_BaseStyles */\n\nfunction parse_themeElements(data, themes, opts) {\n  themes.themeElements = {};\n  var t;\n  [\n  /* clrScheme CT_ColorScheme */\n  ['clrScheme', clrsregex, parse_clrScheme],\n  /* fontScheme CT_FontScheme */\n  ['fontScheme', fntsregex, parse_fontScheme],\n  /* fmtScheme CT_StyleMatrix */\n  ['fmtScheme', fmtsregex, parse_fmtScheme]].forEach(function (m) {\n    if (!(t = data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n    m[2](t, themes, opts);\n  });\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n/* 14.2.7 Theme Part */\n\nfunction parse_theme_xml(data\n/*:string*/\n, opts) {\n  /* 20.1.6.9 theme CT_OfficeStyleSheet */\n  if (!data || data.length === 0) data = write_theme();\n  var t;\n  var themes = {};\n  /* themeElements CT_BaseStyles */\n\n  if (!(t = data.match(themeltregex))) throw new Error('themeElements not found in theme');\n  parse_themeElements(t[0], themes, opts);\n  themes.raw = data;\n  return themes;\n}\n\nfunction write_theme(Themes, opts)\n/*:string*/\n{\n  if (opts && opts.themeXLSX) return opts.themeXLSX;\n  if (Themes && typeof Themes.raw == \"string\") return Themes.raw;\n  var o = [XML_HEADER];\n  o[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n  o[o.length] = '<a:themeElements>';\n  o[o.length] = '<a:clrScheme name=\"Office\">';\n  o[o.length] = '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n  o[o.length] = '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n  o[o.length] = '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n  o[o.length] = '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n  o[o.length] = '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n  o[o.length] = '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n  o[o.length] = '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n  o[o.length] = '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n  o[o.length] = '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n  o[o.length] = '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n  o[o.length] = '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n  o[o.length] = '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n  o[o.length] = '</a:clrScheme>';\n  o[o.length] = '<a:fontScheme name=\"Office\">';\n  o[o.length] = '<a:majorFont>';\n  o[o.length] = '<a:latin typeface=\"Cambria\"/>';\n  o[o.length] = '<a:ea typeface=\"\"/>';\n  o[o.length] = '<a:cs typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n  o[o.length] = '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n  o[o.length] = '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n  o[o.length] = '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n  o[o.length] = '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n  o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n  o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n  o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n  o[o.length] = '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n  o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n  o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n  o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n  o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n  o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n  o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n  o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n  o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n  o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n  o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n  o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n  o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n  o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n  o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n  o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n  o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n  o[o.length] = '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n  o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n  o[o.length] = '</a:majorFont>';\n  o[o.length] = '<a:minorFont>';\n  o[o.length] = '<a:latin typeface=\"Calibri\"/>';\n  o[o.length] = '<a:ea typeface=\"\"/>';\n  o[o.length] = '<a:cs typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n  o[o.length] = '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n  o[o.length] = '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n  o[o.length] = '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n  o[o.length] = '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n  o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n  o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n  o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n  o[o.length] = '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n  o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n  o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n  o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n  o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n  o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n  o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n  o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n  o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n  o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n  o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n  o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n  o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n  o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n  o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n  o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n  o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n  o[o.length] = '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n  o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n  o[o.length] = '</a:minorFont>';\n  o[o.length] = '</a:fontScheme>';\n  o[o.length] = '<a:fmtScheme name=\"Office\">';\n  o[o.length] = '<a:fillStyleLst>';\n  o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '</a:fillStyleLst>';\n  o[o.length] = '<a:lnStyleLst>';\n  o[o.length] = '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '</a:lnStyleLst>';\n  o[o.length] = '<a:effectStyleLst>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n  o[o.length] = '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '</a:effectStyleLst>';\n  o[o.length] = '<a:bgFillStyleLst>';\n  o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '</a:bgFillStyleLst>';\n  o[o.length] = '</a:fmtScheme>';\n  o[o.length] = '</a:themeElements>';\n  o[o.length] = '<a:objectDefaults>';\n  o[o.length] = '<a:spDef>';\n  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n  o[o.length] = '</a:spDef>';\n  o[o.length] = '<a:lnDef>';\n  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n  o[o.length] = '</a:lnDef>';\n  o[o.length] = '</a:objectDefaults>';\n  o[o.length] = '<a:extraClrSchemeLst/>';\n  o[o.length] = '</a:theme>';\n  return o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\n\n\nfunction parse_Theme(blob, length, opts) {\n  var end = blob.l + length;\n  var dwThemeVersion = blob.read_shift(4);\n  if (dwThemeVersion === 124226) return;\n\n  if (!opts.cellStyles) {\n    blob.l = end;\n    return;\n  }\n\n  var data = blob.slice(blob.l);\n  blob.l = end;\n  var zip;\n\n  try {\n    zip = zip_read(data, {\n      type: \"array\"\n    });\n  } catch (e) {\n    return;\n  }\n\n  var themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n  if (!themeXML) return;\n  return parse_theme_xml(themeXML, opts);\n}\n/* 2.5.49 */\n\n\nfunction parse_ColorTheme(blob\n/*::, length*/\n) {\n  return blob.read_shift(4);\n}\n/* 2.5.155 */\n\n\nfunction parse_FullColorExt(blob\n/*::, length*/\n) {\n  var o = {};\n  o.xclrType = blob.read_shift(2);\n  o.nTintShade = blob.read_shift(2);\n\n  switch (o.xclrType) {\n    case 0:\n      blob.l += 4;\n      break;\n\n    case 1:\n      o.xclrValue = parse_IcvXF(blob, 4);\n      break;\n\n    case 2:\n      o.xclrValue = parse_LongRGBA(blob);\n      break;\n\n    case 3:\n      o.xclrValue = parse_ColorTheme(blob);\n      break;\n\n    case 4:\n      blob.l += 4;\n      break;\n  }\n\n  blob.l += 8;\n  return o;\n}\n/* 2.5.164 TODO: read 7 bits*/\n\n\nfunction parse_IcvXF(blob, length) {\n  return parsenoop(blob, length);\n}\n/* 2.5.280 */\n\n\nfunction parse_XFExtGradient(blob, length) {\n  return parsenoop(blob, length);\n}\n/* [MS-XLS] 2.5.108 */\n\n\nfunction parse_ExtProp(blob\n/*::, length*/\n)\n/*:Array<any>*/\n{\n  var extType = blob.read_shift(2);\n  var cb = blob.read_shift(2) - 4;\n  var o = [extType];\n\n  switch (extType) {\n    case 0x04:\n    case 0x05:\n    case 0x07:\n    case 0x08:\n    case 0x09:\n    case 0x0A:\n    case 0x0B:\n    case 0x0D:\n      o[1] = parse_FullColorExt(blob);\n      break;\n\n    case 0x06:\n      o[1] = parse_XFExtGradient(blob, cb);\n      break;\n\n    case 0x0E:\n    case 0x0F:\n      o[1] = blob.read_shift(cb === 1 ? 1 : 2);\n      break;\n\n    default:\n      throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n  }\n\n  return o;\n}\n/* 2.4.355 */\n\n\nfunction parse_XFExt(blob, length) {\n  var end = blob.l + length;\n  blob.l += 2;\n  var ixfe = blob.read_shift(2);\n  blob.l += 2;\n  var cexts = blob.read_shift(2);\n  var ext\n  /*:AOA*/\n  = [];\n\n  while (cexts-- > 0) {\n    ext.push(parse_ExtProp(blob, end - blob.l));\n  }\n\n  return {\n    ixfe: ixfe,\n    ext: ext\n  };\n}\n/* xf is an XF, see parse_XFExt for xfext */\n\n\nfunction update_xfext(xf, xfext) {\n  xfext.forEach(function (xfe) {\n    switch (xfe[0]) {}\n  });\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data)\n  };\n}\n\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n\n  while (cnt-- > 0) {\n    out.push([data.read_shift(4), data.read_shift(4)]);\n  }\n\n  return out;\n}\n\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\n\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = {\n    Types: [],\n    Cell: [],\n    Value: []\n  };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function (val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({\n          name: val.name\n        });\n        break;\n\n      case 51:\n        val.forEach(function (r) {\n          if (metatype == 1) out.Cell.push({\n            type: out.Types[r[0] - 1].name,\n            index: r[1]\n          });else if (metatype == 0) out.Value.push({\n            type: out.Types[r[0] - 1].name,\n            index: r[1]\n          });\n        });\n        break;\n\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n\n      case 338:\n        metatype = 2;\n        break;\n\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n\n      default:\n        if (R.T) ;else if (!pass || opts.WTF && state[state.length - 1] != 35) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\n\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = {\n    Types: [],\n    Cell: [],\n    Value: []\n  };\n  if (!data) return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n\n      case \"<metadataType\":\n        out.Types.push({\n          name: y.name\n        });\n        break;\n\n      case \"</metadataType>\":\n        break;\n\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j) {\n          if (out.Types[j].name == y.name) lastmeta = out.Types[j];\n        }\n\n        break;\n\n      case \"</futureMetadata>\":\n        break;\n\n      case \"<bk>\":\n        break;\n\n      case \"</bk>\":\n        break;\n\n      case \"<rc\":\n        if (metatype == 1) out.Cell.push({\n          type: out.Types[y.t - 1].name,\n          index: +y.v\n        });else if (metatype == 0) out.Value.push({\n          type: out.Types[y.t - 1].name,\n          index: +y.v\n        });\n        break;\n\n      case \"</rc>\":\n        break;\n\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n\n      case \"<ext\":\n        pass = true;\n        break;\n\n      case \"</ext>\":\n        pass = false;\n        break;\n\n      case \"<rvb\":\n        if (!lastmeta) break;\n        if (!lastmeta.offsets) lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n\n    return x;\n  });\n  return out;\n}\n/* 18.6 Calculation Chain */\n\n\nfunction parse_cc_xml(data\n/*::, name, opts*/\n)\n/*:Array<any>*/\n{\n  var d = [];\n  if (!data) return d;\n  var i = 1;\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0]) {\n      case '<?xml':\n        break;\n\n      /* 18.6.2  calcChain CT_CalcChain 1 */\n\n      case '<calcChain':\n      case '<calcChain>':\n      case '</calcChain>':\n        break;\n\n      /* 18.6.1  c CT_CalcCell 1 */\n\n      case '<c':\n        delete y[0];\n        if (y.i) i = y.i;else y.i = i;\n        d.push(y);\n        break;\n    }\n  });\n  return d;\n} //function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\n\n\nfunction parse_BrtCalcChainItem$(data) {\n  var out = {};\n  out.i = data.read_shift(4);\n  var cell = {};\n  cell.r = data.read_shift(4);\n  cell.c = data.read_shift(4);\n  out.r = encode_cell(cell);\n  var flags = data.read_shift(1);\n  if (flags & 0x2) out.l = '1';\n  if (flags & 0x8) out.a = '1';\n  return out;\n}\n/* 18.6 Calculation Chain */\n\n\nfunction parse_cc_bin(data, name, opts) {\n  var out = [];\n  recordhopper(data, function hopper_cc(val, R, RT) {\n    switch (RT) {\n      case 0x003F:\n        /* 'BrtCalcChainItem$' */\n        out.push(val);\n        break;\n\n      default:\n        if (R.T) ;else throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n} //function write_cc_bin(data, opts) { }\n\n/* 18.14 Supplementary Workbook Data */\n\n\nfunction\n  /*::data, rel, name:string, _opts*/\nparse_xlink_xml() {//var opts = _opts || {};\n  //if(opts.WTF) throw \"XLSX External Link\";\n}\n/* [MS-XLSB] 2.1.7.25 External Link */\n\n\nfunction parse_xlink_bin(data, rel, name\n/*:string*/\n, _opts) {\n  if (!data) return data;\n  var opts = _opts || {};\n  var pass = false;\n  recordhopper(data, function xlink_parse(val, R, RT) {\n    switch (RT) {\n      case 0x0167:\n      /* 'BrtSupTabs' */\n\n      case 0x016B:\n      /* 'BrtExternTableStart' */\n\n      case 0x016C:\n      /* 'BrtExternTableEnd' */\n\n      case 0x016E:\n      /* 'BrtExternRowHdr' */\n\n      case 0x016F:\n      /* 'BrtExternCellBlank' */\n\n      case 0x0170:\n      /* 'BrtExternCellReal' */\n\n      case 0x0171:\n      /* 'BrtExternCellBool' */\n\n      case 0x0172:\n      /* 'BrtExternCellError' */\n\n      case 0x0173:\n      /* 'BrtExternCellString' */\n\n      case 0x01D8:\n      /* 'BrtExternValueMeta' */\n\n      case 0x0241:\n      /* 'BrtSupNameStart' */\n\n      case 0x0242:\n      /* 'BrtSupNameValueStart' */\n\n      case 0x0243:\n      /* 'BrtSupNameValueEnd' */\n\n      case 0x0244:\n      /* 'BrtSupNameNum' */\n\n      case 0x0245:\n      /* 'BrtSupNameErr' */\n\n      case 0x0246:\n      /* 'BrtSupNameSt' */\n\n      case 0x0247:\n      /* 'BrtSupNameNil' */\n\n      case 0x0248:\n      /* 'BrtSupNameBool' */\n\n      case 0x0249:\n      /* 'BrtSupNameFmla' */\n\n      case 0x024A:\n      /* 'BrtSupNameBits' */\n\n      case 0x024B:\n        /* 'BrtSupNameEnd' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      default:\n        if (R.T) ;else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  }, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n\n/* 20.5.2.35 wsDr CT_Drawing */\n\n\nfunction parse_drawing(data, rels\n/*:any*/\n) {\n  if (!data) return \"??\";\n  /*\n    Chartsheet Drawing:\n     - 20.5.2.35 wsDr CT_Drawing\n      - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n       - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n        - 20.1.2.2.16 graphic CT_GraphicalObject\n         - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n           - chart reference\n     the actual type is based on the URI of the graphicData\n  \tTODO: handle embedded charts and other types of graphics\n  */\n\n  var id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/) || [\"\", \"\"])[1];\n  return rels['!id'][id].Target;\n}\n\nfunction sheet_insert_comments(sheet, comments\n/*:Array<RawComment>*/\n, threaded\n/*:boolean*/\n, people\n/*:?Array<any>*/\n) {\n  var dense = Array.isArray(sheet);\n  var cell\n  /*:Cell*/\n  ;\n  comments.forEach(function (comment) {\n    var r = decode_cell(comment.ref);\n\n    if (dense) {\n      if (!sheet[r.r]) sheet[r.r] = [];\n      cell = sheet[r.r][r.c];\n    } else cell = sheet[comment.ref];\n\n    if (!cell) {\n      cell = {\n        t: \"z\"\n      }\n      /*:any*/\n      ;\n      if (dense) sheet[r.r][r.c] = cell;else sheet[comment.ref] = cell;\n      var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n      if (range.s.r > r.r) range.s.r = r.r;\n      if (range.e.r < r.r) range.e.r = r.r;\n      if (range.s.c > r.c) range.s.c = r.c;\n      if (range.e.c < r.c) range.e.c = r.c;\n      var encoded = encode_range(range);\n      if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n    }\n\n    if (!cell.c) cell.c = [];\n    var o\n    /*:Comment*/\n    = {\n      a: comment.author,\n      t: comment.t,\n      r: comment.r,\n      T: threaded\n    };\n    if (comment.h) o.h = comment.h;\n    /* threaded comments always override */\n\n    for (var i = cell.c.length - 1; i >= 0; --i) {\n      if (!threaded && cell.c[i].T) return;\n      if (threaded && !cell.c[i].T) cell.c.splice(i, 1);\n    }\n\n    if (threaded && people) for (i = 0; i < people.length; ++i) {\n      if (o.a == people[i].id) {\n        o.a = people[i].name || o.a;\n        break;\n      }\n    }\n    cell.c.push(o);\n  });\n}\n/* 18.7 Comments */\n\n\nfunction parse_comments_xml(data\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  /* 18.7.6 CT_Comments */\n  if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n  var authors\n  /*:Array<string>*/\n  = [];\n  var commentList\n  /*:Array<RawComment>*/\n  = [];\n  var authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n  if (authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\n    if (x === \"\" || x.trim() === \"\") return;\n    var a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n    if (a) authors.push(a[1]);\n  });\n  var cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n  if (cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function (x) {\n    if (x === \"\" || x.trim() === \"\") return;\n    var cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n    if (!cm) return;\n    var y = parsexmltag(cm[0]);\n    var comment\n    /*:RawComment*/\n    = {\n      author: y.authorId && authors[y.authorId] || \"sheetjsghost\",\n      ref: y.ref,\n      guid: y.guid\n    }\n    /*:any*/\n    ;\n    var cell = decode_cell(y.ref);\n    if (opts.sheetRows && opts.sheetRows <= cell.r) return;\n    var textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n    var rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {\n      r: \"\",\n      t: \"\",\n      h: \"\"\n    };\n    comment.r = rt.r;\n    if (rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n    comment.t = (rt.t || \"\").replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n    if (opts.cellHTML) comment.h = rt.h;\n    commentList.push(comment);\n  });\n  return commentList;\n}\n/* [MS-XLSX] 2.1.17 */\n\n\nfunction parse_tcmnt_xml(data\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  var out = [];\n  var pass = false,\n      comment = {},\n      tidx = 0;\n  data.replace(tagregex, function xml_tcmnt(x, idx) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 2.6.207 ThreadedComments CT_ThreadedComments */\n\n      case '<ThreadedComments':\n        break;\n\n      case '</ThreadedComments>':\n        break;\n\n      /* 2.6.205 threadedComment CT_ThreadedComment */\n\n      case '<threadedComment':\n        comment = {\n          author: y.personId,\n          guid: y.id,\n          ref: y.ref,\n          T: 1\n        };\n        break;\n\n      case '</threadedComment>':\n        if (comment.t != null) out.push(comment);\n        break;\n\n      case '<text>':\n      case '<text':\n        tidx = idx + x.length;\n        break;\n\n      case '</text>':\n        comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n        break;\n\n      /* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\n      case '<mentions':\n      case '<mentions>':\n        pass = true;\n        break;\n\n      case '</mentions>':\n        pass = false;\n        break;\n\n      /* 2.6.202 mention CT_Mention TODO */\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n    }\n\n    return x;\n  });\n  return out;\n}\n/* [MS-XLSX] 2.1.18 */\n\n\nfunction parse_people_xml(data\n/*:string*/\n, opts) {\n  var out = [];\n  var pass = false;\n  data.replace(tagregex, function xml_tcmnt(x) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 2.4.85 personList CT_PersonList */\n\n      case '<personList':\n        break;\n\n      case '</personList>':\n        break;\n\n      /* 2.6.203 person CT_Person TODO: providers */\n\n      case '<person':\n        out.push({\n          name: y.displayname,\n          id: y.id\n        });\n        break;\n\n      case '</person>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n    }\n\n    return x;\n  });\n  return out;\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\n\n\nfunction parse_BrtBeginComment(data) {\n  var out = {};\n  out.iauthor = data.read_shift(4);\n  var rfx = parse_UncheckedRfX(data);\n  out.rfx = rfx.s;\n  out.ref = encode_cell(rfx.s);\n  data.l += 16;\n  /*var guid = parse_GUID(data); */\n\n  return out;\n}\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\n\n\nvar parse_BrtCommentAuthor = parse_XLWideString;\n/* [MS-XLSB] 2.1.7.8 Comments */\n\nfunction parse_comments_bin(data, opts)\n/*:Array<RawComment>*/\n{\n  var out\n  /*:Array<RawComment>*/\n  = [];\n  var authors\n  /*:Array<string>*/\n  = [];\n  var c = {};\n  var pass = false;\n  recordhopper(data, function hopper_cmnt(val, R, RT) {\n    switch (RT) {\n      case 0x0278:\n        /* 'BrtCommentAuthor' */\n        authors.push(val);\n        break;\n\n      case 0x027B:\n        /* 'BrtBeginComment' */\n        c = val;\n        break;\n\n      case 0x027D:\n        /* 'BrtCommentText' */\n        c.t = val.t;\n        c.h = val.h;\n        c.r = val.r;\n        break;\n\n      case 0x027C:\n        /* 'BrtEndComment' */\n        c.author = authors[c.iauthor];\n        delete c\n        /*:any*/\n        .iauthor;\n        if (opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n        if (!c.t) c.t = \"\";\n        delete c.rfx;\n        out.push(c);\n        break;\n\n      case 0x0C00:\n        /* 'BrtUid' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        break;\n\n      default:\n        if (R.T) ;else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\n\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\n\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({\n    root: \"R\"\n  });\n  cfb.FullPaths.forEach(function (p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/)) return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\n/* macro and dialog sheet stubs */\n\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ds_bin()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'dialog'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ds_xml()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'dialog'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ms_bin()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'macro'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ms_xml()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'macro'\n  };\n}\n/* TODO: it will be useful to parse the function str */\n\n\nvar rc_to_a1 = /*#__PURE__*/function () {\n  var rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n  var rcbase\n  /*:Cell*/\n  = {\n    r: 0,\n    c: 0\n  }\n  /*:any*/\n  ;\n\n  function rcfunc($$, $1, $2, $3) {\n    var cRel = false,\n        rRel = false;\n    if ($2.length == 0) rRel = true;else if ($2.charAt(0) == \"[\") {\n      rRel = true;\n      $2 = $2.slice(1, -1);\n    }\n    if ($3.length == 0) cRel = true;else if ($3.charAt(0) == \"[\") {\n      cRel = true;\n      $3 = $3.slice(1, -1);\n    }\n    var R = $2.length > 0 ? parseInt($2, 10) | 0 : 0,\n        C = $3.length > 0 ? parseInt($3, 10) | 0 : 0;\n    if (cRel) C += rcbase.c;else --C;\n    if (rRel) R += rcbase.r;else --R;\n    return $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n  }\n\n  return function rc_to_a1(fstr\n  /*:string*/\n  , base\n  /*:Cell*/\n  )\n  /*:string*/\n  {\n    rcbase = base;\n    return fstr.replace(rcregex, rcfunc);\n  };\n}();\n\nvar crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\n\nvar a1_to_rc = /*#__PURE__*/function () {\n  return function a1_to_rc(fstr\n  /*:string*/\n  , base\n  /*:CellAddress*/\n  ) {\n    return fstr.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n      var c = decode_col($3) - ($2 ? 0 : base.c);\n      var r = decode_row($5) - ($4 ? 0 : base.r);\n      var R = r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : r + 1;\n      var C = c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : c + 1;\n      return $1 + \"R\" + R + \"C\" + C;\n    });\n  };\n}();\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\n\n\nfunction shift_formula_str(f\n/*:string*/\n, delta\n/*:Cell*/\n)\n/*:string*/\n{\n  return f.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n    return $1 + ($2 == \"$\" ? $2 + $3 : encode_col(decode_col($3) + delta.c)) + ($4 == \"$\" ? $4 + $5 : encode_row(decode_row($5) + delta.r));\n  });\n}\n\nfunction shift_formula_xlsx(f\n/*:string*/\n, range\n/*:string*/\n, cell\n/*:string*/\n)\n/*:string*/\n{\n  var r = decode_range(range),\n      s = r.s,\n      c = decode_cell(cell);\n  var delta = {\n    r: c.r - s.r,\n    c: c.c - s.c\n  };\n  return shift_formula_str(f, delta);\n}\n/* TODO: parse formula */\n\n\nfunction fuzzyfmla(f\n/*:string*/\n)\n/*:boolean*/\n{\n  if (f.length == 1) return false;\n  return true;\n}\n\nfunction _xlfn(f\n/*:string*/\n)\n/*:string*/\n{\n  return f.replace(/_xlfn\\./g, \"\");\n}\n\nfunction parseread1(blob) {\n  blob.l += 1;\n  return;\n}\n/* [MS-XLS] 2.5.51 */\n\n\nfunction parse_ColRelU(blob, length) {\n  var c = blob.read_shift(length == 1 ? 1 : 2);\n  return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n}\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\n\n\nfunction parse_RgceArea(blob, length, opts) {\n  var w = 2;\n\n  if (opts) {\n    if (opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob);else if (opts.biff == 12) w = 4;\n  }\n\n  var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n  var c = parse_ColRelU(blob, 2);\n  var C = parse_ColRelU(blob, 2);\n  return {\n    s: {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    },\n    e: {\n      r: R,\n      c: C[0],\n      cRel: C[1],\n      rRel: C[2]\n    }\n  };\n}\n/* BIFF 2-5 encodes flags in the row field */\n\n\nfunction parse_RgceArea_BIFF2(blob\n/*::, length, opts*/\n) {\n  var r = parse_ColRelU(blob, 2),\n      R = parse_ColRelU(blob, 2);\n  var c = blob.read_shift(1);\n  var C = blob.read_shift(1);\n  return {\n    s: {\n      r: r[0],\n      c: c,\n      cRel: r[1],\n      rRel: r[2]\n    },\n    e: {\n      r: R[0],\n      c: C,\n      cRel: R[1],\n      rRel: R[2]\n    }\n  };\n}\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\n\n\nfunction parse_RgceAreaRel(blob, length, opts) {\n  if (opts.biff < 8) return parse_RgceArea_BIFF2(blob);\n  var r = blob.read_shift(opts.biff == 12 ? 4 : 2),\n      R = blob.read_shift(opts.biff == 12 ? 4 : 2);\n  var c = parse_ColRelU(blob, 2);\n  var C = parse_ColRelU(blob, 2);\n  return {\n    s: {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    },\n    e: {\n      r: R,\n      c: C[0],\n      cRel: C[1],\n      rRel: C[2]\n    }\n  };\n}\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\n\n\nfunction parse_RgceLoc(blob, length, opts) {\n  if (opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob);\n  var r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n  var c = parse_ColRelU(blob, 2);\n  return {\n    r: r,\n    c: c[0],\n    cRel: c[1],\n    rRel: c[2]\n  };\n}\n\nfunction parse_RgceLoc_BIFF2(blob\n/*::, length, opts*/\n) {\n  var r = parse_ColRelU(blob, 2);\n  var c = blob.read_shift(1);\n  return {\n    r: r[0],\n    c: c,\n    cRel: r[1],\n    rRel: r[2]\n  };\n}\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\n\n\nfunction parse_RgceElfLoc(blob\n/*::, length, opts*/\n) {\n  var r = blob.read_shift(2);\n  var c = blob.read_shift(2);\n  return {\n    r: r,\n    c: c & 0xFF,\n    fQuoted: !!(c & 0x4000),\n    cRel: c >> 15,\n    rRel: c >> 15\n  };\n}\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\n\n\nfunction parse_RgceLocRel(blob, length, opts) {\n  var biff = opts && opts.biff ? opts.biff : 8;\n  if (biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob);\n  var r = blob.read_shift(biff >= 12 ? 4 : 2);\n  var cl = blob.read_shift(2);\n  var cRel = (cl & 0x4000) >> 14,\n      rRel = (cl & 0x8000) >> 15;\n  cl &= 0x3FFF;\n  if (rRel == 1) while (r > 0x7FFFF) {\n    r -= 0x100000;\n  }\n  if (cRel == 1) while (cl > 0x1FFF) {\n    cl = cl - 0x4000;\n  }\n  return {\n    r: r,\n    c: cl,\n    cRel: cRel,\n    rRel: rRel\n  };\n}\n\nfunction parse_RgceLocRel_BIFF2(blob\n/*::, length:number, opts*/\n) {\n  var rl = blob.read_shift(2);\n  var c = blob.read_shift(1);\n  var rRel = (rl & 0x8000) >> 15,\n      cRel = (rl & 0x4000) >> 14;\n  rl &= 0x3FFF;\n  if (rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n  if (cRel == 1 && c >= 0x80) c = c - 0x100;\n  return {\n    r: rl,\n    c: c,\n    cRel: cRel,\n    rRel: rRel\n  };\n}\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\n\n\nfunction parse_PtgArea(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n  return [type, area];\n}\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\n\n\nfunction parse_PtgArea3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2, 'i');\n  var w = 8;\n  if (opts) switch (opts.biff) {\n    case 5:\n      blob.l += 12;\n      w = 6;\n      break;\n\n    case 12:\n      w = 12;\n      break;\n  }\n  var area = parse_RgceArea(blob, w, opts);\n  return [type, ixti, area];\n}\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\n\n\nfunction parse_PtgAreaErr(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  blob.l += opts && opts.biff > 8 ? 12 : opts.biff < 8 ? 6 : 8;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\n\n\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2);\n  var w = 8;\n  if (opts) switch (opts.biff) {\n    case 5:\n      blob.l += 12;\n      w = 6;\n      break;\n\n    case 12:\n      w = 12;\n      break;\n  }\n  blob.l += w;\n  return [type, ixti];\n}\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\n\n\nfunction parse_PtgAreaN(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var area = parse_RgceAreaRel(blob, length - 1, opts);\n  return [type, area];\n}\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\n\n\nfunction parse_PtgArray(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  blob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\n\n\nfunction parse_PtgAttrBaxcel(blob) {\n  var bitSemi = blob[blob.l + 1] & 0x01;\n  /* 1 = volatile */\n\n  var bitBaxcel = 1;\n  blob.l += 4;\n  return [bitSemi, bitBaxcel];\n}\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\n\n\nfunction parse_PtgAttrChoose(blob, length, opts)\n/*:Array<number>*/\n{\n  blob.l += 2;\n  var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  var o\n  /*:Array<number>*/\n  = [];\n  /* offset is 1 less than the number of elements */\n\n  for (var i = 0; i <= offset; ++i) {\n    o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n  }\n\n  return o;\n}\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\n\n\nfunction parse_PtgAttrGoto(blob, length, opts) {\n  var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\n\n\nfunction parse_PtgAttrIf(blob, length, opts) {\n  var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n/* [MS-XLSB] 2.5.97.28 */\n\n\nfunction parse_PtgAttrIfError(blob) {\n  var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitIf, blob.read_shift(2)];\n}\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\n\n\nfunction parse_PtgAttrSemi(blob, length, opts) {\n  var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  return [bitSemi];\n}\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\n\n\nfunction parse_PtgAttrSpaceType(blob\n/*::, length*/\n) {\n  var type = blob.read_shift(1),\n      cch = blob.read_shift(1);\n  return [type, cch];\n}\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\n\n\nfunction parse_PtgAttrSpace(blob) {\n  blob.read_shift(2);\n  return parse_PtgAttrSpaceType(blob);\n}\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\n\n\nfunction parse_PtgAttrSpaceSemi(blob) {\n  blob.read_shift(2);\n  return parse_PtgAttrSpaceType(blob);\n}\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\n\n\nfunction parse_PtgRef(blob, length, opts) {\n  //var ptg = blob[blob.l] & 0x1F;\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var loc = parse_RgceLoc(blob, 0, opts);\n  return [type, loc];\n}\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\n\n\nfunction parse_PtgRefN(blob, length, opts) {\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var loc = parse_RgceLocRel(blob, 0, opts);\n  return [type, loc];\n}\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\n\n\nfunction parse_PtgRef3d(blob, length, opts) {\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var ixti = blob.read_shift(2); // XtiIndex\n\n  if (opts && opts.biff == 5) blob.l += 12;\n  var loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\n  return [type, ixti, loc];\n}\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\n\n\nfunction parse_PtgFunc(blob, length, opts) {\n  //var ptg = blob[blob.l] & 0x1F;\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n  return [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\n\n\nfunction parse_PtgFuncVar(blob, length, opts) {\n  var type = blob[blob.l++];\n  var cparams = blob.read_shift(1),\n      tab = opts && opts.biff <= 3 ? [type == 0x58 ? -1 : 0, blob.read_shift(1)] : parsetab(blob);\n  return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n  return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n}\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\n\n\nfunction parse_PtgAttrSum(blob, length, opts) {\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  return;\n}\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\n\n\nfunction parse_PtgExp(blob, length, opts) {\n  blob.l++;\n  if (opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n  var row = blob.read_shift(2);\n  var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [row, col];\n}\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\n\n\nfunction parse_PtgErr(blob) {\n  blob.l++;\n  return BErr[blob.read_shift(1)];\n}\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\n\n\nfunction parse_PtgInt(blob) {\n  blob.l++;\n  return blob.read_shift(2);\n}\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\n\n\nfunction parse_PtgBool(blob) {\n  blob.l++;\n  return blob.read_shift(1) !== 0;\n}\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\n\n\nfunction parse_PtgNum(blob) {\n  blob.l++;\n  return parse_Xnum(blob);\n}\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\n\n\nfunction parse_PtgStr(blob, length, opts) {\n  blob.l++;\n  return parse_ShortXLUnicodeString(blob, length - 1, opts);\n}\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\n\n\nfunction parse_SerAr(blob, biff\n/*:number*/\n) {\n  var val = [blob.read_shift(1)];\n  if (biff == 12) switch (val[0]) {\n    case 0x02:\n      val[0] = 0x04;\n      break;\n\n    /* SerBool */\n\n    case 0x04:\n      val[0] = 0x10;\n      break;\n\n    /* SerErr */\n\n    case 0x00:\n      val[0] = 0x01;\n      break;\n\n    /* SerNum */\n\n    case 0x01:\n      val[0] = 0x02;\n      break;\n\n    /* SerStr */\n  }\n\n  switch (val[0]) {\n    case 0x04:\n      /* SerBool -- boolean */\n      val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n      if (biff != 12) blob.l += 7;\n      break;\n\n    case 0x25:\n    /* appears to be an alias */\n\n    case 0x10:\n      /* SerErr -- error */\n      val[1] = BErr[blob[blob.l]];\n      blob.l += biff == 12 ? 4 : 8;\n      break;\n\n    case 0x00:\n      /* SerNil -- honestly, I'm not sure how to reproduce this */\n      blob.l += 8;\n      break;\n\n    case 0x01:\n      /* SerNum -- Xnum */\n      val[1] = parse_Xnum(blob);\n      break;\n\n    case 0x02:\n      /* SerStr -- XLUnicodeString (<256 chars) */\n      val[1] = parse_XLUnicodeString2(blob, 0, {\n        biff: biff > 0 && biff < 8 ? 2 : biff\n      });\n      break;\n\n    default:\n      throw new Error(\"Bad SerAr: \" + val[0]);\n\n    /* Unreachable */\n  }\n\n  return val;\n}\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\n\n\nfunction parse_PtgExtraMem(blob, cce, opts) {\n  var count = blob.read_shift(opts.biff == 12 ? 4 : 2);\n  var out\n  /*:Array<Range>*/\n  = [];\n\n  for (var i = 0; i != count; ++i) {\n    out.push((opts.biff == 12 ? parse_UncheckedRfX : parse_Ref8U)(blob));\n  }\n\n  return out;\n}\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\n\n\nfunction parse_PtgExtraArray(blob, length, opts) {\n  var rows = 0,\n      cols = 0;\n\n  if (opts.biff == 12) {\n    rows = blob.read_shift(4); // DRw\n\n    cols = blob.read_shift(4); // DCol\n  } else {\n    cols = 1 + blob.read_shift(1); //DColByteU\n\n    rows = 1 + blob.read_shift(2); //DRw\n  }\n\n  if (opts.biff >= 2 && opts.biff < 8) {\n    --rows;\n    if (--cols == 0) cols = 0x100;\n  } // $FlowIgnore\n\n\n  for (var i = 0, o\n  /*:Array<Array<any>>*/\n  = []; i != rows && (o[i] = []); ++i) {\n    for (var j = 0; j != cols; ++j) {\n      o[i][j] = parse_SerAr(blob, opts.biff);\n    }\n  }\n\n  return o;\n}\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\n\n\nfunction parse_PtgName(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var w = !opts || opts.biff >= 8 ? 4 : 2;\n  var nameindex = blob.read_shift(w);\n\n  switch (opts.biff) {\n    case 2:\n      blob.l += 5;\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 8;\n      break;\n\n    case 5:\n      blob.l += 12;\n      break;\n  }\n\n  return [type, 0, nameindex];\n}\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\n\n\nfunction parse_PtgNameX(blob, length, opts) {\n  if (opts.biff == 5) return parse_PtgNameX_BIFF5(blob);\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var ixti = blob.read_shift(2); // XtiIndex\n\n  var nameindex = blob.read_shift(4);\n  return [type, ixti, nameindex];\n}\n\nfunction parse_PtgNameX_BIFF5(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var ixti = blob.read_shift(2, 'i'); // XtiIndex\n\n  blob.l += 8;\n  var nameindex = blob.read_shift(2);\n  blob.l += 12;\n  return [type, ixti, nameindex];\n}\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\n\n\nfunction parse_PtgMemArea(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [type, cce];\n}\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\n\n\nfunction parse_PtgMemFunc(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [type, cce];\n}\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\n\n\nfunction parse_PtgRefErr(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  blob.l += 4;\n  if (opts.biff < 8) blob.l--;\n  if (opts.biff == 12) blob.l += 2;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\n\n\nfunction parse_PtgRefErr3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2);\n  var w = 4;\n  if (opts) switch (opts.biff) {\n    case 5:\n      w = 15;\n      break;\n\n    case 12:\n      w = 6;\n      break;\n  }\n  blob.l += w;\n  return [type, ixti];\n}\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\n\n\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\n\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\n\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n  blob.l += 2;\n  return [parse_RgceElfLoc(blob)];\n}\n\nfunction parse_PtgElfNoop(blob\n/*::, length, opts*/\n) {\n  blob.l += 6;\n  return [];\n}\n/* [MS-XLS] 2.5.198.46 */\n\n\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\n\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\n\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\n\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\n\nfunction parse_PtgElfLel(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  return [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\n\n\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\n\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\n\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\n\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\n\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n/* [MS-XLSB] 2.5.97.52 TODO */\n\nvar PtgListRT = [\"Data\", \"All\", \"Headers\", \"??\", \"?Data2\", \"??\", \"?DataHeaders\", \"??\", \"Totals\", \"??\", \"??\", \"??\", \"?DataTotals\", \"??\", \"??\", \"??\", \"?Current\"];\n\nfunction parse_PtgList(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  var ixti = blob.read_shift(2);\n  var flags = blob.read_shift(2);\n  var idx = blob.read_shift(4);\n  var c = blob.read_shift(2);\n  var C = blob.read_shift(2);\n  var rt = PtgListRT[flags >> 2 & 0x1F];\n  return {\n    ixti: ixti,\n    coltype: flags & 0x3,\n    rt: rt,\n    idx: idx,\n    c: c,\n    C: C\n  };\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\n\n\nfunction parse_PtgSxName(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  return [blob.read_shift(4)];\n}\n/* [XLS] old spec */\n\n\nfunction parse_PtgSheet(blob, length, opts) {\n  blob.l += 5;\n  blob.l += 2;\n  blob.l += opts.biff == 2 ? 1 : 4;\n  return [\"PTGSHEET\"];\n}\n\nfunction parse_PtgEndSheet(blob, length, opts) {\n  blob.l += opts.biff == 2 ? 4 : 5;\n  return [\"PTGENDSHEET\"];\n}\n\nfunction parse_PtgMemAreaN(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(2);\n  return [type, cce];\n}\n\nfunction parse_PtgMemNoMemN(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(2);\n  return [type, cce];\n}\n\nfunction parse_PtgAttrNoop(blob\n/*::, length, opts*/\n) {\n  blob.l += 4;\n  return [0, 0];\n}\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\n\n\nvar PtgTypes = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgExp',\n    f: parse_PtgExp\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgTbl',\n    f: parse_PtgTbl\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PtgAdd',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'PtgSub',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'PtgMul',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'PtgDiv',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'PtgPower',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'PtgConcat',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'PtgLt',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'PtgLe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'PtgEq',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : {\n    n: 'PtgGe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'PtgGt',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : {\n    n: 'PtgNe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'PtgIsect',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgUnion',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'PtgRange',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : {\n    n: 'PtgUplus',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'PtgUminus',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x14\n  /*::]*/\n  : {\n    n: 'PtgPercent',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x15\n  /*::]*/\n  : {\n    n: 'PtgParen',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x16\n  /*::]*/\n  : {\n    n: 'PtgMissArg',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : {\n    n: 'PtgStr',\n    f: parse_PtgStr\n  },\n\n  /*::[*/\n  0x1A\n  /*::]*/\n  : {\n    n: 'PtgSheet',\n    f: parse_PtgSheet\n  },\n\n  /*::[*/\n  0x1B\n  /*::]*/\n  : {\n    n: 'PtgEndSheet',\n    f: parse_PtgEndSheet\n  },\n\n  /*::[*/\n  0x1C\n  /*::]*/\n  : {\n    n: 'PtgErr',\n    f: parse_PtgErr\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'PtgBool',\n    f: parse_PtgBool\n  },\n\n  /*::[*/\n  0x1E\n  /*::]*/\n  : {\n    n: 'PtgInt',\n    f: parse_PtgInt\n  },\n\n  /*::[*/\n  0x1F\n  /*::]*/\n  : {\n    n: 'PtgNum',\n    f: parse_PtgNum\n  },\n\n  /*::[*/\n  0x20\n  /*::]*/\n  : {\n    n: 'PtgArray',\n    f: parse_PtgArray\n  },\n\n  /*::[*/\n  0x21\n  /*::]*/\n  : {\n    n: 'PtgFunc',\n    f: parse_PtgFunc\n  },\n\n  /*::[*/\n  0x22\n  /*::]*/\n  : {\n    n: 'PtgFuncVar',\n    f: parse_PtgFuncVar\n  },\n\n  /*::[*/\n  0x23\n  /*::]*/\n  : {\n    n: 'PtgName',\n    f: parse_PtgName\n  },\n\n  /*::[*/\n  0x24\n  /*::]*/\n  : {\n    n: 'PtgRef',\n    f: parse_PtgRef\n  },\n\n  /*::[*/\n  0x25\n  /*::]*/\n  : {\n    n: 'PtgArea',\n    f: parse_PtgArea\n  },\n\n  /*::[*/\n  0x26\n  /*::]*/\n  : {\n    n: 'PtgMemArea',\n    f: parse_PtgMemArea\n  },\n\n  /*::[*/\n  0x27\n  /*::]*/\n  : {\n    n: 'PtgMemErr',\n    f: parse_PtgMemErr\n  },\n\n  /*::[*/\n  0x28\n  /*::]*/\n  : {\n    n: 'PtgMemNoMem',\n    f: parse_PtgMemNoMem\n  },\n\n  /*::[*/\n  0x29\n  /*::]*/\n  : {\n    n: 'PtgMemFunc',\n    f: parse_PtgMemFunc\n  },\n\n  /*::[*/\n  0x2A\n  /*::]*/\n  : {\n    n: 'PtgRefErr',\n    f: parse_PtgRefErr\n  },\n\n  /*::[*/\n  0x2B\n  /*::]*/\n  : {\n    n: 'PtgAreaErr',\n    f: parse_PtgAreaErr\n  },\n\n  /*::[*/\n  0x2C\n  /*::]*/\n  : {\n    n: 'PtgRefN',\n    f: parse_PtgRefN\n  },\n\n  /*::[*/\n  0x2D\n  /*::]*/\n  : {\n    n: 'PtgAreaN',\n    f: parse_PtgAreaN\n  },\n\n  /*::[*/\n  0x2E\n  /*::]*/\n  : {\n    n: 'PtgMemAreaN',\n    f: parse_PtgMemAreaN\n  },\n\n  /*::[*/\n  0x2F\n  /*::]*/\n  : {\n    n: 'PtgMemNoMemN',\n    f: parse_PtgMemNoMemN\n  },\n\n  /*::[*/\n  0x39\n  /*::]*/\n  : {\n    n: 'PtgNameX',\n    f: parse_PtgNameX\n  },\n\n  /*::[*/\n  0x3A\n  /*::]*/\n  : {\n    n: 'PtgRef3d',\n    f: parse_PtgRef3d\n  },\n\n  /*::[*/\n  0x3B\n  /*::]*/\n  : {\n    n: 'PtgArea3d',\n    f: parse_PtgArea3d\n  },\n\n  /*::[*/\n  0x3C\n  /*::]*/\n  : {\n    n: 'PtgRefErr3d',\n    f: parse_PtgRefErr3d\n  },\n\n  /*::[*/\n  0x3D\n  /*::]*/\n  : {\n    n: 'PtgAreaErr3d',\n    f: parse_PtgAreaErr3d\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\n/* These are duplicated in the PtgTypes table */\n\nvar PtgDupes = {\n  /*::[*/\n  0x40\n  /*::]*/\n  : 0x20,\n\n  /*::[*/\n  0x60\n  /*::]*/\n  : 0x20,\n\n  /*::[*/\n  0x41\n  /*::]*/\n  : 0x21,\n\n  /*::[*/\n  0x61\n  /*::]*/\n  : 0x21,\n\n  /*::[*/\n  0x42\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x62\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x43\n  /*::]*/\n  : 0x23,\n\n  /*::[*/\n  0x63\n  /*::]*/\n  : 0x23,\n\n  /*::[*/\n  0x44\n  /*::]*/\n  : 0x24,\n\n  /*::[*/\n  0x64\n  /*::]*/\n  : 0x24,\n\n  /*::[*/\n  0x45\n  /*::]*/\n  : 0x25,\n\n  /*::[*/\n  0x65\n  /*::]*/\n  : 0x25,\n\n  /*::[*/\n  0x46\n  /*::]*/\n  : 0x26,\n\n  /*::[*/\n  0x66\n  /*::]*/\n  : 0x26,\n\n  /*::[*/\n  0x47\n  /*::]*/\n  : 0x27,\n\n  /*::[*/\n  0x67\n  /*::]*/\n  : 0x27,\n\n  /*::[*/\n  0x48\n  /*::]*/\n  : 0x28,\n\n  /*::[*/\n  0x68\n  /*::]*/\n  : 0x28,\n\n  /*::[*/\n  0x49\n  /*::]*/\n  : 0x29,\n\n  /*::[*/\n  0x69\n  /*::]*/\n  : 0x29,\n\n  /*::[*/\n  0x4A\n  /*::]*/\n  : 0x2A,\n\n  /*::[*/\n  0x6A\n  /*::]*/\n  : 0x2A,\n\n  /*::[*/\n  0x4B\n  /*::]*/\n  : 0x2B,\n\n  /*::[*/\n  0x6B\n  /*::]*/\n  : 0x2B,\n\n  /*::[*/\n  0x4C\n  /*::]*/\n  : 0x2C,\n\n  /*::[*/\n  0x6C\n  /*::]*/\n  : 0x2C,\n\n  /*::[*/\n  0x4D\n  /*::]*/\n  : 0x2D,\n\n  /*::[*/\n  0x6D\n  /*::]*/\n  : 0x2D,\n\n  /*::[*/\n  0x4E\n  /*::]*/\n  : 0x2E,\n\n  /*::[*/\n  0x6E\n  /*::]*/\n  : 0x2E,\n\n  /*::[*/\n  0x4F\n  /*::]*/\n  : 0x2F,\n\n  /*::[*/\n  0x6F\n  /*::]*/\n  : 0x2F,\n\n  /*::[*/\n  0x58\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x78\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x59\n  /*::]*/\n  : 0x39,\n\n  /*::[*/\n  0x79\n  /*::]*/\n  : 0x39,\n\n  /*::[*/\n  0x5A\n  /*::]*/\n  : 0x3A,\n\n  /*::[*/\n  0x7A\n  /*::]*/\n  : 0x3A,\n\n  /*::[*/\n  0x5B\n  /*::]*/\n  : 0x3B,\n\n  /*::[*/\n  0x7B\n  /*::]*/\n  : 0x3B,\n\n  /*::[*/\n  0x5C\n  /*::]*/\n  : 0x3C,\n\n  /*::[*/\n  0x7C\n  /*::]*/\n  : 0x3C,\n\n  /*::[*/\n  0x5D\n  /*::]*/\n  : 0x3D,\n\n  /*::[*/\n  0x7D\n  /*::]*/\n  : 0x3D\n};\nvar Ptg18 = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgElfLel',\n    f: parse_PtgElfLel\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgElfRw',\n    f: parse_PtgElfRw\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PtgElfCol',\n    f: parse_PtgElfCol\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'PtgElfRwV',\n    f: parse_PtgElfRwV\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'PtgElfColV',\n    f: parse_PtgElfColV\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'PtgElfRadical',\n    f: parse_PtgElfRadical\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'PtgElfRadicalS',\n    f: parse_PtgElfRadicalS\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'PtgElfColS',\n    f: parse_PtgElfColS\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'PtgElfColSV',\n    f: parse_PtgElfColSV\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgElfRadicalLel',\n    f: parse_PtgElfRadicalLel\n  },\n\n  /*::[*/\n  0x19\n  /*::]*/\n  : {\n    n: 'PtgList',\n    f: parse_PtgList\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'PtgSxName',\n    f: parse_PtgSxName\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\nvar Ptg19 = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : {\n    n: 'PtgAttrNoop',\n    f: parse_PtgAttrNoop\n  },\n\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgAttrSemi',\n    f: parse_PtgAttrSemi\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgAttrIf',\n    f: parse_PtgAttrIf\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'PtgAttrChoose',\n    f: parse_PtgAttrChoose\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'PtgAttrGoto',\n    f: parse_PtgAttrGoto\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgAttrSum',\n    f: parse_PtgAttrSum\n  },\n\n  /*::[*/\n  0x20\n  /*::]*/\n  : {\n    n: 'PtgAttrBaxcel',\n    f: parse_PtgAttrBaxcel\n  },\n\n  /*::[*/\n  0x21\n  /*::]*/\n  : {\n    n: 'PtgAttrBaxcel',\n    f: parse_PtgAttrBaxcel\n  },\n\n  /*::[*/\n  0x40\n  /*::]*/\n  : {\n    n: 'PtgAttrSpace',\n    f: parse_PtgAttrSpace\n  },\n\n  /*::[*/\n  0x41\n  /*::]*/\n  : {\n    n: 'PtgAttrSpaceSemi',\n    f: parse_PtgAttrSpaceSemi\n  },\n\n  /*::[*/\n  0x80\n  /*::]*/\n  : {\n    n: 'PtgAttrIfError',\n    f: parse_PtgAttrIfError\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\n\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n  if (opts.biff < 8) return parsenoop(blob, length);\n  var target = blob.l + length;\n  var o = [];\n\n  for (var i = 0; i !== rgce.length; ++i) {\n    switch (rgce[i][0]) {\n      case 'PtgArray':\n        /* PtgArray -> PtgExtraArray */\n        rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n        o.push(rgce[i][1]);\n        break;\n\n      case 'PtgMemArea':\n        /* PtgMemArea -> PtgExtraMem */\n        rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n        o.push(rgce[i][2]);\n        break;\n\n      case 'PtgExp':\n        /* PtgExp -> PtgExtraCol */\n        if (opts && opts.biff == 12) {\n          rgce[i][1][1] = blob.read_shift(4);\n          o.push(rgce[i][1]);\n        }\n\n        break;\n\n      case 'PtgList':\n      /* TODO: PtgList -> PtgExtraList */\n\n      case 'PtgElfRadicalS':\n      /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\n      case 'PtgElfColS':\n      /* TODO: PtgElfColS -> PtgExtraElf */\n\n      case 'PtgElfColSV':\n        /* TODO: PtgElfColSV -> PtgExtraElf */\n        throw \"Unsupported \" + rgce[i][0];\n    }\n  }\n\n  length = target - blob.l;\n  /* note: this is technically an error but Excel disregards */\n  //if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\n  if (length !== 0) o.push(parsenoop(blob, length));\n  return o;\n}\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\n\n\nfunction parse_Rgce(blob, length, opts) {\n  var target = blob.l + length;\n  var R,\n      id,\n      ptgs = [];\n\n  while (target != blob.l) {\n    length = target - blob.l;\n    id = blob[blob.l];\n    R = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n    if (id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\n    if (!R || !R.f) {\n      /*ptgs.push*/\n      parsenoop(blob, length);\n    } else {\n      ptgs.push([R.n, R.f(blob, length, opts)]);\n    }\n  }\n\n  return ptgs;\n}\n\nfunction stringify_array(f\n/*:Array<Array<string>>*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < f.length; ++i) {\n    var x = f[i],\n        r\n    /*:Array<string>*/\n    = [];\n\n    for (var j = 0; j < x.length; ++j) {\n      var y = x[j];\n      if (y) switch (y[0]) {\n        // TODO: handle embedded quotes\n        case 0x02:\n          /*:: if(typeof y[1] != 'string') throw \"unreachable\"; */\n          r.push('\"' + y[1].replace(/\"/g, '\"\"') + '\"');\n          break;\n\n        default:\n          r.push(y[1]);\n      } else r.push(\"\");\n    }\n\n    o.push(r.join(\",\"));\n  }\n\n  return o.join(\";\");\n}\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\n\n\nvar PtgBinOp = {\n  PtgAdd: \"+\",\n  PtgConcat: \"&\",\n  PtgDiv: \"/\",\n  PtgEq: \"=\",\n  PtgGe: \">=\",\n  PtgGt: \">\",\n  PtgLe: \"<=\",\n  PtgLt: \"<\",\n  PtgMul: \"*\",\n  PtgNe: \"<>\",\n  PtgPower: \"^\",\n  PtgSub: \"-\"\n}; // List of invalid characters needs to be tested further\n\nfunction formula_quote_sheet_name(sname\n/*:string*/\n, opts)\n/*:string*/\n{\n  if (!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n  if (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname + \"'\";\n  return sname;\n}\n\nfunction get_ixti_raw(supbooks, ixti\n/*:number*/\n, opts)\n/*:string*/\n{\n  if (!supbooks) return \"SH33TJSERR0\";\n  if (opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n  if (!supbooks.XTI) return \"SH33TJSERR6\";\n  var XTI = supbooks.XTI[ixti];\n\n  if (opts.biff < 8) {\n    if (ixti > 10000) ixti -= 65536;\n    if (ixti < 0) ixti = -ixti;\n    return ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n  }\n\n  if (!XTI) return \"SH33TJSERR1\";\n  var o = \"\";\n  if (opts.biff > 8) switch (supbooks[XTI[0]][0]) {\n    case 0x0165:\n      /* 'BrtSupSelf' */\n      o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\n    case 0x0166:\n      /* 'BrtSupSame' */\n      if (opts.SID != null) return supbooks.SheetNames[opts.SID];\n      return \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\n    case 0x0163:\n    /* 'BrtSupBookSrc' */\n\n    /* falls through */\n\n    default:\n      return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n  }\n\n  switch (supbooks[XTI[0]][0][0]) {\n    case 0x0401:\n      o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\";\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\n    case 0x3A01:\n      return supbooks[XTI[0]].slice(1).map(function (name) {\n        return name.Name;\n      }).join(\";;\");\n    //return \"SH33TJSERR8\";\n\n    default:\n      if (!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n      o = XTI[1] == -1 ? \"#REF\" : supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\";\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n  }\n}\n\nfunction get_ixti(supbooks, ixti\n/*:number*/\n, opts)\n/*:string*/\n{\n  var ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n  return ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\n\nfunction stringify_formula(formula\n/*Array<any>*/\n, range, cell\n/*:any*/\n, supbooks, opts)\n/*:string*/\n{\n  var biff = opts && opts.biff || 8;\n  var _range =\n  /*range != null ? range :*/\n  {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var stack\n  /*:Array<string>*/\n  = [],\n      e1,\n      e2,\n\n  /*::type,*/\n  c\n  /*:CellAddress*/\n  ,\n      ixti = 0,\n      nameidx = 0,\n      r,\n      sname = \"\";\n  if (!formula[0] || !formula[0][0]) return \"\";\n  var last_sp = -1,\n      sp = \"\";\n\n  for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n    var f = formula[0][ff];\n\n    switch (f[0]) {\n      case 'PtgUminus':\n        /* [MS-XLS] 2.5.198.93 */\n        stack.push(\"-\" + stack.pop());\n        break;\n\n      case 'PtgUplus':\n        /* [MS-XLS] 2.5.198.95 */\n        stack.push(\"+\" + stack.pop());\n        break;\n\n      case 'PtgPercent':\n        /* [MS-XLS] 2.5.198.81 */\n        stack.push(stack.pop() + \"%\");\n        break;\n\n      case 'PtgAdd':\n      /* [MS-XLS] 2.5.198.26 */\n\n      case 'PtgConcat':\n      /* [MS-XLS] 2.5.198.43 */\n\n      case 'PtgDiv':\n      /* [MS-XLS] 2.5.198.45 */\n\n      case 'PtgEq':\n      /* [MS-XLS] 2.5.198.56 */\n\n      case 'PtgGe':\n      /* [MS-XLS] 2.5.198.64 */\n\n      case 'PtgGt':\n      /* [MS-XLS] 2.5.198.65 */\n\n      case 'PtgLe':\n      /* [MS-XLS] 2.5.198.68 */\n\n      case 'PtgLt':\n      /* [MS-XLS] 2.5.198.69 */\n\n      case 'PtgMul':\n      /* [MS-XLS] 2.5.198.75 */\n\n      case 'PtgNe':\n      /* [MS-XLS] 2.5.198.78 */\n\n      case 'PtgPower':\n      /* [MS-XLS] 2.5.198.82 */\n\n      case 'PtgSub':\n        /* [MS-XLS] 2.5.198.90 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n\n        if (last_sp >= 0) {\n          switch (formula[0][last_sp][1][0]) {\n            case 0:\n              // $FlowIgnore\n              sp = fill(\" \", formula[0][last_sp][1][1]);\n              break;\n\n            case 1:\n              // $FlowIgnore\n              sp = fill(\"\\r\", formula[0][last_sp][1][1]);\n              break;\n\n            default:\n              sp = \"\"; // $FlowIgnore\n\n              if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n          }\n\n          e2 = e2 + sp;\n          last_sp = -1;\n        }\n\n        stack.push(e2 + PtgBinOp[f[0]] + e1);\n        break;\n\n      case 'PtgIsect':\n        /* [MS-XLS] 2.5.198.67 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \" \" + e1);\n        break;\n\n      case 'PtgUnion':\n        /* [MS-XLS] 2.5.198.94 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \",\" + e1);\n        break;\n\n      case 'PtgRange':\n        /* [MS-XLS] 2.5.198.83 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \":\" + e1);\n        break;\n\n      case 'PtgAttrChoose':\n        /* [MS-XLS] 2.5.198.34 */\n        break;\n\n      case 'PtgAttrGoto':\n        /* [MS-XLS] 2.5.198.35 */\n        break;\n\n      case 'PtgAttrIf':\n        /* [MS-XLS] 2.5.198.36 */\n        break;\n\n      case 'PtgAttrIfError':\n        /* [MS-XLSB] 2.5.97.28 */\n        break;\n\n      case 'PtgRef':\n        /* [MS-XLS] 2.5.198.84 */\n\n        /*::type = f[1][0]; */\n        c = shift_cell_xls(f[1][1]\n        /*:any*/\n        , _range, opts);\n        stack.push(encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgRefN':\n        /* [MS-XLS] 2.5.198.88 */\n\n        /*::type = f[1][0]; */\n        c = cell ? shift_cell_xls(f[1][1]\n        /*:any*/\n        , cell, opts) : f[1][1]\n        /*:any*/\n        ;\n        stack.push(encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgRef3d':\n        /* [MS-XLS] 2.5.198.85 */\n\n        /*::type = f[1][0]; */\n        ixti =\n        /*::Number(*/\n        f[1][1]\n        /*::)*/\n        ;\n        c = shift_cell_xls(f[1][2]\n        /*:any*/\n        , _range, opts);\n        sname = get_ixti(supbooks, ixti, opts);\n        stack.push(sname + \"!\" + encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgFunc':\n      /* [MS-XLS] 2.5.198.62 */\n\n      case 'PtgFuncVar':\n        /* [MS-XLS] 2.5.198.63 */\n\n        /* f[1] = [argc, func, type] */\n        var argc\n        /*:number*/\n        = f[1][0]\n        /*:any*/\n        ,\n            func\n        /*:string*/\n        = f[1][1]\n        /*:any*/\n        ;\n        if (!argc) argc = 0;\n        argc &= 0x7F;\n        var args = argc == 0 ? [] : stack.slice(-argc);\n        stack.length -= argc;\n        if (func === 'User') func = args.shift();\n        stack.push(func + \"(\" + args.join(\",\") + \")\");\n        break;\n\n      case 'PtgBool':\n        /* [MS-XLS] 2.5.198.42 */\n        stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n        break;\n\n      case 'PtgInt':\n        /* [MS-XLS] 2.5.198.66 */\n        stack.push(\n        /*::String(*/\n        f[1]\n        /*::)*/\n        );\n        break;\n\n      case 'PtgNum':\n        /* [MS-XLS] 2.5.198.79 TODO: precision? */\n        stack.push(String(f[1]));\n        break;\n\n      case 'PtgStr':\n        /* [MS-XLS] 2.5.198.89 */\n        // $FlowIgnore\n        stack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"');\n        break;\n\n      case 'PtgErr':\n        /* [MS-XLS] 2.5.198.57 */\n        stack.push(\n        /*::String(*/\n        f[1]\n        /*::)*/\n        );\n        break;\n\n      case 'PtgAreaN':\n        /* [MS-XLS] 2.5.198.31 TODO */\n\n        /*::type = f[1][0]; */\n        r = shift_range_xls(f[1][1], cell ? {\n          s: cell\n        } : _range, opts);\n        stack.push(encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgArea':\n        /* [MS-XLS] 2.5.198.27 TODO: fixed points */\n\n        /*::type = f[1][0]; */\n        r = shift_range_xls(f[1][1], _range, opts);\n        stack.push(encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgArea3d':\n        /* [MS-XLS] 2.5.198.28 TODO */\n\n        /*::type = f[1][0]; */\n        ixti =\n        /*::Number(*/\n        f[1][1]\n        /*::)*/\n        ;\n        r = f[1][2];\n        sname = get_ixti(supbooks, ixti, opts);\n        stack.push(sname + \"!\" + encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgAttrSum':\n        /* [MS-XLS] 2.5.198.41 */\n        stack.push(\"SUM(\" + stack.pop() + \")\");\n        break;\n\n      case 'PtgAttrBaxcel':\n      /* [MS-XLS] 2.5.198.33 */\n\n      case 'PtgAttrSemi':\n        /* [MS-XLS] 2.5.198.37 */\n        break;\n\n      case 'PtgName':\n        /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\n        /* f[1] = type, 0, nameindex */\n        nameidx = f[1][2]\n        /*:any*/\n        ;\n        var lbl = (supbooks.names || [])[nameidx - 1] || (supbooks[0] || [])[nameidx];\n        var name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n        /* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\n        if (name && name.slice(0, 6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n        stack.push(name);\n        break;\n\n      case 'PtgNameX':\n        /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\n        /* f[1] = type, ixti, nameindex */\n        var bookidx\n        /*:number*/\n        = f[1][1]\n        /*:any*/\n        ;\n        nameidx = f[1][2]\n        /*:any*/\n        ;\n        var externbook;\n        /* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\n        if (opts.biff <= 5) {\n          if (bookidx < 0) bookidx = -bookidx;\n          if (supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n        } else {\n          var o = \"\";\n          if (((supbooks[bookidx] || [])[0] || [])[0] == 0x3A01) ;else if (((supbooks[bookidx] || [])[0] || [])[0] == 0x0401) {\n            if (supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n              o = supbooks.SheetNames[supbooks[bookidx][nameidx].itab - 1] + \"!\";\n            }\n          } else o = supbooks.SheetNames[nameidx - 1] + \"!\";\n          if (supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;else if (supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;else {\n            var ixtidata = (get_ixti_raw(supbooks, bookidx, opts) || \"\").split(\";;\");\n            if (ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n            else o += \"SH33TJSERRX\";\n          }\n          stack.push(o);\n          break;\n        }\n\n        if (!externbook) externbook = {\n          Name: \"SH33TJSERRY\"\n        };\n        stack.push(externbook.Name);\n        break;\n\n      case 'PtgParen':\n        /* [MS-XLS] 2.5.198.80 */\n        var lp = '(',\n            rp = ')';\n\n        if (last_sp >= 0) {\n          sp = \"\";\n\n          switch (formula[0][last_sp][1][0]) {\n            // $FlowIgnore\n            case 2:\n              lp = fill(\" \", formula[0][last_sp][1][1]) + lp;\n              break;\n            // $FlowIgnore\n\n            case 3:\n              lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp;\n              break;\n            // $FlowIgnore\n\n            case 4:\n              rp = fill(\" \", formula[0][last_sp][1][1]) + rp;\n              break;\n            // $FlowIgnore\n\n            case 5:\n              rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp;\n              break;\n\n            default:\n              // $FlowIgnore\n              if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n          }\n\n          last_sp = -1;\n        }\n\n        stack.push(lp + stack.pop() + rp);\n        break;\n\n      case 'PtgRefErr':\n        /* [MS-XLS] 2.5.198.86 */\n        stack.push('#REF!');\n        break;\n\n      case 'PtgRefErr3d':\n        /* [MS-XLS] 2.5.198.87 */\n        stack.push('#REF!');\n        break;\n\n      case 'PtgExp':\n        /* [MS-XLS] 2.5.198.58 TODO */\n        c = {\n          c: f[1][1]\n          /*:any*/\n          ,\n          r: f[1][0]\n          /*:any*/\n\n        };\n        var q = {\n          c: cell.c,\n          r: cell.r\n        }\n        /*:any*/\n        ;\n\n        if (supbooks.sharedf[encode_cell(c)]) {\n          var parsedf = supbooks.sharedf[encode_cell(c)];\n          stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n        } else {\n          var fnd = false;\n\n          for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n            /* TODO: should be something like range_has */\n            e2 = supbooks.arrayf[e1];\n            if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n            if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n            stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n            fnd = true;\n            break;\n          }\n\n          if (!fnd) stack.push(\n          /*::String(*/\n          f[1]\n          /*::)*/\n          );\n        }\n\n        break;\n\n      case 'PtgArray':\n        /* [MS-XLS] 2.5.198.32 TODO */\n        stack.push(\"{\" + stringify_array(\n        /*::(*/\n        f[1]\n        /*:: :any)*/\n        ) + \"}\");\n        break;\n\n      case 'PtgMemArea':\n        /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n        //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n        break;\n\n      case 'PtgAttrSpace':\n      /* [MS-XLS] 2.5.198.38 */\n\n      case 'PtgAttrSpaceSemi':\n        /* [MS-XLS] 2.5.198.39 */\n        last_sp = ff;\n        break;\n\n      case 'PtgTbl':\n        /* [MS-XLS] 2.5.198.92 TODO */\n        break;\n\n      case 'PtgMemErr':\n        /* [MS-XLS] 2.5.198.71 */\n        break;\n\n      case 'PtgMissArg':\n        /* [MS-XLS] 2.5.198.74 */\n        stack.push(\"\");\n        break;\n\n      case 'PtgAreaErr':\n        /* [MS-XLS] 2.5.198.29 */\n        stack.push(\"#REF!\");\n        break;\n\n      case 'PtgAreaErr3d':\n        /* [MS-XLS] 2.5.198.30 */\n        stack.push(\"#REF!\");\n        break;\n\n      case 'PtgList':\n        /* [MS-XLSB] 2.5.97.52 */\n        // $FlowIgnore\n        stack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n        break;\n\n      case 'PtgMemAreaN':\n      case 'PtgMemNoMemN':\n      case 'PtgAttrNoop':\n      case 'PtgSheet':\n      case 'PtgEndSheet':\n        break;\n\n      case 'PtgMemFunc':\n        /* [MS-XLS] 2.5.198.72 TODO */\n        break;\n\n      case 'PtgMemNoMem':\n        /* [MS-XLS] 2.5.198.73 TODO */\n        break;\n\n      case 'PtgElfCol':\n      /* [MS-XLS] 2.5.198.46 */\n\n      case 'PtgElfColS':\n      /* [MS-XLS] 2.5.198.47 */\n\n      case 'PtgElfColSV':\n      /* [MS-XLS] 2.5.198.48 */\n\n      case 'PtgElfColV':\n      /* [MS-XLS] 2.5.198.49 */\n\n      case 'PtgElfLel':\n      /* [MS-XLS] 2.5.198.50 */\n\n      case 'PtgElfRadical':\n      /* [MS-XLS] 2.5.198.51 */\n\n      case 'PtgElfRadicalLel':\n      /* [MS-XLS] 2.5.198.52 */\n\n      case 'PtgElfRadicalS':\n      /* [MS-XLS] 2.5.198.53 */\n\n      case 'PtgElfRw':\n      /* [MS-XLS] 2.5.198.54 */\n\n      case 'PtgElfRwV':\n        /* [MS-XLS] 2.5.198.55 */\n        throw new Error(\"Unsupported ELFs\");\n\n      case 'PtgSxName':\n        /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n        throw new Error('Unrecognized Formula Token: ' + String(f));\n\n      default:\n        throw new Error('Unrecognized Formula Token: ' + String(f));\n    }\n\n    var PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n    if (opts.biff != 3) if (last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n      f = formula[0][last_sp];\n      var _left = true;\n\n      switch (f[1][0]) {\n        /* note: some bad XLSB files omit the PtgParen */\n        case 4:\n          _left = false;\n\n        /* falls through */\n\n        case 0:\n          // $FlowIgnore\n          sp = fill(\" \", f[1][1]);\n          break;\n\n        case 5:\n          _left = false;\n\n        /* falls through */\n\n        case 1:\n          // $FlowIgnore\n          sp = fill(\"\\r\", f[1][1]);\n          break;\n\n        default:\n          sp = \"\"; // $FlowIgnore\n\n          if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n      }\n\n      stack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n      last_sp = -1;\n    }\n  }\n\n  if (stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n  return stack[0];\n}\n/* [MS-XLS] 2.5.198.1 TODO */\n\n\nfunction parse_ArrayParsedFormula(blob, length, opts\n/*::, ref*/\n) {\n  var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n  var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n  blob.l = target;\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.3 TODO */\n\n\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n  var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n  var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n  blob.l = target;\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.21 */\n\n\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n  var target = blob.l + length;\n  var rgce = parse_Rgce(blob, cce, opts);\n  var rgcb;\n  if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.118 TODO */\n\n\nfunction parse_SharedParsedFormula(blob, length, opts) {\n  var target = blob.l + length;\n  var rgcb,\n      cce = blob.read_shift(2); // length of rgce\n\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\n\n\nfunction parse_FormulaValue(blob\n/*::, length*/\n) {\n  var b;\n  if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n\n  switch (blob[blob.l]) {\n    case 0x00:\n      blob.l += 8;\n      return [\"String\", 's'];\n\n    case 0x01:\n      b = blob[blob.l + 2] === 0x1;\n      blob.l += 8;\n      return [b, 'b'];\n\n    case 0x02:\n      b = blob[blob.l + 2];\n      blob.l += 8;\n      return [b, 'e'];\n\n    case 0x03:\n      blob.l += 8;\n      return [\"\", 's'];\n  }\n\n  return [];\n}\n/* [MS-XLS] 2.4.127 TODO */\n\n\nfunction parse_Formula(blob, length, opts) {\n  var end = blob.l + length;\n  var cell = parse_XLSCell(blob);\n  if (opts.biff == 2) ++blob.l;\n  var val = parse_FormulaValue(blob);\n  var flags = blob.read_shift(1);\n\n  if (opts.biff != 2) {\n    blob.read_shift(1);\n\n    if (opts.biff >= 5) {\n      /*var chn = */\n      blob.read_shift(4);\n    }\n  }\n\n  var cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n  return {\n    cell: cell,\n    val: val[0],\n    formula: cbf,\n    shared: flags >> 3 & 1,\n    tt: val[1]\n  };\n}\n/* XLSB Parsed Formula records have the same shape */\n\n\nfunction parse_XLSBParsedFormula(data, length, opts) {\n  var cce = data.read_shift(4);\n  var rgce = parse_Rgce(data, cce, opts);\n  var cb = data.read_shift(4);\n  var rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n  return [rgce, rgcb];\n}\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\n\n\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\n\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\n\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\n\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\n\nfunction ods_to_csf_formula(f\n/*:string*/\n)\n/*:string*/\n{\n  if (f.slice(0, 3) == \"of:\") f = f.slice(3);\n  /* 5.2 Basic Expressions */\n\n  if (f.charCodeAt(0) == 61) {\n    f = f.slice(1);\n    if (f.charCodeAt(0) == 61) f = f.slice(1);\n  }\n\n  f = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n  /* Part 3 Section 5.8 References */\n\n  f = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function ($$, $1) {\n    return $1.replace(/\\./g, \"\");\n  });\n  /* TODO: something other than this */\n\n  f = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n  return f.replace(/[;~]/g, \",\").replace(/\\|/g, \";\");\n}\n\nfunction ods_to_csf_3D(r\n/*:string*/\n)\n/*:[string, string]*/\n{\n  var a = r.split(\":\");\n  var s = a[0].split(\".\")[0];\n  return [s, a[0].split(\".\")[1] + (a.length > 1 ? \":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0]) : \"\")];\n}\n\nvar strs = {}; // shared strings\n\nvar _ssfopts = {}; // spreadsheet formatting options\n\nfunction default_margins(margins\n/*:Margins*/\n, mode\n/*:?string*/\n) {\n  if (!margins) return;\n  var defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n  if (mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n  if (margins.left == null) margins.left = defs[0];\n  if (margins.right == null) margins.right = defs[1];\n  if (margins.top == null) margins.top = defs[2];\n  if (margins.bottom == null) margins.bottom = defs[3];\n  if (margins.header == null) margins.header = defs[4];\n  if (margins.footer == null) margins.footer = defs[5];\n}\n\nfunction safe_format(p\n/*:Cell*/\n, fmtid\n/*:number*/\n, fillid\n/*:?number*/\n, opts, themes, styles) {\n  try {\n    if (opts.cellNF) p.z = table_fmt[fmtid];\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (p.t === 'z' && !opts.cellStyles) return;\n  if (p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n  if ((!opts || opts.cellText !== false) && p.t !== 'z') try {\n    if (table_fmt[fmtid] == null) SSF_load(SSFImplicit[fmtid] || \"General\", fmtid);\n    if (p.t === 'e') p.w = p.w || BErr[p.v];else if (fmtid === 0) {\n      if (p.t === 'n') {\n        if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n      } else if (p.t === 'd') {\n        var dd = datenum(p.v);\n        if ((dd | 0) === dd) p.w = dd.toString(10);else p.w = SSF_general_num(dd);\n      } else if (p.v === undefined) return \"\";else p.w = SSF_general(p.v, _ssfopts);\n    } else if (p.t === 'd') p.w = SSF_format(fmtid, datenum(p.v), _ssfopts);else p.w = SSF_format(fmtid, p.v, _ssfopts);\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n  if (!opts.cellStyles) return;\n  if (fillid != null) try {\n    p.s = styles.Fills[fillid];\n\n    if (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n      p.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n      if (opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n    }\n\n    if (p.s.bgColor && p.s.bgColor.theme) {\n      p.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n      if (opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n    }\n  } catch (e) {\n    if (opts.WTF && styles.Fills) throw e;\n  }\n}\n\nfunction parse_ws_xml_dim(ws\n/*:Worksheet*/\n, s\n/*:string*/\n) {\n  var d = safe_decode_range(s);\n  if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n}\n\nvar mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\nvar afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nvar marginregex = /<(?:\\w:)?pageMargins[^>]*\\/>/g;\nvar sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\nvar sheetprregex2 = /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\nvar svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n/* 18.3 Worksheets */\n\nfunction parse_ws_xml(data\n/*:?string*/\n, opts, idx\n/*:number*/\n, rels, wb\n/*:WBWBProps*/\n, themes, styles)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  if (!rels) rels = {\n    '!id': {}\n  };\n  /* 18.3.1.99 worksheet CT_Worksheet */\n\n  var s = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  var refguess\n  /*:Range*/\n  = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  }\n  /*:any*/\n  ;\n  var data1 = \"\",\n      data2 = \"\";\n  var mtch\n  /*:?any*/\n  = data.match(sheetdataregex);\n\n  if (mtch) {\n    data1 = data.slice(0, mtch.index);\n    data2 = data.slice(mtch.index + mtch[0].length);\n  } else data1 = data2 = data;\n  /* 18.3.1.82 sheetPr CT_SheetPr */\n\n\n  var sheetPr = data1.match(sheetprregex);\n  if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);else if (sheetPr = data1.match(sheetprregex2)) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1] || \"\", s, wb, idx);\n  /* 18.3.1.35 dimension CT_SheetDimension */\n\n  var ridx = (data1.match(/<(?:\\w*:)?dimension/) || {\n    index: -1\n  }).index;\n\n  if (ridx > 0) {\n    var ref = data1.slice(ridx, ridx + 50).match(dimregex);\n    if (ref) parse_ws_xml_dim(s, ref[1]);\n  }\n  /* 18.3.1.88 sheetViews CT_SheetViews */\n\n\n  var svs = data1.match(svsregex);\n  if (svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n  /* 18.3.1.17 cols CT_Cols */\n\n  var columns\n  /*:Array<ColInfo>*/\n  = [];\n\n  if (opts.cellStyles) {\n    /* 18.3.1.13 col CT_Col */\n    var cols = data1.match(colregex);\n    if (cols) parse_ws_xml_cols(columns, cols);\n  }\n  /* 18.3.1.80 sheetData CT_SheetData ? */\n\n\n  if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\n  /* 18.3.1.2  autoFilter CT_AutoFilter */\n\n  var afilter = data2.match(afregex);\n  if (afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n  /* 18.3.1.55 mergeCells CT_MergeCells */\n\n  var merges\n  /*:Array<Range>*/\n  = [];\n\n  var _merge = data2.match(mergecregex);\n\n  if (_merge) for (ridx = 0; ridx != _merge.length; ++ridx) {\n    merges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\") + 1));\n  }\n  /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\n  var hlink = data2.match(hlinkregex);\n  if (hlink) parse_ws_xml_hlinks(s, hlink, rels);\n  /* 18.3.1.62 pageMargins CT_PageMargins */\n\n  var margins = data2.match(marginregex);\n  if (margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n  if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\n  if (opts.sheetRows > 0 && s[\"!ref\"]) {\n    var tmpref = safe_decode_range(s[\"!ref\"]);\n\n    if (opts.sheetRows <= +tmpref.e.r) {\n      tmpref.e.r = opts.sheetRows - 1;\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n      s[\"!fullref\"] = s[\"!ref\"];\n      s[\"!ref\"] = encode_range(tmpref);\n    }\n  }\n\n  if (columns.length > 0) s[\"!cols\"] = columns;\n  if (merges.length > 0) s[\"!merges\"] = merges;\n  return s;\n}\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\n\n\nfunction parse_ws_xml_sheetpr(sheetPr\n/*:string*/\n, s, wb\n/*:WBWBProps*/\n, idx\n/*:number*/\n) {\n  var data = parsexmltag(sheetPr);\n  if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n  if (data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\n\nfunction parse_ws_xml_sheetpr2(sheetPr\n/*:string*/\n, body\n/*:string*/\n, s, wb\n/*:WBWBProps*/\n, idx\n/*:number*/\n) {\n  parse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\n\nfunction parse_ws_xml_hlinks(s, data\n/*:Array<string>*/\n, rels) {\n  var dense = Array.isArray(s);\n\n  for (var i = 0; i != data.length; ++i) {\n    var val = parsexmltag(utf8read(data[i]), true);\n    if (!val.ref) return;\n    var rel = ((rels || {})['!id'] || [])[val.id];\n\n    if (rel) {\n      val.Target = rel.Target;\n      if (val.location) val.Target += \"#\" + unescapexml(val.location);\n    } else {\n      val.Target = \"#\" + unescapexml(val.location);\n      rel = {\n        Target: val.Target,\n        TargetMode: 'Internal'\n      };\n    }\n\n    val.Rel = rel;\n\n    if (val.tooltip) {\n      val.Tooltip = val.tooltip;\n      delete val.tooltip;\n    }\n\n    var rng = safe_decode_range(val.ref);\n\n    for (var R = rng.s.r; R <= rng.e.r; ++R) {\n      for (var C = rng.s.c; C <= rng.e.c; ++C) {\n        var addr = encode_cell({\n          c: C,\n          r: R\n        });\n\n        if (dense) {\n          if (!s[R]) s[R] = [];\n          if (!s[R][C]) s[R][C] = {\n            t: \"z\",\n            v: undefined\n          };\n          s[R][C].l = val;\n        } else {\n          if (!s[addr]) s[addr] = {\n            t: \"z\",\n            v: undefined\n          };\n          s[addr].l = val;\n        }\n      }\n    }\n  }\n}\n\nfunction parse_ws_xml_margins(margin) {\n  var o = {};\n  [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function (k) {\n    if (margin[k]) o[k] = parseFloat(margin[k]);\n  });\n  return o;\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n  var seencol = false;\n\n  for (var coli = 0; coli != cols.length; ++coli) {\n    var coll = parsexmltag(cols[coli], true);\n    if (coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n    var colm = parseInt(coll.min, 10) - 1,\n        colM = parseInt(coll.max, 10) - 1;\n    if (coll.outlineLevel) coll.level = +coll.outlineLevel || 0;\n    delete coll.min;\n    delete coll.max;\n    coll.width = +coll.width;\n\n    if (!seencol && coll.width) {\n      seencol = true;\n      find_mdw_colw(coll.width);\n    }\n\n    process_col(coll);\n\n    while (colm <= colM) {\n      columns[colm++] = dup(coll);\n    }\n  }\n}\n\nfunction parse_ws_xml_autofilter(data\n/*:string*/\n) {\n  var o = {\n    ref: (data.match(/ref=\"([^\"]*)\"/) || [])[1]\n  };\n  return o;\n}\n/* 18.3.1.88 sheetViews CT_SheetViews */\n\n/* 18.3.1.87 sheetView CT_SheetView */\n\n\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;\n\nfunction parse_ws_xml_sheetviews(data, wb\n/*:WBWBProps*/\n) {\n  if (!wb.Views) wb.Views = [{}];\n  (data.match(sviewregex) || []).forEach(function (r\n  /*:string*/\n  , i\n  /*:number*/\n  ) {\n    var tag = parsexmltag(r); // $FlowIgnore\n\n    if (!wb.Views[i]) wb.Views[i] = {}; // $FlowIgnore\n\n    if (+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale; // $FlowIgnore\n\n    if (parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n  });\n}\n\nvar parse_ws_xml_data = /*#__PURE__*/function () {\n  var cellregex = /<(?:\\w+:)?c[ \\/>]/,\n      rowregex = /<\\/(?:\\w+:)?row>/;\n  var rregex = /r=[\"']([^\"']*)[\"']/,\n      isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n  var refregex = /ref=[\"']([^\"']*)[\"']/;\n  var match_v = matchtag(\"v\"),\n      match_f = matchtag(\"f\");\n  return function parse_ws_xml_data(sdata\n  /*:string*/\n  , s, opts, guess\n  /*:Range*/\n  , themes, styles) {\n    var ri = 0,\n        x = \"\",\n        cells\n    /*:Array<string>*/\n    = [],\n        cref\n    /*:?Array<string>*/\n    = [],\n        idx = 0,\n        i = 0,\n        cc = 0,\n        d = \"\",\n        p\n    /*:any*/\n    ;\n    var tag,\n        tagr = 0,\n        tagc = 0;\n    var sstr, ftag;\n    var fmtid = 0,\n        fillid = 0;\n    var do_format = Array.isArray(styles.CellXf),\n        cf;\n    var arrayf\n    /*:Array<[Range, string]>*/\n    = [];\n    var sharedf = [];\n    var dense = Array.isArray(s);\n    var rows\n    /*:Array<RowInfo>*/\n    = [],\n        rowobj = {},\n        rowrite = false;\n    var sheetStubs = !!opts.sheetStubs;\n\n    for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n      x = marr[mt].trim();\n      var xlen = x.length;\n      if (xlen === 0) continue;\n      /* 18.3.1.73 row CT_Row */\n\n      var rstarti = 0;\n\n      outa: for (ri = 0; ri < xlen; ++ri) {\n        switch (\n        /*x.charCodeAt(ri)*/\n        x[ri]) {\n          case \">\"\n          /*62*/\n          :\n            if (\n            /*x.charCodeAt(ri-1) != 47*/\n            x[ri - 1] != \"/\") {\n              ++ri;\n              break outa;\n            }\n\n            if (opts && opts.cellStyles) {\n              // TODO: avoid duplication\n              tag = parsexmltag(x.slice(rstarti, ri), true);\n              tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n              tagc = -1;\n              if (opts.sheetRows && opts.sheetRows < tagr) continue;\n              rowobj = {};\n              rowrite = false;\n\n              if (tag.ht) {\n                rowrite = true;\n                rowobj.hpt = parseFloat(tag.ht);\n                rowobj.hpx = pt2px(rowobj.hpt);\n              }\n\n              if (tag.hidden == \"1\") {\n                rowrite = true;\n                rowobj.hidden = true;\n              }\n\n              if (tag.outlineLevel != null) {\n                rowrite = true;\n                rowobj.level = +tag.outlineLevel;\n              }\n\n              if (rowrite) rows[tagr - 1] = rowobj;\n            }\n\n            break;\n\n          case \"<\"\n          /*60*/\n          :\n            rstarti = ri;\n            break;\n        }\n      }\n\n      if (rstarti >= ri) break;\n      tag = parsexmltag(x.slice(rstarti, ri), true);\n      tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n      tagc = -1;\n      if (opts.sheetRows && opts.sheetRows < tagr) continue;\n      if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n      if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\n      if (opts && opts.cellStyles) {\n        rowobj = {};\n        rowrite = false;\n\n        if (tag.ht) {\n          rowrite = true;\n          rowobj.hpt = parseFloat(tag.ht);\n          rowobj.hpx = pt2px(rowobj.hpt);\n        }\n\n        if (tag.hidden == \"1\") {\n          rowrite = true;\n          rowobj.hidden = true;\n        }\n\n        if (tag.outlineLevel != null) {\n          rowrite = true;\n          rowobj.level = +tag.outlineLevel;\n        }\n\n        if (rowrite) rows[tagr - 1] = rowobj;\n      }\n      /* 18.3.1.4 c CT_Cell */\n\n\n      cells = x.slice(ri).split(cellregex);\n\n      for (var rslice = 0; rslice != cells.length; ++rslice) {\n        if (cells[rslice].trim().charAt(0) != \"<\") break;\n      }\n\n      cells = cells.slice(rslice);\n\n      for (ri = 0; ri != cells.length; ++ri) {\n        x = cells[ri].trim();\n        if (x.length === 0) continue;\n        cref = x.match(rregex);\n        idx = ri;\n        i = 0;\n        cc = 0;\n        x = \"<c \" + (x.slice(0, 1) == \"<\" ? \">\" : \"\") + x;\n\n        if (cref != null && cref.length === 2) {\n          idx = 0;\n          d = cref[1];\n\n          for (i = 0; i != d.length; ++i) {\n            if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n            idx = 26 * idx + cc;\n          }\n\n          --idx;\n          tagc = idx;\n        } else ++tagc;\n\n        for (i = 0; i != x.length; ++i) {\n          if (x.charCodeAt(i) === 62) break;\n        }\n\n        ++i;\n        tag = parsexmltag(x.slice(0, i), true);\n        if (!tag.r) tag.r = encode_cell({\n          r: tagr - 1,\n          c: tagc\n        });\n        d = x.slice(i);\n        p = {\n          t: \"\"\n        }\n        /*:any*/\n        ;\n        if ((cref = d.match(match_v)) != null &&\n        /*::cref != null && */\n        cref[1] !== '') p.v = unescapexml(cref[1]);\n\n        if (opts.cellFormula) {\n          if ((cref = d.match(match_f)) != null &&\n          /*::cref != null && */\n          cref[1] !== '') {\n            /* TODO: match against XLSXFutureFunctions */\n            p.f = unescapexml(utf8read(cref[1])).replace(/\\r\\n/g, \"\\n\");\n            if (!opts.xlfn) p.f = _xlfn(p.f);\n\n            if (\n            /*::cref != null && cref[0] != null && */\n            cref[0].indexOf('t=\"array\"') > -1) {\n              p.F = (d.match(refregex) || [])[1];\n              if (p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n            } else if (\n            /*::cref != null && cref[0] != null && */\n            cref[0].indexOf('t=\"shared\"') > -1) {\n              // TODO: parse formula\n              ftag = parsexmltag(cref[0]);\n\n              var ___f = unescapexml(utf8read(cref[1]));\n\n              if (!opts.xlfn) ___f = _xlfn(___f);\n              sharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n            }\n          } else if (cref = d.match(/<f[^>]*\\/>/)) {\n            ftag = parsexmltag(cref[0]);\n            if (sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]\n            /*[0].ref*/\n            , tag.r);\n          }\n          /* TODO: factor out contains logic */\n\n\n          var _tag = decode_cell(tag.r);\n\n          for (i = 0; i < arrayf.length; ++i) {\n            if (_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r) if (_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c) p.F = arrayf[i][1];\n          }\n        }\n\n        if (tag.t == null && p.v === undefined) {\n          if (p.f || p.F) {\n            p.v = 0;\n            p.t = \"n\";\n          } else if (!sheetStubs) continue;else p.t = \"z\";\n        } else p.t = tag.t || \"n\";\n\n        if (guess.s.c > tagc) guess.s.c = tagc;\n        if (guess.e.c < tagc) guess.e.c = tagc;\n        /* 18.18.11 t ST_CellType */\n\n        switch (p.t) {\n          case 'n':\n            if (p.v == \"\" || p.v == null) {\n              if (!sheetStubs) continue;\n              p.t = 'z';\n            } else p.v = parseFloat(p.v);\n\n            break;\n\n          case 's':\n            if (typeof p.v == 'undefined') {\n              if (!sheetStubs) continue;\n              p.t = 'z';\n            } else {\n              sstr = strs[parseInt(p.v, 10)];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              if (opts.cellHTML) p.h = sstr.h;\n            }\n\n            break;\n\n          case 'str':\n            p.t = \"s\";\n            p.v = p.v != null ? utf8read(p.v) : '';\n            if (opts.cellHTML) p.h = escapehtml(p.v);\n            break;\n\n          case 'inlineStr':\n            cref = d.match(isregex);\n            p.t = 's';\n\n            if (cref != null && (sstr = parse_si(cref[1]))) {\n              p.v = sstr.t;\n              if (opts.cellHTML) p.h = sstr.h;\n            } else p.v = \"\";\n\n            break;\n\n          case 'b':\n            p.v = parsexmlbool(p.v);\n            break;\n\n          case 'd':\n            if (opts.cellDates) p.v = parseDate(p.v, 1);else {\n              p.v = datenum(parseDate(p.v, 1));\n              p.t = 'n';\n            }\n            break;\n\n          /* error string in .w, number in .v */\n\n          case 'e':\n            if (!opts || opts.cellText !== false) p.w = p.v;\n            p.v = RBErr[p.v];\n            break;\n        }\n        /* formatting */\n\n\n        fmtid = fillid = 0;\n        cf = null;\n\n        if (do_format && tag.s !== undefined) {\n          cf = styles.CellXf[tag.s];\n\n          if (cf != null) {\n            if (cf.numFmtId != null) fmtid = cf.numFmtId;\n\n            if (opts.cellStyles) {\n              if (cf.fillId != null) fillid = cf.fillId;\n            }\n          }\n        }\n\n        safe_format(p, fmtid, fillid, opts, themes, styles);\n\n        if (opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) {\n          p.t = 'd';\n          p.v = numdate(p.v);\n        }\n\n        if (tag.cm && opts.xlmeta) {\n          var cm = (opts.xlmeta.Cell || [])[+tag.cm - 1];\n          if (cm && cm.type == 'XLDAPR') p.D = true;\n        }\n\n        if (dense) {\n          var _r = decode_cell(tag.r);\n\n          if (!s[_r.r]) s[_r.r] = [];\n          s[_r.r][_r.c] = p;\n        } else s[tag.r] = p;\n      }\n    }\n\n    if (rows.length > 0) s['!rows'] = rows;\n  };\n}();\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\n\n\nfunction parse_BrtRowHdr(data, length) {\n  var z = {}\n  /*:any*/\n  ;\n  var tgt = data.l + length;\n  z.r = data.read_shift(4);\n  data.l += 4; // TODO: ixfe\n\n  var miyRw = data.read_shift(2);\n  data.l += 1; // TODO: top/bot padding\n\n  var flags = data.read_shift(1);\n  data.l = tgt;\n  if (flags & 0x07) z.level = flags & 0x07;\n  if (flags & 0x10) z.hidden = true;\n  if (flags & 0x20) z.hpt = miyRw / 20;\n  return z;\n}\n/* [MS-XLSB] 2.4.820 BrtWsDim */\n\n\nvar parse_BrtWsDim = parse_UncheckedRfX;\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\n\nfunction\n  /*::data, length*/\nparse_BrtWsFmtInfo() {} //function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\n\n\nfunction parse_BrtWsProp(data, length) {\n  var z = {};\n  var f = data[data.l];\n  ++data.l;\n  z.above = !(f & 0x40);\n  z.left = !(f & 0x80);\n  /* TODO: pull flags */\n\n  data.l += 18;\n  z.name = parse_XLSBCodeName(data);\n  return z;\n}\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\n\n\nfunction parse_BrtCellBlank(data) {\n  var cell = parse_XLSBCell(data);\n  return [cell];\n}\n\nfunction parse_BrtShortBlank(data) {\n  var cell = parse_XLSBShortCell(data);\n  return [cell];\n}\n/* [MS-XLSB] 2.4.307 BrtCellBool */\n\n\nfunction parse_BrtCellBool(data) {\n  var cell = parse_XLSBCell(data);\n  var fBool = data.read_shift(1);\n  return [cell, fBool, 'b'];\n}\n\nfunction parse_BrtShortBool(data) {\n  var cell = parse_XLSBShortCell(data);\n  var fBool = data.read_shift(1);\n  return [cell, fBool, 'b'];\n}\n/* [MS-XLSB] 2.4.308 BrtCellError */\n\n\nfunction parse_BrtCellError(data) {\n  var cell = parse_XLSBCell(data);\n  var bError = data.read_shift(1);\n  return [cell, bError, 'e'];\n}\n\nfunction parse_BrtShortError(data) {\n  var cell = parse_XLSBShortCell(data);\n  var bError = data.read_shift(1);\n  return [cell, bError, 'e'];\n}\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\n\n\nfunction parse_BrtCellIsst(data) {\n  var cell = parse_XLSBCell(data);\n  var isst = data.read_shift(4);\n  return [cell, isst, 's'];\n}\n\nfunction parse_BrtShortIsst(data) {\n  var cell = parse_XLSBShortCell(data);\n  var isst = data.read_shift(4);\n  return [cell, isst, 's'];\n}\n/* [MS-XLSB] 2.4.313 BrtCellReal */\n\n\nfunction parse_BrtCellReal(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_Xnum(data);\n  return [cell, value, 'n'];\n}\n\nfunction parse_BrtShortReal(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_Xnum(data);\n  return [cell, value, 'n'];\n}\n/* [MS-XLSB] 2.4.314 BrtCellRk */\n\n\nfunction parse_BrtCellRk(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_RkNumber(data);\n  return [cell, value, 'n'];\n}\n\nfunction parse_BrtShortRk(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_RkNumber(data);\n  return [cell, value, 'n'];\n}\n/* [MS-XLSB] 2.4.323 BrtCellRString */\n\n\nfunction parse_BrtCellRString(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_RichStr(data);\n  return [cell, value, 'is'];\n}\n/* [MS-XLSB] 2.4.317 BrtCellSt */\n\n\nfunction parse_BrtCellSt(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_XLWideString(data);\n  return [cell, value, 'str'];\n}\n\nfunction parse_BrtShortSt(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_XLWideString(data);\n  return [cell, value, 'str'];\n}\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\n\n\nfunction parse_BrtFmlaBool(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = data.read_shift(1);\n  var o = [cell, value, 'b'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\n\n\nfunction parse_BrtFmlaError(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = data.read_shift(1);\n  var o = [cell, value, 'e'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\n\n\nfunction parse_BrtFmlaNum(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = parse_Xnum(data);\n  var o = [cell, value, 'n'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\n\n\nfunction parse_BrtFmlaString(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = parse_XLWideString(data);\n  var o = [cell, value, 'str'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\n\n\nvar parse_BrtMergeCell = parse_UncheckedRfX;\n/* [MS-XLSB] 2.4.662 BrtHLink */\n\nfunction parse_BrtHLink(data, length\n/*::, opts*/\n) {\n  var end = data.l + length;\n  var rfx = parse_UncheckedRfX(data);\n  var relId = parse_XLNullableWideString(data);\n  var loc = parse_XLWideString(data);\n  var tooltip = parse_XLWideString(data);\n  var display = parse_XLWideString(data);\n  data.l = end;\n  var o = {\n    rfx: rfx,\n    relId: relId,\n    loc: loc,\n    display: display\n  }\n  /*:any*/\n  ;\n  if (tooltip) o.Tooltip = tooltip;\n  return o;\n}\n/* [MS-XLSB] 2.4.692 BrtPane */\n\n\nfunction\n  /*data, length, opts*/\nparse_BrtPane() {}\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\n\n\nfunction parse_BrtArrFmla(data, length, opts) {\n  var end = data.l + length;\n  var rfx = parse_RfX(data);\n  var fAlwaysCalc = data.read_shift(1);\n  var o = [rfx];\n  o[2] = fAlwaysCalc;\n\n  if (opts.cellFormula) {\n    var formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n    o[1] = formula;\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\n\n\nfunction parse_BrtShrFmla(data, length, opts) {\n  var end = data.l + length;\n  var rfx = parse_UncheckedRfX(data);\n  var o = [rfx];\n\n  if (opts.cellFormula) {\n    var formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n    o[1] = formula;\n    data.l = end;\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.678 BrtMargins */\n\n\nvar BrtMarginKeys = [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"];\n\nfunction parse_BrtMargins(data\n/*::, length, opts*/\n)\n/*:Margins*/\n{\n  var margins = {}\n  /*:any*/\n  ;\n  BrtMarginKeys.forEach(function (k) {\n    margins[k] = parse_Xnum(data);\n  });\n  return margins;\n}\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\n\n\nfunction parse_BrtBeginWsView(data\n/*::, length, opts*/\n) {\n  var f = data.read_shift(2);\n  data.l += 28;\n  return {\n    RTL: f & 0x20\n  };\n}\n\nfunction\n  /*data, length, opts*/\nparse_BrtDVal() {}\n\nfunction\n  /*data, length, opts*/\nparse_BrtDVal14() {}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\n\n\nfunction parse_ws_bin(data, _opts, idx, rels, wb\n/*:WBWBProps*/\n, themes, styles)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  var opts = _opts || {};\n  if (!rels) rels = {\n    '!id': {}\n  };\n  var s\n  /*:Worksheet*/\n  = opts.dense ? [] : {};\n  var ref;\n  var refguess = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var pass = false,\n      end = false;\n  var row, p, cf, R, C, addr, sstr, rr, cell\n  /*:Cell*/\n  ;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  opts.biff = 12;\n  opts['!row'] = 0;\n  var ai = 0,\n      af = false;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var sharedf = {};\n  var supbooks = opts.supbooks ||\n  /*::(*/\n  wb\n  /*:: :any)*/\n  .supbooks || [[]]\n  /*:any*/\n  ;\n  supbooks.sharedf = sharedf;\n  supbooks.arrayf = arrayf;\n  supbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function (x) {\n    return x.name;\n  });\n\n  if (!opts.supbooks) {\n    opts.supbooks = supbooks;\n    if (wb.Names) for (var i = 0; i < wb.Names.length; ++i) {\n      supbooks[0][i + 1] = wb.Names[i];\n    }\n  }\n\n  var colinfo\n  /*:Array<ColInfo>*/\n  = [],\n      rowinfo\n  /*:Array<RowInfo>*/\n  = [];\n  var seencol = false;\n  XLSBRecordEnum[0x0010] = {\n    n: \"BrtShortReal\",\n    f: parse_BrtShortReal\n  };\n  var cm;\n  recordhopper(data, function ws_parse(val, RR, RT) {\n    if (end) return;\n\n    switch (RT) {\n      case 0x0094:\n        /* 'BrtWsDim' */\n        ref = val;\n        break;\n\n      case 0x0000:\n        /* 'BrtRowHdr' */\n        row = val;\n        if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\n        rr = encode_row(R = row.r);\n        opts['!row'] = row.r;\n\n        if (val.hidden || val.hpt || val.level != null) {\n          if (val.hpt) val.hpx = pt2px(val.hpt);\n          rowinfo[val.r] = val;\n        }\n\n        break;\n\n      case 0x0002:\n      /* 'BrtCellRk' */\n\n      case 0x0003:\n      /* 'BrtCellError' */\n\n      case 0x0004:\n      /* 'BrtCellBool' */\n\n      case 0x0005:\n      /* 'BrtCellReal' */\n\n      case 0x0006:\n      /* 'BrtCellSt' */\n\n      case 0x0007:\n      /* 'BrtCellIsst' */\n\n      case 0x0008:\n      /* 'BrtFmlaString' */\n\n      case 0x0009:\n      /* 'BrtFmlaNum' */\n\n      case 0x000A:\n      /* 'BrtFmlaBool' */\n\n      case 0x000B:\n      /* 'BrtFmlaError' */\n\n      case 0x000D:\n      /* 'BrtShortRk' */\n\n      case 0x000E:\n      /* 'BrtShortError' */\n\n      case 0x000F:\n      /* 'BrtShortBool' */\n\n      case 0x0010:\n      /* 'BrtShortReal' */\n\n      case 0x0011:\n      /* 'BrtShortSt' */\n\n      case 0x0012:\n      /* 'BrtShortIsst' */\n\n      case 0x003E:\n        /* 'BrtCellRString' */\n        p = {\n          t: val[2]\n        }\n        /*:any*/\n        ;\n\n        switch (val[2]) {\n          case 'n':\n            p.v = val[1];\n            break;\n\n          case 's':\n            sstr = strs[val[1]];\n            p.v = sstr.t;\n            p.r = sstr.r;\n            break;\n\n          case 'b':\n            p.v = val[1] ? true : false;\n            break;\n\n          case 'e':\n            p.v = val[1];\n            if (opts.cellText !== false) p.w = BErr[p.v];\n            break;\n\n          case 'str':\n            p.t = 's';\n            p.v = val[1];\n            break;\n\n          case 'is':\n            p.t = 's';\n            p.v = val[1].t;\n            break;\n        }\n\n        if (cf = styles.CellXf[val[0].iStyleRef]) safe_format(p, cf.numFmtId, null, opts, themes, styles);\n        C = val[0].c == -1 ? C + 1 : val[0].c;\n\n        if (opts.dense) {\n          if (!s[R]) s[R] = [];\n          s[R][C] = p;\n        } else s[encode_col(C) + rr] = p;\n\n        if (opts.cellFormula) {\n          af = false;\n\n          for (ai = 0; ai < arrayf.length; ++ai) {\n            var aii = arrayf[ai];\n            if (row.r >= aii[0].s.r && row.r <= aii[0].e.r) if (C >= aii[0].s.c && C <= aii[0].e.c) {\n              p.F = encode_range(aii[0]);\n              af = true;\n            }\n          }\n\n          if (!af && val.length > 3) p.f = val[3];\n        }\n\n        if (refguess.s.r > row.r) refguess.s.r = row.r;\n        if (refguess.s.c > C) refguess.s.c = C;\n        if (refguess.e.r < row.r) refguess.e.r = row.r;\n        if (refguess.e.c < C) refguess.e.c = C;\n\n        if (opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n          var _d = SSF_parse_date_code(p.v);\n\n          if (_d) {\n            p.t = 'd';\n            p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n          }\n        }\n\n        if (cm) {\n          if (cm.type == 'XLDAPR') p.D = true;\n          cm = void 0;\n        }\n\n        break;\n\n      case 0x0001:\n      /* 'BrtCellBlank' */\n\n      case 0x000C:\n        /* 'BrtShortBlank' */\n        if (!opts.sheetStubs || pass) break;\n        p = {\n          t: 'z',\n          v: void 0\n        }\n        /*:any*/\n        ;\n        C = val[0].c == -1 ? C + 1 : val[0].c;\n\n        if (opts.dense) {\n          if (!s[R]) s[R] = [];\n          s[R][C] = p;\n        } else s[encode_col(C) + rr] = p;\n\n        if (refguess.s.r > row.r) refguess.s.r = row.r;\n        if (refguess.s.c > C) refguess.s.c = C;\n        if (refguess.e.r < row.r) refguess.e.r = row.r;\n        if (refguess.e.c < C) refguess.e.c = C;\n\n        if (cm) {\n          if (cm.type == 'XLDAPR') p.D = true;\n          cm = void 0;\n        }\n\n        break;\n\n      case 0x00B0:\n        /* 'BrtMergeCell' */\n        merges.push(val);\n        break;\n\n      case 0x0031:\n        {\n          /* 'BrtCellMeta' */\n          cm = ((opts.xlmeta || {}).Cell || [])[val - 1];\n        }\n        break;\n\n      case 0x01EE:\n        /* 'BrtHLink' */\n        var rel = rels['!id'][val.relId];\n\n        if (rel) {\n          val.Target = rel.Target;\n          if (val.loc) val.Target += \"#\" + val.loc;\n          val.Rel = rel;\n        } else if (val.relId == '') {\n          val.Target = \"#\" + val.loc;\n        }\n\n        for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) {\n          for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\n            if (opts.dense) {\n              if (!s[R]) s[R] = [];\n              if (!s[R][C]) s[R][C] = {\n                t: 'z',\n                v: undefined\n              };\n              s[R][C].l = val;\n            } else {\n              addr = encode_cell({\n                c: C,\n                r: R\n              });\n              if (!s[addr]) s[addr] = {\n                t: 'z',\n                v: undefined\n              };\n              s[addr].l = val;\n            }\n          }\n        }\n\n        break;\n\n      case 0x01AA:\n        /* 'BrtArrFmla' */\n        if (!opts.cellFormula) break;\n        arrayf.push(val);\n        cell = opts.dense ? s[R][C] : s[encode_col(C) + rr]\n        /*:any*/\n        ;\n        cell.f = stringify_formula(val[1], refguess, {\n          r: row.r,\n          c: C\n        }, supbooks, opts);\n        cell.F = encode_range(val[0]);\n        break;\n\n      case 0x01AB:\n        /* 'BrtShrFmla' */\n        if (!opts.cellFormula) break;\n        sharedf[encode_cell(val[0].s)] = val[1];\n        cell = opts.dense ? s[R][C] : s[encode_col(C) + rr];\n        cell.f = stringify_formula(val[1], refguess, {\n          r: row.r,\n          c: C\n        }, supbooks, opts);\n        break;\n\n      /* identical to 'ColInfo' in XLS */\n\n      case 0x003C:\n        /* 'BrtColInfo' */\n        if (!opts.cellStyles) break;\n\n        while (val.e >= val.s) {\n          colinfo[val.e--] = {\n            width: val.w / 256,\n            hidden: !!(val.flags & 0x01),\n            level: val.level\n          };\n\n          if (!seencol) {\n            seencol = true;\n            find_mdw_colw(val.w / 256);\n          }\n\n          process_col(colinfo[val.e + 1]);\n        }\n\n        break;\n\n      case 0x00A1:\n        /* 'BrtBeginAFilter' */\n        s['!autofilter'] = {\n          ref: encode_range(val)\n        };\n        break;\n\n      case 0x01DC:\n        /* 'BrtMargins' */\n        s['!margins'] = val;\n        break;\n\n      case 0x0093:\n        /* 'BrtWsProp' */\n        if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n        if (val.name) wb.Sheets[idx].CodeName = val.name;\n        if (val.above || val.left) s['!outline'] = {\n          above: val.above,\n          left: val.left\n        };\n        break;\n\n      case 0x0089:\n        /* 'BrtBeginWsView' */\n        if (!wb.Views) wb.Views = [{}];\n        if (!wb.Views[0]) wb.Views[0] = {};\n        if (val.RTL) wb.Views[0].RTL = true;\n        break;\n\n      case 0x01E5:\n        /* 'BrtWsFmtInfo' */\n        break;\n\n      case 0x0040:\n      /* 'BrtDVal' */\n\n      case 0x041D:\n        /* 'BrtDVal14' */\n        break;\n\n      case 0x0097:\n        /* 'BrtPane' */\n        break;\n\n      case 0x0098:\n      /* 'BrtSel' */\n\n      case 0x00AF:\n      /* 'BrtAFilterDateGroupItem' */\n\n      case 0x0284:\n      /* 'BrtActiveX' */\n\n      case 0x0271:\n      /* 'BrtBigName' */\n\n      case 0x0232:\n      /* 'BrtBkHim' */\n\n      case 0x018C:\n      /* 'BrtBrk' */\n\n      case 0x0458:\n      /* 'BrtCFIcon' */\n\n      case 0x047A:\n      /* 'BrtCFRuleExt' */\n\n      case 0x01D7:\n      /* 'BrtCFVO' */\n\n      case 0x041A:\n      /* 'BrtCFVO14' */\n\n      case 0x0289:\n      /* 'BrtCellIgnoreEC' */\n\n      case 0x0451:\n      /* 'BrtCellIgnoreEC14' */\n\n      case 0x024D:\n      /* 'BrtCellSmartTagProperty' */\n\n      case 0x025F:\n      /* 'BrtCellWatch' */\n\n      case 0x0234:\n      /* 'BrtColor' */\n\n      case 0x041F:\n      /* 'BrtColor14' */\n\n      case 0x00A8:\n      /* 'BrtColorFilter' */\n\n      case 0x00AE:\n      /* 'BrtCustomFilter' */\n\n      case 0x049C:\n      /* 'BrtCustomFilter14' */\n\n      case 0x01F3:\n      /* 'BrtDRef' */\n\n      case 0x01FB:\n      /* 'BrtDXF' */\n\n      case 0x0226:\n      /* 'BrtDrawing' */\n\n      case 0x00AB:\n      /* 'BrtDynamicFilter' */\n\n      case 0x00A7:\n      /* 'BrtFilter' */\n\n      case 0x0499:\n      /* 'BrtFilter14' */\n\n      case 0x00A9:\n      /* 'BrtIconFilter' */\n\n      case 0x049D:\n      /* 'BrtIconFilter14' */\n\n      case 0x0227:\n      /* 'BrtLegacyDrawing' */\n\n      case 0x0228:\n      /* 'BrtLegacyDrawingHF' */\n\n      case 0x0295:\n      /* 'BrtListPart' */\n\n      case 0x027F:\n      /* 'BrtOleObject' */\n\n      case 0x01DE:\n      /* 'BrtPageSetup' */\n\n      case 0x0219:\n      /* 'BrtPhoneticInfo' */\n\n      case 0x01DD:\n      /* 'BrtPrintOptions' */\n\n      case 0x0218:\n      /* 'BrtRangeProtection' */\n\n      case 0x044F:\n      /* 'BrtRangeProtection14' */\n\n      case 0x02A8:\n      /* 'BrtRangeProtectionIso' */\n\n      case 0x0450:\n      /* 'BrtRangeProtectionIso14' */\n\n      case 0x0400:\n      /* 'BrtRwDescent' */\n\n      case 0x0297:\n      /* 'BrtSheetCalcProp' */\n\n      case 0x0217:\n      /* 'BrtSheetProtection' */\n\n      case 0x02A6:\n      /* 'BrtSheetProtectionIso' */\n\n      case 0x01F8:\n      /* 'BrtSlc' */\n\n      case 0x0413:\n      /* 'BrtSparkline' */\n\n      case 0x01AC:\n      /* 'BrtTable' */\n\n      case 0x00AA:\n      /* 'BrtTop10Filter' */\n\n      case 0x0C00:\n      /* 'BrtUid' */\n\n      case 0x0032:\n      /* 'BrtValueMeta' */\n\n      case 0x0816:\n      /* 'BrtWebExtension' */\n\n      case 0x0415:\n        /* 'BrtWsFmtInfoEx14' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        pass = false;\n        break;\n\n      default:\n        if (RR.T) ;else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  }, opts);\n  delete opts.supbooks;\n  delete opts['!row'];\n  if (!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\n  if (opts.sheetRows && s[\"!ref\"]) {\n    var tmpref = safe_decode_range(s[\"!ref\"]);\n\n    if (opts.sheetRows <= +tmpref.e.r) {\n      tmpref.e.r = opts.sheetRows - 1;\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n      s[\"!fullref\"] = s[\"!ref\"];\n      s[\"!ref\"] = encode_range(tmpref);\n    }\n  }\n\n  if (merges.length > 0) s[\"!merges\"] = merges;\n  if (colinfo.length > 0) s[\"!cols\"] = colinfo;\n  if (rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n  return s;\n}\n\nfunction parse_Cache(data\n/*:string*/\n)\n/*:[Array<number|string>, string, ?string]*/\n{\n  var col\n  /*:Array<number|string>*/\n  = [];\n  var num = data.match(/^<c:numCache>/);\n  var f;\n  /* 21.2.2.150 pt CT_NumVal */\n\n  (data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg) || []).forEach(function (pt) {\n    var q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n    if (!q) return;\n    col[+q[1]] = num ? +q[2] : q[2];\n  });\n  /* 21.2.2.71 formatCode CT_Xstring */\n\n  var nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\", \"General\"])[1]);\n  (data.match(/<c:f>(.*?)<\\/c:f>/mg) || []).forEach(function (F) {\n    f = F.replace(/<.*?>/g, \"\");\n  });\n  return [col, nf, f];\n}\n/* 21.2 DrawingML - Charts */\n\n\nfunction parse_chart(data\n/*:?string*/\n, name\n/*:string*/\n, opts, rels, wb, csheet) {\n  var cs\n  /*:Worksheet*/\n  = csheet || {\n    \"!type\": \"chart\"\n  }\n  /*:any*/\n  ;\n  if (!data) return csheet;\n  /* 21.2.2.27 chart CT_Chart */\n\n  var C = 0,\n      R = 0,\n      col = \"A\";\n  var refguess = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  /* 21.2.2.120 numCache CT_NumData */\n\n  (data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm) || []).forEach(function (nc) {\n    var cache = parse_Cache(nc);\n    refguess.s.r = refguess.s.c = 0;\n    refguess.e.c = C;\n    col = encode_col(C);\n    cache[0].forEach(function (n, i) {\n      cs[col + encode_row(i)] = {\n        t: 'n',\n        v: n,\n        z: cache[1]\n      };\n      R = i;\n    });\n    if (refguess.e.r < R) refguess.e.r = R;\n    ++C;\n  });\n  if (C > 0) cs[\"!ref\"] = encode_range(refguess);\n  return cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\n\n\nfunction parse_cs_xml(data\n/*:?string*/\n, opts, idx\n/*:number*/\n, rels, wb\n/*::, themes, styles*/\n)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  /* 18.3.1.12 chartsheet CT_ChartSheet */\n\n  if (!rels) rels = {\n    '!id': {}\n  };\n  var s = {\n    '!type': \"chart\",\n    '!drawel': null,\n    '!rel': \"\"\n  }\n  /*:any*/\n  ;\n  var m;\n  /* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\n  var sheetPr = data.match(sheetprregex);\n  if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n  /* 18.3.1.36 drawing CT_Drawing */\n\n  if (m = data.match(/drawing r:id=\"(.*?)\"/)) s['!rel'] = m[1];\n  if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n  return s;\n}\n/* [MS-XLSB] 2.4.331 BrtCsProp */\n\n\nfunction parse_BrtCsProp(data, length\n/*:number*/\n) {\n  data.l += 10;\n  var name = parse_XLWideString(data);\n  return {\n    name: name\n  };\n}\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\n\n\nfunction parse_cs_bin(data, opts, idx\n/*:number*/\n, rels, wb\n/*::, themes, styles*/\n)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  if (!rels) rels = {\n    '!id': {}\n  };\n  var s = {\n    '!type': \"chart\",\n    '!drawel': null,\n    '!rel': \"\"\n  };\n  var pass = false;\n  recordhopper(data, function cs_parse(val, R, RT) {\n    switch (RT) {\n      case 0x0226:\n        /* 'BrtDrawing' */\n        s['!rel'] = val;\n        break;\n\n      case 0x028B:\n        /* 'BrtCsProp' */\n        if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n        if (val.name) wb.Sheets[idx].CodeName = val.name;\n        break;\n\n      case 0x0232:\n      /* 'BrtBkHim' */\n\n      case 0x028C:\n      /* 'BrtCsPageSetup' */\n\n      case 0x029D:\n      /* 'BrtCsProtection' */\n\n      case 0x02A7:\n      /* 'BrtCsProtectionIso' */\n\n      case 0x0227:\n      /* 'BrtLegacyDrawing' */\n\n      case 0x0228:\n      /* 'BrtLegacyDrawingHF' */\n\n      case 0x01DC:\n      /* 'BrtMargins' */\n\n      case 0x0C00:\n        /* 'BrtUid' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        break;\n\n      default:\n        if (R.T > 0) ;else if (R.T < 0) ;else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  }, opts);\n  if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n  return s;\n}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\n\n\nvar WBPropsDef = [['allowRefreshQuery', false, \"bool\"], ['autoCompressPictures', true, \"bool\"], ['backupFile', false, \"bool\"], ['checkCompatibility', false, \"bool\"], ['CodeName', ''], ['date1904', false, \"bool\"], ['defaultThemeVersion', 0, \"int\"], ['filterPrivacy', false, \"bool\"], ['hidePivotFieldList', false, \"bool\"], ['promptedSolutions', false, \"bool\"], ['publishItems', false, \"bool\"], ['refreshAllConnections', false, \"bool\"], ['saveExternalLinkValues', true, \"bool\"], ['showBorderUnselectedTables', true, \"bool\"], ['showInkAnnotation', true, \"bool\"], ['showObjects', 'all'], ['showPivotChartFilter', false, \"bool\"], ['updateLinks', 'userSet']];\n/* 18.2.30 (CT_BookView) Defaults */\n\nvar WBViewDef = [['activeTab', 0, \"int\"], ['autoFilterDateGrouping', true, \"bool\"], ['firstSheet', 0, \"int\"], ['minimized', false, \"bool\"], ['showHorizontalScroll', true, \"bool\"], ['showSheetTabs', true, \"bool\"], ['showVerticalScroll', true, \"bool\"], ['tabRatio', 600, \"int\"], ['visibility', 'visible'] //window{Height,Width}, {x,y}Window\n];\n/* 18.2.19 (CT_Sheet) Defaults */\n\nvar SheetDef = [//['state', 'visible']\n];\n/* 18.2.2  (CT_CalcPr) Defaults */\n\nvar CalcPrDef = [['calcCompleted', 'true'], ['calcMode', 'auto'], ['calcOnSave', 'true'], ['concurrentCalc', 'true'], ['fullCalcOnLoad', 'false'], ['fullPrecision', 'true'], ['iterate', 'false'], ['iterateCount', '100'], ['iterateDelta', '0.001'], ['refMode', 'A1']];\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n  for (var j = 0; j != target.length; ++j) {\n    var w = target[j];\n\n    for (var i = 0; i != defaults.length; ++i) {\n      var z = defaults[i];\n      if (w[z[0]] == null) w[z[0]] = z[1];else switch (z[2]) {\n        case \"bool\":\n          if (typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]);\n          break;\n\n        case \"int\":\n          if (typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10);\n          break;\n      }\n    }\n  }\n}\n\nfunction push_defaults(target, defaults) {\n  for (var i = 0; i != defaults.length; ++i) {\n    var z = defaults[i];\n    if (target[z[0]] == null) target[z[0]] = z[1];else switch (z[2]) {\n      case \"bool\":\n        if (typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]);\n        break;\n\n      case \"int\":\n        if (typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10);\n        break;\n    }\n  }\n}\n\nfunction parse_wb_defaults(wb) {\n  push_defaults(wb.WBProps, WBPropsDef);\n  push_defaults(wb.CalcPr, CalcPrDef);\n  push_defaults_array(wb.WBView, WBViewDef);\n  push_defaults_array(wb.Sheets, SheetDef);\n  _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nvar badchars = /*#__PURE__*/\"][*?\\/\\\\\".split(\"\");\n\nfunction check_ws_name(n\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:boolean*/\n{\n  if (n.length > 31) {\n    if (safe) return false;\n    throw new Error(\"Sheet names cannot exceed 31 chars\");\n  }\n\n  var _good = true;\n  badchars.forEach(function (c) {\n    if (n.indexOf(c) == -1) return;\n    if (!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n    _good = false;\n  });\n  return _good;\n}\n/* 18.2 Workbook */\n\n\nvar wbnsregex = /<\\w+:workbook/;\n\nfunction parse_wb_xml(data, opts)\n/*:WorkbookFile*/\n{\n  if (!data) throw new Error(\"Could not find file\");\n  var wb =\n  /*::(*/\n  {\n    AppVersion: {},\n    WBProps: {},\n    WBView: [],\n    Sheets: [],\n    CalcPr: {},\n    Names: [],\n    xmlns: \"\"\n  }\n  /*::)*/\n  ;\n  var pass = false,\n      xmlns = \"xmlns\";\n  var dname = {},\n      dnstart = 0;\n  data.replace(tagregex, function xml_wb(x, idx) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 18.2.27 workbook CT_Workbook 1 */\n\n      case '<workbook':\n        if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n        wb.xmlns = y[xmlns];\n        break;\n\n      case '</workbook>':\n        break;\n\n      /* 18.2.13 fileVersion CT_FileVersion ? */\n\n      case '<fileVersion':\n        delete y[0];\n        wb.AppVersion = y;\n        break;\n\n      case '<fileVersion/>':\n      case '</fileVersion>':\n        break;\n\n      /* 18.2.12 fileSharing CT_FileSharing ? */\n\n      case '<fileSharing':\n        break;\n\n      case '<fileSharing/>':\n        break;\n\n      /* 18.2.28 workbookPr CT_WorkbookPr ? */\n\n      case '<workbookPr':\n      case '<workbookPr/>':\n        WBPropsDef.forEach(function (w) {\n          if (y[w[0]] == null) return;\n\n          switch (w[2]) {\n            case \"bool\":\n              wb.WBProps[w[0]] = parsexmlbool(y[w[0]]);\n              break;\n\n            case \"int\":\n              wb.WBProps[w[0]] = parseInt(y[w[0]], 10);\n              break;\n\n            default:\n              wb.WBProps[w[0]] = y[w[0]];\n          }\n        });\n        if (y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n        break;\n\n      case '</workbookPr>':\n        break;\n\n      /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\n      case '<workbookProtection':\n        break;\n\n      case '<workbookProtection/>':\n        break;\n\n      /* 18.2.1  bookViews CT_BookViews ? */\n\n      case '<bookViews':\n      case '<bookViews>':\n      case '</bookViews>':\n        break;\n\n      /* 18.2.30   workbookView CT_BookView + */\n\n      case '<workbookView':\n      case '<workbookView/>':\n        delete y[0];\n        wb.WBView.push(y);\n        break;\n\n      case '</workbookView>':\n        break;\n\n      /* 18.2.20 sheets CT_Sheets 1 */\n\n      case '<sheets':\n      case '<sheets>':\n      case '</sheets>':\n        break;\n      // aggregate sheet\n\n      /* 18.2.19   sheet CT_Sheet + */\n\n      case '<sheet':\n        switch (y.state) {\n          case \"hidden\":\n            y.Hidden = 1;\n            break;\n\n          case \"veryHidden\":\n            y.Hidden = 2;\n            break;\n\n          default:\n            y.Hidden = 0;\n        }\n\n        delete y.state;\n        y.name = unescapexml(utf8read(y.name));\n        delete y[0];\n        wb.Sheets.push(y);\n        break;\n\n      case '</sheet>':\n        break;\n\n      /* 18.2.15 functionGroups CT_FunctionGroups ? */\n\n      case '<functionGroups':\n      case '<functionGroups/>':\n        break;\n\n      /* 18.2.14   functionGroup CT_FunctionGroup + */\n\n      case '<functionGroup':\n        break;\n\n      /* 18.2.9  externalReferences CT_ExternalReferences ? */\n\n      case '<externalReferences':\n      case '</externalReferences>':\n      case '<externalReferences>':\n        break;\n\n      /* 18.2.8    externalReference CT_ExternalReference + */\n\n      case '<externalReference':\n        break;\n\n      /* 18.2.6  definedNames CT_DefinedNames ? */\n\n      case '<definedNames/>':\n        break;\n\n      case '<definedNames>':\n      case '<definedNames':\n        pass = true;\n        break;\n\n      case '</definedNames>':\n        pass = false;\n        break;\n\n      /* 18.2.5    definedName CT_DefinedName + */\n\n      case '<definedName':\n        {\n          dname = {};\n          dname.Name = utf8read(y.name);\n          if (y.comment) dname.Comment = y.comment;\n          if (y.localSheetId) dname.Sheet = +y.localSheetId;\n          if (parsexmlbool(y.hidden || \"0\")) dname.Hidden = true;\n          dnstart = idx + x.length;\n        }\n        break;\n\n      case '</definedName>':\n        {\n          dname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n          wb.Names.push(dname);\n        }\n        break;\n\n      case '<definedName/>':\n        break;\n\n      /* 18.2.2  calcPr CT_CalcPr ? */\n\n      case '<calcPr':\n        delete y[0];\n        wb.CalcPr = y;\n        break;\n\n      case '<calcPr/>':\n        delete y[0];\n        wb.CalcPr = y;\n        break;\n\n      case '</calcPr>':\n        break;\n\n      /* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\n      case '<oleSize':\n        break;\n\n      /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\n      case '<customWorkbookViews>':\n      case '</customWorkbookViews>':\n      case '<customWorkbookViews':\n        break;\n\n      /* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\n      case '<customWorkbookView':\n      case '</customWorkbookView>':\n        break;\n\n      /* 18.2.18 pivotCaches CT_PivotCaches ? */\n\n      case '<pivotCaches>':\n      case '</pivotCaches>':\n      case '<pivotCaches':\n        break;\n\n      /* 18.2.17 pivotCache CT_PivotCache ? */\n\n      case '<pivotCache':\n        break;\n\n      /* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\n      case '<smartTagPr':\n      case '<smartTagPr/>':\n        break;\n\n      /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\n      case '<smartTagTypes':\n      case '<smartTagTypes>':\n      case '</smartTagTypes>':\n        break;\n\n      /* 18.2.22 smartTagType CT_SmartTagType ? */\n\n      case '<smartTagType':\n        break;\n\n      /* 18.2.24 webPublishing CT_WebPublishing ? */\n\n      case '<webPublishing':\n      case '<webPublishing/>':\n        break;\n\n      /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\n      case '<fileRecoveryPr':\n      case '<fileRecoveryPr/>':\n        break;\n\n      /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\n      case '<webPublishObjects>':\n      case '<webPublishObjects':\n      case '</webPublishObjects>':\n        break;\n\n      /* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\n      case '<webPublishObject':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n      //TODO: check with versions of excel\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      /* Others */\n\n      case '<ArchID':\n        break;\n\n      case '<AlternateContent':\n      case '<AlternateContent>':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* TODO */\n\n      case '<revisionPtr':\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n    }\n\n    return x;\n  });\n  if (XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n  parse_wb_defaults(wb);\n  return wb;\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\n\n\nfunction parse_BrtBundleSh(data, length\n/*:number*/\n) {\n  var z = {};\n  z.Hidden = data.read_shift(4); //hsState ST_SheetState\n\n  z.iTabID = data.read_shift(4);\n  z.strRelID = parse_RelID(data);\n  z.name = parse_XLWideString(data);\n  return z;\n}\n/* [MS-XLSB] 2.4.815 BrtWbProp */\n\n\nfunction parse_BrtWbProp(data, length)\n/*:WBProps*/\n{\n  var o\n  /*:WBProps*/\n  = {}\n  /*:any*/\n  ;\n  var flags = data.read_shift(4);\n  o.defaultThemeVersion = data.read_shift(4);\n  var strName = length > 8 ? parse_XLWideString(data) : \"\";\n  if (strName.length > 0) o.CodeName = strName;\n  o.autoCompressPictures = !!(flags & 0x10000);\n  o.backupFile = !!(flags & 0x40);\n  o.checkCompatibility = !!(flags & 0x1000);\n  o.date1904 = !!(flags & 0x01);\n  o.filterPrivacy = !!(flags & 0x08);\n  o.hidePivotFieldList = !!(flags & 0x400);\n  o.promptedSolutions = !!(flags & 0x10);\n  o.publishItems = !!(flags & 0x800);\n  o.refreshAllConnections = !!(flags & 0x40000);\n  o.saveExternalLinkValues = !!(flags & 0x80);\n  o.showBorderUnselectedTables = !!(flags & 0x04);\n  o.showInkAnnotation = !!(flags & 0x20);\n  o.showObjects = [\"all\", \"placeholders\", \"none\"][flags >> 13 & 0x03];\n  o.showPivotChartFilter = !!(flags & 0x8000);\n  o.updateLinks = [\"userSet\", \"never\", \"always\"][flags >> 8 & 0x03];\n  return o;\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n  var o = {};\n  data.read_shift(4);\n  o.ArchID = data.read_shift(4);\n  data.l += length - 8;\n  return o;\n}\n/* [MS-XLSB] 2.4.687 BrtName */\n\n\nfunction parse_BrtName(data, length, opts) {\n  var end = data.l + length;\n  data.l += 4; //var flags = data.read_shift(4);\n\n  data.l += 1; //var chKey = data.read_shift(1);\n\n  var itab = data.read_shift(4);\n  var name = parse_XLNameWideString(data);\n  var formula = parse_XLSBNameParsedFormula(data, 0, opts);\n  var comment = parse_XLNullableWideString(data); //if(0 /* fProc */) {\n  // unusedstring1: XLNullableWideString\n  // description: XLNullableWideString\n  // helpTopic: XLNullableWideString\n  // unusedstring2: XLNullableWideString\n  //}\n\n  data.l = end;\n  var out = {\n    Name: name,\n    Ptg: formula\n  }\n  /*:any*/\n  ;\n  if (itab < 0xFFFFFFF) out.Sheet = itab;\n  if (comment) out.Comment = comment;\n  return out;\n}\n/* [MS-XLSB] 2.1.7.61 Workbook */\n\n\nfunction parse_wb_bin(data, opts)\n/*:WorkbookFile*/\n{\n  var wb = {\n    AppVersion: {},\n    WBProps: {},\n    WBView: [],\n    Sheets: [],\n    CalcPr: {},\n    xmlns: \"\"\n  };\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false;\n  if (!opts) opts = {};\n  opts.biff = 12;\n  var Names = [];\n  var supbooks = [[]]\n  /*:any*/\n  ;\n  supbooks.SheetNames = [];\n  supbooks.XTI = [];\n  XLSBRecordEnum[0x0010] = {\n    n: \"BrtFRTArchID$\",\n    f: parse_BrtFRTArchID$\n  };\n  recordhopper(data, function hopper_wb(val, R, RT) {\n    switch (RT) {\n      case 0x009C:\n        /* 'BrtBundleSh' */\n        supbooks.SheetNames.push(val.name);\n        wb.Sheets.push(val);\n        break;\n\n      case 0x0099:\n        /* 'BrtWbProp' */\n        wb.WBProps = val;\n        break;\n\n      case 0x0027:\n        /* 'BrtName' */\n        if (val.Sheet != null) opts.SID = val.Sheet;\n        val.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n        delete opts.SID;\n        delete val.Ptg;\n        Names.push(val);\n        break;\n\n      case 0x040C:\n        /* 'BrtNameExt' */\n        break;\n\n      case 0x0165:\n      /* 'BrtSupSelf' */\n\n      case 0x0166:\n      /* 'BrtSupSame' */\n\n      case 0x0163:\n      /* 'BrtSupBookSrc' */\n\n      case 0x029B:\n        /* 'BrtSupAddin' */\n        if (!supbooks[0].length) supbooks[0] = [RT, val];else supbooks.push([RT, val]);\n        supbooks[supbooks.length - 1].XTI = [];\n        break;\n\n      case 0x016A:\n        /* 'BrtExternSheet' */\n        if (supbooks.length === 0) {\n          supbooks[0] = [];\n          supbooks[0].XTI = [];\n        }\n\n        supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n        supbooks.XTI = supbooks.XTI.concat(val);\n        break;\n\n      case 0x0169:\n        /* 'BrtPlaceholderName' */\n        break;\n\n      case 0x0817:\n      /* 'BrtAbsPath15' */\n\n      case 0x009E:\n      /* 'BrtBookView' */\n\n      case 0x008F:\n      /* 'BrtBeginBundleShs' */\n\n      case 0x0298:\n      /* 'BrtBeginFnGroup' */\n\n      case 0x0161:\n        /* 'BrtBeginExternals' */\n        break;\n\n      /* case 'BrtModelTimeGroupingCalcCol' */\n\n      case 0x0C00:\n      /* 'BrtUid' */\n\n      case 0x0C01:\n      /* 'BrtRevisionPtr' */\n\n      case 0x0216:\n      /* 'BrtBookProtection' */\n\n      case 0x02A5:\n      /* 'BrtBookProtectionIso' */\n\n      case 0x009D:\n      /* 'BrtCalcProp' */\n\n      case 0x0262:\n      /* 'BrtCrashRecErr' */\n\n      case 0x0802:\n      /* 'BrtDecoupledPivotCacheID' */\n\n      case 0x009B:\n      /* 'BrtFileRecover' */\n\n      case 0x0224:\n      /* 'BrtFileSharing' */\n\n      case 0x02A4:\n      /* 'BrtFileSharingIso' */\n\n      case 0x0080:\n      /* 'BrtFileVersion' */\n\n      case 0x0299:\n      /* 'BrtFnGroup' */\n\n      case 0x0850:\n      /* 'BrtModelRelationship' */\n\n      case 0x084D:\n      /* 'BrtModelTable' */\n\n      case 0x0225:\n      /* 'BrtOleSize' */\n\n      case 0x0805:\n      /* 'BrtPivotTableRef' */\n\n      case 0x0254:\n      /* 'BrtSmartTagType' */\n\n      case 0x081C:\n      /* 'BrtTableSlicerCacheID' */\n\n      case 0x081B:\n      /* 'BrtTableSlicerCacheIDs' */\n\n      case 0x0822:\n      /* 'BrtTimelineCachePivotCacheID' */\n\n      case 0x018D:\n      /* 'BrtUserBookView' */\n\n      case 0x009A:\n      /* 'BrtWbFactoid' */\n\n      case 0x045D:\n      /* 'BrtWbProp14' */\n\n      case 0x0229:\n      /* 'BrtWebOpt' */\n\n      case 0x082B:\n        /* 'BrtWorkBookPr15' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        state.pop();\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        state.pop();\n        pass = false;\n        break;\n\n      case 0x0010:\n        /* 'BrtFRTArchID$' */\n        break;\n\n      default:\n        if (R.T) ;else if (!pass || opts.WTF && state[state.length - 1] != 0x0025\n        /* BrtACBegin */\n        && state[state.length - 1] != 0x0023\n        /* BrtFRTBegin */\n        ) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  }, opts);\n  parse_wb_defaults(wb); // $FlowIgnore\n\n  wb.Names = Names;\n  wb\n  /*:any*/\n  .supbooks = supbooks;\n  return wb;\n}\n\nfunction parse_wb(data, name\n/*:string*/\n, opts)\n/*:WorkbookFile*/\n{\n  if (name.slice(-4) === \".bin\") return parse_wb_bin(data\n  /*:any*/\n  , opts);\n  return parse_wb_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_ws(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ws_bin(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n  return parse_ws_xml(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_cs_bin(data\n  /*:any*/\n  , opts, idx, rels, wb);\n  return parse_cs_xml(data\n  /*:any*/\n  , opts, idx, rels, wb);\n}\n\nfunction parse_ms(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ms_bin();\n  return parse_ms_xml();\n}\n\nfunction parse_ds(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ds_bin();\n  return parse_ds_xml();\n}\n\nfunction parse_sty(data, name\n/*:string*/\n, themes, opts) {\n  if (name.slice(-4) === \".bin\") return parse_sty_bin(data\n  /*:any*/\n  , themes, opts);\n  return parse_sty_xml(data\n  /*:any*/\n  , themes, opts);\n}\n\nfunction parse_theme(data\n/*:string*/\n, name\n/*:string*/\n, opts) {\n  return parse_theme_xml(data, opts);\n}\n\nfunction parse_sst(data, name\n/*:string*/\n, opts)\n/*:SST*/\n{\n  if (name.slice(-4) === \".bin\") return parse_sst_bin(data\n  /*:any*/\n  , opts);\n  return parse_sst_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_cmnt(data, name\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  if (name.slice(-4) === \".bin\") return parse_comments_bin(data\n  /*:any*/\n  , opts);\n  return parse_comments_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_cc(data, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_cc_bin(data\n  /*:any*/\n  );\n  return parse_cc_xml(data\n  /*:any*/\n  );\n}\n\nfunction parse_xlink(data, rel, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_xlink_bin(data\n  /*:any*/\n  , rel, name, opts);\n  return parse_xlink_xml();\n}\n\nfunction parse_xlmeta(data, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_xlmeta_bin(data\n  /*:any*/\n  , name, opts);\n  return parse_xlmeta_xml(data\n  /*:any*/\n  , name, opts);\n}\n\nvar attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n\nfunction xlml_parsexmltag(tag\n/*:string*/\n, skip_root\n/*:?boolean*/\n) {\n  var words = tag.split(/\\s+/);\n  var z\n  /*:any*/\n  = []\n  /*:any*/\n  ;\n  if (!skip_root) z[0] = words[0];\n  if (words.length === 1) return z;\n  var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n  if (m) for (i = 0; i != m.length; ++i) {\n    y = m[i].match(attregex2);\n    /*:: if(!y || !y[2]) continue; */\n\n    if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n      if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n      z[w] = y[2].slice(1, y[2].length - 1);\n    }\n  }\n  return z;\n}\n\nfunction xlml_parsexmltagobj(tag\n/*:string*/\n) {\n  var words = tag.split(/\\s+/);\n  var z = {};\n  if (words.length === 1) return z;\n  var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n  if (m) for (i = 0; i != m.length; ++i) {\n    y = m[i].match(attregex2);\n    /*:: if(!y || !y[2]) continue; */\n\n    if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n      if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n      z[w] = y[2].slice(1, y[2].length - 1);\n    }\n  }\n  return z;\n} // ----\n\n/* map from xlml named formats to SSF TODO: localize */\n\n\nvar XLMLFormatMap\n/*: {[string]:string}*/\n;\n\nfunction xlml_format(format, value)\n/*:string*/\n{\n  var fmt = XLMLFormatMap[format] || unescapexml(format);\n  if (fmt === \"General\") return SSF_general(value);\n  return SSF_format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val\n/*:string*/\n) {\n  var oval\n  /*:any*/\n  = val;\n\n  switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n    case \"boolean\":\n      oval = parsexmlbool(val);\n      break;\n\n    case \"i2\":\n    case \"int\":\n      oval = parseInt(val, 10);\n      break;\n\n    case \"r4\":\n    case \"float\":\n      oval = parseFloat(val);\n      break;\n\n    case \"date\":\n    case \"dateTime.tz\":\n      oval = parseDate(val);\n      break;\n\n    case \"i8\":\n    case \"string\":\n    case \"fixed\":\n    case \"uuid\":\n    case \"bin.base64\":\n      break;\n\n    default:\n      throw new Error(\"bad custprop:\" + cp[0]);\n  }\n\n  Custprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell\n/*:Cell*/\n, nf, o) {\n  if (cell.t === 'z') return;\n  if (!o || o.cellText !== false) try {\n    if (cell.t === 'e') {\n      cell.w = cell.w || BErr[cell.v];\n    } else if (nf === \"General\") {\n      if (cell.t === 'n') {\n        if ((cell.v | 0) === cell.v) cell.w = cell.v.toString(10);else cell.w = SSF_general_num(cell.v);\n      } else cell.w = SSF_general(cell.v);\n    } else cell.w = xlml_format(nf || \"General\", cell.v);\n  } catch (e) {\n    if (o.WTF) throw e;\n  }\n\n  try {\n    var z = XLMLFormatMap[nf] || nf || \"General\";\n    if (o.cellNF) cell.z = z;\n\n    if (o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n      var _d = SSF_parse_date_code(cell.v);\n\n      if (_d) {\n        cell.t = 'd';\n        cell.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n      }\n    }\n  } catch (e) {\n    if (o.WTF) throw e;\n  }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n  if (opts.cellStyles) {\n    if (stag.Interior) {\n      var I = stag.Interior;\n      if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n    }\n  }\n\n  styles[stag.ID] = stag;\n}\n/* TODO: there must exist some form of OSP-blessed spec */\n\n\nfunction parse_xlml_data(xml, ss, data, cell\n/*:any*/\n, base, styles, csty, row, arrayf, o) {\n  var nf = \"General\",\n      sid = cell.StyleID,\n      S = {};\n  o = o || {};\n  var interiors = [];\n  var i = 0;\n  if (sid === undefined && row) sid = row.StyleID;\n  if (sid === undefined && csty) sid = csty.StyleID;\n\n  while (styles[sid] !== undefined) {\n    if (styles[sid].nf) nf = styles[sid].nf;\n    if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n    if (!styles[sid].Parent) break;\n    sid = styles[sid].Parent;\n  }\n\n  switch (data.Type) {\n    case 'Boolean':\n      cell.t = 'b';\n      cell.v = parsexmlbool(xml);\n      break;\n\n    case 'String':\n      cell.t = 's';\n      cell.r = xlml_fixstr(unescapexml(xml));\n      cell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss || xml).replace(/<.*?>/g, \"\") : cell.r; // todo: BR etc\n\n      break;\n\n    case 'DateTime':\n      if (xml.slice(-1) != \"Z\") xml += \"Z\";\n      cell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n      if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v < 60) cell.v = cell.v - 1;\n      if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\n    /* falls through */\n\n    case 'Number':\n      if (cell.v === undefined) cell.v = +xml;\n      if (!cell.t) cell.t = 'n';\n      break;\n\n    case 'Error':\n      cell.t = 'e';\n      cell.v = RBErr[xml];\n      if (o.cellText !== false) cell.w = xml;\n      break;\n\n    default:\n      if (xml == \"\" && ss == \"\") {\n        cell.t = 'z';\n      } else {\n        cell.t = 's';\n        cell.v = xlml_fixstr(ss || xml);\n      }\n\n      break;\n  }\n\n  safe_format_xlml(cell, nf, o);\n\n  if (o.cellFormula !== false) {\n    if (cell.Formula) {\n      var fstr = unescapexml(cell.Formula);\n      /* strictly speaking, the leading = is required but some writers omit */\n\n      if (fstr.charCodeAt(0) == 61\n      /* = */\n      ) fstr = fstr.slice(1);\n      cell.f = rc_to_a1(fstr, base);\n      delete cell.Formula;\n      if (cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);else if (cell.ArrayRange) {\n        cell.F = rc_to_a1(cell.ArrayRange, base);\n        arrayf.push([safe_decode_range(cell.F), cell.F]);\n      }\n    } else {\n      for (i = 0; i < arrayf.length; ++i) {\n        if (base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r) if (base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c) cell.F = arrayf[i][1];\n      }\n    }\n  }\n\n  if (o.cellStyles) {\n    interiors.forEach(function (x) {\n      if (!S.patternType && x.patternType) S.patternType = x.patternType;\n    });\n    cell.s = S;\n  }\n\n  if (cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_clean_comment(comment\n/*:any*/\n) {\n  comment.t = comment.v || \"\";\n  comment.t = comment.t.replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n  comment.v = comment.w = comment.ixfe = undefined;\n}\n/* TODO: Everything */\n\n\nfunction parse_xlml_xml(d, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  make_ssf();\n  var str = debom(xlml_normalize(d));\n\n  if (opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n    str = utf8read(str);\n  }\n\n  var opening = str.slice(0, 1024).toLowerCase(),\n      ishtml = false;\n  opening = opening.replace(/\".*?\"/g, \"\");\n\n  if ((opening.indexOf(\">\") & 1023) > Math.min(opening.indexOf(\",\") & 1023, opening.indexOf(\";\") & 1023)) {\n    var _o = dup(opts);\n\n    _o.type = \"string\";\n    return PRN.to_workbook(str, _o);\n  }\n\n  if (opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function (tag) {\n    if (opening.indexOf(\"<\" + tag) >= 0) ishtml = true;\n  });\n  if (ishtml) return html_to_workbook(str, opts);\n  XLMLFormatMap = {\n    \"General Number\": \"General\",\n    \"General Date\": table_fmt[22],\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\n    \"Medium Date\": table_fmt[15],\n    \"Short Date\": table_fmt[14],\n    \"Long Time\": table_fmt[19],\n    \"Medium Time\": table_fmt[18],\n    \"Short Time\": table_fmt[20],\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"Fixed\": table_fmt[2],\n    \"Standard\": table_fmt[4],\n    \"Percent\": table_fmt[10],\n    \"Scientific\": table_fmt[11],\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n    \"True/False\": '\"True\";\"True\";\"False\";@',\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n  }\n  /*:any*/\n  ;\n  var Rn;\n  var state = [],\n      tmp;\n  var sheets = {},\n      sheetnames\n  /*:Array<string>*/\n  = [],\n      cursheet\n  /*:Worksheet*/\n  = opts.dense ? [] : {},\n      sheetname = \"\";\n  var cell = {}\n  /*:any*/\n  ,\n      row = {}; // eslint-disable-line no-unused-vars\n\n  var dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'),\n      didx = 0;\n  var c = 0,\n      r = 0;\n  var refguess\n  /*:Range*/\n  = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var styles = {},\n      stag = {};\n  var ss = \"\",\n      fidx = 0;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var Props = {},\n      Custprops = {},\n      pidx = 0,\n      cp = [];\n  var comments\n  /*:Array<Comment>*/\n  = [],\n      comment\n  /*:Comment*/\n  = {}\n  /*:any*/\n  ;\n  var cstys = [],\n      csty,\n      seencol = false;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = [],\n      rowobj = {},\n      cc = 0,\n      rr = 0;\n  var Workbook\n  /*:WBWBProps*/\n  = {\n    Sheets: [],\n    WBProps: {\n      date1904: false\n    }\n  }\n  /*:any*/\n  ,\n      wsprops = {};\n  xlmlregex.lastIndex = 0;\n  str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\");\n  var raw_Rn3 = \"\";\n\n  while (Rn = xlmlregex.exec(str)) {\n    switch (Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase()) {\n      case 'data'\n      /*case 'Data'*/\n      :\n        if (raw_Rn3 == \"data\") {\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n          break;\n        }\n\n        if (state[state.length - 1][1]) break;\n        if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] ==\n        /*\"Comment\"*/\n        \"comment\" ? comment : cell, {\n          c: c,\n          r: r\n        }, styles, cstys[c], row, arrayf, opts);else {\n          ss = \"\";\n          dtag = xlml_parsexmltag(Rn[0]);\n          didx = Rn.index + Rn[0].length;\n        }\n        break;\n\n      case 'cell'\n      /*case 'Cell'*/\n      :\n        if (Rn[1] === '/') {\n          if (comments.length > 0) cell.c = comments;\n\n          if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\n            if (opts.dense) {\n              if (!cursheet[r]) cursheet[r] = [];\n              cursheet[r][c] = cell;\n            } else cursheet[encode_col(c) + encode_row(r)] = cell;\n          }\n\n          if (cell.HRef) {\n            cell.l = {\n              Target: unescapexml(cell.HRef)\n            }\n            /*:any*/\n            ;\n            if (cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n            delete cell.HRef;\n            delete cell.HRefScreenTip;\n          }\n\n          if (cell.MergeAcross || cell.MergeDown) {\n            cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n            rr = r + (parseInt(cell.MergeDown, 10) | 0);\n            merges.push({\n              s: {\n                c: c,\n                r: r\n              },\n              e: {\n                c: cc,\n                r: rr\n              }\n            });\n          }\n\n          if (!opts.sheetStubs) {\n            if (cell.MergeAcross) c = cc + 1;else ++c;\n          } else if (cell.MergeAcross || cell.MergeDown) {\n            /*:: if(!cc) cc = 0; if(!rr) rr = 0; */\n            for (var cma = c; cma <= cc; ++cma) {\n              for (var cmd = r; cmd <= rr; ++cmd) {\n                if (cma > c || cmd > r) {\n                  if (opts.dense) {\n                    if (!cursheet[cmd]) cursheet[cmd] = [];\n                    cursheet[cmd][cma] = {\n                      t: 'z'\n                    };\n                  } else cursheet[encode_col(cma) + encode_row(cmd)] = {\n                    t: 'z'\n                  };\n                }\n              }\n            }\n\n            c = cc + 1;\n          } else ++c;\n        } else {\n          cell = xlml_parsexmltagobj(Rn[0]);\n          if (cell.Index) c = +cell.Index - 1;\n          if (c < refguess.s.c) refguess.s.c = c;\n          if (c > refguess.e.c) refguess.e.c = c;\n          if (Rn[0].slice(-2) === \"/>\") ++c;\n          comments = [];\n        }\n\n        break;\n\n      case 'row'\n      /*case 'Row'*/\n      :\n        if (Rn[1] === '/' || Rn[0].slice(-2) === \"/>\") {\n          if (r < refguess.s.r) refguess.s.r = r;\n          if (r > refguess.e.r) refguess.e.r = r;\n\n          if (Rn[0].slice(-2) === \"/>\") {\n            row = xlml_parsexmltag(Rn[0]);\n            if (row.Index) r = +row.Index - 1;\n          }\n\n          c = 0;\n          ++r;\n        } else {\n          row = xlml_parsexmltag(Rn[0]);\n          if (row.Index) r = +row.Index - 1;\n          rowobj = {};\n\n          if (row.AutoFitHeight == \"0\" || row.Height) {\n            rowobj.hpx = parseInt(row.Height, 10);\n            rowobj.hpt = px2pt(rowobj.hpx);\n            rowinfo[r] = rowobj;\n          }\n\n          if (row.Hidden == \"1\") {\n            rowobj.hidden = true;\n            rowinfo[r] = rowobj;\n          }\n        }\n\n        break;\n\n      case 'worksheet'\n      /*case 'Worksheet'*/\n      :\n        /* TODO: read range from FullRows/FullColumns */\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          sheetnames.push(sheetname);\n\n          if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n            cursheet[\"!ref\"] = encode_range(refguess);\n\n            if (opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n              cursheet[\"!fullref\"] = cursheet[\"!ref\"];\n              refguess.e.r = opts.sheetRows - 1;\n              cursheet[\"!ref\"] = encode_range(refguess);\n            }\n          }\n\n          if (merges.length) cursheet[\"!merges\"] = merges;\n          if (cstys.length > 0) cursheet[\"!cols\"] = cstys;\n          if (rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n          sheets[sheetname] = cursheet;\n        } else {\n          refguess = {\n            s: {\n              r: 2000000,\n              c: 2000000\n            },\n            e: {\n              r: 0,\n              c: 0\n            }\n          };\n          r = c = 0;\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          sheetname = unescapexml(tmp.Name);\n          cursheet = opts.dense ? [] : {};\n          merges = [];\n          arrayf = [];\n          rowinfo = [];\n          wsprops = {\n            name: sheetname,\n            Hidden: 0\n          };\n          Workbook.Sheets.push(wsprops);\n        }\n\n        break;\n\n      case 'table'\n      /*case 'Table'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].slice(-2) == \"/>\") break;else {\n          state.push([Rn[3], false]);\n          cstys = [];\n          seencol = false;\n        }\n\n        break;\n\n      case 'style'\n      /*case 'Style'*/\n      :\n        if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = xlml_parsexmltag(Rn[0]);\n        break;\n\n      case 'numberformat'\n      /*case 'NumberFormat'*/\n      :\n        stag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n        if (XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\n        for (var ssfidx = 0; ssfidx != 0x188; ++ssfidx) {\n          if (table_fmt[ssfidx] == stag.nf) break;\n        }\n\n        if (ssfidx == 0x188) for (ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) {\n          if (table_fmt[ssfidx] == null) {\n            SSF_load(stag.nf, ssfidx);\n            break;\n          }\n        }\n        break;\n\n      case 'column'\n      /*case 'Column'*/\n      :\n        if (state[state.length - 1][0] !==\n        /*'Table'*/\n        'table') break;\n        csty = xlml_parsexmltag(Rn[0]);\n\n        if (csty.Hidden) {\n          csty.hidden = true;\n          delete csty.Hidden;\n        }\n\n        if (csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\n        if (!seencol && csty.wpx > 10) {\n          seencol = true;\n          MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\n          for (var _col = 0; _col < cstys.length; ++_col) {\n            if (cstys[_col]) process_col(cstys[_col]);\n          }\n        }\n\n        if (seencol) process_col(csty);\n        cstys[csty.Index - 1 || cstys.length] = csty;\n\n        for (var i = 0; i < +csty.Span; ++i) {\n          cstys[cstys.length] = dup(csty);\n        }\n\n        break;\n\n      case 'namedrange'\n      /*case 'NamedRange'*/\n      :\n        if (Rn[1] === '/') break;\n        if (!Workbook.Names) Workbook.Names = [];\n\n        var _NamedRange = parsexmltag(Rn[0]);\n\n        var _DefinedName\n        /*:DefinedName*/\n        = {\n          Name: _NamedRange.Name,\n          Ref: rc_to_a1(_NamedRange.RefersTo.slice(1), {\n            r: 0,\n            c: 0\n          })\n        }\n        /*:any*/\n        ;\n        if (Workbook.Sheets.length > 0) _DefinedName.Sheet = Workbook.Sheets.length - 1;\n        /*:: if(Workbook.Names) */\n\n        Workbook.Names.push(_DefinedName);\n        break;\n\n      case 'namedcell'\n      /*case 'NamedCell'*/\n      :\n        break;\n\n      case 'b'\n      /*case 'B'*/\n      :\n        break;\n\n      case 'i'\n      /*case 'I'*/\n      :\n        break;\n\n      case 'u'\n      /*case 'U'*/\n      :\n        break;\n\n      case 's'\n      /*case 'S'*/\n      :\n        break;\n\n      case 'em'\n      /*case 'EM'*/\n      :\n        break;\n\n      case 'h2'\n      /*case 'H2'*/\n      :\n        break;\n\n      case 'h3'\n      /*case 'H3'*/\n      :\n        break;\n\n      case 'sub'\n      /*case 'Sub'*/\n      :\n        break;\n\n      case 'sup'\n      /*case 'Sup'*/\n      :\n        break;\n\n      case 'span'\n      /*case 'Span'*/\n      :\n        break;\n\n      case 'alignment'\n      /*case 'Alignment'*/\n      :\n        break;\n\n      case 'borders'\n      /*case 'Borders'*/\n      :\n        break;\n\n      case 'border'\n      /*case 'Border'*/\n      :\n        break;\n\n      case 'font'\n      /*case 'Font'*/\n      :\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n        break;\n\n      case 'interior'\n      /*case 'Interior'*/\n      :\n        if (!opts.cellStyles) break;\n        stag.Interior = xlml_parsexmltag(Rn[0]);\n        break;\n\n      case 'protection'\n      /*case 'Protection'*/\n      :\n        break;\n\n      case 'author'\n      /*case 'Author'*/\n      :\n      case 'title'\n      /*case 'Title'*/\n      :\n      case 'description'\n      /*case 'Description'*/\n      :\n      case 'created'\n      /*case 'Created'*/\n      :\n      case 'keywords'\n      /*case 'Keywords'*/\n      :\n      case 'subject'\n      /*case 'Subject'*/\n      :\n      case 'category'\n      /*case 'Category'*/\n      :\n      case 'company'\n      /*case 'Company'*/\n      :\n      case 'lastauthor'\n      /*case 'LastAuthor'*/\n      :\n      case 'lastsaved'\n      /*case 'LastSaved'*/\n      :\n      case 'lastprinted'\n      /*case 'LastPrinted'*/\n      :\n      case 'version'\n      /*case 'Version'*/\n      :\n      case 'revision'\n      /*case 'Revision'*/\n      :\n      case 'totaltime'\n      /*case 'TotalTime'*/\n      :\n      case 'hyperlinkbase'\n      /*case 'HyperlinkBase'*/\n      :\n      case 'manager'\n      /*case 'Manager'*/\n      :\n      case 'contentstatus'\n      /*case 'ContentStatus'*/\n      :\n      case 'identifier'\n      /*case 'Identifier'*/\n      :\n      case 'language'\n      /*case 'Language'*/\n      :\n      case 'appname'\n      /*case 'AppName'*/\n      :\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n        break;\n\n      case 'paragraphs'\n      /*case 'Paragraphs'*/\n      :\n        break;\n\n      case 'styles'\n      /*case 'Styles'*/\n      :\n      case 'workbook'\n      /*case 'Workbook'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else state.push([Rn[3], false]);\n\n        break;\n\n      case 'comment'\n      /*case 'Comment'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n          xlml_clean_comment(comment);\n          comments.push(comment);\n        } else {\n          state.push([Rn[3], false]);\n          tmp = xlml_parsexmltag(Rn[0]);\n          comment = {\n            a: tmp.Author\n          }\n          /*:any*/\n          ;\n        }\n\n        break;\n\n      case 'autofilter'\n      /*case 'AutoFilter'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          var AutoFilter = xlml_parsexmltag(Rn[0]);\n          cursheet['!autofilter'] = {\n            ref: rc_to_a1(AutoFilter.Range).replace(/\\$/g, \"\")\n          };\n          state.push([Rn[3], true]);\n        }\n\n        break;\n\n      case 'name'\n      /*case 'Name'*/\n      :\n        break;\n\n      case 'datavalidation'\n      /*case 'DataValidation'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else {\n          if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n        }\n\n        break;\n\n      case 'pixelsperinch'\n      /*case 'PixelsPerInch'*/\n      :\n        break;\n\n      case 'componentoptions'\n      /*case 'ComponentOptions'*/\n      :\n      case 'documentproperties'\n      /*case 'DocumentProperties'*/\n      :\n      case 'customdocumentproperties'\n      /*case 'CustomDocumentProperties'*/\n      :\n      case 'officedocumentsettings'\n      /*case 'OfficeDocumentSettings'*/\n      :\n      case 'pivottable'\n      /*case 'PivotTable'*/\n      :\n      case 'pivotcache'\n      /*case 'PivotCache'*/\n      :\n      case 'names'\n      /*case 'Names'*/\n      :\n      case 'mapinfo'\n      /*case 'MapInfo'*/\n      :\n      case 'pagebreaks'\n      /*case 'PageBreaks'*/\n      :\n      case 'querytable'\n      /*case 'QueryTable'*/\n      :\n      case 'sorting'\n      /*case 'Sorting'*/\n      :\n      case 'schema'\n      /*case 'Schema'*/\n      : //case 'data' /*case 'data'*/:\n\n      case 'conditionalformatting'\n      /*case 'ConditionalFormatting'*/\n      :\n      case 'smarttagtype'\n      /*case 'SmartTagType'*/\n      :\n      case 'smarttags'\n      /*case 'SmartTags'*/\n      :\n      case 'excelworkbook'\n      /*case 'ExcelWorkbook'*/\n      :\n      case 'workbookoptions'\n      /*case 'WorkbookOptions'*/\n      :\n      case 'worksheetoptions'\n      /*case 'WorksheetOptions'*/\n      :\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n        break;\n\n      case 'null'\n      /*case 'Null'*/\n      :\n        break;\n\n      default:\n        /* FODS file root is <office:document> */\n        if (state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n        /* UOS file root is <uof:UOF> */\n\n        if (state.length == 0 && Rn[3] == \"uof\"\n        /*\"UOF\"*/\n        ) return parse_fods(str, opts);\n        var seen = true;\n\n        switch (state[state.length - 1][0]) {\n          /* OfficeDocumentSettings */\n          case 'officedocumentsettings'\n          /*case 'OfficeDocumentSettings'*/\n          :\n            switch (Rn[3]) {\n              case 'allowpng'\n              /*case 'AllowPNG'*/\n              :\n                break;\n\n              case 'removepersonalinformation'\n              /*case 'RemovePersonalInformation'*/\n              :\n                break;\n\n              case 'downloadcomponents'\n              /*case 'DownloadComponents'*/\n              :\n                break;\n\n              case 'locationofcomponents'\n              /*case 'LocationOfComponents'*/\n              :\n                break;\n\n              case 'colors'\n              /*case 'Colors'*/\n              :\n                break;\n\n              case 'color'\n              /*case 'Color'*/\n              :\n                break;\n\n              case 'index'\n              /*case 'Index'*/\n              :\n                break;\n\n              case 'rgb'\n              /*case 'RGB'*/\n              :\n                break;\n\n              case 'targetscreensize'\n              /*case 'TargetScreenSize'*/\n              :\n                break;\n\n              case 'readonlyrecommended'\n              /*case 'ReadOnlyRecommended'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* ComponentOptions */\n\n          case 'componentoptions'\n          /*case 'ComponentOptions'*/\n          :\n            switch (Rn[3]) {\n              case 'toolbar'\n              /*case 'Toolbar'*/\n              :\n                break;\n\n              case 'hideofficelogo'\n              /*case 'HideOfficeLogo'*/\n              :\n                break;\n\n              case 'spreadsheetautofit'\n              /*case 'SpreadsheetAutoFit'*/\n              :\n                break;\n\n              case 'label'\n              /*case 'Label'*/\n              :\n                break;\n\n              case 'caption'\n              /*case 'Caption'*/\n              :\n                break;\n\n              case 'maxheight'\n              /*case 'MaxHeight'*/\n              :\n                break;\n\n              case 'maxwidth'\n              /*case 'MaxWidth'*/\n              :\n                break;\n\n              case 'nextsheetnumber'\n              /*case 'NextSheetNumber'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* ExcelWorkbook */\n\n          case 'excelworkbook'\n          /*case 'ExcelWorkbook'*/\n          :\n            switch (Rn[3]) {\n              case 'date1904'\n              /*case 'Date1904'*/\n              :\n                /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n                Workbook.WBProps.date1904 = true;\n                break;\n\n              case 'windowheight'\n              /*case 'WindowHeight'*/\n              :\n                break;\n\n              case 'windowwidth'\n              /*case 'WindowWidth'*/\n              :\n                break;\n\n              case 'windowtopx'\n              /*case 'WindowTopX'*/\n              :\n                break;\n\n              case 'windowtopy'\n              /*case 'WindowTopY'*/\n              :\n                break;\n\n              case 'tabratio'\n              /*case 'TabRatio'*/\n              :\n                break;\n\n              case 'protectstructure'\n              /*case 'ProtectStructure'*/\n              :\n                break;\n\n              case 'protectwindow'\n              /*case 'ProtectWindow'*/\n              :\n                break;\n\n              case 'protectwindows'\n              /*case 'ProtectWindows'*/\n              :\n                break;\n\n              case 'activesheet'\n              /*case 'ActiveSheet'*/\n              :\n                break;\n\n              case 'displayinknotes'\n              /*case 'DisplayInkNotes'*/\n              :\n                break;\n\n              case 'firstvisiblesheet'\n              /*case 'FirstVisibleSheet'*/\n              :\n                break;\n\n              case 'supbook'\n              /*case 'SupBook'*/\n              :\n                break;\n\n              case 'sheetname'\n              /*case 'SheetName'*/\n              :\n                break;\n\n              case 'sheetindex'\n              /*case 'SheetIndex'*/\n              :\n                break;\n\n              case 'sheetindexfirst'\n              /*case 'SheetIndexFirst'*/\n              :\n                break;\n\n              case 'sheetindexlast'\n              /*case 'SheetIndexLast'*/\n              :\n                break;\n\n              case 'dll'\n              /*case 'Dll'*/\n              :\n                break;\n\n              case 'acceptlabelsinformulas'\n              /*case 'AcceptLabelsInFormulas'*/\n              :\n                break;\n\n              case 'donotsavelinkvalues'\n              /*case 'DoNotSaveLinkValues'*/\n              :\n                break;\n\n              case 'iteration'\n              /*case 'Iteration'*/\n              :\n                break;\n\n              case 'maxiterations'\n              /*case 'MaxIterations'*/\n              :\n                break;\n\n              case 'maxchange'\n              /*case 'MaxChange'*/\n              :\n                break;\n\n              case 'path'\n              /*case 'Path'*/\n              :\n                break;\n\n              case 'xct'\n              /*case 'Xct'*/\n              :\n                break;\n\n              case 'count'\n              /*case 'Count'*/\n              :\n                break;\n\n              case 'selectedsheets'\n              /*case 'SelectedSheets'*/\n              :\n                break;\n\n              case 'calculation'\n              /*case 'Calculation'*/\n              :\n                break;\n\n              case 'uncalced'\n              /*case 'Uncalced'*/\n              :\n                break;\n\n              case 'startupprompt'\n              /*case 'StartupPrompt'*/\n              :\n                break;\n\n              case 'crn'\n              /*case 'Crn'*/\n              :\n                break;\n\n              case 'externname'\n              /*case 'ExternName'*/\n              :\n                break;\n\n              case 'formula'\n              /*case 'Formula'*/\n              :\n                break;\n\n              case 'colfirst'\n              /*case 'ColFirst'*/\n              :\n                break;\n\n              case 'collast'\n              /*case 'ColLast'*/\n              :\n                break;\n\n              case 'wantadvise'\n              /*case 'WantAdvise'*/\n              :\n                break;\n\n              case 'boolean'\n              /*case 'Boolean'*/\n              :\n                break;\n\n              case 'error'\n              /*case 'Error'*/\n              :\n                break;\n\n              case 'text'\n              /*case 'Text'*/\n              :\n                break;\n\n              case 'ole'\n              /*case 'OLE'*/\n              :\n                break;\n\n              case 'noautorecover'\n              /*case 'NoAutoRecover'*/\n              :\n                break;\n\n              case 'publishobjects'\n              /*case 'PublishObjects'*/\n              :\n                break;\n\n              case 'donotcalculatebeforesave'\n              /*case 'DoNotCalculateBeforeSave'*/\n              :\n                break;\n\n              case 'number'\n              /*case 'Number'*/\n              :\n                break;\n\n              case 'refmoder1c1'\n              /*case 'RefModeR1C1'*/\n              :\n                break;\n\n              case 'embedsavesmarttags'\n              /*case 'EmbedSaveSmartTags'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* WorkbookOptions */\n\n          case 'workbookoptions'\n          /*case 'WorkbookOptions'*/\n          :\n            switch (Rn[3]) {\n              case 'owcversion'\n              /*case 'OWCVersion'*/\n              :\n                break;\n\n              case 'height'\n              /*case 'Height'*/\n              :\n                break;\n\n              case 'width'\n              /*case 'Width'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* WorksheetOptions */\n\n          case 'worksheetoptions'\n          /*case 'WorksheetOptions'*/\n          :\n            switch (Rn[3]) {\n              case 'visible'\n              /*case 'Visible'*/\n              :\n                if (Rn[0].slice(-2) === \"/>\") ;else if (Rn[1] === \"/\") switch (str.slice(pidx, Rn.index)) {\n                  case \"SheetHidden\":\n                    wsprops.Hidden = 1;\n                    break;\n\n                  case \"SheetVeryHidden\":\n                    wsprops.Hidden = 2;\n                    break;\n                } else pidx = Rn.index + Rn[0].length;\n                break;\n\n              case 'header'\n              /*case 'Header'*/\n              :\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n                break;\n\n              case 'footer'\n              /*case 'Footer'*/\n              :\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n                break;\n\n              case 'pagemargins'\n              /*case 'PageMargins'*/\n              :\n                var pagemargins = parsexmltag(Rn[0]);\n                if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n                if (!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n                if (!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n                if (!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n                if (!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n                break;\n\n              case 'displayrighttoleft'\n              /*case 'DisplayRightToLeft'*/\n              :\n                if (!Workbook.Views) Workbook.Views = [];\n                if (!Workbook.Views[0]) Workbook.Views[0] = {};\n                Workbook.Views[0].RTL = true;\n                break;\n\n              case 'freezepanes'\n              /*case 'FreezePanes'*/\n              :\n                break;\n\n              case 'frozennosplit'\n              /*case 'FrozenNoSplit'*/\n              :\n                break;\n\n              case 'splithorizontal'\n              /*case 'SplitHorizontal'*/\n              :\n              case 'splitvertical'\n              /*case 'SplitVertical'*/\n              :\n                break;\n\n              case 'donotdisplaygridlines'\n              /*case 'DoNotDisplayGridlines'*/\n              :\n                break;\n\n              case 'activerow'\n              /*case 'ActiveRow'*/\n              :\n                break;\n\n              case 'activecol'\n              /*case 'ActiveCol'*/\n              :\n                break;\n\n              case 'toprowbottompane'\n              /*case 'TopRowBottomPane'*/\n              :\n                break;\n\n              case 'leftcolumnrightpane'\n              /*case 'LeftColumnRightPane'*/\n              :\n                break;\n\n              case 'unsynced'\n              /*case 'Unsynced'*/\n              :\n                break;\n\n              case 'print'\n              /*case 'Print'*/\n              :\n                break;\n\n              case 'printerrors'\n              /*case 'PrintErrors'*/\n              :\n                break;\n\n              case 'panes'\n              /*case 'Panes'*/\n              :\n                break;\n\n              case 'scale'\n              /*case 'Scale'*/\n              :\n                break;\n\n              case 'pane'\n              /*case 'Pane'*/\n              :\n                break;\n\n              case 'number'\n              /*case 'Number'*/\n              :\n                break;\n\n              case 'layout'\n              /*case 'Layout'*/\n              :\n                break;\n\n              case 'pagesetup'\n              /*case 'PageSetup'*/\n              :\n                break;\n\n              case 'selected'\n              /*case 'Selected'*/\n              :\n                break;\n\n              case 'protectobjects'\n              /*case 'ProtectObjects'*/\n              :\n                break;\n\n              case 'enableselection'\n              /*case 'EnableSelection'*/\n              :\n                break;\n\n              case 'protectscenarios'\n              /*case 'ProtectScenarios'*/\n              :\n                break;\n\n              case 'validprinterinfo'\n              /*case 'ValidPrinterInfo'*/\n              :\n                break;\n\n              case 'horizontalresolution'\n              /*case 'HorizontalResolution'*/\n              :\n                break;\n\n              case 'verticalresolution'\n              /*case 'VerticalResolution'*/\n              :\n                break;\n\n              case 'numberofcopies'\n              /*case 'NumberofCopies'*/\n              :\n                break;\n\n              case 'activepane'\n              /*case 'ActivePane'*/\n              :\n                break;\n\n              case 'toprowvisible'\n              /*case 'TopRowVisible'*/\n              :\n                break;\n\n              case 'leftcolumnvisible'\n              /*case 'LeftColumnVisible'*/\n              :\n                break;\n\n              case 'fittopage'\n              /*case 'FitToPage'*/\n              :\n                break;\n\n              case 'rangeselection'\n              /*case 'RangeSelection'*/\n              :\n                break;\n\n              case 'papersizeindex'\n              /*case 'PaperSizeIndex'*/\n              :\n                break;\n\n              case 'pagelayoutzoom'\n              /*case 'PageLayoutZoom'*/\n              :\n                break;\n\n              case 'pagebreakzoom'\n              /*case 'PageBreakZoom'*/\n              :\n                break;\n\n              case 'filteron'\n              /*case 'FilterOn'*/\n              :\n                break;\n\n              case 'fitwidth'\n              /*case 'FitWidth'*/\n              :\n                break;\n\n              case 'fitheight'\n              /*case 'FitHeight'*/\n              :\n                break;\n\n              case 'commentslayout'\n              /*case 'CommentsLayout'*/\n              :\n                break;\n\n              case 'zoom'\n              /*case 'Zoom'*/\n              :\n                break;\n\n              case 'lefttoright'\n              /*case 'LeftToRight'*/\n              :\n                break;\n\n              case 'gridlines'\n              /*case 'Gridlines'*/\n              :\n                break;\n\n              case 'allowsort'\n              /*case 'AllowSort'*/\n              :\n                break;\n\n              case 'allowfilter'\n              /*case 'AllowFilter'*/\n              :\n                break;\n\n              case 'allowinsertrows'\n              /*case 'AllowInsertRows'*/\n              :\n                break;\n\n              case 'allowdeleterows'\n              /*case 'AllowDeleteRows'*/\n              :\n                break;\n\n              case 'allowinsertcols'\n              /*case 'AllowInsertCols'*/\n              :\n                break;\n\n              case 'allowdeletecols'\n              /*case 'AllowDeleteCols'*/\n              :\n                break;\n\n              case 'allowinserthyperlinks'\n              /*case 'AllowInsertHyperlinks'*/\n              :\n                break;\n\n              case 'allowformatcells'\n              /*case 'AllowFormatCells'*/\n              :\n                break;\n\n              case 'allowsizecols'\n              /*case 'AllowSizeCols'*/\n              :\n                break;\n\n              case 'allowsizerows'\n              /*case 'AllowSizeRows'*/\n              :\n                break;\n\n              case 'nosummaryrowsbelowdetail'\n              /*case 'NoSummaryRowsBelowDetail'*/\n              :\n                if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n                cursheet[\"!outline\"].above = true;\n                break;\n\n              case 'tabcolorindex'\n              /*case 'TabColorIndex'*/\n              :\n                break;\n\n              case 'donotdisplayheadings'\n              /*case 'DoNotDisplayHeadings'*/\n              :\n                break;\n\n              case 'showpagelayoutzoom'\n              /*case 'ShowPageLayoutZoom'*/\n              :\n                break;\n\n              case 'nosummarycolumnsrightdetail'\n              /*case 'NoSummaryColumnsRightDetail'*/\n              :\n                if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n                cursheet[\"!outline\"].left = true;\n                break;\n\n              case 'blackandwhite'\n              /*case 'BlackAndWhite'*/\n              :\n                break;\n\n              case 'donotdisplayzeros'\n              /*case 'DoNotDisplayZeros'*/\n              :\n                break;\n\n              case 'displaypagebreak'\n              /*case 'DisplayPageBreak'*/\n              :\n                break;\n\n              case 'rowcolheadings'\n              /*case 'RowColHeadings'*/\n              :\n                break;\n\n              case 'donotdisplayoutline'\n              /*case 'DoNotDisplayOutline'*/\n              :\n                break;\n\n              case 'noorientation'\n              /*case 'NoOrientation'*/\n              :\n                break;\n\n              case 'allowusepivottables'\n              /*case 'AllowUsePivotTables'*/\n              :\n                break;\n\n              case 'zeroheight'\n              /*case 'ZeroHeight'*/\n              :\n                break;\n\n              case 'viewablerange'\n              /*case 'ViewableRange'*/\n              :\n                break;\n\n              case 'selection'\n              /*case 'Selection'*/\n              :\n                break;\n\n              case 'protectcontents'\n              /*case 'ProtectContents'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* PivotTable */\n\n          case 'pivottable'\n          /*case 'PivotTable'*/\n          :\n          case 'pivotcache'\n          /*case 'PivotCache'*/\n          :\n            switch (Rn[3]) {\n              case 'immediateitemsondrop'\n              /*case 'ImmediateItemsOnDrop'*/\n              :\n                break;\n\n              case 'showpagemultipleitemlabel'\n              /*case 'ShowPageMultipleItemLabel'*/\n              :\n                break;\n\n              case 'compactrowindent'\n              /*case 'CompactRowIndent'*/\n              :\n                break;\n\n              case 'location'\n              /*case 'Location'*/\n              :\n                break;\n\n              case 'pivotfield'\n              /*case 'PivotField'*/\n              :\n                break;\n\n              case 'orientation'\n              /*case 'Orientation'*/\n              :\n                break;\n\n              case 'layoutform'\n              /*case 'LayoutForm'*/\n              :\n                break;\n\n              case 'layoutsubtotallocation'\n              /*case 'LayoutSubtotalLocation'*/\n              :\n                break;\n\n              case 'layoutcompactrow'\n              /*case 'LayoutCompactRow'*/\n              :\n                break;\n\n              case 'position'\n              /*case 'Position'*/\n              :\n                break;\n\n              case 'pivotitem'\n              /*case 'PivotItem'*/\n              :\n                break;\n\n              case 'datatype'\n              /*case 'DataType'*/\n              :\n                break;\n\n              case 'datafield'\n              /*case 'DataField'*/\n              :\n                break;\n\n              case 'sourcename'\n              /*case 'SourceName'*/\n              :\n                break;\n\n              case 'parentfield'\n              /*case 'ParentField'*/\n              :\n                break;\n\n              case 'ptlineitems'\n              /*case 'PTLineItems'*/\n              :\n                break;\n\n              case 'ptlineitem'\n              /*case 'PTLineItem'*/\n              :\n                break;\n\n              case 'countofsameitems'\n              /*case 'CountOfSameItems'*/\n              :\n                break;\n\n              case 'item'\n              /*case 'Item'*/\n              :\n                break;\n\n              case 'itemtype'\n              /*case 'ItemType'*/\n              :\n                break;\n\n              case 'ptsource'\n              /*case 'PTSource'*/\n              :\n                break;\n\n              case 'cacheindex'\n              /*case 'CacheIndex'*/\n              :\n                break;\n\n              case 'consolidationreference'\n              /*case 'ConsolidationReference'*/\n              :\n                break;\n\n              case 'filename'\n              /*case 'FileName'*/\n              :\n                break;\n\n              case 'reference'\n              /*case 'Reference'*/\n              :\n                break;\n\n              case 'nocolumngrand'\n              /*case 'NoColumnGrand'*/\n              :\n                break;\n\n              case 'norowgrand'\n              /*case 'NoRowGrand'*/\n              :\n                break;\n\n              case 'blanklineafteritems'\n              /*case 'BlankLineAfterItems'*/\n              :\n                break;\n\n              case 'hidden'\n              /*case 'Hidden'*/\n              :\n                break;\n\n              case 'subtotal'\n              /*case 'Subtotal'*/\n              :\n                break;\n\n              case 'basefield'\n              /*case 'BaseField'*/\n              :\n                break;\n\n              case 'mapchilditems'\n              /*case 'MapChildItems'*/\n              :\n                break;\n\n              case 'function'\n              /*case 'Function'*/\n              :\n                break;\n\n              case 'refreshonfileopen'\n              /*case 'RefreshOnFileOpen'*/\n              :\n                break;\n\n              case 'printsettitles'\n              /*case 'PrintSetTitles'*/\n              :\n                break;\n\n              case 'mergelabels'\n              /*case 'MergeLabels'*/\n              :\n                break;\n\n              case 'defaultversion'\n              /*case 'DefaultVersion'*/\n              :\n                break;\n\n              case 'refreshname'\n              /*case 'RefreshName'*/\n              :\n                break;\n\n              case 'refreshdate'\n              /*case 'RefreshDate'*/\n              :\n                break;\n\n              case 'refreshdatecopy'\n              /*case 'RefreshDateCopy'*/\n              :\n                break;\n\n              case 'versionlastrefresh'\n              /*case 'VersionLastRefresh'*/\n              :\n                break;\n\n              case 'versionlastupdate'\n              /*case 'VersionLastUpdate'*/\n              :\n                break;\n\n              case 'versionupdateablemin'\n              /*case 'VersionUpdateableMin'*/\n              :\n                break;\n\n              case 'versionrefreshablemin'\n              /*case 'VersionRefreshableMin'*/\n              :\n                break;\n\n              case 'calculation'\n              /*case 'Calculation'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* PageBreaks */\n\n          case 'pagebreaks'\n          /*case 'PageBreaks'*/\n          :\n            switch (Rn[3]) {\n              case 'colbreaks'\n              /*case 'ColBreaks'*/\n              :\n                break;\n\n              case 'colbreak'\n              /*case 'ColBreak'*/\n              :\n                break;\n\n              case 'rowbreaks'\n              /*case 'RowBreaks'*/\n              :\n                break;\n\n              case 'rowbreak'\n              /*case 'RowBreak'*/\n              :\n                break;\n\n              case 'colstart'\n              /*case 'ColStart'*/\n              :\n                break;\n\n              case 'colend'\n              /*case 'ColEnd'*/\n              :\n                break;\n\n              case 'rowend'\n              /*case 'RowEnd'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* AutoFilter */\n\n          case 'autofilter'\n          /*case 'AutoFilter'*/\n          :\n            switch (Rn[3]) {\n              case 'autofiltercolumn'\n              /*case 'AutoFilterColumn'*/\n              :\n                break;\n\n              case 'autofiltercondition'\n              /*case 'AutoFilterCondition'*/\n              :\n                break;\n\n              case 'autofilterand'\n              /*case 'AutoFilterAnd'*/\n              :\n                break;\n\n              case 'autofilteror'\n              /*case 'AutoFilterOr'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* QueryTable */\n\n          case 'querytable'\n          /*case 'QueryTable'*/\n          :\n            switch (Rn[3]) {\n              case 'id'\n              /*case 'Id'*/\n              :\n                break;\n\n              case 'autoformatfont'\n              /*case 'AutoFormatFont'*/\n              :\n                break;\n\n              case 'autoformatpattern'\n              /*case 'AutoFormatPattern'*/\n              :\n                break;\n\n              case 'querysource'\n              /*case 'QuerySource'*/\n              :\n                break;\n\n              case 'querytype'\n              /*case 'QueryType'*/\n              :\n                break;\n\n              case 'enableredirections'\n              /*case 'EnableRedirections'*/\n              :\n                break;\n\n              case 'refreshedinxl9'\n              /*case 'RefreshedInXl9'*/\n              :\n                break;\n\n              case 'urlstring'\n              /*case 'URLString'*/\n              :\n                break;\n\n              case 'htmltables'\n              /*case 'HTMLTables'*/\n              :\n                break;\n\n              case 'connection'\n              /*case 'Connection'*/\n              :\n                break;\n\n              case 'commandtext'\n              /*case 'CommandText'*/\n              :\n                break;\n\n              case 'refreshinfo'\n              /*case 'RefreshInfo'*/\n              :\n                break;\n\n              case 'notitles'\n              /*case 'NoTitles'*/\n              :\n                break;\n\n              case 'nextid'\n              /*case 'NextId'*/\n              :\n                break;\n\n              case 'columninfo'\n              /*case 'ColumnInfo'*/\n              :\n                break;\n\n              case 'overwritecells'\n              /*case 'OverwriteCells'*/\n              :\n                break;\n\n              case 'donotpromptforfile'\n              /*case 'DoNotPromptForFile'*/\n              :\n                break;\n\n              case 'textwizardsettings'\n              /*case 'TextWizardSettings'*/\n              :\n                break;\n\n              case 'source'\n              /*case 'Source'*/\n              :\n                break;\n\n              case 'number'\n              /*case 'Number'*/\n              :\n                break;\n\n              case 'decimal'\n              /*case 'Decimal'*/\n              :\n                break;\n\n              case 'thousandseparator'\n              /*case 'ThousandSeparator'*/\n              :\n                break;\n\n              case 'trailingminusnumbers'\n              /*case 'TrailingMinusNumbers'*/\n              :\n                break;\n\n              case 'formatsettings'\n              /*case 'FormatSettings'*/\n              :\n                break;\n\n              case 'fieldtype'\n              /*case 'FieldType'*/\n              :\n                break;\n\n              case 'delimiters'\n              /*case 'Delimiters'*/\n              :\n                break;\n\n              case 'tab'\n              /*case 'Tab'*/\n              :\n                break;\n\n              case 'comma'\n              /*case 'Comma'*/\n              :\n                break;\n\n              case 'autoformatname'\n              /*case 'AutoFormatName'*/\n              :\n                break;\n\n              case 'versionlastedit'\n              /*case 'VersionLastEdit'*/\n              :\n                break;\n\n              case 'versionlastrefresh'\n              /*case 'VersionLastRefresh'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          case 'datavalidation'\n          /*case 'DataValidation'*/\n          :\n            switch (Rn[3]) {\n              case 'range'\n              /*case 'Range'*/\n              :\n                break;\n\n              case 'type'\n              /*case 'Type'*/\n              :\n                break;\n\n              case 'min'\n              /*case 'Min'*/\n              :\n                break;\n\n              case 'max'\n              /*case 'Max'*/\n              :\n                break;\n\n              case 'sort'\n              /*case 'Sort'*/\n              :\n                break;\n\n              case 'descending'\n              /*case 'Descending'*/\n              :\n                break;\n\n              case 'order'\n              /*case 'Order'*/\n              :\n                break;\n\n              case 'casesensitive'\n              /*case 'CaseSensitive'*/\n              :\n                break;\n\n              case 'value'\n              /*case 'Value'*/\n              :\n                break;\n\n              case 'errorstyle'\n              /*case 'ErrorStyle'*/\n              :\n                break;\n\n              case 'errormessage'\n              /*case 'ErrorMessage'*/\n              :\n                break;\n\n              case 'errortitle'\n              /*case 'ErrorTitle'*/\n              :\n                break;\n\n              case 'inputmessage'\n              /*case 'InputMessage'*/\n              :\n                break;\n\n              case 'inputtitle'\n              /*case 'InputTitle'*/\n              :\n                break;\n\n              case 'combohide'\n              /*case 'ComboHide'*/\n              :\n                break;\n\n              case 'inputhide'\n              /*case 'InputHide'*/\n              :\n                break;\n\n              case 'condition'\n              /*case 'Condition'*/\n              :\n                break;\n\n              case 'qualifier'\n              /*case 'Qualifier'*/\n              :\n                break;\n\n              case 'useblank'\n              /*case 'UseBlank'*/\n              :\n                break;\n\n              case 'value1'\n              /*case 'Value1'*/\n              :\n                break;\n\n              case 'value2'\n              /*case 'Value2'*/\n              :\n                break;\n\n              case 'format'\n              /*case 'Format'*/\n              :\n                break;\n\n              case 'cellrangelist'\n              /*case 'CellRangeList'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          case 'sorting'\n          /*case 'Sorting'*/\n          :\n          case 'conditionalformatting'\n          /*case 'ConditionalFormatting'*/\n          :\n            switch (Rn[3]) {\n              case 'range'\n              /*case 'Range'*/\n              :\n                break;\n\n              case 'type'\n              /*case 'Type'*/\n              :\n                break;\n\n              case 'min'\n              /*case 'Min'*/\n              :\n                break;\n\n              case 'max'\n              /*case 'Max'*/\n              :\n                break;\n\n              case 'sort'\n              /*case 'Sort'*/\n              :\n                break;\n\n              case 'descending'\n              /*case 'Descending'*/\n              :\n                break;\n\n              case 'order'\n              /*case 'Order'*/\n              :\n                break;\n\n              case 'casesensitive'\n              /*case 'CaseSensitive'*/\n              :\n                break;\n\n              case 'value'\n              /*case 'Value'*/\n              :\n                break;\n\n              case 'errorstyle'\n              /*case 'ErrorStyle'*/\n              :\n                break;\n\n              case 'errormessage'\n              /*case 'ErrorMessage'*/\n              :\n                break;\n\n              case 'errortitle'\n              /*case 'ErrorTitle'*/\n              :\n                break;\n\n              case 'cellrangelist'\n              /*case 'CellRangeList'*/\n              :\n                break;\n\n              case 'inputmessage'\n              /*case 'InputMessage'*/\n              :\n                break;\n\n              case 'inputtitle'\n              /*case 'InputTitle'*/\n              :\n                break;\n\n              case 'combohide'\n              /*case 'ComboHide'*/\n              :\n                break;\n\n              case 'inputhide'\n              /*case 'InputHide'*/\n              :\n                break;\n\n              case 'condition'\n              /*case 'Condition'*/\n              :\n                break;\n\n              case 'qualifier'\n              /*case 'Qualifier'*/\n              :\n                break;\n\n              case 'useblank'\n              /*case 'UseBlank'*/\n              :\n                break;\n\n              case 'value1'\n              /*case 'Value1'*/\n              :\n                break;\n\n              case 'value2'\n              /*case 'Value2'*/\n              :\n                break;\n\n              case 'format'\n              /*case 'Format'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* MapInfo (schema) */\n\n          case 'mapinfo'\n          /*case 'MapInfo'*/\n          :\n          case 'schema'\n          /*case 'Schema'*/\n          :\n          case 'data'\n          /*case 'data'*/\n          :\n            switch (Rn[3]) {\n              case 'map'\n              /*case 'Map'*/\n              :\n                break;\n\n              case 'entry'\n              /*case 'Entry'*/\n              :\n                break;\n\n              case 'range'\n              /*case 'Range'*/\n              :\n                break;\n\n              case 'xpath'\n              /*case 'XPath'*/\n              :\n                break;\n\n              case 'field'\n              /*case 'Field'*/\n              :\n                break;\n\n              case 'xsdtype'\n              /*case 'XSDType'*/\n              :\n                break;\n\n              case 'filteron'\n              /*case 'FilterOn'*/\n              :\n                break;\n\n              case 'aggregate'\n              /*case 'Aggregate'*/\n              :\n                break;\n\n              case 'elementtype'\n              /*case 'ElementType'*/\n              :\n                break;\n\n              case 'attributetype'\n              /*case 'AttributeType'*/\n              :\n                break;\n\n              /* These are from xsd (XML Schema Definition) */\n\n              case 'schema'\n              /*case 'schema'*/\n              :\n              case 'element'\n              /*case 'element'*/\n              :\n              case 'complextype'\n              /*case 'complexType'*/\n              :\n              case 'datatype'\n              /*case 'datatype'*/\n              :\n              case 'all'\n              /*case 'all'*/\n              :\n              case 'attribute'\n              /*case 'attribute'*/\n              :\n              case 'extends'\n              /*case 'extends'*/\n              :\n                break;\n\n              case 'row'\n              /*case 'row'*/\n              :\n                break;\n\n              default:\n                seen = false;\n            }\n\n            break;\n\n          /* SmartTags (can be anything) */\n\n          case 'smarttags'\n          /*case 'SmartTags'*/\n          :\n            break;\n\n          default:\n            seen = false;\n            break;\n        }\n\n        if (seen) break;\n        /* CustomDocumentProperties */\n\n        if (Rn[3].match(/!\\[CDATA/)) break;\n        if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\n        if (state[state.length - 1][0] ===\n        /*'CustomDocumentProperties'*/\n        'customdocumentproperties') {\n          if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));else {\n            cp = Rn;\n            pidx = Rn.index + Rn[0].length;\n          }\n          break;\n        }\n\n        if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n    }\n  }\n\n  var out = {}\n  /*:any*/\n  ;\n  if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n  out.SheetNames = sheetnames;\n  out.Workbook = Workbook;\n  out.SSF = dup(table_fmt);\n  out.Props = Props;\n  out.Custprops = Custprops;\n  return out;\n}\n\nfunction parse_xlml(data\n/*:RawBytes|string*/\n, opts)\n/*:Workbook*/\n{\n  fix_read_opts(opts = opts || {});\n\n  switch (opts.type || \"base64\") {\n    case \"base64\":\n      return parse_xlml_xml(Base64_decode(data), opts);\n\n    case \"binary\":\n    case \"buffer\":\n    case \"file\":\n      return parse_xlml_xml(data, opts);\n\n    case \"array\":\n      return parse_xlml_xml(a2s(data), opts);\n  }\n  /*:: throw new Error(\"unsupported type \" + opts.type); */\n\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\n\n\nfunction parse_compobj(obj\n/*:CFBEntry*/\n) {\n  var v = {};\n  var o = obj.content;\n  /*:: if(o == null) return; */\n\n  /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\n  o.l = 28;\n  v.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n  v.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n  if (o.length - o.l <= 4) return v;\n  var m\n  /*:number*/\n  = o.read_shift(4);\n  if (m == 0 || m > 40) return v;\n  o.l -= 4;\n  v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n  if (o.length - o.l <= 4) return v;\n  m = o.read_shift(4);\n  if (m !== 0x71b239f4) return v;\n  v.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n  m = o.read_shift(4);\n  if (m == 0 || m > 40) return v;\n  o.l -= 4;\n  v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\n\n\nvar CONTINUE_RT = [0x003c, 0x043c, 0x0812, 0x0875, 0x087f];\n\nfunction slurp(RecordType, R, blob, length\n/*:number*/\n, opts)\n/*:any*/\n{\n  var l = length;\n  var bufs = [];\n  var d = blob.slice(blob.l, blob.l + l);\n  if (opts && opts.enc && opts.enc.insitu && d.length > 0) switch (RecordType) {\n    case 0x0009:\n    case 0x0209:\n    case 0x0409:\n    case 0x0809\n    /* BOF */\n    :\n    case 0x002f\n    /* FilePass */\n    :\n    case 0x0195\n    /* FileLock */\n    :\n    case 0x00e1\n    /* InterfaceHdr */\n    :\n    case 0x0196\n    /* RRDInfo */\n    :\n    case 0x0138\n    /* RRDHead */\n    :\n    case 0x0194\n    /* UsrExcl */\n    :\n    case 0x000a\n    /* EOF */\n    :\n      break;\n\n    case 0x0085\n    /* BoundSheet8 */\n    :\n      break;\n\n    default:\n      opts.enc.insitu(d);\n  }\n  bufs.push(d);\n  blob.l += l;\n\n  var nextrt = __readUInt16LE(blob, blob.l),\n      next = XLSRecordEnum[nextrt];\n\n  var start = 0;\n\n  while (next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n    l = __readUInt16LE(blob, blob.l + 2);\n    start = blob.l + 4;\n    if (nextrt == 0x0812\n    /* ContinueFrt */\n    ) start += 4;else if (nextrt == 0x0875 || nextrt == 0x087f) {\n      start += 12;\n    }\n    d = blob.slice(start, blob.l + 4 + l);\n    bufs.push(d);\n    blob.l += 4 + l;\n    next = XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)];\n  }\n\n  var b = bconcat(bufs)\n  /*:any*/\n  ;\n  prep_blob(b, 0);\n  var ll = 0;\n  b.lens = [];\n\n  for (var j = 0; j < bufs.length; ++j) {\n    b.lens.push(ll);\n    ll += bufs[j].length;\n  }\n\n  if (b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n  return R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p\n/*:any*/\n, opts\n/*:ParseOpts*/\n, date1904\n/*:?boolean*/\n) {\n  if (p.t === 'z') return;\n  if (!p.XF) return;\n  var fmtid = 0;\n\n  try {\n    fmtid = p.z || p.XF.numFmtId || 0;\n    if (opts.cellNF) p.z = table_fmt[fmtid];\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (!opts || opts.cellText !== false) try {\n    if (p.t === 'e') {\n      p.w = p.w || BErr[p.v];\n    } else if (fmtid === 0 || fmtid == \"General\") {\n      if (p.t === 'n') {\n        if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n      } else p.w = SSF_general(p.v);\n    } else p.w = SSF_format(fmtid, p.v, {\n      date1904: !!date1904,\n      dateNF: opts && opts.dateNF\n    });\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n    var _d = SSF_parse_date_code(p.v);\n\n    if (_d) {\n      p.t = 'd';\n      p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n    }\n  }\n}\n\nfunction make_cell(val, ixfe, t)\n/*:Cell*/\n{\n  return {\n    v: val,\n    ixfe: ixfe,\n    t: t\n  }\n  /*:any*/\n  ;\n} // 2.3.2\n\n\nfunction parse_workbook(blob, options\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var wb = {\n    opts: {}\n  }\n  /*:any*/\n  ;\n  var Sheets = {};\n  var out\n  /*:Worksheet*/\n  = options.dense ? [] : {}\n  /*:any*/\n  ;\n  var Directory = {};\n  var range\n  /*:Range*/\n  = {}\n  /*:any*/\n  ;\n  var last_formula = null;\n  var sst\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n  var cur_sheet = \"\";\n  var Preamble = {};\n  var lastcell,\n      last_cell = \"\",\n      cc\n  /*:Cell*/\n  ,\n      cmnt,\n      rngC,\n      rngR;\n  var sharedf = {};\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var temp_val\n  /*:Cell*/\n  ;\n  var country;\n  var XFs = [];\n  /* XF records */\n\n  var palette\n  /*:Array<[number, number, number]>*/\n  = [];\n  var Workbook\n  /*:WBWBProps*/\n  = {\n    Sheets: [],\n    WBProps: {\n      date1904: false\n    },\n    Views: [{}]\n  }\n  /*:any*/\n  ,\n      wsprops = {};\n\n  var get_rgb = function getrgb(icv\n  /*:number*/\n  )\n  /*:[number, number, number]*/\n  {\n    if (icv < 8) return XLSIcv[icv];\n    if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\n    return XLSIcv[icv];\n  };\n\n  var process_cell_style = function pcs(cell, line\n  /*:any*/\n  , options) {\n    var xfd = line.XF.data;\n    if (!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n    line.s = {}\n    /*:any*/\n    ;\n    line.s.patternType = xfd.patternType;\n    var t;\n\n    if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n      line.s.fgColor = {\n        rgb: t\n      };\n    }\n\n    if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n      line.s.bgColor = {\n        rgb: t\n      };\n    }\n  };\n\n  var addcell = function addcell(cell\n  /*:any*/\n  , line\n  /*:any*/\n  , options\n  /*:any*/\n  ) {\n    if (file_depth > 1) return;\n    if (options.sheetRows && cell.r >= options.sheetRows) return;\n    if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n    delete line.ixfe;\n    delete line.XF;\n    lastcell = cell;\n    last_cell = encode_cell(cell);\n    if (!range || !range.s || !range.e) range = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    if (cell.r < range.s.r) range.s.r = cell.r;\n    if (cell.c < range.s.c) range.s.c = cell.c;\n    if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n    if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\n    if (options.cellFormula && line.f) {\n      for (var afi = 0; afi < arrayf.length; ++afi) {\n        if (arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n        if (arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n        line.F = encode_range(arrayf[afi][0]);\n        if (arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n        if (line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n        break;\n      }\n    }\n\n    {\n      if (options.dense) {\n        if (!out[cell.r]) out[cell.r] = [];\n        out[cell.r][cell.c] = line;\n      } else out[last_cell] = line;\n    }\n  };\n\n  var opts = {\n    enc: false,\n    // encrypted\n    sbcch: 0,\n    // cch in the preceding SupBook\n    snames: [],\n    // sheetnames\n    sharedf: sharedf,\n    // shared formulae by address\n    arrayf: arrayf,\n    // array formulae array\n    rrtabid: [],\n    // RRTabId\n    lastuser: \"\",\n    // Last User from WriteAccess\n    biff: 8,\n    // BIFF version\n    codepage: 0,\n    // CP from CodePage record\n    winlocked: 0,\n    // fLockWn from WinProtect\n    cellStyles: !!options && !!options.cellStyles,\n    WTF: !!options && !!options.wtf\n  }\n  /*:any*/\n  ;\n  if (options.password) opts.password = options.password;\n  var themes;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var objects = [];\n  var colinfo\n  /*:Array<ColInfo>*/\n  = [],\n      rowinfo\n  /*:Array<RowInfo>*/\n  = [];\n  var seencol = false;\n  var supbooks = []\n  /*:any*/\n  ; // 1-indexed, will hold extern names\n\n  supbooks.SheetNames = opts.snames;\n  supbooks.sharedf = opts.sharedf;\n  supbooks.arrayf = opts.arrayf;\n  supbooks.names = [];\n  supbooks.XTI = [];\n  var last_RT = 0;\n  var file_depth = 0;\n  /* TODO: make a real stack */\n\n  var BIFF2Fmt = 0,\n      BIFF2FmtTable\n  /*:Array<string>*/\n  = [];\n  var FilterDatabases = [];\n  /* TODO: sort out supbooks and process elsewhere */\n\n  var last_lbl\n  /*:?DefinedName*/\n  ;\n  /* explicit override for some broken writers */\n\n  opts.codepage = 1200;\n  set_cp(1200);\n  var seen_codepage = false;\n\n  while (blob.l < blob.length - 1) {\n    var s = blob.l;\n    var RecordType = blob.read_shift(2);\n    if (RecordType === 0 && last_RT === 0x000a\n    /* EOF */\n    ) break;\n    var length = blob.l === blob.length ? 0 : blob.read_shift(2);\n    var R = XLSRecordEnum[RecordType]; //console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n    //if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\n    if (R && R.f) {\n      if (options.bookSheets) {\n        if (last_RT === 0x0085\n        /* BoundSheet8 */\n        && RecordType !== 0x0085\n        /* R.n !== 'BoundSheet8' */\n        ) break;\n      }\n\n      last_RT = RecordType;\n\n      if (R.r === 2 || R.r == 12) {\n        var rt = blob.read_shift(2);\n        length -= 2;\n        if (!opts.enc && rt !== RecordType && ((rt & 0xFF) << 8 | rt >> 8) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\n        if (R.r == 12) {\n          blob.l += 10;\n          length -= 10;\n        } // skip FRT\n\n      } //console.error(R,blob.l,length,blob.length);\n\n\n      var val\n      /*:any*/\n      = {}\n      /*:any*/\n      ;\n      if (RecordType === 0x000a\n      /* EOF */\n      ) val =\n      /*::(*/\n      R.f(blob, length, opts)\n      /*:: :any)*/\n      ;else val =\n      /*::(*/\n      slurp(RecordType, R, blob, length, opts)\n      /*:: :any)*/\n      ;\n      /*:: val = (val:any); */\n\n      if (file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1\n      /* 'BOF' */\n      ) continue;\n\n      switch (RecordType) {\n        case 0x0022\n        /* Date1904 */\n        :\n          /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n          wb.opts.Date1904 = Workbook.WBProps.date1904 = val;\n          break;\n\n        case 0x0086\n        /* WriteProtect */\n        :\n          wb.opts.WriteProtect = true;\n          break;\n\n        case 0x002f\n        /* FilePass */\n        :\n          if (!opts.enc) blob.l = 0;\n          opts.enc = val;\n          if (!options.password) throw new Error(\"File is password-protected\");\n          if (val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n          if (!val.valid) throw new Error(\"Password is incorrect\");\n          break;\n\n        case 0x005c\n        /* WriteAccess */\n        :\n          opts.lastuser = val;\n          break;\n\n        case 0x0042\n        /* CodePage */\n        :\n          var cpval = Number(val);\n          /* overrides based on test cases */\n\n          switch (cpval) {\n            case 0x5212:\n              cpval = 1200;\n              break;\n\n            case 0x8000:\n              cpval = 10000;\n              break;\n\n            case 0x8001:\n              cpval = 1252;\n              break;\n          }\n\n          set_cp(opts.codepage = cpval);\n          seen_codepage = true;\n          break;\n\n        case 0x013d\n        /* RRTabId */\n        :\n          opts.rrtabid = val;\n          break;\n\n        case 0x0019\n        /* WinProtect */\n        :\n          opts.winlocked = val;\n          break;\n\n        case 0x01b7\n        /* RefreshAll */\n        :\n          wb.opts[\"RefreshAll\"] = val;\n          break;\n\n        case 0x000c\n        /* CalcCount */\n        :\n          wb.opts[\"CalcCount\"] = val;\n          break;\n\n        case 0x0010\n        /* CalcDelta */\n        :\n          wb.opts[\"CalcDelta\"] = val;\n          break;\n\n        case 0x0011\n        /* CalcIter */\n        :\n          wb.opts[\"CalcIter\"] = val;\n          break;\n\n        case 0x000d\n        /* CalcMode */\n        :\n          wb.opts[\"CalcMode\"] = val;\n          break;\n\n        case 0x000e\n        /* CalcPrecision */\n        :\n          wb.opts[\"CalcPrecision\"] = val;\n          break;\n\n        case 0x005f\n        /* CalcSaveRecalc */\n        :\n          wb.opts[\"CalcSaveRecalc\"] = val;\n          break;\n\n        case 0x000f\n        /* CalcRefMode */\n        :\n          opts.CalcRefMode = val;\n          break;\n        // TODO: implement R1C1\n\n        case 0x08a3\n        /* ForceFullCalculation */\n        :\n          wb.opts.FullCalc = val;\n          break;\n\n        case 0x0081\n        /* WsBool */\n        :\n          if (val.fDialog) out[\"!type\"] = \"dialog\";\n          if (!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n          if (!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n          break;\n        // TODO\n\n        case 0x00e0\n        /* XF */\n        :\n          XFs.push(val);\n          break;\n\n        case 0x01ae\n        /* SupBook */\n        :\n          supbooks.push([val]);\n          supbooks[supbooks.length - 1].XTI = [];\n          break;\n\n        case 0x0023:\n        case 0x0223\n        /* ExternName */\n        :\n          supbooks[supbooks.length - 1].push(val);\n          break;\n\n        case 0x0018:\n        case 0x0218\n        /* Lbl */\n        :\n          last_lbl = {\n            Name: val.Name,\n            Ref: stringify_formula(val.rgce, range, null, supbooks, opts)\n          }\n          /*:DefinedName*/\n          ;\n          if (val.itab > 0) last_lbl.Sheet = val.itab - 1;\n          supbooks.names.push(last_lbl);\n\n          if (!supbooks[0]) {\n            supbooks[0] = [];\n            supbooks[0].XTI = [];\n          }\n\n          supbooks[supbooks.length - 1].push(val);\n          if (val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0) if (val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d') FilterDatabases[val.itab - 1] = {\n            ref: encode_range(val.rgce[0][0][1][2])\n          };\n          break;\n\n        case 0x0016\n        /* ExternCount */\n        :\n          opts.ExternCount = val;\n          break;\n\n        case 0x0017\n        /* ExternSheet */\n        :\n          if (supbooks.length == 0) {\n            supbooks[0] = [];\n            supbooks[0].XTI = [];\n          }\n\n          supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n          supbooks.XTI = supbooks.XTI.concat(val);\n          break;\n\n        case 0x0894\n        /* NameCmt */\n        :\n          /* TODO: search for correct name */\n          if (opts.biff < 8) break;\n          if (last_lbl != null) last_lbl.Comment = val[1];\n          break;\n\n        case 0x0012\n        /* Protect */\n        :\n          out[\"!protect\"] = val;\n          break;\n\n        /* for sheet or book */\n\n        case 0x0013\n        /* Password */\n        :\n          if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n          break;\n\n        case 0x0085\n        /* BoundSheet8 */\n        :\n          {\n            Directory[val.pos] = val;\n            opts.snames.push(val.name);\n          }\n          break;\n\n        case 0x000a\n        /* EOF */\n        :\n          {\n            if (--file_depth) break;\n\n            if (range.e) {\n              if (range.e.r > 0 && range.e.c > 0) {\n                range.e.r--;\n                range.e.c--;\n                out[\"!ref\"] = encode_range(range);\n\n                if (options.sheetRows && options.sheetRows <= range.e.r) {\n                  var tmpri = range.e.r;\n                  range.e.r = options.sheetRows - 1;\n                  out[\"!fullref\"] = out[\"!ref\"];\n                  out[\"!ref\"] = encode_range(range);\n                  range.e.r = tmpri;\n                }\n\n                range.e.r++;\n                range.e.c++;\n              }\n\n              if (merges.length > 0) out[\"!merges\"] = merges;\n              if (objects.length > 0) out[\"!objects\"] = objects;\n              if (colinfo.length > 0) out[\"!cols\"] = colinfo;\n              if (rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n              Workbook.Sheets.push(wsprops);\n            }\n\n            if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n            out = options.dense ? [] : {}\n            /*:any*/\n            ;\n          }\n          break;\n\n        case 0x0009:\n        case 0x0209:\n        case 0x0409:\n        case 0x0809\n        /* BOF */\n        :\n          {\n            if (opts.biff === 8) opts.biff = {\n              /*::[*/\n              0x0009\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0209\n              /*::]*/\n              : 3,\n\n              /*::[*/\n              0x0409\n              /*::]*/\n              : 4\n            }[RecordType] || {\n              /*::[*/\n              0x0200\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0300\n              /*::]*/\n              : 3,\n\n              /*::[*/\n              0x0400\n              /*::]*/\n              : 4,\n\n              /*::[*/\n              0x0500\n              /*::]*/\n              : 5,\n\n              /*::[*/\n              0x0600\n              /*::]*/\n              : 8,\n\n              /*::[*/\n              0x0002\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0007\n              /*::]*/\n              : 2\n            }[val.BIFFVer] || 8;\n            opts.biffguess = val.BIFFVer == 0;\n\n            if (val.BIFFVer == 0 && val.dt == 0x1000) {\n              opts.biff = 5;\n              seen_codepage = true;\n              set_cp(opts.codepage = 28591);\n            }\n\n            if (opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n            if (file_depth++) break;\n            out = options.dense ? [] : {}\n            /*:any*/\n            ;\n\n            if (opts.biff < 8 && !seen_codepage) {\n              seen_codepage = true;\n              set_cp(opts.codepage = options.codepage || 1252);\n            }\n\n            if (opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n              if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n              range = {\n                s: {\n                  r: 0,\n                  c: 0\n                },\n                e: {\n                  r: 0,\n                  c: 0\n                }\n              };\n              /* fake BoundSheet8 */\n\n              var fakebs8 = {\n                pos: blob.l - length,\n                name: cur_sheet\n              };\n              Directory[fakebs8.pos] = fakebs8;\n              opts.snames.push(cur_sheet);\n            } else cur_sheet = (Directory[s] || {\n              name: \"\"\n            }).name;\n\n            if (val.dt == 0x20) out[\"!type\"] = \"chart\";\n            if (val.dt == 0x40) out[\"!type\"] = \"macro\";\n            merges = [];\n            objects = [];\n            opts.arrayf = arrayf = [];\n            colinfo = [];\n            rowinfo = [];\n            seencol = false;\n            wsprops = {\n              Hidden: (Directory[s] || {\n                hs: 0\n              }).hs,\n              name: cur_sheet\n            };\n          }\n          break;\n\n        case 0x0203\n        /* Number */\n        :\n        case 0x0003\n        /* BIFF2NUM */\n        :\n        case 0x0002\n        /* BIFF2INT */\n        :\n          {\n            if (out[\"!type\"] == \"chart\") if (options.dense ? (out[val.r] || [])[val.c] : out[encode_cell({\n              c: val.c,\n              r: val.r\n            })]) ++val.c;\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe] || {},\n              v: val.val,\n              t: 'n'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x0005:\n        case 0x0205\n        /* BoolErr */\n        :\n          {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              v: val.val,\n              t: val.t\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x027e\n        /* RK */\n        :\n          {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              v: val.rknum,\n              t: 'n'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x00bd\n        /* MulRk */\n        :\n          {\n            for (var j = val.c; j <= val.C; ++j) {\n              var ixfe = val.rkrec[j - val.c][0];\n              temp_val = {\n                ixfe: ixfe,\n                XF: XFs[ixfe],\n                v: val.rkrec[j - val.c][1],\n                t: 'n'\n              }\n              /*:any*/\n              ;\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: j,\n                r: val.r\n              }, temp_val, options);\n            }\n          }\n          break;\n\n        case 0x0006:\n        case 0x0206:\n        case 0x0406\n        /* Formula */\n        :\n          {\n            if (val.val == 'String') {\n              last_formula = val;\n              break;\n            }\n\n            temp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n            temp_val.XF = XFs[temp_val.ixfe];\n\n            if (options.cellFormula) {\n              var _f = val.formula;\n\n              if (_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n                var _fr = _f[0][0][1][0],\n                    _fc = _f[0][0][1][1];\n\n                var _fe = encode_cell({\n                  r: _fr,\n                  c: _fc\n                });\n\n                if (sharedf[_fe]) temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);else temp_val.F = ((options.dense ? (out[_fr] || [])[_fc] : out[_fe]) || {}).F;\n              } else temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\n            }\n\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell(val.cell, temp_val, options);\n            last_formula = val;\n          }\n          break;\n\n        case 0x0007:\n        case 0x0207\n        /* String */\n        :\n          {\n            if (last_formula) {\n              /* technically always true */\n              last_formula.val = val;\n              temp_val = make_cell(val, last_formula.cell.ixfe, 's');\n              temp_val.XF = XFs[temp_val.ixfe];\n\n              if (options.cellFormula) {\n                temp_val.f = \"\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n              }\n\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell(last_formula.cell, temp_val, options);\n              last_formula = null;\n            } else throw new Error(\"String record expects Formula\");\n          }\n          break;\n\n        case 0x0021:\n        case 0x0221\n        /* Array */\n        :\n          {\n            arrayf.push(val);\n\n            var _arraystart = encode_cell(val[0].s);\n\n            cc = options.dense ? (out[val[0].s.r] || [])[val[0].s.c] : out[_arraystart];\n\n            if (options.cellFormula && cc) {\n              if (!last_formula) break;\n              /* technically unreachable */\n\n              if (!_arraystart || !cc) break;\n              cc.f = \"\" + stringify_formula(val[1], range, val[0], supbooks, opts);\n              cc.F = encode_range(val[0]);\n            }\n          }\n          break;\n\n        case 0x04bc\n        /* ShrFmla */\n        :\n          {\n            if (!options.cellFormula) break;\n\n            if (last_cell) {\n              /* TODO: capture range */\n              if (!last_formula) break;\n              /* technically unreachable */\n\n              sharedf[encode_cell(last_formula.cell)] = val[0];\n              cc = options.dense ? (out[last_formula.cell.r] || [])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n              (cc || {}).f = \"\" + stringify_formula(val[0], range, lastcell, supbooks, opts);\n            }\n          }\n          break;\n\n        case 0x00fd\n        /* LabelSst */\n        :\n          temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n          if (sst[val.isst].h) temp_val.h = sst[val.isst].h;\n          temp_val.XF = XFs[temp_val.ixfe];\n          if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n          safe_format_xf(temp_val, options, wb.opts.Date1904);\n          addcell({\n            c: val.c,\n            r: val.r\n          }, temp_val, options);\n          break;\n\n        case 0x0201\n        /* Blank */\n        :\n          if (options.sheetStubs) {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              t: 'z'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n\n          break;\n\n        case 0x00be\n        /* MulBlank */\n        :\n          if (options.sheetStubs) {\n            for (var _j = val.c; _j <= val.C; ++_j) {\n              var _ixfe = val.ixfe[_j - val.c];\n              temp_val = {\n                ixfe: _ixfe,\n                XF: XFs[_ixfe],\n                t: 'z'\n              }\n              /*:any*/\n              ;\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: _j,\n                r: val.r\n              }, temp_val, options);\n            }\n          }\n\n          break;\n\n        case 0x00d6\n        /* RString */\n        :\n        case 0x0204\n        /* Label */\n        :\n        case 0x0004\n        /* BIFF2STR */\n        :\n          temp_val = make_cell(val.val, val.ixfe, 's');\n          temp_val.XF = XFs[temp_val.ixfe];\n          if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n          safe_format_xf(temp_val, options, wb.opts.Date1904);\n          addcell({\n            c: val.c,\n            r: val.r\n          }, temp_val, options);\n          break;\n\n        case 0x0000:\n        case 0x0200\n        /* Dimensions */\n        :\n          {\n            if (file_depth === 1) range = val;\n            /* TODO: stack */\n          }\n          break;\n\n        case 0x00fc\n        /* SST */\n        :\n          {\n            sst = val;\n          }\n          break;\n\n        case 0x041e\n        /* Format */\n        :\n          {\n            /* val = [id, fmt] */\n            if (opts.biff == 4) {\n              BIFF2FmtTable[BIFF2Fmt++] = val[1];\n\n              for (var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) {\n                if (table_fmt[b4idx] == val[1]) break;\n              }\n\n              if (b4idx >= 163) SSF_load(val[1], BIFF2Fmt + 163);\n            } else SSF_load(val[1], val[0]);\n          }\n          break;\n\n        case 0x001e\n        /* BIFF2FORMAT */\n        :\n          {\n            BIFF2FmtTable[BIFF2Fmt++] = val;\n\n            for (var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) {\n              if (table_fmt[b2idx] == val) break;\n            }\n\n            if (b2idx >= 163) SSF_load(val, BIFF2Fmt + 163);\n          }\n          break;\n\n        case 0x00e5\n        /* MergeCells */\n        :\n          merges = merges.concat(val);\n          break;\n\n        case 0x005d\n        /* Obj */\n        :\n          objects[val.cmo[0]] = opts.lastobj = val;\n          break;\n\n        case 0x01b6\n        /* TxO */\n        :\n          opts.lastobj.TxO = val;\n          break;\n\n        case 0x007f\n        /* ImData */\n        :\n          opts.lastobj.ImData = val;\n          break;\n\n        case 0x01b8\n        /* HLink */\n        :\n          {\n            for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) {\n              for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                  c: rngC,\n                  r: rngR\n                })];\n                if (cc) cc.l = val[1];\n              }\n            }\n          }\n          break;\n\n        case 0x0800\n        /* HLinkTooltip */\n        :\n          {\n            for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) {\n              for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                  c: rngC,\n                  r: rngR\n                })];\n                if (cc && cc.l) cc.l.Tooltip = val[1];\n              }\n            }\n          }\n          break;\n\n        case 0x001c\n        /* Note */\n        :\n          {\n            if (opts.biff <= 5 && opts.biff >= 2) break;\n            /* TODO: BIFF5 */\n\n            cc = options.dense ? (out[val[0].r] || [])[val[0].c] : out[encode_cell(val[0])];\n            var noteobj = objects[val[2]];\n\n            if (!cc) {\n              if (options.dense) {\n                if (!out[val[0].r]) out[val[0].r] = [];\n                cc = out[val[0].r][val[0].c] = {\n                  t: \"z\"\n                }\n                /*:any*/\n                ;\n              } else {\n                cc = out[encode_cell(val[0])] = {\n                  t: \"z\"\n                }\n                /*:any*/\n                ;\n              }\n\n              range.e.r = Math.max(range.e.r, val[0].r);\n              range.s.r = Math.min(range.s.r, val[0].r);\n              range.e.c = Math.max(range.e.c, val[0].c);\n              range.s.c = Math.min(range.s.c, val[0].c);\n            }\n\n            if (!cc.c) cc.c = [];\n            cmnt = {\n              a: val[1],\n              t: noteobj.TxO.t\n            };\n            cc.c.push(cmnt);\n          }\n          break;\n\n        case 0x087d\n        /* XFExt */\n        :\n          update_xfext(XFs[val.ixfe], val.ext);\n          break;\n\n        case 0x007d\n        /* ColInfo */\n        :\n          {\n            if (!opts.cellStyles) break;\n\n            while (val.e >= val.s) {\n              colinfo[val.e--] = {\n                width: val.w / 256,\n                level: val.level || 0,\n                hidden: !!(val.flags & 1)\n              };\n\n              if (!seencol) {\n                seencol = true;\n                find_mdw_colw(val.w / 256);\n              }\n\n              process_col(colinfo[val.e + 1]);\n            }\n          }\n          break;\n\n        case 0x0208\n        /* Row */\n        :\n          {\n            var rowobj = {};\n\n            if (val.level != null) {\n              rowinfo[val.r] = rowobj;\n              rowobj.level = val.level;\n            }\n\n            if (val.hidden) {\n              rowinfo[val.r] = rowobj;\n              rowobj.hidden = true;\n            }\n\n            if (val.hpt) {\n              rowinfo[val.r] = rowobj;\n              rowobj.hpt = val.hpt;\n              rowobj.hpx = pt2px(val.hpt);\n            }\n          }\n          break;\n\n        case 0x0026\n        /* LeftMargin */\n        :\n        case 0x0027\n        /* RightMargin */\n        :\n        case 0x0028\n        /* TopMargin */\n        :\n        case 0x0029\n        /* BottomMargin */\n        :\n          if (!out['!margins']) default_margins(out['!margins'] = {});\n          out['!margins'][{\n            0x26: \"left\",\n            0x27: \"right\",\n            0x28: \"top\",\n            0x29: \"bottom\"\n          }[RecordType]] = val;\n          break;\n\n        case 0x00a1\n        /* Setup */\n        :\n          // TODO\n          if (!out['!margins']) default_margins(out['!margins'] = {});\n          out['!margins'].header = val.header;\n          out['!margins'].footer = val.footer;\n          break;\n\n        case 0x023e\n        /* Window2 */\n        :\n          // TODO\n          // $FlowIgnore\n          if (val.RTL) Workbook.Views[0].RTL = true;\n          break;\n\n        case 0x0092\n        /* Palette */\n        :\n          palette = val;\n          break;\n\n        case 0x0896\n        /* Theme */\n        :\n          themes = val;\n          break;\n\n        case 0x008c\n        /* Country */\n        :\n          country = val;\n          break;\n\n        case 0x01ba\n        /* CodeName */\n        :\n          {\n            /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n            if (!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";else wsprops.CodeName = val || wsprops.name;\n          }\n          break;\n      }\n    } else {\n      if (!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n      blob.l += length;\n    }\n  }\n\n  wb.SheetNames = keys(Directory).sort(function (a, b) {\n    return Number(a) - Number(b);\n  }).map(function (x) {\n    return Directory[x].name;\n  });\n  if (!options.bookSheets) wb.Sheets = Sheets;\n\n  if (!wb.SheetNames.length && Preamble[\"!ref\"]) {\n    wb.SheetNames.push(\"Sheet1\");\n    /*jshint -W069 */\n\n    if (wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n    /*jshint +W069 */\n  } else wb.Preamble = Preamble;\n\n  if (wb.Sheets) FilterDatabases.forEach(function (r, i) {\n    wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r;\n  });\n  wb.Strings = sst;\n  wb.SSF = dup(table_fmt);\n  if (opts.enc) wb.Encryption = opts.enc;\n  if (themes) wb.Themes = themes;\n  wb.Metadata = {};\n  if (country !== undefined) wb.Metadata.Country = country;\n  if (supbooks.names.length > 0) Workbook.Names = supbooks.names;\n  wb.Workbook = Workbook;\n  return wb;\n}\n/* TODO: split props*/\n\n\nvar PSCLSID = {\n  SI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n  DSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n  UDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\n\nfunction parse_xls_props(cfb\n/*:CFBContainer*/\n, props, o) {\n  /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n  var DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n  if (DSI && DSI.size > 0) try {\n    var DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\n    for (var d in DocSummary) {\n      props[d] = DocSummary[d];\n    }\n  } catch (e) {\n    if (o.WTF) throw e;\n    /* empty */\n  }\n  /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\n  var SI = CFB.find(cfb, '/!SummaryInformation');\n  if (SI && SI.size > 0) try {\n    var Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\n    for (var s in Summary) {\n      if (props[s] == null) props[s] = Summary[s];\n    }\n  } catch (e) {\n    if (o.WTF) throw e;\n    /* empty */\n  }\n\n  if (props.HeadingPairs && props.TitlesOfParts) {\n    load_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n    delete props.HeadingPairs;\n    delete props.TitlesOfParts;\n  }\n}\n\nfunction parse_xlscfb(cfb\n/*:any*/\n, options\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  if (!options) options = {};\n  fix_read_opts(options);\n  reset_cp();\n  if (options.codepage) set_ansi(options.codepage);\n  var CompObj\n  /*:?CFBEntry*/\n  , WB\n  /*:?any*/\n  ;\n\n  if (cfb.FullPaths) {\n    if (CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n    CompObj = CFB.find(cfb, '!CompObj');\n    WB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n  } else {\n    switch (options.type) {\n      case 'base64':\n        cfb = s2a(Base64_decode(cfb));\n        break;\n\n      case 'binary':\n        cfb = s2a(cfb);\n        break;\n\n      case 'buffer':\n        break;\n\n      case 'array':\n        if (!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb);\n        break;\n    }\n\n    prep_blob(cfb, 0);\n    WB = {\n      content: cfb\n    }\n    /*:any*/\n    ;\n  }\n\n  var\n  /*::CompObjP, */\n  WorkbookP\n  /*:: :Workbook = XLSX.utils.book_new(); */\n  ;\n\n  var _data\n  /*:?any*/\n  ;\n\n  if (CompObj)\n    /*::CompObjP = */\n    parse_compobj(CompObj);\n  if (options.bookProps && !options.bookSheets) WorkbookP = {}\n  /*:any*/\n  ;else\n    /*:: if(cfb instanceof CFBContainer) */\n    {\n      var T = has_buf ? 'buffer' : 'array';\n      if (WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n      /* Quattro Pro 7-8 */\n      else if ((_data = CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Quattro Pro 9 */\n      else if ((_data = CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Works 4 for Mac */\n      else if ((_data = CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");else throw new Error(\"Cannot find Workbook stream\");\n      if (options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n    }\n  var props = {};\n  if (cfb.FullPaths) parse_xls_props(\n  /*::((*/\n  cfb\n  /*:: :any):CFBContainer)*/\n  , props, options);\n  WorkbookP.Props = WorkbookP.Custprops = props;\n  /* TODO: split up properties */\n\n  if (options.bookFiles) WorkbookP.cfb = cfb;\n  /*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\n\n  return WorkbookP;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\n\n\nvar XLSBRecordEnum = {\n  /*::[*/\n  0x0000\n  /*::]*/\n  : {\n    /* n:\"BrtRowHdr\", */\n    f: parse_BrtRowHdr\n  },\n\n  /*::[*/\n  0x0001\n  /*::]*/\n  : {\n    /* n:\"BrtCellBlank\", */\n    f: parse_BrtCellBlank\n  },\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : {\n    /* n:\"BrtCellRk\", */\n    f: parse_BrtCellRk\n  },\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : {\n    /* n:\"BrtCellError\", */\n    f: parse_BrtCellError\n  },\n\n  /*::[*/\n  0x0004\n  /*::]*/\n  : {\n    /* n:\"BrtCellBool\", */\n    f: parse_BrtCellBool\n  },\n\n  /*::[*/\n  0x0005\n  /*::]*/\n  : {\n    /* n:\"BrtCellReal\", */\n    f: parse_BrtCellReal\n  },\n\n  /*::[*/\n  0x0006\n  /*::]*/\n  : {\n    /* n:\"BrtCellSt\", */\n    f: parse_BrtCellSt\n  },\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : {\n    /* n:\"BrtCellIsst\", */\n    f: parse_BrtCellIsst\n  },\n\n  /*::[*/\n  0x0008\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaString\", */\n    f: parse_BrtFmlaString\n  },\n\n  /*::[*/\n  0x0009\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaNum\", */\n    f: parse_BrtFmlaNum\n  },\n\n  /*::[*/\n  0x000A\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaBool\", */\n    f: parse_BrtFmlaBool\n  },\n\n  /*::[*/\n  0x000B\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaError\", */\n    f: parse_BrtFmlaError\n  },\n\n  /*::[*/\n  0x000C\n  /*::]*/\n  : {\n    /* n:\"BrtShortBlank\", */\n    f: parse_BrtShortBlank\n  },\n\n  /*::[*/\n  0x000D\n  /*::]*/\n  : {\n    /* n:\"BrtShortRk\", */\n    f: parse_BrtShortRk\n  },\n\n  /*::[*/\n  0x000E\n  /*::]*/\n  : {\n    /* n:\"BrtShortError\", */\n    f: parse_BrtShortError\n  },\n\n  /*::[*/\n  0x000F\n  /*::]*/\n  : {\n    /* n:\"BrtShortBool\", */\n    f: parse_BrtShortBool\n  },\n\n  /*::[*/\n  0x0010\n  /*::]*/\n  : {\n    /* n:\"BrtShortReal\", */\n    f: parse_BrtShortReal\n  },\n\n  /*::[*/\n  0x0011\n  /*::]*/\n  : {\n    /* n:\"BrtShortSt\", */\n    f: parse_BrtShortSt\n  },\n\n  /*::[*/\n  0x0012\n  /*::]*/\n  : {\n    /* n:\"BrtShortIsst\", */\n    f: parse_BrtShortIsst\n  },\n\n  /*::[*/\n  0x0013\n  /*::]*/\n  : {\n    /* n:\"BrtSSTItem\", */\n    f: parse_RichStr\n  },\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIMissing\" */\n  },\n\n  /*::[*/\n  0x0015\n  /*::]*/\n  : {\n    /* n:\"BrtPCDINumber\" */\n  },\n\n  /*::[*/\n  0x0016\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIBoolean\" */\n  },\n\n  /*::[*/\n  0x0017\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIError\" */\n  },\n\n  /*::[*/\n  0x0018\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIString\" */\n  },\n\n  /*::[*/\n  0x0019\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIDatetime\" */\n  },\n\n  /*::[*/\n  0x001A\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIIndex\" */\n  },\n\n  /*::[*/\n  0x001B\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAMissing\" */\n  },\n\n  /*::[*/\n  0x001C\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIANumber\" */\n  },\n\n  /*::[*/\n  0x001D\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIABoolean\" */\n  },\n\n  /*::[*/\n  0x001E\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAError\" */\n  },\n\n  /*::[*/\n  0x001F\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAString\" */\n  },\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIADatetime\" */\n  },\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : {\n    /* n:\"BrtPCRRecord\" */\n  },\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : {\n    /* n:\"BrtPCRRecordDt\" */\n  },\n\n  /*::[*/\n  0x0023\n  /*::]*/\n  : {\n    /* n:\"BrtFRTBegin\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : {\n    /* n:\"BrtFRTEnd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0025\n  /*::]*/\n  : {\n    /* n:\"BrtACBegin\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0026\n  /*::]*/\n  : {\n    /* n:\"BrtACEnd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : {\n    /* n:\"BrtName\", */\n    f: parse_BrtName\n  },\n\n  /*::[*/\n  0x0028\n  /*::]*/\n  : {\n    /* n:\"BrtIndexRowBlock\" */\n  },\n\n  /*::[*/\n  0x002A\n  /*::]*/\n  : {\n    /* n:\"BrtIndexBlock\" */\n  },\n\n  /*::[*/\n  0x002B\n  /*::]*/\n  : {\n    /* n:\"BrtFont\", */\n    f: parse_BrtFont\n  },\n\n  /*::[*/\n  0x002C\n  /*::]*/\n  : {\n    /* n:\"BrtFmt\", */\n    f: parse_BrtFmt\n  },\n\n  /*::[*/\n  0x002D\n  /*::]*/\n  : {\n    /* n:\"BrtFill\", */\n    f: parse_BrtFill\n  },\n\n  /*::[*/\n  0x002E\n  /*::]*/\n  : {\n    /* n:\"BrtBorder\", */\n    f: parse_BrtBorder\n  },\n\n  /*::[*/\n  0x002F\n  /*::]*/\n  : {\n    /* n:\"BrtXF\", */\n    f: parse_BrtXF\n  },\n\n  /*::[*/\n  0x0030\n  /*::]*/\n  : {\n    /* n:\"BrtStyle\" */\n  },\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : {\n    /* n:\"BrtCellMeta\", */\n    f: parse_Int32LE\n  },\n\n  /*::[*/\n  0x0032\n  /*::]*/\n  : {\n    /* n:\"BrtValueMeta\" */\n  },\n\n  /*::[*/\n  0x0033\n  /*::]*/\n  : {\n    /* n:\"BrtMdb\" */\n    f: parse_BrtMdb\n  },\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFmd\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0035\n  /*::]*/\n  : {\n    /* n:\"BrtEndFmd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0036\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0037\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0038\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxTuple\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0039\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxTuple\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x003A\n  /*::]*/\n  : {\n    /* n:\"BrtMdxMbrIstr\" */\n  },\n\n  /*::[*/\n  0x003B\n  /*::]*/\n  : {\n    /* n:\"BrtStr\" */\n  },\n\n  /*::[*/\n  0x003C\n  /*::]*/\n  : {\n    /* n:\"BrtColInfo\", */\n    f: parse_ColInfo\n  },\n\n  /*::[*/\n  0x003E\n  /*::]*/\n  : {\n    /* n:\"BrtCellRString\", */\n    f: parse_BrtCellRString\n  },\n\n  /*::[*/\n  0x003F\n  /*::]*/\n  : {\n    /* n:\"BrtCalcChainItem$\", */\n    f: parse_BrtCalcChainItem$\n  },\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : {\n    /* n:\"BrtDVal\", */\n    f: parse_BrtDVal\n  },\n\n  /*::[*/\n  0x0041\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellNum\" */\n  },\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellStr\" */\n  },\n\n  /*::[*/\n  0x0043\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellBool\" */\n  },\n\n  /*::[*/\n  0x0044\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellErr\" */\n  },\n\n  /*::[*/\n  0x0045\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellDate\" */\n  },\n\n  /*::[*/\n  0x0046\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellNil\" */\n  },\n\n  /*::[*/\n  0x0080\n  /*::]*/\n  : {\n    /* n:\"BrtFileVersion\" */\n  },\n\n  /*::[*/\n  0x0081\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSheet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0082\n  /*::]*/\n  : {\n    /* n:\"BrtEndSheet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0083\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBook\", */\n    T: 1,\n    f: parsenoop,\n    p: 0\n  },\n\n  /*::[*/\n  0x0084\n  /*::]*/\n  : {\n    /* n:\"BrtEndBook\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0085\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0086\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0087\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBookViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0088\n  /*::]*/\n  : {\n    /* n:\"BrtEndBookViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0089\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsView\", */\n    T: 1,\n    f: parse_BrtBeginWsView\n  },\n\n  /*::[*/\n  0x008A\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x008C\n  /*::]*/\n  : {\n    /* n:\"BrtEndCsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCsView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x008E\n  /*::]*/\n  : {\n    /* n:\"BrtEndCsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBundleShs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0090\n  /*::]*/\n  : {\n    /* n:\"BrtEndBundleShs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0091\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSheetData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0092\n  /*::]*/\n  : {\n    /* n:\"BrtEndSheetData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0093\n  /*::]*/\n  : {\n    /* n:\"BrtWsProp\", */\n    f: parse_BrtWsProp\n  },\n\n  /*::[*/\n  0x0094\n  /*::]*/\n  : {\n    /* n:\"BrtWsDim\", */\n    f: parse_BrtWsDim,\n    p: 16\n  },\n\n  /*::[*/\n  0x0097\n  /*::]*/\n  : {\n    /* n:\"BrtPane\", */\n    f: parse_BrtPane\n  },\n\n  /*::[*/\n  0x0098\n  /*::]*/\n  : {\n    /* n:\"BrtSel\" */\n  },\n\n  /*::[*/\n  0x0099\n  /*::]*/\n  : {\n    /* n:\"BrtWbProp\", */\n    f: parse_BrtWbProp\n  },\n\n  /*::[*/\n  0x009A\n  /*::]*/\n  : {\n    /* n:\"BrtWbFactoid\" */\n  },\n\n  /*::[*/\n  0x009B\n  /*::]*/\n  : {\n    /* n:\"BrtFileRecover\" */\n  },\n\n  /*::[*/\n  0x009C\n  /*::]*/\n  : {\n    /* n:\"BrtBundleSh\", */\n    f: parse_BrtBundleSh\n  },\n\n  /*::[*/\n  0x009D\n  /*::]*/\n  : {\n    /* n:\"BrtCalcProp\" */\n  },\n\n  /*::[*/\n  0x009E\n  /*::]*/\n  : {\n    /* n:\"BrtBookView\" */\n  },\n\n  /*::[*/\n  0x009F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSst\", */\n    T: 1,\n    f: parse_BrtBeginSst\n  },\n\n  /*::[*/\n  0x00A0\n  /*::]*/\n  : {\n    /* n:\"BrtEndSst\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginAFilter\", */\n    T: 1,\n    f: parse_UncheckedRfX\n  },\n\n  /*::[*/\n  0x00A2\n  /*::]*/\n  : {\n    /* n:\"BrtEndAFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFilterColumn\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00A4\n  /*::]*/\n  : {\n    /* n:\"BrtEndFilterColumn\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00A6\n  /*::]*/\n  : {\n    /* n:\"BrtEndFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A7\n  /*::]*/\n  : {\n    /* n:\"BrtFilter\" */\n  },\n\n  /*::[*/\n  0x00A8\n  /*::]*/\n  : {\n    /* n:\"BrtColorFilter\" */\n  },\n\n  /*::[*/\n  0x00A9\n  /*::]*/\n  : {\n    /* n:\"BrtIconFilter\" */\n  },\n\n  /*::[*/\n  0x00AA\n  /*::]*/\n  : {\n    /* n:\"BrtTop10Filter\" */\n  },\n\n  /*::[*/\n  0x00AB\n  /*::]*/\n  : {\n    /* n:\"BrtDynamicFilter\" */\n  },\n\n  /*::[*/\n  0x00AC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00AD\n  /*::]*/\n  : {\n    /* n:\"BrtEndCustomFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00AE\n  /*::]*/\n  : {\n    /* n:\"BrtCustomFilter\" */\n  },\n\n  /*::[*/\n  0x00AF\n  /*::]*/\n  : {\n    /* n:\"BrtAFilterDateGroupItem\" */\n  },\n\n  /*::[*/\n  0x00B0\n  /*::]*/\n  : {\n    /* n:\"BrtMergeCell\", */\n    f: parse_BrtMergeCell\n  },\n\n  /*::[*/\n  0x00B1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMergeCells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B2\n  /*::]*/\n  : {\n    /* n:\"BrtEndMergeCells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheDef\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheDef\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFields\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFields\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDField\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDField\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSource\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSource\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFAtbl\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFAtbl\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDIRun\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDIRun\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheRecords\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheRecords\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHierarchies\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHierarchies\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHierarchy\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHierarchy\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHFieldsUsage\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHFieldsUsage\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConnection\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CA\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConnection\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECDbProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CC\n  /*::]*/\n  : {\n    /* n:\"BrtEndECDbProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECOlapProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CE\n  /*::]*/\n  : {\n    /* n:\"BrtEndECOlapProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSConsol\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSConsol\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPages\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPages\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPage\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPage\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCSets\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCSets\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGDiscrete\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGDiscrete\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTupleCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTupleCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEntries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEntries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMembers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEMembers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMember\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEMember\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00EB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCQueries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCQueries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00ED\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCQuery\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCQuery\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00EF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCSets\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCSets\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRule\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRule\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilter\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPName\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0100\n  /*::]*/\n  : {\n    /* n:\"BrtEndPName\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0101\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNPairs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0102\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNPairs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0103\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNPair\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0104\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNPair\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0105\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECWebProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0106\n  /*::]*/\n  : {\n    /* n:\"BrtEndECWebProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0107\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEcWpTables\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0108\n  /*::]*/\n  : {\n    /* n:\"BrtEndECWPTables\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0109\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECParams\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010A\n  /*::]*/\n  : {\n    /* n:\"BrtEndECParams\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECParam\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010C\n  /*::]*/\n  : {\n    /* n:\"BrtEndECParam\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDKPIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010E\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDKPIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDKPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0110\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDKPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0111\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDims\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0112\n  /*::]*/\n  : {\n    /* n:\"BrtEndDims\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0113\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDim\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0114\n  /*::]*/\n  : {\n    /* n:\"BrtEndDim\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0115\n  /*::]*/\n  : {\n    /* n:\"BrtIndexPartEnd\" */\n  },\n\n  /*::[*/\n  0x0116\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyleSheet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0117\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyleSheet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0118\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0119\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVD\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVD\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0120\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0121\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0122\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0123\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXPIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0124\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXPIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0125\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXDI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0126\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXDI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0127\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXDIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0128\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXDIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0129\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLIRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLIRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLICols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLICols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFormat\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0130\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFormat\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0131\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFormats\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0132\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxFormats\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0133\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxSelect\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0134\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxSelect\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0135\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVDRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0136\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVDRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0137\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVDCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0138\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVDCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0139\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLocation\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLocation\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013D\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTH\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTH\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0140\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXTHRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0141\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXTHRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0142\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXTHCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0143\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXTHCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0144\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTDMPS\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0145\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTDMPs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0146\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTDMP\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0147\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTDMP\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0148\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0149\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMetadata\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014D\n  /*::]*/\n  : {\n    /* n:\"BrtEndMetadata\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdtinfo\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014F\n  /*::]*/\n  : {\n    /* n:\"BrtMdtinfo\", */\n    f: parse_BrtMdtinfo\n  },\n\n  /*::[*/\n  0x0150\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdtinfo\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0151\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdb\", */\n    f: parse_BrtBeginEsmdb,\n    T: 1\n  },\n\n  /*::[*/\n  0x0152\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdb\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0153\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsfmd\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0154\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsfmd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0155\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSingleCells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0156\n  /*::]*/\n  : {\n    /* n:\"BrtEndSingleCells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0157\n  /*::]*/\n  : {\n    /* n:\"BrtBeginList\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0158\n  /*::]*/\n  : {\n    /* n:\"BrtEndList\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0159\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015A\n  /*::]*/\n  : {\n    /* n:\"BrtEndListCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListCol\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015C\n  /*::]*/\n  : {\n    /* n:\"BrtEndListCol\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListXmlCPr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015E\n  /*::]*/\n  : {\n    /* n:\"BrtEndListXmlCPr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015F\n  /*::]*/\n  : {\n    /* n:\"BrtListCCFmla\" */\n  },\n\n  /*::[*/\n  0x0160\n  /*::]*/\n  : {\n    /* n:\"BrtListTrFmla\" */\n  },\n\n  /*::[*/\n  0x0161\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExternals\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : {\n    /* n:\"BrtEndExternals\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0163\n  /*::]*/\n  : {\n    /* n:\"BrtSupBookSrc\", */\n    f: parse_RelID\n  },\n\n  /*::[*/\n  0x0165\n  /*::]*/\n  : {\n    /* n:\"BrtSupSelf\" */\n  },\n\n  /*::[*/\n  0x0166\n  /*::]*/\n  : {\n    /* n:\"BrtSupSame\" */\n  },\n\n  /*::[*/\n  0x0167\n  /*::]*/\n  : {\n    /* n:\"BrtSupTabs\" */\n  },\n\n  /*::[*/\n  0x0168\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSupBook\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0169\n  /*::]*/\n  : {\n    /* n:\"BrtPlaceholderName\" */\n  },\n\n  /*::[*/\n  0x016A\n  /*::]*/\n  : {\n    /* n:\"BrtExternSheet\", */\n    f: parse_ExternSheet\n  },\n\n  /*::[*/\n  0x016B\n  /*::]*/\n  : {\n    /* n:\"BrtExternTableStart\" */\n  },\n\n  /*::[*/\n  0x016C\n  /*::]*/\n  : {\n    /* n:\"BrtExternTableEnd\" */\n  },\n\n  /*::[*/\n  0x016E\n  /*::]*/\n  : {\n    /* n:\"BrtExternRowHdr\" */\n  },\n\n  /*::[*/\n  0x016F\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellBlank\" */\n  },\n\n  /*::[*/\n  0x0170\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellReal\" */\n  },\n\n  /*::[*/\n  0x0171\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellBool\" */\n  },\n\n  /*::[*/\n  0x0172\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellError\" */\n  },\n\n  /*::[*/\n  0x0173\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellString\" */\n  },\n\n  /*::[*/\n  0x0174\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0175\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0176\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0177\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0178\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxMbrProp\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0179\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxMbrProp\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxKPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017B\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxKPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsstr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017D\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsstr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017F\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0180\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0181\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0182\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0183\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0184\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0185\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0186\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColInfos\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0187\n  /*::]*/\n  : {\n    /* n:\"BrtEndColInfos\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0188\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRwBrk\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0189\n  /*::]*/\n  : {\n    /* n:\"BrtEndRwBrk\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x018A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColBrk\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x018B\n  /*::]*/\n  : {\n    /* n:\"BrtEndColBrk\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x018C\n  /*::]*/\n  : {\n    /* n:\"BrtBrk\" */\n  },\n\n  /*::[*/\n  0x018D\n  /*::]*/\n  : {\n    /* n:\"BrtUserBookView\" */\n  },\n\n  /*::[*/\n  0x018E\n  /*::]*/\n  : {\n    /* n:\"BrtInfo\" */\n  },\n\n  /*::[*/\n  0x018F\n  /*::]*/\n  : {\n    /* n:\"BrtCUsr\" */\n  },\n\n  /*::[*/\n  0x0190\n  /*::]*/\n  : {\n    /* n:\"BrtUsr\" */\n  },\n\n  /*::[*/\n  0x0191\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUsers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0193\n  /*::]*/\n  : {\n    /* n:\"BrtEOF\" */\n  },\n\n  /*::[*/\n  0x0194\n  /*::]*/\n  : {\n    /* n:\"BrtUCR\" */\n  },\n\n  /*::[*/\n  0x0195\n  /*::]*/\n  : {\n    /* n:\"BrtRRInsDel\" */\n  },\n\n  /*::[*/\n  0x0196\n  /*::]*/\n  : {\n    /* n:\"BrtRREndInsDel\" */\n  },\n\n  /*::[*/\n  0x0197\n  /*::]*/\n  : {\n    /* n:\"BrtRRMove\" */\n  },\n\n  /*::[*/\n  0x0198\n  /*::]*/\n  : {\n    /* n:\"BrtRREndMove\" */\n  },\n\n  /*::[*/\n  0x0199\n  /*::]*/\n  : {\n    /* n:\"BrtRRChgCell\" */\n  },\n\n  /*::[*/\n  0x019A\n  /*::]*/\n  : {\n    /* n:\"BrtRREndChgCell\" */\n  },\n\n  /*::[*/\n  0x019B\n  /*::]*/\n  : {\n    /* n:\"BrtRRHeader\" */\n  },\n\n  /*::[*/\n  0x019C\n  /*::]*/\n  : {\n    /* n:\"BrtRRUserView\" */\n  },\n\n  /*::[*/\n  0x019D\n  /*::]*/\n  : {\n    /* n:\"BrtRRRenSheet\" */\n  },\n\n  /*::[*/\n  0x019E\n  /*::]*/\n  : {\n    /* n:\"BrtRRInsertSh\" */\n  },\n\n  /*::[*/\n  0x019F\n  /*::]*/\n  : {\n    /* n:\"BrtRRDefName\" */\n  },\n\n  /*::[*/\n  0x01A0\n  /*::]*/\n  : {\n    /* n:\"BrtRRNote\" */\n  },\n\n  /*::[*/\n  0x01A1\n  /*::]*/\n  : {\n    /* n:\"BrtRRConflict\" */\n  },\n\n  /*::[*/\n  0x01A2\n  /*::]*/\n  : {\n    /* n:\"BrtRRTQSIF\" */\n  },\n\n  /*::[*/\n  0x01A3\n  /*::]*/\n  : {\n    /* n:\"BrtRRFormat\" */\n  },\n\n  /*::[*/\n  0x01A4\n  /*::]*/\n  : {\n    /* n:\"BrtRREndFormat\" */\n  },\n\n  /*::[*/\n  0x01A5\n  /*::]*/\n  : {\n    /* n:\"BrtRRAutoFmt\" */\n  },\n\n  /*::[*/\n  0x01A6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserShViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01A7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserShView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01A8\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserShView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01A9\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserShViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01AA\n  /*::]*/\n  : {\n    /* n:\"BrtArrFmla\", */\n    f: parse_BrtArrFmla\n  },\n\n  /*::[*/\n  0x01AB\n  /*::]*/\n  : {\n    /* n:\"BrtShrFmla\", */\n    f: parse_BrtShrFmla\n  },\n\n  /*::[*/\n  0x01AC\n  /*::]*/\n  : {\n    /* n:\"BrtTable\" */\n  },\n\n  /*::[*/\n  0x01AD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConnections\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01AE\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConnections\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01AF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLevels\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLevels\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLevel\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLevel\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGroups\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGroups\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGMembers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGMembers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGMember\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGMember\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C0\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIR\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C2\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIR\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDeletedNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C4\n  /*::]*/\n  : {\n    /* n:\"BrtEndDeletedNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDeletedName\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C6\n  /*::]*/\n  : {\n    /* n:\"BrtEndDeletedName\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C8\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIF\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CA\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIF\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginAutoSortScope\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CC\n  /*::]*/\n  : {\n    /* n:\"BrtEndAutoSortScope\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormatting\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CE\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormatting\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCFRule\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D0\n  /*::]*/\n  : {\n    /* n:\"BrtEndCFRule\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIconSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D2\n  /*::]*/\n  : {\n    /* n:\"BrtEndIconSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDatabar\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D4\n  /*::]*/\n  : {\n    /* n:\"BrtEndDatabar\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorScale\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D6\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorScale\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D7\n  /*::]*/\n  : {\n    /* n:\"BrtCFVO\" */\n  },\n\n  /*::[*/\n  0x01D8\n  /*::]*/\n  : {\n    /* n:\"BrtExternValueMeta\" */\n  },\n\n  /*::[*/\n  0x01D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorPalette\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorPalette\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01DB\n  /*::]*/\n  : {\n    /* n:\"BrtIndexedColor\" */\n  },\n\n  /*::[*/\n  0x01DC\n  /*::]*/\n  : {\n    /* n:\"BrtMargins\", */\n    f: parse_BrtMargins\n  },\n\n  /*::[*/\n  0x01DD\n  /*::]*/\n  : {\n    /* n:\"BrtPrintOptions\" */\n  },\n\n  /*::[*/\n  0x01DE\n  /*::]*/\n  : {\n    /* n:\"BrtPageSetup\" */\n  },\n\n  /*::[*/\n  0x01DF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginHeaderFooter\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E0\n  /*::]*/\n  : {\n    /* n:\"BrtEndHeaderFooter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCrtFormat\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E2\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCrtFormat\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCrtFormats\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E4\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCrtFormats\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E5\n  /*::]*/\n  : {\n    /* n:\"BrtWsFmtInfo\", */\n    f: parse_BrtWsFmtInfo\n  },\n\n  /*::[*/\n  0x01E6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMgs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E7\n  /*::]*/\n  : {\n    /* n:\"BrtEndMGs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E8\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMGMaps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E9\n  /*::]*/\n  : {\n    /* n:\"BrtEndMGMaps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EA\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMG\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01EB\n  /*::]*/\n  : {\n    /* n:\"BrtEndMG\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMap\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01ED\n  /*::]*/\n  : {\n    /* n:\"BrtEndMap\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EE\n  /*::]*/\n  : {\n    /* n:\"BrtHLink\", */\n    f: parse_BrtHLink\n  },\n\n  /*::[*/\n  0x01EF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDCon\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F0\n  /*::]*/\n  : {\n    /* n:\"BrtEndDCon\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDRefs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F2\n  /*::]*/\n  : {\n    /* n:\"BrtEndDRefs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F3\n  /*::]*/\n  : {\n    /* n:\"BrtDRef\" */\n  },\n\n  /*::[*/\n  0x01F4\n  /*::]*/\n  : {\n    /* n:\"BrtBeginScenMan\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F5\n  /*::]*/\n  : {\n    /* n:\"BrtEndScenMan\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSct\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F7\n  /*::]*/\n  : {\n    /* n:\"BrtEndSct\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F8\n  /*::]*/\n  : {\n    /* n:\"BrtSlc\" */\n  },\n\n  /*::[*/\n  0x01F9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FA\n  /*::]*/\n  : {\n    /* n:\"BrtEndDXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01FB\n  /*::]*/\n  : {\n    /* n:\"BrtDXF\" */\n  },\n\n  /*::[*/\n  0x01FC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FD\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01FE\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FF\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0200\n  /*::]*/\n  : {\n    /* n:\"BrtTableStyleElement\" */\n  },\n\n  /*::[*/\n  0x0201\n  /*::]*/\n  : {\n    /* n:\"BrtTableStyleClient\" */\n  },\n\n  /*::[*/\n  0x0202\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolDeps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0203\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolDeps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0204\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolType\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0205\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolType\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0206\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolMain\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0207\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolMain\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0208\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolTopic\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0209\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolTopic\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x020A\n  /*::]*/\n  : {\n    /* n:\"BrtVolSubtopic\" */\n  },\n\n  /*::[*/\n  0x020B\n  /*::]*/\n  : {\n    /* n:\"BrtVolRef\" */\n  },\n\n  /*::[*/\n  0x020C\n  /*::]*/\n  : {\n    /* n:\"BrtVolNum\" */\n  },\n\n  /*::[*/\n  0x020D\n  /*::]*/\n  : {\n    /* n:\"BrtVolErr\" */\n  },\n\n  /*::[*/\n  0x020E\n  /*::]*/\n  : {\n    /* n:\"BrtVolStr\" */\n  },\n\n  /*::[*/\n  0x020F\n  /*::]*/\n  : {\n    /* n:\"BrtVolBool\" */\n  },\n\n  /*::[*/\n  0x0210\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCalcChain$\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0211\n  /*::]*/\n  : {\n    /* n:\"BrtEndCalcChain$\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0212\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortState\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0213\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortState\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0214\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortCond\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0215\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortCond\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0216\n  /*::]*/\n  : {\n    /* n:\"BrtBookProtection\" */\n  },\n\n  /*::[*/\n  0x0217\n  /*::]*/\n  : {\n    /* n:\"BrtSheetProtection\" */\n  },\n\n  /*::[*/\n  0x0218\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtection\" */\n  },\n\n  /*::[*/\n  0x0219\n  /*::]*/\n  : {\n    /* n:\"BrtPhoneticInfo\" */\n  },\n\n  /*::[*/\n  0x021A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTxtWiz\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x021B\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTxtWiz\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x021C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfoLst\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x021D\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTWFldInfoLst\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x021E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTwFldInfo\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0224\n  /*::]*/\n  : {\n    /* n:\"BrtFileSharing\" */\n  },\n\n  /*::[*/\n  0x0225\n  /*::]*/\n  : {\n    /* n:\"BrtOleSize\" */\n  },\n\n  /*::[*/\n  0x0226\n  /*::]*/\n  : {\n    /* n:\"BrtDrawing\", */\n    f: parse_RelID\n  },\n\n  /*::[*/\n  0x0227\n  /*::]*/\n  : {\n    /* n:\"BrtLegacyDrawing\" */\n  },\n\n  /*::[*/\n  0x0228\n  /*::]*/\n  : {\n    /* n:\"BrtLegacyDrawingHF\" */\n  },\n\n  /*::[*/\n  0x0229\n  /*::]*/\n  : {\n    /* n:\"BrtWebOpt\" */\n  },\n\n  /*::[*/\n  0x022A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebPubItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022B\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebPubItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x022C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebPubItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022D\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebPubItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x022E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0230\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0231\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0232\n  /*::]*/\n  : {\n    /* n:\"BrtBkHim\" */\n  },\n\n  /*::[*/\n  0x0234\n  /*::]*/\n  : {\n    /* n:\"BrtColor\" */\n  },\n\n  /*::[*/\n  0x0235\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIndexedColors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0236\n  /*::]*/\n  : {\n    /* n:\"BrtEndIndexedColors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0239\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMRUColors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x023A\n  /*::]*/\n  : {\n    /* n:\"BrtEndMRUColors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x023C\n  /*::]*/\n  : {\n    /* n:\"BrtMRUColor\" */\n  },\n\n  /*::[*/\n  0x023D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDVals\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x023E\n  /*::]*/\n  : {\n    /* n:\"BrtEndDVals\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0241\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameStart\" */\n  },\n\n  /*::[*/\n  0x0242\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameValueStart\" */\n  },\n\n  /*::[*/\n  0x0243\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameValueEnd\" */\n  },\n\n  /*::[*/\n  0x0244\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameNum\" */\n  },\n\n  /*::[*/\n  0x0245\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameErr\" */\n  },\n\n  /*::[*/\n  0x0246\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameSt\" */\n  },\n\n  /*::[*/\n  0x0247\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameNil\" */\n  },\n\n  /*::[*/\n  0x0248\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameBool\" */\n  },\n\n  /*::[*/\n  0x0249\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameFmla\" */\n  },\n\n  /*::[*/\n  0x024A\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameBits\" */\n  },\n\n  /*::[*/\n  0x024B\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameEnd\" */\n  },\n\n  /*::[*/\n  0x024C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSupBook\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x024D\n  /*::]*/\n  : {\n    /* n:\"BrtCellSmartTagProperty\" */\n  },\n\n  /*::[*/\n  0x024E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellSmartTag\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x024F\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellSmartTag\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0250\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellSmartTags\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0251\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellSmartTags\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0252\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSmartTags\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0253\n  /*::]*/\n  : {\n    /* n:\"BrtEndSmartTags\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0254\n  /*::]*/\n  : {\n    /* n:\"BrtSmartTagType\" */\n  },\n\n  /*::[*/\n  0x0255\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSmartTagTypes\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0256\n  /*::]*/\n  : {\n    /* n:\"BrtEndSmartTagTypes\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0257\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0258\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0259\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFILTER\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFills\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025C\n  /*::]*/\n  : {\n    /* n:\"BrtEndFills\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellWatches\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025E\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellWatches\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025F\n  /*::]*/\n  : {\n    /* n:\"BrtCellWatch\" */\n  },\n\n  /*::[*/\n  0x0260\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCRErrs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0261\n  /*::]*/\n  : {\n    /* n:\"BrtEndCRErrs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0262\n  /*::]*/\n  : {\n    /* n:\"BrtCrashRecErr\" */\n  },\n\n  /*::[*/\n  0x0263\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFonts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0264\n  /*::]*/\n  : {\n    /* n:\"BrtEndFonts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0265\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBorders\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0266\n  /*::]*/\n  : {\n    /* n:\"BrtEndBorders\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0267\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFmts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0268\n  /*::]*/\n  : {\n    /* n:\"BrtEndFmts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0269\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x026A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x026B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x026C\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0271\n  /*::]*/\n  : {\n    /* n:\"BrtBigName\" */\n  },\n\n  /*::[*/\n  0x0272\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellStyleXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0273\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellStyleXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0274\n  /*::]*/\n  : {\n    /* n:\"BrtBeginComments\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0275\n  /*::]*/\n  : {\n    /* n:\"BrtEndComments\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0276\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCommentAuthors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0277\n  /*::]*/\n  : {\n    /* n:\"BrtEndCommentAuthors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0278\n  /*::]*/\n  : {\n    /* n:\"BrtCommentAuthor\", */\n    f: parse_BrtCommentAuthor\n  },\n\n  /*::[*/\n  0x0279\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCommentList\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x027A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCommentList\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x027B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginComment\", */\n    T: 1,\n    f: parse_BrtBeginComment\n  },\n\n  /*::[*/\n  0x027C\n  /*::]*/\n  : {\n    /* n:\"BrtEndComment\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x027D\n  /*::]*/\n  : {\n    /* n:\"BrtCommentText\", */\n    f: parse_BrtCommentText\n  },\n\n  /*::[*/\n  0x027E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginOleObjects\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x027F\n  /*::]*/\n  : {\n    /* n:\"BrtOleObject\" */\n  },\n\n  /*::[*/\n  0x0280\n  /*::]*/\n  : {\n    /* n:\"BrtEndOleObjects\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0281\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxrules\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0282\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxRules\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0283\n  /*::]*/\n  : {\n    /* n:\"BrtBeginActiveXControls\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0284\n  /*::]*/\n  : {\n    /* n:\"BrtActiveX\" */\n  },\n\n  /*::[*/\n  0x0285\n  /*::]*/\n  : {\n    /* n:\"BrtEndActiveXControls\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0286\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0288\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellIgnoreECs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0289\n  /*::]*/\n  : {\n    /* n:\"BrtCellIgnoreEC\" */\n  },\n\n  /*::[*/\n  0x028A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellIgnoreECs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x028B\n  /*::]*/\n  : {\n    /* n:\"BrtCsProp\", */\n    f: parse_BrtCsProp\n  },\n\n  /*::[*/\n  0x028C\n  /*::]*/\n  : {\n    /* n:\"BrtCsPageSetup\" */\n  },\n\n  /*::[*/\n  0x028D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserCsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x028E\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserCsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x028F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserCsView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0290\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserCsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0291\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPcdSFCIEntries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0292\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSFCIEntries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0293\n  /*::]*/\n  : {\n    /* n:\"BrtPCDSFCIEntry\" */\n  },\n\n  /*::[*/\n  0x0294\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListParts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0295\n  /*::]*/\n  : {\n    /* n:\"BrtListPart\" */\n  },\n\n  /*::[*/\n  0x0296\n  /*::]*/\n  : {\n    /* n:\"BrtEndListParts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0297\n  /*::]*/\n  : {\n    /* n:\"BrtSheetCalcProp\" */\n  },\n\n  /*::[*/\n  0x0298\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFnGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0299\n  /*::]*/\n  : {\n    /* n:\"BrtFnGroup\" */\n  },\n\n  /*::[*/\n  0x029A\n  /*::]*/\n  : {\n    /* n:\"BrtEndFnGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x029B\n  /*::]*/\n  : {\n    /* n:\"BrtSupAddin\" */\n  },\n\n  /*::[*/\n  0x029C\n  /*::]*/\n  : {\n    /* n:\"BrtSXTDMPOrder\" */\n  },\n\n  /*::[*/\n  0x029D\n  /*::]*/\n  : {\n    /* n:\"BrtCsProtection\" */\n  },\n\n  /*::[*/\n  0x029F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsSortMap\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x02A0\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsSortMap\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x02A1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRRSort\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x02A2\n  /*::]*/\n  : {\n    /* n:\"BrtEndRRSort\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x02A3\n  /*::]*/\n  : {\n    /* n:\"BrtRRSortItem\" */\n  },\n\n  /*::[*/\n  0x02A4\n  /*::]*/\n  : {\n    /* n:\"BrtFileSharingIso\" */\n  },\n\n  /*::[*/\n  0x02A5\n  /*::]*/\n  : {\n    /* n:\"BrtBookProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A6\n  /*::]*/\n  : {\n    /* n:\"BrtSheetProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A7\n  /*::]*/\n  : {\n    /* n:\"BrtCsProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A8\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A9\n  /*::]*/\n  : {\n    /* n:\"BrtDValList\" */\n  },\n\n  /*::[*/\n  0x0400\n  /*::]*/\n  : {\n    /* n:\"BrtRwDescent\" */\n  },\n\n  /*::[*/\n  0x0401\n  /*::]*/\n  : {\n    /* n:\"BrtKnownFonts\" */\n  },\n\n  /*::[*/\n  0x0402\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0403\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0404\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetHeader\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0405\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetHeader\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0406\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleSetHeaderItem\" */\n  },\n\n  /*::[*/\n  0x0407\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0408\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0409\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetRow\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x040A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetRow\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x040B\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleSetRowItem\" */\n  },\n\n  /*::[*/\n  0x040C\n  /*::]*/\n  : {\n    /* n:\"BrtNameExt\" */\n  },\n\n  /*::[*/\n  0x040D\n  /*::]*/\n  : {\n    /* n:\"BrtPCDH14\" */\n  },\n\n  /*::[*/\n  0x040E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMem14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x040F\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMem14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0410\n  /*::]*/\n  : {\n    /* n:\"BrtSXTH14\" */\n  },\n\n  /*::[*/\n  0x0411\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklineGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0412\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklineGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0413\n  /*::]*/\n  : {\n    /* n:\"BrtSparkline\" */\n  },\n\n  /*::[*/\n  0x0414\n  /*::]*/\n  : {\n    /* n:\"BrtSXDI14\" */\n  },\n\n  /*::[*/\n  0x0415\n  /*::]*/\n  : {\n    /* n:\"BrtWsFmtInfoEx14\" */\n  },\n\n  /*::[*/\n  0x0416\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormatting14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0417\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormatting14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0418\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCFRule14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0419\n  /*::]*/\n  : {\n    /* n:\"BrtEndCFRule14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x041A\n  /*::]*/\n  : {\n    /* n:\"BrtCFVO14\" */\n  },\n\n  /*::[*/\n  0x041B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDatabar14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIconSet14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041D\n  /*::]*/\n  : {\n    /* n:\"BrtDVal14\", */\n    f: parse_BrtDVal14\n  },\n\n  /*::[*/\n  0x041E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDVals14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041F\n  /*::]*/\n  : {\n    /* n:\"BrtColor14\" */\n  },\n\n  /*::[*/\n  0x0420\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklines\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0421\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklines\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0422\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklineGroups\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0423\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklineGroups\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0425\n  /*::]*/\n  : {\n    /* n:\"BrtSXVD14\" */\n  },\n\n  /*::[*/\n  0x0426\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0427\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0428\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView16\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0429\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView16\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCD14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042B\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCD14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConn14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042D\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConn14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0430\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0431\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0433\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0434\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0435\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheDef\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0436\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheDef\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0437\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicersEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0438\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicersEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0439\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x043B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicer\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicer\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x043D\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCachePivotTables\" */\n  },\n\n  /*::[*/\n  0x043E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheOlapImpl\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheOlapImpl\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0440\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheLevelsData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0441\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheLevelsData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0442\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheLevelData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0443\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheLevelData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0444\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSiRanges\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0445\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSiRanges\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0446\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSiRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0447\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSiRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0448\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheOlapItem\" */\n  },\n\n  /*::[*/\n  0x0449\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSelections\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x044A\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheSelection\" */\n  },\n\n  /*::[*/\n  0x044B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSelections\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x044C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheNative\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x044D\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheNative\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x044E\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheNativeItem\" */\n  },\n\n  /*::[*/\n  0x044F\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtection14\" */\n  },\n\n  /*::[*/\n  0x0450\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtectionIso14\" */\n  },\n\n  /*::[*/\n  0x0451\n  /*::]*/\n  : {\n    /* n:\"BrtCellIgnoreEC14\" */\n  },\n\n  /*::[*/\n  0x0457\n  /*::]*/\n  : {\n    /* n:\"BrtList14\" */\n  },\n\n  /*::[*/\n  0x0458\n  /*::]*/\n  : {\n    /* n:\"BrtCFIcon\" */\n  },\n\n  /*::[*/\n  0x0459\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x045B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x045D\n  /*::]*/\n  : {\n    /* n:\"BrtWbProp14\" */\n  },\n\n  /*::[*/\n  0x045E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXEdit\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXEdit\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0460\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXEdits\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0461\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXEdits\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0462\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXChange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0463\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXChange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0464\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXChanges\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0465\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXChanges\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0466\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleItems\" */\n  },\n\n  /*::[*/\n  0x0468\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0469\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046A\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerStyleElement\" */\n  },\n\n  /*::[*/\n  0x046B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyleSheetExt14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x046C\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyleSheetExt14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCachesPivotCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x046E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCachesPivotCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormattings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0470\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormattings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0471\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMemExt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0472\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMemExt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0473\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMemsExt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0474\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMemsExt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0475\n  /*::]*/\n  : {\n    /* n:\"BrtPCDField14\" */\n  },\n\n  /*::[*/\n  0x0476\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0477\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0478\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyleElements\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0479\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyleElements\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x047A\n  /*::]*/\n  : {\n    /* n:\"BrtCFRuleExt\" */\n  },\n\n  /*::[*/\n  0x047B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmt14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x047C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmt14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x047D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmts14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x047E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmts14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0480\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortCond14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0481\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortCond14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0482\n  /*::]*/\n  : {\n    /* n:\"BrtEndDVals14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0483\n  /*::]*/\n  : {\n    /* n:\"BrtEndIconSet14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0484\n  /*::]*/\n  : {\n    /* n:\"BrtEndDatabar14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0485\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorScale14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0486\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorScale14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0487\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxrules14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0488\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxrules14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0489\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRule14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048A\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRule14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilters14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048C\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilters14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilter14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048E\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilter14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFItem14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0490\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFItem14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0491\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellIgnoreECs14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0492\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellIgnoreECs14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0493\n  /*::]*/\n  : {\n    /* n:\"BrtDxf14\" */\n  },\n\n  /*::[*/\n  0x0494\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDxF14s\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0495\n  /*::]*/\n  : {\n    /* n:\"BrtEndDxf14s\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0499\n  /*::]*/\n  : {\n    /* n:\"BrtFilter14\" */\n  },\n\n  /*::[*/\n  0x049A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomFilters14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x049C\n  /*::]*/\n  : {\n    /* n:\"BrtCustomFilter14\" */\n  },\n\n  /*::[*/\n  0x049D\n  /*::]*/\n  : {\n    /* n:\"BrtIconFilter14\" */\n  },\n\n  /*::[*/\n  0x049E\n  /*::]*/\n  : {\n    /* n:\"BrtPivotCacheConnectionName\" */\n  },\n\n  /*::[*/\n  0x0800\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDecoupledPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0801\n  /*::]*/\n  : {\n    /* n:\"BrtEndDecoupledPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0802\n  /*::]*/\n  : {\n    /* n:\"BrtDecoupledPivotCacheID\" */\n  },\n\n  /*::[*/\n  0x0803\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotTableRefs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0804\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotTableRefs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0805\n  /*::]*/\n  : {\n    /* n:\"BrtPivotTableRef\" */\n  },\n\n  /*::[*/\n  0x0806\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheBookPivotTables\" */\n  },\n\n  /*::[*/\n  0x0807\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxvcells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0808\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxvcells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0809\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxRow\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x080A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxRow\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x080C\n  /*::]*/\n  : {\n    /* n:\"BrtPcdCalcMem15\" */\n  },\n\n  /*::[*/\n  0x0813\n  /*::]*/\n  : {\n    /* n:\"BrtQsi15\" */\n  },\n\n  /*::[*/\n  0x0814\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebExtensions\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0815\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebExtensions\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0816\n  /*::]*/\n  : {\n    /* n:\"BrtWebExtension\" */\n  },\n\n  /*::[*/\n  0x0817\n  /*::]*/\n  : {\n    /* n:\"BrtAbsPath15\" */\n  },\n\n  /*::[*/\n  0x0818\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotTableUISettings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0819\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotTableUISettings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x081B\n  /*::]*/\n  : {\n    /* n:\"BrtTableSlicerCacheIDs\" */\n  },\n\n  /*::[*/\n  0x081C\n  /*::]*/\n  : {\n    /* n:\"BrtTableSlicerCacheID\" */\n  },\n\n  /*::[*/\n  0x081D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableSlicerCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x081E\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableSlicerCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x081F\n  /*::]*/\n  : {\n    /* n:\"BrtSxFilter15\" */\n  },\n\n  /*::[*/\n  0x0820\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0821\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCachePivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0822\n  /*::]*/\n  : {\n    /* n:\"BrtTimelineCachePivotCacheID\" */\n  },\n\n  /*::[*/\n  0x0823\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0824\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0825\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0826\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0827\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelinesEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0828\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelinesEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0829\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x082A\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x082B\n  /*::]*/\n  : {\n    /* n:\"BrtWorkBookPr15\" */\n  },\n\n  /*::[*/\n  0x082C\n  /*::]*/\n  : {\n    /* n:\"BrtPCDH15\" */\n  },\n\n  /*::[*/\n  0x082D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x082E\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x082F\n  /*::]*/\n  : {\n    /* n:\"BrtTimelineStyleElement\" */\n  },\n\n  /*::[*/\n  0x0830\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStylesheetExt15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0831\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStylesheetExt15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0832\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0833\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0834\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyleElements\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0835\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyleElements\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0836\n  /*::]*/\n  : {\n    /* n:\"BrtDxf15\" */\n  },\n\n  /*::[*/\n  0x0837\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDxfs15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0838\n  /*::]*/\n  : {\n    /* n:\"BrtEndDxfs15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0839\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheHideItemsWithNoData\" */\n  },\n\n  /*::[*/\n  0x083A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginItemUniqueNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x083B\n  /*::]*/\n  : {\n    /* n:\"BrtEndItemUniqueNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x083C\n  /*::]*/\n  : {\n    /* n:\"BrtItemUniqueName\" */\n  },\n\n  /*::[*/\n  0x083D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConn15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x083E\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConn15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x083F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginOledbPr15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0840\n  /*::]*/\n  : {\n    /* n:\"BrtEndOledbPr15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0841\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDataFeedPr15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0842\n  /*::]*/\n  : {\n    /* n:\"BrtEndDataFeedPr15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0843\n  /*::]*/\n  : {\n    /* n:\"BrtTextPr15\" */\n  },\n\n  /*::[*/\n  0x0844\n  /*::]*/\n  : {\n    /* n:\"BrtRangePr15\" */\n  },\n\n  /*::[*/\n  0x0845\n  /*::]*/\n  : {\n    /* n:\"BrtDbCommand15\" */\n  },\n\n  /*::[*/\n  0x0846\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDbTables15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0847\n  /*::]*/\n  : {\n    /* n:\"BrtEndDbTables15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0848\n  /*::]*/\n  : {\n    /* n:\"BrtDbTable15\" */\n  },\n\n  /*::[*/\n  0x0849\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDataModel\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084A\n  /*::]*/\n  : {\n    /* n:\"BrtEndDataModel\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x084B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTables\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084C\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTables\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x084D\n  /*::]*/\n  : {\n    /* n:\"BrtModelTable\" */\n  },\n\n  /*::[*/\n  0x084E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelRelationships\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084F\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelRelationships\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0850\n  /*::]*/\n  : {\n    /* n:\"BrtModelRelationship\" */\n  },\n\n  /*::[*/\n  0x0851\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTxtWiz15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0852\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTxtWiz15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0853\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfoLst15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0854\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTWFldInfoLst15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0855\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfo15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0856\n  /*::]*/\n  : {\n    /* n:\"BrtFieldListActiveItem\" */\n  },\n\n  /*::[*/\n  0x0857\n  /*::]*/\n  : {\n    /* n:\"BrtPivotCacheIdVersion\" */\n  },\n\n  /*::[*/\n  0x0858\n  /*::]*/\n  : {\n    /* n:\"BrtSXDI15\" */\n  },\n\n  /*::[*/\n  0x0859\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTimeGroupings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x085A\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTimeGroupings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x085B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTimeGrouping\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x085C\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTimeGrouping\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x085D\n  /*::]*/\n  : {\n    /* n:\"BrtModelTimeGroupingCalcCol\" */\n  },\n\n  /*::[*/\n  0x0C00\n  /*::]*/\n  : {\n    /* n:\"BrtUid\" */\n  },\n\n  /*::[*/\n  0x0C01\n  /*::]*/\n  : {\n    /* n:\"BrtRevisionPtr\" */\n  },\n\n  /*::[*/\n  0x1000\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDynamicArrayPr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x1001\n  /*::]*/\n  : {\n    /* n:\"BrtEndDynamicArrayPr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x138A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichValueBlock\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x138B\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichValueBlock\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13DB\n  /*::]*/\n  : {\n    /* n:\"BrtRichFilter\" */\n  },\n\n  /*::[*/\n  0x13DC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichFilterColumn\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DD\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichFilterColumn\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13DE\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomRichFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DF\n  /*::]*/\n  : {\n    /* n:\"BrtEndCustomRichFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E0\n  /*::]*/\n  : {\n    /* n:\"BrtCustomRichFilter\" */\n  },\n\n  /*::[*/\n  0x13E1\n  /*::]*/\n  : {\n    /* n:\"BrtTop10RichFilter\" */\n  },\n\n  /*::[*/\n  0x13E2\n  /*::]*/\n  : {\n    /* n:\"BrtDynamicRichFilter\" */\n  },\n\n  /*::[*/\n  0x13E4\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichSortCondition\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13E5\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichSortCondition\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E6\n  /*::]*/\n  : {\n    /* n:\"BrtRichFilterDateGroupItem\" */\n  },\n\n  /*::[*/\n  0x13E7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCalcFeatures\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13E8\n  /*::]*/\n  : {\n    /* n:\"BrtEndCalcFeatures\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E9\n  /*::]*/\n  : {\n    /* n:\"BrtCalcFeature\" */\n  },\n\n  /*::[*/\n  0x13EB\n  /*::]*/\n  : {\n    /* n:\"BrtExternalLinksPr\" */\n  },\n\n  /*::[*/\n  0xFFFF\n  /*::]*/\n  : {\n    n: \"\"\n  }\n};\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\n\nvar XLSRecordEnum = {\n  /* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n\n  /*::[*/\n  0x0006\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x000a\n  /*::]*/\n  : {\n    /* n:\"EOF\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x000c\n  /*::]*/\n  : {\n    /* n:\"CalcCount\", */\n    f: parseuint16\n  },\n  //\n\n  /*::[*/\n  0x000d\n  /*::]*/\n  : {\n    /* n:\"CalcMode\", */\n    f: parseuint16\n  },\n  //\n\n  /*::[*/\n  0x000e\n  /*::]*/\n  : {\n    /* n:\"CalcPrecision\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x000f\n  /*::]*/\n  : {\n    /* n:\"CalcRefMode\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0010\n  /*::]*/\n  : {\n    /* n:\"CalcDelta\", */\n    f: parse_Xnum\n  },\n  //\n\n  /*::[*/\n  0x0011\n  /*::]*/\n  : {\n    /* n:\"CalcIter\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0012\n  /*::]*/\n  : {\n    /* n:\"Protect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0013\n  /*::]*/\n  : {\n    /* n:\"Password\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : {\n    /* n:\"Header\", */\n    f: parse_XLHeaderFooter\n  },\n\n  /*::[*/\n  0x0015\n  /*::]*/\n  : {\n    /* n:\"Footer\", */\n    f: parse_XLHeaderFooter\n  },\n\n  /*::[*/\n  0x0017\n  /*::]*/\n  : {\n    /* n:\"ExternSheet\", */\n    f: parse_ExternSheet\n  },\n\n  /*::[*/\n  0x0018\n  /*::]*/\n  : {\n    /* n:\"Lbl\", */\n    f: parse_Lbl\n  },\n\n  /*::[*/\n  0x0019\n  /*::]*/\n  : {\n    /* n:\"WinProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x001a\n  /*::]*/\n  : {\n    /* n:\"VerticalPageBreaks\", */\n  },\n\n  /*::[*/\n  0x001b\n  /*::]*/\n  : {\n    /* n:\"HorizontalPageBreaks\", */\n  },\n\n  /*::[*/\n  0x001c\n  /*::]*/\n  : {\n    /* n:\"Note\", */\n    f: parse_Note\n  },\n\n  /*::[*/\n  0x001d\n  /*::]*/\n  : {\n    /* n:\"Selection\", */\n  },\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : {\n    /* n:\"Date1904\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0023\n  /*::]*/\n  : {\n    /* n:\"ExternName\", */\n    f: parse_ExternName\n  },\n\n  /*::[*/\n  0x0026\n  /*::]*/\n  : {\n    /* n:\"LeftMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : {\n    /* n:\"RightMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0028\n  /*::]*/\n  : {\n    /* n:\"TopMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0029\n  /*::]*/\n  : {\n    /* n:\"BottomMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x002a\n  /*::]*/\n  : {\n    /* n:\"PrintRowCol\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x002b\n  /*::]*/\n  : {\n    /* n:\"PrintGrid\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x002f\n  /*::]*/\n  : {\n    /* n:\"FilePass\", */\n    f: parse_FilePass\n  },\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : {\n    /* n:\"Font\", */\n    f: parse_Font\n  },\n\n  /*::[*/\n  0x0033\n  /*::]*/\n  : {\n    /* n:\"PrintSize\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x003c\n  /*::]*/\n  : {\n    /* n:\"Continue\", */\n  },\n\n  /*::[*/\n  0x003d\n  /*::]*/\n  : {\n    /* n:\"Window1\", */\n    f: parse_Window1\n  },\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : {\n    /* n:\"Backup\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0041\n  /*::]*/\n  : {\n    /* n:\"Pane\", */\n    f: parse_Pane\n  },\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : {\n    /* n:\"CodePage\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x004d\n  /*::]*/\n  : {\n    /* n:\"Pls\", */\n  },\n\n  /*::[*/\n  0x0050\n  /*::]*/\n  : {\n    /* n:\"DCon\", */\n  },\n\n  /*::[*/\n  0x0051\n  /*::]*/\n  : {\n    /* n:\"DConRef\", */\n  },\n\n  /*::[*/\n  0x0052\n  /*::]*/\n  : {\n    /* n:\"DConName\", */\n  },\n\n  /*::[*/\n  0x0055\n  /*::]*/\n  : {\n    /* n:\"DefColWidth\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0059\n  /*::]*/\n  : {\n    /* n:\"XCT\", */\n  },\n\n  /*::[*/\n  0x005a\n  /*::]*/\n  : {\n    /* n:\"CRN\", */\n  },\n\n  /*::[*/\n  0x005b\n  /*::]*/\n  : {\n    /* n:\"FileSharing\", */\n  },\n\n  /*::[*/\n  0x005c\n  /*::]*/\n  : {\n    /* n:\"WriteAccess\", */\n    f: parse_WriteAccess\n  },\n\n  /*::[*/\n  0x005d\n  /*::]*/\n  : {\n    /* n:\"Obj\", */\n    f: parse_Obj\n  },\n\n  /*::[*/\n  0x005e\n  /*::]*/\n  : {\n    /* n:\"Uncalced\", */\n  },\n\n  /*::[*/\n  0x005f\n  /*::]*/\n  : {\n    /* n:\"CalcSaveRecalc\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0060\n  /*::]*/\n  : {\n    /* n:\"Template\", */\n  },\n\n  /*::[*/\n  0x0061\n  /*::]*/\n  : {\n    /* n:\"Intl\", */\n  },\n\n  /*::[*/\n  0x0063\n  /*::]*/\n  : {\n    /* n:\"ObjProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x007d\n  /*::]*/\n  : {\n    /* n:\"ColInfo\", */\n    f: parse_ColInfo\n  },\n\n  /*::[*/\n  0x0080\n  /*::]*/\n  : {\n    /* n:\"Guts\", */\n    f: parse_Guts\n  },\n\n  /*::[*/\n  0x0081\n  /*::]*/\n  : {\n    /* n:\"WsBool\", */\n    f: parse_WsBool\n  },\n\n  /*::[*/\n  0x0082\n  /*::]*/\n  : {\n    /* n:\"GridSet\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0083\n  /*::]*/\n  : {\n    /* n:\"HCenter\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0084\n  /*::]*/\n  : {\n    /* n:\"VCenter\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0085\n  /*::]*/\n  : {\n    /* n:\"BoundSheet8\", */\n    f: parse_BoundSheet8\n  },\n\n  /*::[*/\n  0x0086\n  /*::]*/\n  : {\n    /* n:\"WriteProtect\", */\n  },\n\n  /*::[*/\n  0x008c\n  /*::]*/\n  : {\n    /* n:\"Country\", */\n    f: parse_Country\n  },\n\n  /*::[*/\n  0x008d\n  /*::]*/\n  : {\n    /* n:\"HideObj\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0090\n  /*::]*/\n  : {\n    /* n:\"Sort\", */\n  },\n\n  /*::[*/\n  0x0092\n  /*::]*/\n  : {\n    /* n:\"Palette\", */\n    f: parse_Palette\n  },\n\n  /*::[*/\n  0x0097\n  /*::]*/\n  : {\n    /* n:\"Sync\", */\n  },\n\n  /*::[*/\n  0x0098\n  /*::]*/\n  : {\n    /* n:\"LPr\", */\n  },\n\n  /*::[*/\n  0x0099\n  /*::]*/\n  : {\n    /* n:\"DxGCol\", */\n  },\n\n  /*::[*/\n  0x009a\n  /*::]*/\n  : {\n    /* n:\"FnGroupName\", */\n  },\n\n  /*::[*/\n  0x009b\n  /*::]*/\n  : {\n    /* n:\"FilterMode\", */\n  },\n\n  /*::[*/\n  0x009c\n  /*::]*/\n  : {\n    /* n:\"BuiltInFnGroupCount\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x009d\n  /*::]*/\n  : {\n    /* n:\"AutoFilterInfo\", */\n  },\n\n  /*::[*/\n  0x009e\n  /*::]*/\n  : {\n    /* n:\"AutoFilter\", */\n  },\n\n  /*::[*/\n  0x00a0\n  /*::]*/\n  : {\n    /* n:\"Scl\", */\n    f: parse_Scl\n  },\n\n  /*::[*/\n  0x00a1\n  /*::]*/\n  : {\n    /* n:\"Setup\", */\n    f: parse_Setup\n  },\n\n  /*::[*/\n  0x00ae\n  /*::]*/\n  : {\n    /* n:\"ScenMan\", */\n  },\n\n  /*::[*/\n  0x00af\n  /*::]*/\n  : {\n    /* n:\"SCENARIO\", */\n  },\n\n  /*::[*/\n  0x00b0\n  /*::]*/\n  : {\n    /* n:\"SxView\", */\n  },\n\n  /*::[*/\n  0x00b1\n  /*::]*/\n  : {\n    /* n:\"Sxvd\", */\n  },\n\n  /*::[*/\n  0x00b2\n  /*::]*/\n  : {\n    /* n:\"SXVI\", */\n  },\n\n  /*::[*/\n  0x00b4\n  /*::]*/\n  : {\n    /* n:\"SxIvd\", */\n  },\n\n  /*::[*/\n  0x00b5\n  /*::]*/\n  : {\n    /* n:\"SXLI\", */\n  },\n\n  /*::[*/\n  0x00b6\n  /*::]*/\n  : {\n    /* n:\"SXPI\", */\n  },\n\n  /*::[*/\n  0x00b8\n  /*::]*/\n  : {\n    /* n:\"DocRoute\", */\n  },\n\n  /*::[*/\n  0x00b9\n  /*::]*/\n  : {\n    /* n:\"RecipName\", */\n  },\n\n  /*::[*/\n  0x00bd\n  /*::]*/\n  : {\n    /* n:\"MulRk\", */\n    f: parse_MulRk\n  },\n\n  /*::[*/\n  0x00be\n  /*::]*/\n  : {\n    /* n:\"MulBlank\", */\n    f: parse_MulBlank\n  },\n\n  /*::[*/\n  0x00c1\n  /*::]*/\n  : {\n    /* n:\"Mms\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x00c5\n  /*::]*/\n  : {\n    /* n:\"SXDI\", */\n  },\n\n  /*::[*/\n  0x00c6\n  /*::]*/\n  : {\n    /* n:\"SXDB\", */\n  },\n\n  /*::[*/\n  0x00c7\n  /*::]*/\n  : {\n    /* n:\"SXFDB\", */\n  },\n\n  /*::[*/\n  0x00c8\n  /*::]*/\n  : {\n    /* n:\"SXDBB\", */\n  },\n\n  /*::[*/\n  0x00c9\n  /*::]*/\n  : {\n    /* n:\"SXNum\", */\n  },\n\n  /*::[*/\n  0x00ca\n  /*::]*/\n  : {\n    /* n:\"SxBool\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x00cb\n  /*::]*/\n  : {\n    /* n:\"SxErr\", */\n  },\n\n  /*::[*/\n  0x00cc\n  /*::]*/\n  : {\n    /* n:\"SXInt\", */\n  },\n\n  /*::[*/\n  0x00cd\n  /*::]*/\n  : {\n    /* n:\"SXString\", */\n  },\n\n  /*::[*/\n  0x00ce\n  /*::]*/\n  : {\n    /* n:\"SXDtr\", */\n  },\n\n  /*::[*/\n  0x00cf\n  /*::]*/\n  : {\n    /* n:\"SxNil\", */\n  },\n\n  /*::[*/\n  0x00d0\n  /*::]*/\n  : {\n    /* n:\"SXTbl\", */\n  },\n\n  /*::[*/\n  0x00d1\n  /*::]*/\n  : {\n    /* n:\"SXTBRGIITM\", */\n  },\n\n  /*::[*/\n  0x00d2\n  /*::]*/\n  : {\n    /* n:\"SxTbpg\", */\n  },\n\n  /*::[*/\n  0x00d3\n  /*::]*/\n  : {\n    /* n:\"ObProj\", */\n  },\n\n  /*::[*/\n  0x00d5\n  /*::]*/\n  : {\n    /* n:\"SXStreamID\", */\n  },\n\n  /*::[*/\n  0x00d7\n  /*::]*/\n  : {\n    /* n:\"DBCell\", */\n  },\n\n  /*::[*/\n  0x00d8\n  /*::]*/\n  : {\n    /* n:\"SXRng\", */\n  },\n\n  /*::[*/\n  0x00d9\n  /*::]*/\n  : {\n    /* n:\"SxIsxoper\", */\n  },\n\n  /*::[*/\n  0x00da\n  /*::]*/\n  : {\n    /* n:\"BookBool\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x00dc\n  /*::]*/\n  : {\n    /* n:\"DbOrParamQry\", */\n  },\n\n  /*::[*/\n  0x00dd\n  /*::]*/\n  : {\n    /* n:\"ScenarioProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x00de\n  /*::]*/\n  : {\n    /* n:\"OleObjectSize\", */\n  },\n\n  /*::[*/\n  0x00e0\n  /*::]*/\n  : {\n    /* n:\"XF\", */\n    f: parse_XF\n  },\n\n  /*::[*/\n  0x00e1\n  /*::]*/\n  : {\n    /* n:\"InterfaceHdr\", */\n    f: parse_InterfaceHdr\n  },\n\n  /*::[*/\n  0x00e2\n  /*::]*/\n  : {\n    /* n:\"InterfaceEnd\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x00e3\n  /*::]*/\n  : {\n    /* n:\"SXVS\", */\n  },\n\n  /*::[*/\n  0x00e5\n  /*::]*/\n  : {\n    /* n:\"MergeCells\", */\n    f: parse_MergeCells\n  },\n\n  /*::[*/\n  0x00e9\n  /*::]*/\n  : {\n    /* n:\"BkHim\", */\n  },\n\n  /*::[*/\n  0x00eb\n  /*::]*/\n  : {\n    /* n:\"MsoDrawingGroup\", */\n  },\n\n  /*::[*/\n  0x00ec\n  /*::]*/\n  : {\n    /* n:\"MsoDrawing\", */\n  },\n\n  /*::[*/\n  0x00ed\n  /*::]*/\n  : {\n    /* n:\"MsoDrawingSelection\", */\n  },\n\n  /*::[*/\n  0x00ef\n  /*::]*/\n  : {\n    /* n:\"PhoneticInfo\", */\n  },\n\n  /*::[*/\n  0x00f0\n  /*::]*/\n  : {\n    /* n:\"SxRule\", */\n  },\n\n  /*::[*/\n  0x00f1\n  /*::]*/\n  : {\n    /* n:\"SXEx\", */\n  },\n\n  /*::[*/\n  0x00f2\n  /*::]*/\n  : {\n    /* n:\"SxFilt\", */\n  },\n\n  /*::[*/\n  0x00f4\n  /*::]*/\n  : {\n    /* n:\"SxDXF\", */\n  },\n\n  /*::[*/\n  0x00f5\n  /*::]*/\n  : {\n    /* n:\"SxItm\", */\n  },\n\n  /*::[*/\n  0x00f6\n  /*::]*/\n  : {\n    /* n:\"SxName\", */\n  },\n\n  /*::[*/\n  0x00f7\n  /*::]*/\n  : {\n    /* n:\"SxSelect\", */\n  },\n\n  /*::[*/\n  0x00f8\n  /*::]*/\n  : {\n    /* n:\"SXPair\", */\n  },\n\n  /*::[*/\n  0x00f9\n  /*::]*/\n  : {\n    /* n:\"SxFmla\", */\n  },\n\n  /*::[*/\n  0x00fb\n  /*::]*/\n  : {\n    /* n:\"SxFormat\", */\n  },\n\n  /*::[*/\n  0x00fc\n  /*::]*/\n  : {\n    /* n:\"SST\", */\n    f: parse_SST\n  },\n\n  /*::[*/\n  0x00fd\n  /*::]*/\n  : {\n    /* n:\"LabelSst\", */\n    f: parse_LabelSst\n  },\n\n  /*::[*/\n  0x00ff\n  /*::]*/\n  : {\n    /* n:\"ExtSST\", */\n    f: parse_ExtSST\n  },\n\n  /*::[*/\n  0x0100\n  /*::]*/\n  : {\n    /* n:\"SXVDEx\", */\n  },\n\n  /*::[*/\n  0x0103\n  /*::]*/\n  : {\n    /* n:\"SXFormula\", */\n  },\n\n  /*::[*/\n  0x0122\n  /*::]*/\n  : {\n    /* n:\"SXDBEx\", */\n  },\n\n  /*::[*/\n  0x0137\n  /*::]*/\n  : {\n    /* n:\"RRDInsDel\", */\n  },\n\n  /*::[*/\n  0x0138\n  /*::]*/\n  : {\n    /* n:\"RRDHead\", */\n  },\n\n  /*::[*/\n  0x013b\n  /*::]*/\n  : {\n    /* n:\"RRDChgCell\", */\n  },\n\n  /*::[*/\n  0x013d\n  /*::]*/\n  : {\n    /* n:\"RRTabId\", */\n    f: parseuint16a\n  },\n\n  /*::[*/\n  0x013e\n  /*::]*/\n  : {\n    /* n:\"RRDRenSheet\", */\n  },\n\n  /*::[*/\n  0x013f\n  /*::]*/\n  : {\n    /* n:\"RRSort\", */\n  },\n\n  /*::[*/\n  0x0140\n  /*::]*/\n  : {\n    /* n:\"RRDMove\", */\n  },\n\n  /*::[*/\n  0x014a\n  /*::]*/\n  : {\n    /* n:\"RRFormat\", */\n  },\n\n  /*::[*/\n  0x014b\n  /*::]*/\n  : {\n    /* n:\"RRAutoFmt\", */\n  },\n\n  /*::[*/\n  0x014d\n  /*::]*/\n  : {\n    /* n:\"RRInsertSh\", */\n  },\n\n  /*::[*/\n  0x014e\n  /*::]*/\n  : {\n    /* n:\"RRDMoveBegin\", */\n  },\n\n  /*::[*/\n  0x014f\n  /*::]*/\n  : {\n    /* n:\"RRDMoveEnd\", */\n  },\n\n  /*::[*/\n  0x0150\n  /*::]*/\n  : {\n    /* n:\"RRDInsDelBegin\", */\n  },\n\n  /*::[*/\n  0x0151\n  /*::]*/\n  : {\n    /* n:\"RRDInsDelEnd\", */\n  },\n\n  /*::[*/\n  0x0152\n  /*::]*/\n  : {\n    /* n:\"RRDConflict\", */\n  },\n\n  /*::[*/\n  0x0153\n  /*::]*/\n  : {\n    /* n:\"RRDDefName\", */\n  },\n\n  /*::[*/\n  0x0154\n  /*::]*/\n  : {\n    /* n:\"RRDRstEtxp\", */\n  },\n\n  /*::[*/\n  0x015f\n  /*::]*/\n  : {\n    /* n:\"LRng\", */\n  },\n\n  /*::[*/\n  0x0160\n  /*::]*/\n  : {\n    /* n:\"UsesELFs\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0161\n  /*::]*/\n  : {\n    /* n:\"DSF\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0191\n  /*::]*/\n  : {\n    /* n:\"CUsr\", */\n  },\n\n  /*::[*/\n  0x0192\n  /*::]*/\n  : {\n    /* n:\"CbUsr\", */\n  },\n\n  /*::[*/\n  0x0193\n  /*::]*/\n  : {\n    /* n:\"UsrInfo\", */\n  },\n\n  /*::[*/\n  0x0194\n  /*::]*/\n  : {\n    /* n:\"UsrExcl\", */\n  },\n\n  /*::[*/\n  0x0195\n  /*::]*/\n  : {\n    /* n:\"FileLock\", */\n  },\n\n  /*::[*/\n  0x0196\n  /*::]*/\n  : {\n    /* n:\"RRDInfo\", */\n  },\n\n  /*::[*/\n  0x0197\n  /*::]*/\n  : {\n    /* n:\"BCUsrs\", */\n  },\n\n  /*::[*/\n  0x0198\n  /*::]*/\n  : {\n    /* n:\"UsrChk\", */\n  },\n\n  /*::[*/\n  0x01a9\n  /*::]*/\n  : {\n    /* n:\"UserBView\", */\n  },\n\n  /*::[*/\n  0x01aa\n  /*::]*/\n  : {\n    /* n:\"UserSViewBegin\", */\n  },\n\n  /*::[*/\n  0x01ab\n  /*::]*/\n  : {\n    /* n:\"UserSViewEnd\", */\n  },\n\n  /*::[*/\n  0x01ac\n  /*::]*/\n  : {\n    /* n:\"RRDUserView\", */\n  },\n\n  /*::[*/\n  0x01ad\n  /*::]*/\n  : {\n    /* n:\"Qsi\", */\n  },\n\n  /*::[*/\n  0x01ae\n  /*::]*/\n  : {\n    /* n:\"SupBook\", */\n    f: parse_SupBook\n  },\n\n  /*::[*/\n  0x01af\n  /*::]*/\n  : {\n    /* n:\"Prot4Rev\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x01b0\n  /*::]*/\n  : {\n    /* n:\"CondFmt\", */\n  },\n\n  /*::[*/\n  0x01b1\n  /*::]*/\n  : {\n    /* n:\"CF\", */\n  },\n\n  /*::[*/\n  0x01b2\n  /*::]*/\n  : {\n    /* n:\"DVal\", */\n  },\n\n  /*::[*/\n  0x01b5\n  /*::]*/\n  : {\n    /* n:\"DConBin\", */\n  },\n\n  /*::[*/\n  0x01b6\n  /*::]*/\n  : {\n    /* n:\"TxO\", */\n    f: parse_TxO\n  },\n\n  /*::[*/\n  0x01b7\n  /*::]*/\n  : {\n    /* n:\"RefreshAll\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x01b8\n  /*::]*/\n  : {\n    /* n:\"HLink\", */\n    f: parse_HLink\n  },\n\n  /*::[*/\n  0x01b9\n  /*::]*/\n  : {\n    /* n:\"Lel\", */\n  },\n\n  /*::[*/\n  0x01ba\n  /*::]*/\n  : {\n    /* n:\"CodeName\", */\n    f: parse_XLUnicodeString\n  },\n\n  /*::[*/\n  0x01bb\n  /*::]*/\n  : {\n    /* n:\"SXFDBType\", */\n  },\n\n  /*::[*/\n  0x01bc\n  /*::]*/\n  : {\n    /* n:\"Prot4RevPass\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x01bd\n  /*::]*/\n  : {\n    /* n:\"ObNoMacros\", */\n  },\n\n  /*::[*/\n  0x01be\n  /*::]*/\n  : {\n    /* n:\"Dv\", */\n  },\n\n  /*::[*/\n  0x01c0\n  /*::]*/\n  : {\n    /* n:\"Excel9File\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x01c1\n  /*::]*/\n  : {\n    /* n:\"RecalcId\", */\n    f: parse_RecalcId,\n    r: 2\n  },\n\n  /*::[*/\n  0x01c2\n  /*::]*/\n  : {\n    /* n:\"EntExU2\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0200\n  /*::]*/\n  : {\n    /* n:\"Dimensions\", */\n    f: parse_Dimensions\n  },\n\n  /*::[*/\n  0x0201\n  /*::]*/\n  : {\n    /* n:\"Blank\", */\n    f: parse_Blank\n  },\n\n  /*::[*/\n  0x0203\n  /*::]*/\n  : {\n    /* n:\"Number\", */\n    f: parse_Number\n  },\n\n  /*::[*/\n  0x0204\n  /*::]*/\n  : {\n    /* n:\"Label\", */\n    f: parse_Label\n  },\n\n  /*::[*/\n  0x0205\n  /*::]*/\n  : {\n    /* n:\"BoolErr\", */\n    f: parse_BoolErr\n  },\n\n  /*::[*/\n  0x0207\n  /*::]*/\n  : {\n    /* n:\"String\", */\n    f: parse_String\n  },\n\n  /*::[*/\n  0x0208\n  /*::]*/\n  : {\n    /* n:\"Row\", */\n    f: parse_Row\n  },\n\n  /*::[*/\n  0x020b\n  /*::]*/\n  : {\n    /* n:\"Index\", */\n  },\n\n  /*::[*/\n  0x0221\n  /*::]*/\n  : {\n    /* n:\"Array\", */\n    f: parse_Array\n  },\n\n  /*::[*/\n  0x0225\n  /*::]*/\n  : {\n    /* n:\"DefaultRowHeight\", */\n    f: parse_DefaultRowHeight\n  },\n\n  /*::[*/\n  0x0236\n  /*::]*/\n  : {\n    /* n:\"Table\", */\n  },\n\n  /*::[*/\n  0x023e\n  /*::]*/\n  : {\n    /* n:\"Window2\", */\n    f: parse_Window2\n  },\n\n  /*::[*/\n  0x027e\n  /*::]*/\n  : {\n    /* n:\"RK\", */\n    f: parse_RK\n  },\n\n  /*::[*/\n  0x0293\n  /*::]*/\n  : {\n    /* n:\"Style\", */\n  },\n\n  /*::[*/\n  0x0418\n  /*::]*/\n  : {\n    /* n:\"BigName\", */\n  },\n\n  /*::[*/\n  0x041e\n  /*::]*/\n  : {\n    /* n:\"Format\", */\n    f: parse_Format\n  },\n\n  /*::[*/\n  0x043c\n  /*::]*/\n  : {\n    /* n:\"ContinueBigName\", */\n  },\n\n  /*::[*/\n  0x04bc\n  /*::]*/\n  : {\n    /* n:\"ShrFmla\", */\n    f: parse_ShrFmla\n  },\n\n  /*::[*/\n  0x0800\n  /*::]*/\n  : {\n    /* n:\"HLinkTooltip\", */\n    f: parse_HLinkTooltip\n  },\n\n  /*::[*/\n  0x0801\n  /*::]*/\n  : {\n    /* n:\"WebPub\", */\n  },\n\n  /*::[*/\n  0x0802\n  /*::]*/\n  : {\n    /* n:\"QsiSXTag\", */\n  },\n\n  /*::[*/\n  0x0803\n  /*::]*/\n  : {\n    /* n:\"DBQueryExt\", */\n  },\n\n  /*::[*/\n  0x0804\n  /*::]*/\n  : {\n    /* n:\"ExtString\", */\n  },\n\n  /*::[*/\n  0x0805\n  /*::]*/\n  : {\n    /* n:\"TxtQry\", */\n  },\n\n  /*::[*/\n  0x0806\n  /*::]*/\n  : {\n    /* n:\"Qsir\", */\n  },\n\n  /*::[*/\n  0x0807\n  /*::]*/\n  : {\n    /* n:\"Qsif\", */\n  },\n\n  /*::[*/\n  0x0808\n  /*::]*/\n  : {\n    /* n:\"RRDTQSIF\", */\n  },\n\n  /*::[*/\n  0x0809\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x080a\n  /*::]*/\n  : {\n    /* n:\"OleDbConn\", */\n  },\n\n  /*::[*/\n  0x080b\n  /*::]*/\n  : {\n    /* n:\"WOpt\", */\n  },\n\n  /*::[*/\n  0x080c\n  /*::]*/\n  : {\n    /* n:\"SXViewEx\", */\n  },\n\n  /*::[*/\n  0x080d\n  /*::]*/\n  : {\n    /* n:\"SXTH\", */\n  },\n\n  /*::[*/\n  0x080e\n  /*::]*/\n  : {\n    /* n:\"SXPIEx\", */\n  },\n\n  /*::[*/\n  0x080f\n  /*::]*/\n  : {\n    /* n:\"SXVDTEx\", */\n  },\n\n  /*::[*/\n  0x0810\n  /*::]*/\n  : {\n    /* n:\"SXViewEx9\", */\n  },\n\n  /*::[*/\n  0x0812\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt\", */\n  },\n\n  /*::[*/\n  0x0813\n  /*::]*/\n  : {\n    /* n:\"RealTimeData\", */\n  },\n\n  /*::[*/\n  0x0850\n  /*::]*/\n  : {\n    /* n:\"ChartFrtInfo\", */\n  },\n\n  /*::[*/\n  0x0851\n  /*::]*/\n  : {\n    /* n:\"FrtWrapper\", */\n  },\n\n  /*::[*/\n  0x0852\n  /*::]*/\n  : {\n    /* n:\"StartBlock\", */\n  },\n\n  /*::[*/\n  0x0853\n  /*::]*/\n  : {\n    /* n:\"EndBlock\", */\n  },\n\n  /*::[*/\n  0x0854\n  /*::]*/\n  : {\n    /* n:\"StartObject\", */\n  },\n\n  /*::[*/\n  0x0855\n  /*::]*/\n  : {\n    /* n:\"EndObject\", */\n  },\n\n  /*::[*/\n  0x0856\n  /*::]*/\n  : {\n    /* n:\"CatLab\", */\n  },\n\n  /*::[*/\n  0x0857\n  /*::]*/\n  : {\n    /* n:\"YMult\", */\n  },\n\n  /*::[*/\n  0x0858\n  /*::]*/\n  : {\n    /* n:\"SXViewLink\", */\n  },\n\n  /*::[*/\n  0x0859\n  /*::]*/\n  : {\n    /* n:\"PivotChartBits\", */\n  },\n\n  /*::[*/\n  0x085a\n  /*::]*/\n  : {\n    /* n:\"FrtFontList\", */\n  },\n\n  /*::[*/\n  0x0862\n  /*::]*/\n  : {\n    /* n:\"SheetExt\", */\n  },\n\n  /*::[*/\n  0x0863\n  /*::]*/\n  : {\n    /* n:\"BookExt\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x0864\n  /*::]*/\n  : {\n    /* n:\"SXAddl\", */\n  },\n\n  /*::[*/\n  0x0865\n  /*::]*/\n  : {\n    /* n:\"CrErr\", */\n  },\n\n  /*::[*/\n  0x0866\n  /*::]*/\n  : {\n    /* n:\"HFPicture\", */\n  },\n\n  /*::[*/\n  0x0867\n  /*::]*/\n  : {\n    /* n:\"FeatHdr\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0868\n  /*::]*/\n  : {\n    /* n:\"Feat\", */\n  },\n\n  /*::[*/\n  0x086a\n  /*::]*/\n  : {\n    /* n:\"DataLabExt\", */\n  },\n\n  /*::[*/\n  0x086b\n  /*::]*/\n  : {\n    /* n:\"DataLabExtContents\", */\n  },\n\n  /*::[*/\n  0x086c\n  /*::]*/\n  : {\n    /* n:\"CellWatch\", */\n  },\n\n  /*::[*/\n  0x0871\n  /*::]*/\n  : {\n    /* n:\"FeatHdr11\", */\n  },\n\n  /*::[*/\n  0x0872\n  /*::]*/\n  : {\n    /* n:\"Feature11\", */\n  },\n\n  /*::[*/\n  0x0874\n  /*::]*/\n  : {\n    /* n:\"DropDownObjIds\", */\n  },\n\n  /*::[*/\n  0x0875\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt11\", */\n  },\n\n  /*::[*/\n  0x0876\n  /*::]*/\n  : {\n    /* n:\"DConn\", */\n  },\n\n  /*::[*/\n  0x0877\n  /*::]*/\n  : {\n    /* n:\"List12\", */\n  },\n\n  /*::[*/\n  0x0878\n  /*::]*/\n  : {\n    /* n:\"Feature12\", */\n  },\n\n  /*::[*/\n  0x0879\n  /*::]*/\n  : {\n    /* n:\"CondFmt12\", */\n  },\n\n  /*::[*/\n  0x087a\n  /*::]*/\n  : {\n    /* n:\"CF12\", */\n  },\n\n  /*::[*/\n  0x087b\n  /*::]*/\n  : {\n    /* n:\"CFEx\", */\n  },\n\n  /*::[*/\n  0x087c\n  /*::]*/\n  : {\n    /* n:\"XFCRC\", */\n    f: parse_XFCRC,\n    r: 12\n  },\n\n  /*::[*/\n  0x087d\n  /*::]*/\n  : {\n    /* n:\"XFExt\", */\n    f: parse_XFExt,\n    r: 12\n  },\n\n  /*::[*/\n  0x087e\n  /*::]*/\n  : {\n    /* n:\"AutoFilter12\", */\n  },\n\n  /*::[*/\n  0x087f\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt12\", */\n  },\n\n  /*::[*/\n  0x0884\n  /*::]*/\n  : {\n    /* n:\"MDTInfo\", */\n  },\n\n  /*::[*/\n  0x0885\n  /*::]*/\n  : {\n    /* n:\"MDXStr\", */\n  },\n\n  /*::[*/\n  0x0886\n  /*::]*/\n  : {\n    /* n:\"MDXTuple\", */\n  },\n\n  /*::[*/\n  0x0887\n  /*::]*/\n  : {\n    /* n:\"MDXSet\", */\n  },\n\n  /*::[*/\n  0x0888\n  /*::]*/\n  : {\n    /* n:\"MDXProp\", */\n  },\n\n  /*::[*/\n  0x0889\n  /*::]*/\n  : {\n    /* n:\"MDXKPI\", */\n  },\n\n  /*::[*/\n  0x088a\n  /*::]*/\n  : {\n    /* n:\"MDB\", */\n  },\n\n  /*::[*/\n  0x088b\n  /*::]*/\n  : {\n    /* n:\"PLV\", */\n  },\n\n  /*::[*/\n  0x088c\n  /*::]*/\n  : {\n    /* n:\"Compat12\", */\n    f: parsebool,\n    r: 12\n  },\n\n  /*::[*/\n  0x088d\n  /*::]*/\n  : {\n    /* n:\"DXF\", */\n  },\n\n  /*::[*/\n  0x088e\n  /*::]*/\n  : {\n    /* n:\"TableStyles\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x088f\n  /*::]*/\n  : {\n    /* n:\"TableStyle\", */\n  },\n\n  /*::[*/\n  0x0890\n  /*::]*/\n  : {\n    /* n:\"TableStyleElement\", */\n  },\n\n  /*::[*/\n  0x0892\n  /*::]*/\n  : {\n    /* n:\"StyleExt\", */\n  },\n\n  /*::[*/\n  0x0893\n  /*::]*/\n  : {\n    /* n:\"NamePublish\", */\n  },\n\n  /*::[*/\n  0x0894\n  /*::]*/\n  : {\n    /* n:\"NameCmt\", */\n    f: parse_NameCmt,\n    r: 12\n  },\n\n  /*::[*/\n  0x0895\n  /*::]*/\n  : {\n    /* n:\"SortData\", */\n  },\n\n  /*::[*/\n  0x0896\n  /*::]*/\n  : {\n    /* n:\"Theme\", */\n    f: parse_Theme,\n    r: 12\n  },\n\n  /*::[*/\n  0x0897\n  /*::]*/\n  : {\n    /* n:\"GUIDTypeLib\", */\n  },\n\n  /*::[*/\n  0x0898\n  /*::]*/\n  : {\n    /* n:\"FnGrp12\", */\n  },\n\n  /*::[*/\n  0x0899\n  /*::]*/\n  : {\n    /* n:\"NameFnGrp12\", */\n  },\n\n  /*::[*/\n  0x089a\n  /*::]*/\n  : {\n    /* n:\"MTRSettings\", */\n    f: parse_MTRSettings,\n    r: 12\n  },\n\n  /*::[*/\n  0x089b\n  /*::]*/\n  : {\n    /* n:\"CompressPictures\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x089c\n  /*::]*/\n  : {\n    /* n:\"HeaderFooter\", */\n  },\n\n  /*::[*/\n  0x089d\n  /*::]*/\n  : {\n    /* n:\"CrtLayout12\", */\n  },\n\n  /*::[*/\n  0x089e\n  /*::]*/\n  : {\n    /* n:\"CrtMlFrt\", */\n  },\n\n  /*::[*/\n  0x089f\n  /*::]*/\n  : {\n    /* n:\"CrtMlFrtContinue\", */\n  },\n\n  /*::[*/\n  0x08a3\n  /*::]*/\n  : {\n    /* n:\"ForceFullCalculation\", */\n    f: parse_ForceFullCalculation\n  },\n\n  /*::[*/\n  0x08a4\n  /*::]*/\n  : {\n    /* n:\"ShapePropsStream\", */\n  },\n\n  /*::[*/\n  0x08a5\n  /*::]*/\n  : {\n    /* n:\"TextPropsStream\", */\n  },\n\n  /*::[*/\n  0x08a6\n  /*::]*/\n  : {\n    /* n:\"RichTextStream\", */\n  },\n\n  /*::[*/\n  0x08a7\n  /*::]*/\n  : {\n    /* n:\"CrtLayout12A\", */\n  },\n\n  /*::[*/\n  0x1001\n  /*::]*/\n  : {\n    /* n:\"Units\", */\n  },\n\n  /*::[*/\n  0x1002\n  /*::]*/\n  : {\n    /* n:\"Chart\", */\n  },\n\n  /*::[*/\n  0x1003\n  /*::]*/\n  : {\n    /* n:\"Series\", */\n  },\n\n  /*::[*/\n  0x1006\n  /*::]*/\n  : {\n    /* n:\"DataFormat\", */\n  },\n\n  /*::[*/\n  0x1007\n  /*::]*/\n  : {\n    /* n:\"LineFormat\", */\n  },\n\n  /*::[*/\n  0x1009\n  /*::]*/\n  : {\n    /* n:\"MarkerFormat\", */\n  },\n\n  /*::[*/\n  0x100a\n  /*::]*/\n  : {\n    /* n:\"AreaFormat\", */\n  },\n\n  /*::[*/\n  0x100b\n  /*::]*/\n  : {\n    /* n:\"PieFormat\", */\n  },\n\n  /*::[*/\n  0x100c\n  /*::]*/\n  : {\n    /* n:\"AttachedLabel\", */\n  },\n\n  /*::[*/\n  0x100d\n  /*::]*/\n  : {\n    /* n:\"SeriesText\", */\n  },\n\n  /*::[*/\n  0x1014\n  /*::]*/\n  : {\n    /* n:\"ChartFormat\", */\n  },\n\n  /*::[*/\n  0x1015\n  /*::]*/\n  : {\n    /* n:\"Legend\", */\n  },\n\n  /*::[*/\n  0x1016\n  /*::]*/\n  : {\n    /* n:\"SeriesList\", */\n  },\n\n  /*::[*/\n  0x1017\n  /*::]*/\n  : {\n    /* n:\"Bar\", */\n  },\n\n  /*::[*/\n  0x1018\n  /*::]*/\n  : {\n    /* n:\"Line\", */\n  },\n\n  /*::[*/\n  0x1019\n  /*::]*/\n  : {\n    /* n:\"Pie\", */\n  },\n\n  /*::[*/\n  0x101a\n  /*::]*/\n  : {\n    /* n:\"Area\", */\n  },\n\n  /*::[*/\n  0x101b\n  /*::]*/\n  : {\n    /* n:\"Scatter\", */\n  },\n\n  /*::[*/\n  0x101c\n  /*::]*/\n  : {\n    /* n:\"CrtLine\", */\n  },\n\n  /*::[*/\n  0x101d\n  /*::]*/\n  : {\n    /* n:\"Axis\", */\n  },\n\n  /*::[*/\n  0x101e\n  /*::]*/\n  : {\n    /* n:\"Tick\", */\n  },\n\n  /*::[*/\n  0x101f\n  /*::]*/\n  : {\n    /* n:\"ValueRange\", */\n  },\n\n  /*::[*/\n  0x1020\n  /*::]*/\n  : {\n    /* n:\"CatSerRange\", */\n  },\n\n  /*::[*/\n  0x1021\n  /*::]*/\n  : {\n    /* n:\"AxisLine\", */\n  },\n\n  /*::[*/\n  0x1022\n  /*::]*/\n  : {\n    /* n:\"CrtLink\", */\n  },\n\n  /*::[*/\n  0x1024\n  /*::]*/\n  : {\n    /* n:\"DefaultText\", */\n  },\n\n  /*::[*/\n  0x1025\n  /*::]*/\n  : {\n    /* n:\"Text\", */\n  },\n\n  /*::[*/\n  0x1026\n  /*::]*/\n  : {\n    /* n:\"FontX\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x1027\n  /*::]*/\n  : {\n    /* n:\"ObjectLink\", */\n  },\n\n  /*::[*/\n  0x1032\n  /*::]*/\n  : {\n    /* n:\"Frame\", */\n  },\n\n  /*::[*/\n  0x1033\n  /*::]*/\n  : {\n    /* n:\"Begin\", */\n  },\n\n  /*::[*/\n  0x1034\n  /*::]*/\n  : {\n    /* n:\"End\", */\n  },\n\n  /*::[*/\n  0x1035\n  /*::]*/\n  : {\n    /* n:\"PlotArea\", */\n  },\n\n  /*::[*/\n  0x103a\n  /*::]*/\n  : {\n    /* n:\"Chart3d\", */\n  },\n\n  /*::[*/\n  0x103c\n  /*::]*/\n  : {\n    /* n:\"PicF\", */\n  },\n\n  /*::[*/\n  0x103d\n  /*::]*/\n  : {\n    /* n:\"DropBar\", */\n  },\n\n  /*::[*/\n  0x103e\n  /*::]*/\n  : {\n    /* n:\"Radar\", */\n  },\n\n  /*::[*/\n  0x103f\n  /*::]*/\n  : {\n    /* n:\"Surf\", */\n  },\n\n  /*::[*/\n  0x1040\n  /*::]*/\n  : {\n    /* n:\"RadarArea\", */\n  },\n\n  /*::[*/\n  0x1041\n  /*::]*/\n  : {\n    /* n:\"AxisParent\", */\n  },\n\n  /*::[*/\n  0x1043\n  /*::]*/\n  : {\n    /* n:\"LegendException\", */\n  },\n\n  /*::[*/\n  0x1044\n  /*::]*/\n  : {\n    /* n:\"ShtProps\", */\n    f: parse_ShtProps\n  },\n\n  /*::[*/\n  0x1045\n  /*::]*/\n  : {\n    /* n:\"SerToCrt\", */\n  },\n\n  /*::[*/\n  0x1046\n  /*::]*/\n  : {\n    /* n:\"AxesUsed\", */\n  },\n\n  /*::[*/\n  0x1048\n  /*::]*/\n  : {\n    /* n:\"SBaseRef\", */\n  },\n\n  /*::[*/\n  0x104a\n  /*::]*/\n  : {\n    /* n:\"SerParent\", */\n  },\n\n  /*::[*/\n  0x104b\n  /*::]*/\n  : {\n    /* n:\"SerAuxTrend\", */\n  },\n\n  /*::[*/\n  0x104e\n  /*::]*/\n  : {\n    /* n:\"IFmtRecord\", */\n  },\n\n  /*::[*/\n  0x104f\n  /*::]*/\n  : {\n    /* n:\"Pos\", */\n  },\n\n  /*::[*/\n  0x1050\n  /*::]*/\n  : {\n    /* n:\"AlRuns\", */\n  },\n\n  /*::[*/\n  0x1051\n  /*::]*/\n  : {\n    /* n:\"BRAI\", */\n  },\n\n  /*::[*/\n  0x105b\n  /*::]*/\n  : {\n    /* n:\"SerAuxErrBar\", */\n  },\n\n  /*::[*/\n  0x105c\n  /*::]*/\n  : {\n    /* n:\"ClrtClient\", */\n    f: parse_ClrtClient\n  },\n\n  /*::[*/\n  0x105d\n  /*::]*/\n  : {\n    /* n:\"SerFmt\", */\n  },\n\n  /*::[*/\n  0x105f\n  /*::]*/\n  : {\n    /* n:\"Chart3DBarShape\", */\n  },\n\n  /*::[*/\n  0x1060\n  /*::]*/\n  : {\n    /* n:\"Fbi\", */\n  },\n\n  /*::[*/\n  0x1061\n  /*::]*/\n  : {\n    /* n:\"BopPop\", */\n  },\n\n  /*::[*/\n  0x1062\n  /*::]*/\n  : {\n    /* n:\"AxcExt\", */\n  },\n\n  /*::[*/\n  0x1063\n  /*::]*/\n  : {\n    /* n:\"Dat\", */\n  },\n\n  /*::[*/\n  0x1064\n  /*::]*/\n  : {\n    /* n:\"PlotGrowth\", */\n  },\n\n  /*::[*/\n  0x1065\n  /*::]*/\n  : {\n    /* n:\"SIIndex\", */\n  },\n\n  /*::[*/\n  0x1066\n  /*::]*/\n  : {\n    /* n:\"GelFrame\", */\n  },\n\n  /*::[*/\n  0x1067\n  /*::]*/\n  : {\n    /* n:\"BopPopCustom\", */\n  },\n\n  /*::[*/\n  0x1068\n  /*::]*/\n  : {\n    /* n:\"Fbi2\", */\n  },\n\n  /*::[*/\n  0x0000\n  /*::]*/\n  : {\n    /* n:\"Dimensions\", */\n    f: parse_Dimensions\n  },\n\n  /*::[*/\n  0x0001\n  /*::]*/\n  : {\n    /* n:\"BIFF2BLANK\", */\n  },\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : {\n    /* n:\"BIFF2INT\", */\n    f: parse_BIFF2INT\n  },\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : {\n    /* n:\"BIFF2NUM\", */\n    f: parse_BIFF2NUM\n  },\n\n  /*::[*/\n  0x0004\n  /*::]*/\n  : {\n    /* n:\"BIFF2STR\", */\n    f: parse_BIFF2STR\n  },\n\n  /*::[*/\n  0x0005\n  /*::]*/\n  : {\n    /* n:\"BoolErr\", */\n    f: parse_BoolErr\n  },\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : {\n    /* n:\"String\", */\n    f: parse_BIFF2STRING\n  },\n\n  /*::[*/\n  0x0008\n  /*::]*/\n  : {\n    /* n:\"BIFF2ROW\", */\n  },\n\n  /*::[*/\n  0x0009\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x000b\n  /*::]*/\n  : {\n    /* n:\"Index\", */\n  },\n\n  /*::[*/\n  0x0016\n  /*::]*/\n  : {\n    /* n:\"ExternCount\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x001e\n  /*::]*/\n  : {\n    /* n:\"BIFF2FORMAT\", */\n    f: parse_BIFF2Format\n  },\n\n  /*::[*/\n  0x001f\n  /*::]*/\n  : {\n    /* n:\"BIFF2FMTCNT\", */\n  },\n\n  /* 16-bit cnt of BIFF2FORMAT records */\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : {\n    /* n:\"BIFF2COLINFO\", */\n  },\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : {\n    /* n:\"Array\", */\n    f: parse_Array\n  },\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : {\n    /* n:\"COLWIDTH\", */\n  },\n\n  /*::[*/\n  0x0025\n  /*::]*/\n  : {\n    /* n:\"DefaultRowHeight\", */\n    f: parse_DefaultRowHeight\n  },\n  // 0x2c ??\n  // 0x2d ??\n  // 0x2e ??\n  // 0x30 FONTCOUNT: number of fonts\n\n  /*::[*/\n  0x0032\n  /*::]*/\n  : {\n    /* n:\"BIFF2FONTXTRA\", */\n    f: parse_BIFF2FONTXTRA\n  },\n  // 0x35: INFOOPTS\n  // 0x36: TABLE (BIFF2 only)\n  // 0x37: TABLE2 (BIFF2 only)\n  // 0x38: WNDESK\n  // 0x39 ??\n  // 0x3a: BEGINPREF\n  // 0x3b: ENDPREF\n\n  /*::[*/\n  0x003e\n  /*::]*/\n  : {\n    /* n:\"BIFF2WINDOW2\", */\n  },\n  // 0x3f ??\n  // 0x46: SHOWSCROLL\n  // 0x47: SHOWFORMULA\n  // 0x48: STATUSBAR\n  // 0x49: SHORTMENUS\n  // 0x4A:\n  // 0x4B:\n  // 0x4C:\n  // 0x4E:\n  // 0x4F:\n  // 0x58: TOOLBAR (BIFF3)\n\n  /* - - - */\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : {\n    /* n:\"DDEObjName\", */\n  },\n\n  /*::[*/\n  0x0043\n  /*::]*/\n  : {\n    /* n:\"BIFF2XF\", */\n  },\n\n  /*::[*/\n  0x0044\n  /*::]*/\n  : {\n    /* n:\"BIFF2XFINDEX\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0045\n  /*::]*/\n  : {\n    /* n:\"BIFF2FONTCLR\", */\n  },\n\n  /*::[*/\n  0x0056\n  /*::]*/\n  : {\n    /* n:\"BIFF4FMTCNT\", */\n  },\n\n  /* 16-bit cnt, similar to BIFF2 */\n\n  /*::[*/\n  0x007e\n  /*::]*/\n  : {\n    /* n:\"RK\", */\n  },\n\n  /* Not necessarily same as 0x027e */\n\n  /*::[*/\n  0x007f\n  /*::]*/\n  : {\n    /* n:\"ImData\", */\n    f: parse_ImData\n  },\n\n  /*::[*/\n  0x0087\n  /*::]*/\n  : {\n    /* n:\"Addin\", */\n  },\n\n  /*::[*/\n  0x0088\n  /*::]*/\n  : {\n    /* n:\"Edg\", */\n  },\n\n  /*::[*/\n  0x0089\n  /*::]*/\n  : {\n    /* n:\"Pub\", */\n  },\n  // 0x8A\n  // 0x8B LH: alternate menu key flag (BIFF3/4)\n  // 0x8E\n  // 0x8F\n\n  /*::[*/\n  0x0091\n  /*::]*/\n  : {\n    /* n:\"Sub\", */\n  },\n  // 0x93 STYLE\n\n  /*::[*/\n  0x0094\n  /*::]*/\n  : {\n    /* n:\"LHRecord\", */\n  },\n\n  /*::[*/\n  0x0095\n  /*::]*/\n  : {\n    /* n:\"LHNGraph\", */\n  },\n\n  /*::[*/\n  0x0096\n  /*::]*/\n  : {\n    /* n:\"Sound\", */\n  },\n  // 0xA2 FNPROTO: function prototypes (BIFF4)\n  // 0xA3\n  // 0xA8\n\n  /*::[*/\n  0x00a9\n  /*::]*/\n  : {\n    /* n:\"CoordList\", */\n  },\n\n  /*::[*/\n  0x00ab\n  /*::]*/\n  : {\n    /* n:\"GCW\", */\n  },\n\n  /*::[*/\n  0x00bc\n  /*::]*/\n  : {\n    /* n:\"ShrFmla\", */\n  },\n\n  /* Not necessarily same as 0x04bc */\n\n  /*::[*/\n  0x00bf\n  /*::]*/\n  : {\n    /* n:\"ToolbarHdr\", */\n  },\n\n  /*::[*/\n  0x00c0\n  /*::]*/\n  : {\n    /* n:\"ToolbarEnd\", */\n  },\n\n  /*::[*/\n  0x00c2\n  /*::]*/\n  : {\n    /* n:\"AddMenu\", */\n  },\n\n  /*::[*/\n  0x00c3\n  /*::]*/\n  : {\n    /* n:\"DelMenu\", */\n  },\n\n  /*::[*/\n  0x00d6\n  /*::]*/\n  : {\n    /* n:\"RString\", */\n    f: parse_RString\n  },\n\n  /*::[*/\n  0x00df\n  /*::]*/\n  : {\n    /* n:\"UDDesc\", */\n  },\n\n  /*::[*/\n  0x00ea\n  /*::]*/\n  : {\n    /* n:\"TabIdConf\", */\n  },\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : {\n    /* n:\"XL5Modify\", */\n  },\n\n  /*::[*/\n  0x01a5\n  /*::]*/\n  : {\n    /* n:\"FileSharing2\", */\n  },\n\n  /*::[*/\n  0x0206\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x0209\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x0218\n  /*::]*/\n  : {\n    /* n:\"Lbl\", */\n    f: parse_Lbl\n  },\n\n  /*::[*/\n  0x0223\n  /*::]*/\n  : {\n    /* n:\"ExternName\", */\n    f: parse_ExternName\n  },\n\n  /*::[*/\n  0x0231\n  /*::]*/\n  : {\n    /* n:\"Font\", */\n  },\n\n  /*::[*/\n  0x0243\n  /*::]*/\n  : {\n    /* n:\"BIFF3XF\", */\n  },\n\n  /*::[*/\n  0x0406\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x0409\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x0443\n  /*::]*/\n  : {\n    /* n:\"BIFF4XF\", */\n  },\n\n  /*::[*/\n  0x086d\n  /*::]*/\n  : {\n    /* n:\"FeatInfo\", */\n  },\n\n  /*::[*/\n  0x0873\n  /*::]*/\n  : {\n    /* n:\"FeatInfo11\", */\n  },\n\n  /*::[*/\n  0x0881\n  /*::]*/\n  : {\n    /* n:\"SXAddl12\", */\n  },\n\n  /*::[*/\n  0x08c0\n  /*::]*/\n  : {\n    /* n:\"AutoWebPub\", */\n  },\n\n  /*::[*/\n  0x08c1\n  /*::]*/\n  : {\n    /* n:\"ListObj\", */\n  },\n\n  /*::[*/\n  0x08c2\n  /*::]*/\n  : {\n    /* n:\"ListField\", */\n  },\n\n  /*::[*/\n  0x08c3\n  /*::]*/\n  : {\n    /* n:\"ListDV\", */\n  },\n\n  /*::[*/\n  0x08c4\n  /*::]*/\n  : {\n    /* n:\"ListCondFmt\", */\n  },\n\n  /*::[*/\n  0x08c5\n  /*::]*/\n  : {\n    /* n:\"ListCF\", */\n  },\n\n  /*::[*/\n  0x08c6\n  /*::]*/\n  : {\n    /* n:\"FMQry\", */\n  },\n\n  /*::[*/\n  0x08c7\n  /*::]*/\n  : {\n    /* n:\"FMSQry\", */\n  },\n\n  /*::[*/\n  0x08c8\n  /*::]*/\n  : {\n    /* n:\"PLV\", */\n  },\n\n  /*::[*/\n  0x08c9\n  /*::]*/\n  : {\n    /* n:\"LnExt\", */\n  },\n\n  /*::[*/\n  0x08ca\n  /*::]*/\n  : {\n    /* n:\"MkrExt\", */\n  },\n\n  /*::[*/\n  0x08cb\n  /*::]*/\n  : {\n    /* n:\"CrtCoopt\", */\n  },\n\n  /*::[*/\n  0x08d6\n  /*::]*/\n  : {\n    /* n:\"FRTArchId$\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x7262\n  /*::]*/\n  : {}\n};\n\nfunction write_biff_rec(ba\n/*:BufArray*/\n, type\n/*:number*/\n, payload, length\n/*:?number*/\n)\n/*:void*/\n{\n  var t\n  /*:number*/\n  = type;\n  if (isNaN(t)) return;\n  var len = length || (payload || []).length || 0;\n  var o = ba.next(4);\n  o.write_shift(2, t);\n  o.write_shift(2, len);\n  if (\n  /*:: len != null &&*/\n  len > 0 && is_buf(payload)) ba.push(payload);\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\n\n\nfunction html_to_sheet(str\n/*:string*/\n, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  var ws\n  /*:Worksheet*/\n  = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  str = str.replace(/<!--.*?-->/g, \"\");\n  var mtch\n  /*:any*/\n  = str.match(/<table/i);\n  if (!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n  var mtch2\n  /*:any*/\n  = str.match(/<\\/table/i);\n  var i\n  /*:number*/\n  = mtch.index,\n      j\n  /*:number*/\n  = mtch2 && mtch2.index || str.length;\n  var rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n  var R = -1,\n      C = 0,\n      RS = 0,\n      CS = 0;\n  var range\n  /*:Range*/\n  = {\n    s: {\n      r: 10000000,\n      c: 10000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var merges\n  /*:Array<Range>*/\n  = [];\n\n  for (i = 0; i < rows.length; ++i) {\n    var row = rows[i].trim();\n    var hd = row.slice(0, 3).toLowerCase();\n\n    if (hd == \"<tr\") {\n      ++R;\n\n      if (opts.sheetRows && opts.sheetRows <= R) {\n        --R;\n        break;\n      }\n\n      C = 0;\n      continue;\n    }\n\n    if (hd != \"<td\" && hd != \"<th\") continue;\n    var cells = row.split(/<\\/t[dh]>/i);\n\n    for (j = 0; j < cells.length; ++j) {\n      var cell = cells[j].trim();\n      if (!cell.match(/<t[dh]/i)) continue;\n      var m = cell,\n          cc = 0;\n      /* TODO: parse styles etc */\n\n      while (m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) {\n        m = m.slice(cc + 1);\n      }\n\n      for (var midx = 0; midx < merges.length; ++midx) {\n        var _merge\n        /*:Range*/\n        = merges[midx];\n\n        if (_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) {\n          C = _merge.e.c + 1;\n          midx = -1;\n        }\n      }\n\n      var tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n      CS = tag.colspan ? +tag.colspan : 1;\n      if ((RS = +tag.rowspan) > 1 || CS > 1) merges.push({\n        s: {\n          r: R,\n          c: C\n        },\n        e: {\n          r: R + (RS || 1) - 1,\n          c: C + CS - 1\n        }\n      });\n\n      var _t\n      /*:string*/\n      = tag.t || tag[\"data-t\"] || \"\";\n      /* TODO: generate stub cells */\n\n\n      if (!m.length) {\n        C += CS;\n        continue;\n      }\n\n      m = htmldecode(m);\n      if (range.s.r > R) range.s.r = R;\n      if (range.e.r < R) range.e.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.c < C) range.e.c = C;\n\n      if (!m.length) {\n        C += CS;\n        continue;\n      }\n\n      var o\n      /*:Cell*/\n      = {\n        t: 's',\n        v: m\n      };\n      if (opts.raw || !m.trim().length || _t == 's') ;else if (m === 'TRUE') o = {\n        t: 'b',\n        v: true\n      };else if (m === 'FALSE') o = {\n        t: 'b',\n        v: false\n      };else if (!isNaN(fuzzynum(m))) o = {\n        t: 'n',\n        v: fuzzynum(m)\n      };else if (!isNaN(fuzzydate(m).getDate())) {\n        o = {\n          t: 'd',\n          v: parseDate(m)\n        }\n        /*:any*/\n        ;\n        if (!opts.cellDates) o = {\n          t: 'n',\n          v: datenum(o.v)\n        }\n        /*:any*/\n        ;\n        o.z = opts.dateNF || table_fmt[14];\n      }\n\n      if (opts.dense) {\n        if (!ws[R]) ws[R] = [];\n        ws[R][C] = o;\n      } else ws[encode_cell({\n        r: R,\n        c: C\n      })] = o;\n\n      C += CS;\n    }\n  }\n\n  ws['!ref'] = encode_range(range);\n  if (merges.length) ws[\"!merges\"] = merges;\n  return ws;\n}\n\nfunction make_html_row(ws\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, o\n/*:Sheet2HTMLOpts*/\n)\n/*:string*/\n{\n  var M\n  /*:Array<Range>*/\n  = ws['!merges'] || [];\n  var oo\n  /*:Array<string>*/\n  = [];\n\n  for (var C = r.s.c; C <= r.e.c; ++C) {\n    var RS = 0,\n        CS = 0;\n\n    for (var j = 0; j < M.length; ++j) {\n      if (M[j].s.r > R || M[j].s.c > C) continue;\n      if (M[j].e.r < R || M[j].e.c < C) continue;\n\n      if (M[j].s.r < R || M[j].s.c < C) {\n        RS = -1;\n        break;\n      }\n\n      RS = M[j].e.r - M[j].s.r + 1;\n      CS = M[j].e.c - M[j].s.c + 1;\n      break;\n    }\n\n    if (RS < 0) continue;\n    var coord = encode_cell({\n      r: R,\n      c: C\n    });\n    var cell = o.dense ? (ws[R] || [])[C] : ws[coord];\n    /* TODO: html entities */\n\n    var w = cell && cell.v != null && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n    var sp = {}\n    /*:any*/\n    ;\n    if (RS > 1) sp.rowspan = RS;\n    if (CS > 1) sp.colspan = CS;\n    if (o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';else if (cell) {\n      sp[\"data-t\"] = cell && cell.t || 'z';\n      if (cell.v != null) sp[\"data-v\"] = cell.v;\n      if (cell.z != null) sp[\"data-z\"] = cell.z;\n      if (cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + cell.l.Target + '\">' + w + '</a>';\n    }\n    sp.id = (o.id || \"sjs\") + \"-\" + coord;\n    oo.push(writextag('td', w, sp));\n  }\n\n  var preamble = \"<tr>\";\n  return preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str\n/*:string*/\n, opts)\n/*:Workbook*/\n{\n  var mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n  if (!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n  if (mtch.length == 1) return sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n  var wb = book_new();\n  mtch.forEach(function (s, idx) {\n    book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx + 1));\n  });\n  return wb;\n}\n\nfunction make_html_preamble(ws\n/*:Worksheet*/\n, R\n/*:Range*/\n, o\n/*:Sheet2HTMLOpts*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  return out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws\n/*:Worksheet*/\n, opts\n/*:?Sheet2HTMLOpts*/\n\n/*, wb:?Workbook*/\n)\n/*:string*/\n{\n  var o = opts || {};\n  var header = o.header != null ? o.header : HTML_BEGIN;\n  var footer = o.footer != null ? o.footer : HTML_END;\n  var out\n  /*:Array<string>*/\n  = [header];\n  var r = decode_range(ws['!ref']);\n  o.dense = Array.isArray(ws);\n  out.push(make_html_preamble(ws, r, o));\n\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    out.push(make_html_row(ws, r, R, o));\n  }\n\n  out.push(\"</table>\" + footer);\n  return out.join(\"\");\n}\n\nfunction sheet_add_dom(ws\n/*:Worksheet*/\n, table\n/*:HTMLElement*/\n, _opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var opts = _opts || {};\n  var or_R = 0,\n      or_C = 0;\n\n  if (opts.origin != null) {\n    if (typeof opts.origin == 'number') or_R = opts.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\n      or_R = _origin.r;\n      or_C = _origin.c;\n    }\n  }\n\n  var rows\n  /*:HTMLCollection<HTMLTableRowElement>*/\n  = table.getElementsByTagName('tr');\n  var sheetRows = Math.min(opts.sheetRows || 10000000, rows.length);\n  var range\n  /*:Range*/\n  = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: or_R,\n      c: or_C\n    }\n  };\n\n  if (ws[\"!ref\"]) {\n    var _range\n    /*:Range*/\n    = decode_range(ws[\"!ref\"]);\n\n    range.s.r = Math.min(range.s.r, _range.s.r);\n    range.s.c = Math.min(range.s.c, _range.s.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    if (or_R == -1) range.e.r = or_R = _range.e.r + 1;\n  }\n\n  var merges\n  /*:Array<Range>*/\n  = [],\n      midx = 0;\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n  var _R = 0,\n      R = 0,\n      _C = 0,\n      C = 0,\n      RS = 0,\n      CS = 0;\n  if (!ws[\"!cols\"]) ws['!cols'] = [];\n\n  for (; _R < rows.length && R < sheetRows; ++_R) {\n    var row\n    /*:HTMLTableRowElement*/\n    = rows[_R];\n\n    if (is_dom_element_hidden(row)) {\n      if (opts.display) continue;\n      rowinfo[R] = {\n        hidden: true\n      };\n    }\n\n    var elts\n    /*:HTMLCollection<HTMLTableCellElement>*/\n    = row.children\n    /*:any*/\n    ;\n\n    for (_C = C = 0; _C < elts.length; ++_C) {\n      var elt\n      /*:HTMLTableCellElement*/\n      = elts[_C];\n      if (opts.display && is_dom_element_hidden(elt)) continue;\n      var v\n      /*:?string*/\n      = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n      var z\n      /*:?string*/\n      = elt.getAttribute('data-z') || elt.getAttribute('z');\n\n      for (midx = 0; midx < merges.length; ++midx) {\n        var m\n        /*:Range*/\n        = merges[midx];\n\n        if (m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) {\n          C = m.e.c + 1 - or_C;\n          midx = -1;\n        }\n      }\n      /* TODO: figure out how to extract nonstandard mso- style */\n\n\n      CS = +elt.getAttribute(\"colspan\") || 1;\n      if ((RS = +elt.getAttribute(\"rowspan\") || 1) > 1 || CS > 1) merges.push({\n        s: {\n          r: R + or_R,\n          c: C + or_C\n        },\n        e: {\n          r: R + or_R + (RS || 1) - 1,\n          c: C + or_C + (CS || 1) - 1\n        }\n      });\n      var o\n      /*:Cell*/\n      = {\n        t: 's',\n        v: v\n      };\n\n      var _t\n      /*:string*/\n      = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\n      if (v != null) {\n        if (v.length == 0) o.t = _t || 'z';else if (opts.raw || v.trim().length == 0 || _t == \"s\") ;else if (v === 'TRUE') o = {\n          t: 'b',\n          v: true\n        };else if (v === 'FALSE') o = {\n          t: 'b',\n          v: false\n        };else if (!isNaN(fuzzynum(v))) o = {\n          t: 'n',\n          v: fuzzynum(v)\n        };else if (!isNaN(fuzzydate(v).getDate())) {\n          o = {\n            t: 'd',\n            v: parseDate(v)\n          }\n          /*:any*/\n          ;\n          if (!opts.cellDates) o = {\n            t: 'n',\n            v: datenum(o.v)\n          }\n          /*:any*/\n          ;\n          o.z = opts.dateNF || table_fmt[14];\n        }\n      }\n\n      if (o.z === undefined && z != null) o.z = z;\n      /* The first link is used.  Links are assumed to be fully specified.\n       * TODO: The right way to process relative links is to make a new <a> */\n\n      var l = \"\",\n          Aelts = elt.getElementsByTagName(\"A\");\n      if (Aelts && Aelts.length) for (var Aelti = 0; Aelti < Aelts.length; ++Aelti) {\n        if (Aelts[Aelti].hasAttribute(\"href\")) {\n          l = Aelts[Aelti].getAttribute(\"href\");\n          if (l.charAt(0) != \"#\") break;\n        }\n      }\n      if (l && l.charAt(0) != \"#\") o.l = {\n        Target: l\n      };\n\n      if (opts.dense) {\n        if (!ws[R + or_R]) ws[R + or_R] = [];\n        ws[R + or_R][C + or_C] = o;\n      } else ws[encode_cell({\n        c: C + or_C,\n        r: R + or_R\n      })] = o;\n\n      if (range.e.c < C + or_C) range.e.c = C + or_C;\n      C += CS;\n    }\n\n    ++R;\n  }\n\n  if (merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n  range.e.r = Math.max(range.e.r, R - 1 + or_R);\n  ws['!ref'] = encode_range(range);\n  if (R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length - _R + R - 1 + or_R, range)); // We can count the real number of rows to parse but we don't to improve the performance\n\n  return ws;\n}\n\nfunction parse_dom_table(table\n/*:HTMLElement*/\n, _opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var opts = _opts || {};\n  var ws\n  /*:Worksheet*/\n  = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  return sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table\n/*:HTMLElement*/\n, opts\n/*:?any*/\n)\n/*:Workbook*/\n{\n  return sheet_to_workbook(parse_dom_table(table, opts), opts);\n}\n\nfunction is_dom_element_hidden(element\n/*:HTMLElement*/\n)\n/*:boolean*/\n{\n  var display\n  /*:string*/\n  = '';\n  var get_computed_style\n  /*:?function*/\n  = get_get_computed_style_function(element);\n  if (get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n  if (!display) display = element.style && element.style.display;\n  return display === 'none';\n}\n/* global getComputedStyle */\n\n\nfunction get_get_computed_style_function(element\n/*:HTMLElement*/\n)\n/*:?function*/\n{\n  // The proper getComputedStyle implementation is the one defined in the element window\n  if (element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle; // If it is not available, try to get one from the global namespace\n\n  if (typeof getComputedStyle === 'function') return getComputedStyle;\n  return null;\n}\n/* OpenDocument */\n\n\nfunction parse_text_p(text\n/*:string*/\n\n/*::, tag*/\n)\n/*:Array<any>*/\n{\n  /* 6.1.2 White Space Characters */\n  var fixed = text.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \").replace(/<text:s\\/>/g, \" \").replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function ($$, $1) {\n    return Array(parseInt($1, 10) + 1).join(\" \");\n  }).replace(/<text:tab[^>]*\\/>/g, \"\\t\").replace(/<text:line-break\\/>/g, \"\\n\");\n  var v = unescapexml(fixed.replace(/<[^>]*>/g, \"\"));\n  return [v];\n}\n\nvar number_formats_ods = {\n  /* ods name: [short ssf fmt, long ssf fmt] */\n  day: [\"d\", \"dd\"],\n  month: [\"m\", \"mm\"],\n  year: [\"y\", \"yy\"],\n  hours: [\"h\", \"hh\"],\n  minutes: [\"m\", \"mm\"],\n  seconds: [\"s\", \"ss\"],\n  \"am-pm\": [\"A/P\", \"AM/PM\"],\n  \"day-of-week\": [\"ddd\", \"dddd\"],\n  era: [\"e\", \"ee\"],\n\n  /* there is no native representation of LO \"Q\" format */\n  quarter: [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\n};\n\nfunction parse_content_xml(d\n/*:string*/\n, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  var str = xlml_normalize(d);\n  var state\n  /*:Array<any>*/\n  = [],\n      tmp;\n  var tag\n  /*:: = {}*/\n  ;\n  var NFtag = {\n    name: \"\"\n  },\n      NF = \"\",\n      pidx = 0;\n  var sheetag\n  /*:: = {name:\"\", '名称':\"\"}*/\n  ;\n  var rowtag\n  /*:: = {'行号':\"\"}*/\n  ;\n  var Sheets = {},\n      SheetNames\n  /*:Array<string>*/\n  = [];\n  var ws = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  var Rn, q\n  /*:: :any = ({t:\"\", v:null, z:null, w:\"\",c:[],}:any)*/\n  ;\n  var ctag = {\n    value: \"\"\n  }\n  /*:any*/\n  ;\n  var textp = \"\",\n      textpidx = 0;\n  var textR = [];\n  var R = -1,\n      C = -1,\n      range = {\n    s: {\n      r: 1000000,\n      c: 10000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var row_ol = 0;\n  var number_format_map = {};\n  var merges\n  /*:Array<Range>*/\n  = [],\n      mrange = {},\n      mR = 0,\n      mC = 0;\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = [],\n      rowpeat = 1,\n      colpeat = 1;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var WB = {\n    Names: []\n  };\n  var atag = {}\n  /*:any*/\n  ;\n  var _Ref\n  /*:[string, string]*/\n  = [\"\", \"\"];\n  var comments\n  /*:Array<Comment>*/\n  = [],\n      comment\n  /*:Comment*/\n  = {}\n  /*:any*/\n  ;\n  var creator = \"\",\n      creatoridx = 0;\n  var isstub = false,\n      intable = false;\n  var i = 0;\n  xlmlregex.lastIndex = 0;\n  str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n\n  while (Rn = xlmlregex.exec(str)) {\n    switch (Rn[3] = Rn[3].replace(/_.*$/, \"\")) {\n      case 'table':\n      case '工作表':\n        // 9.1.2 <table:table>\n        if (Rn[1] === '/') {\n          if (range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);else ws['!ref'] = \"A1:A1\";\n\n          if (opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n            ws['!fullref'] = ws['!ref'];\n            range.e.r = opts.sheetRows - 1;\n            ws['!ref'] = encode_range(range);\n          }\n\n          if (merges.length) ws['!merges'] = merges;\n          if (rowinfo.length) ws[\"!rows\"] = rowinfo;\n          sheetag.name = sheetag['名称'] || sheetag.name;\n          if (typeof JSON !== 'undefined') JSON.stringify(sheetag);\n          SheetNames.push(sheetag.name);\n          Sheets[sheetag.name] = ws;\n          intable = false;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          sheetag = parsexmltag(Rn[0], false);\n          R = C = -1;\n          range.s.r = range.s.c = 10000000;\n          range.e.r = range.e.c = 0;\n          ws = opts.dense ? []\n          /*:any*/\n          : {}\n          /*:any*/\n          ;\n          merges = [];\n          rowinfo = [];\n          intable = true;\n        }\n\n        break;\n\n      case 'table-row-group':\n        // 9.1.9 <table:table-row-group>\n        if (Rn[1] === \"/\") --row_ol;else ++row_ol;\n        break;\n\n      case 'table-row':\n      case '行':\n        // 9.1.3 <table:table-row>\n        if (Rn[1] === '/') {\n          R += rowpeat;\n          rowpeat = 1;\n          break;\n        }\n\n        rowtag = parsexmltag(Rn[0], false);\n        if (rowtag['行号']) R = rowtag['行号'] - 1;else if (R == -1) R = 0;\n        rowpeat = +rowtag['number-rows-repeated'] || 1;\n        /* TODO: remove magic */\n\n        if (rowpeat < 10) for (i = 0; i < rowpeat; ++i) {\n          if (row_ol > 0) rowinfo[R + i] = {\n            level: row_ol\n          };\n        }\n        C = -1;\n        break;\n\n      case 'covered-table-cell':\n        // 9.1.5 <table:covered-table-cell>\n        if (Rn[1] !== '/') ++C;\n\n        if (opts.sheetStubs) {\n          if (opts.dense) {\n            if (!ws[R]) ws[R] = [];\n            ws[R][C] = {\n              t: 'z'\n            };\n          } else ws[encode_cell({\n            r: R,\n            c: C\n          })] = {\n            t: 'z'\n          };\n        }\n\n        textp = \"\";\n        textR = [];\n        break;\n\n      /* stub */\n\n      case 'table-cell':\n      case '数据':\n        if (Rn[0].charAt(Rn[0].length - 2) === '/') {\n          ++C;\n          ctag = parsexmltag(Rn[0], false);\n          colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n          q = {\n            t: 'z',\n            v: null\n            /*:: , z:null, w:\"\",c:[]*/\n\n          }\n          /*:any*/\n          ;\n          if (ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\n          if ((ctag['数据类型'] || ctag['value-type']) == \"string\") {\n            q.t = \"s\";\n            q.v = unescapexml(ctag['string-value'] || \"\");\n\n            if (opts.dense) {\n              if (!ws[R]) ws[R] = [];\n              ws[R][C] = q;\n            } else {\n              ws[encode_cell({\n                r: R,\n                c: C\n              })] = q;\n            }\n          }\n\n          C += colpeat - 1;\n        } else if (Rn[1] !== '/') {\n          ++C;\n          textp = \"\";\n          textpidx = 0;\n          textR = [];\n          colpeat = 1;\n          var rptR = rowpeat ? R + rowpeat - 1 : R;\n          if (C > range.e.c) range.e.c = C;\n          if (C < range.s.c) range.s.c = C;\n          if (R < range.s.r) range.s.r = R;\n          if (rptR > range.e.r) range.e.r = rptR;\n          ctag = parsexmltag(Rn[0], false);\n          comments = [];\n          comment = {}\n          /*:any*/\n          ;\n          q = {\n            t: ctag['数据类型'] || ctag['value-type'],\n            v: null\n            /*:: , z:null, w:\"\",c:[]*/\n\n          }\n          /*:any*/\n          ;\n\n          if (opts.cellFormula) {\n            if (ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\n            if (ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n              mR = parseInt(ctag['number-matrix-rows-spanned'], 10) || 0;\n              mC = parseInt(ctag['number-matrix-columns-spanned'], 10) || 0;\n              mrange = {\n                s: {\n                  r: R,\n                  c: C\n                },\n                e: {\n                  r: R + mR - 1,\n                  c: C + mC - 1\n                }\n              };\n              q.F = encode_range(mrange);\n              arrayf.push([mrange, q.F]);\n            }\n\n            if (ctag.formula) q.f = ods_to_csf_formula(ctag.formula);else for (i = 0; i < arrayf.length; ++i) {\n              if (R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r) if (C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c) q.F = arrayf[i][1];\n            }\n          }\n\n          if (ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n            mR = parseInt(ctag['number-rows-spanned'], 10) || 0;\n            mC = parseInt(ctag['number-columns-spanned'], 10) || 0;\n            mrange = {\n              s: {\n                r: R,\n                c: C\n              },\n              e: {\n                r: R + mR - 1,\n                c: C + mC - 1\n              }\n            };\n            merges.push(mrange);\n          }\n          /* 19.675.2 table:number-columns-repeated */\n\n\n          if (ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n          /* 19.385 office:value-type */\n\n          switch (q.t) {\n            case 'boolean':\n              q.t = 'b';\n              q.v = parsexmlbool(ctag['boolean-value']);\n              break;\n\n            case 'float':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n\n            case 'percentage':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n\n            case 'currency':\n              q.t = 'n';\n              q.v = parseFloat(ctag.value);\n              break;\n\n            case 'date':\n              q.t = 'd';\n              q.v = parseDate(ctag['date-value']);\n\n              if (!opts.cellDates) {\n                q.t = 'n';\n                q.v = datenum(q.v);\n              }\n\n              q.z = 'm/d/yy';\n              break;\n\n            case 'time':\n              q.t = 'n';\n              q.v = parse_isodur(ctag['time-value']) / 86400;\n\n              if (opts.cellDates) {\n                q.t = 'd';\n                q.v = numdate(q.v);\n              }\n\n              q.z = 'HH:MM:SS';\n              break;\n\n            case 'number':\n              q.t = 'n';\n              q.v = parseFloat(ctag['数据数值']);\n              break;\n\n            default:\n              if (q.t === 'string' || q.t === 'text' || !q.t) {\n                q.t = 's';\n\n                if (ctag['string-value'] != null) {\n                  textp = unescapexml(ctag['string-value']);\n                  textR = [];\n                }\n              } else throw new Error('Unsupported value type ' + q.t);\n\n          }\n        } else {\n          isstub = false;\n\n          if (q.t === 's') {\n            q.v = textp || '';\n            if (textR.length) q.R = textR;\n            isstub = textpidx == 0;\n          }\n\n          if (atag.Target) q.l = atag;\n\n          if (comments.length > 0) {\n            q.c = comments;\n            comments = [];\n          }\n\n          if (textp && opts.cellText !== false) q.w = textp;\n\n          if (isstub) {\n            q.t = \"z\";\n            delete q.v;\n          }\n\n          if (!isstub || opts.sheetStubs) {\n            if (!(opts.sheetRows && opts.sheetRows <= R)) {\n              for (var rpt = 0; rpt < rowpeat; ++rpt) {\n                colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n\n                if (opts.dense) {\n                  if (!ws[R + rpt]) ws[R + rpt] = [];\n                  ws[R + rpt][C] = rpt == 0 ? q : dup(q);\n\n                  while (--colpeat > 0) {\n                    ws[R + rpt][C + colpeat] = dup(q);\n                  }\n                } else {\n                  ws[encode_cell({\n                    r: R + rpt,\n                    c: C\n                  })] = q;\n\n                  while (--colpeat > 0) {\n                    ws[encode_cell({\n                      r: R + rpt,\n                      c: C + colpeat\n                    })] = dup(q);\n                  }\n                }\n\n                if (range.e.c <= C) range.e.c = C;\n              }\n            }\n          }\n\n          colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n          C += colpeat - 1;\n          colpeat = 0;\n          q = {\n            /*:: t:\"\", v:null, z:null, w:\"\",c:[]*/\n          };\n          textp = \"\";\n          textR = [];\n        }\n\n        atag = {}\n        /*:any*/\n        ;\n        break;\n      // 9.1.4 <table:table-cell>\n\n      /* pure state */\n\n      case 'document': // TODO: <office:document> is the root for FODS\n\n      case 'document-content':\n      case '电子表格文档': // 3.1.3.2 <office:document-content>\n\n      case 'spreadsheet':\n      case '主体': // 3.7 <office:spreadsheet>\n\n      case 'scripts': // 3.12 <office:scripts>\n\n      case 'styles': // TODO <office:styles>\n\n      case 'font-face-decls': // 3.14 <office:font-face-decls>\n\n      case 'master-styles':\n        // 3.15.4 <office:master-styles> -- relevant for FODS\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n        break;\n\n      case 'annotation':\n        // 14.1 <office:annotation>\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          comment.t = textp;\n          if (textR.length)\n            /*::(*/\n            comment\n            /*:: :any)*/\n            .R = textR;\n          comment.a = creator;\n          comments.push(comment);\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          state.push([Rn[3], false]);\n        }\n\n        creator = \"\";\n        creatoridx = 0;\n        textp = \"\";\n        textpidx = 0;\n        textR = [];\n        break;\n\n      case 'creator':\n        // 4.3.2.7 <dc:creator>\n        if (Rn[1] === '/') {\n          creator = str.slice(creatoridx, Rn.index);\n        } else creatoridx = Rn.index + Rn[0].length;\n\n        break;\n\n      /* ignore state */\n\n      case 'meta':\n      case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n\n      case 'settings': // TODO: <office:settings>\n\n      case 'config-item-set': // TODO: <office:config-item-set>\n\n      case 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\n      case 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\n      case 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\n      case 'shapes': // 9.2.8 <table:shapes>\n\n      case 'frame': // 10.4.2 <draw:frame>\n\n      case 'text-box': // 10.4.3 <draw:text-box>\n\n      case 'image': // 10.4.4 <draw:image>\n\n      case 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\n      case 'list-style': // 16.30 <text:list-style>\n\n      case 'form': // 13.13 <form:form>\n\n      case 'dde-links': // 9.8 <table:dde-links>\n\n      case 'event-listeners': // TODO\n\n      case 'chart':\n        // TODO\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], false]);\n\n        textp = \"\";\n        textpidx = 0;\n        textR = [];\n        break;\n\n      case 'scientific-number':\n        // TODO: <number:scientific-number>\n        break;\n\n      case 'currency-symbol':\n        // TODO: <number:currency-symbol>\n        break;\n\n      case 'currency-style':\n        // TODO: <number:currency-style>\n        break;\n\n      case 'number-style': // 16.27.2 <number:number-style>\n\n      case 'percentage-style': // 16.27.9 <number:percentage-style>\n\n      case 'date-style': // 16.27.10 <number:date-style>\n\n      case 'time-style':\n        // 16.27.18 <number:time-style>\n        if (Rn[1] === '/') {\n          number_format_map[NFtag.name] = NF;\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n          NF = \"\";\n          NFtag = parsexmltag(Rn[0], false);\n          state.push([Rn[3], true]);\n        }\n\n        break;\n\n      case 'script':\n        break;\n      // 3.13 <office:script>\n\n      case 'libraries':\n        break;\n      // TODO: <ooo:libraries>\n\n      case 'automatic-styles':\n        break;\n      // 3.15.3 <office:automatic-styles>\n\n      case 'default-style': // TODO: <style:default-style>\n\n      case 'page-layout':\n        break;\n      // TODO: <style:page-layout>\n\n      case 'style':\n        // 16.2 <style:style>\n        break;\n\n      case 'map':\n        break;\n      // 16.3 <style:map>\n\n      case 'font-face':\n        break;\n      // 16.21 <style:font-face>\n\n      case 'paragraph-properties':\n        break;\n      // 17.6 <style:paragraph-properties>\n\n      case 'table-properties':\n        break;\n      // 17.15 <style:table-properties>\n\n      case 'table-column-properties':\n        break;\n      // 17.16 <style:table-column-properties>\n\n      case 'table-row-properties':\n        break;\n      // 17.17 <style:table-row-properties>\n\n      case 'table-cell-properties':\n        break;\n      // 17.18 <style:table-cell-properties>\n\n      case 'number':\n        // 16.27.3 <number:number>\n        switch (state[state.length - 1][0]) {\n          case 'time-style':\n          case 'date-style':\n            tag = parsexmltag(Rn[0], false);\n            NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n            break;\n        }\n\n        break;\n\n      case 'fraction':\n        break;\n      // TODO 16.27.6 <number:fraction>\n\n      case 'day': // 16.27.11 <number:day>\n\n      case 'month': // 16.27.12 <number:month>\n\n      case 'year': // 16.27.13 <number:year>\n\n      case 'era': // 16.27.14 <number:era>\n\n      case 'day-of-week': // 16.27.15 <number:day-of-week>\n\n      case 'week-of-year': // 16.27.16 <number:week-of-year>\n\n      case 'quarter': // 16.27.17 <number:quarter>\n\n      case 'hours': // 16.27.19 <number:hours>\n\n      case 'minutes': // 16.27.20 <number:minutes>\n\n      case 'seconds': // 16.27.21 <number:seconds>\n\n      case 'am-pm':\n        // 16.27.22 <number:am-pm>\n        switch (state[state.length - 1][0]) {\n          case 'time-style':\n          case 'date-style':\n            tag = parsexmltag(Rn[0], false);\n            NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n            break;\n        }\n\n        break;\n\n      case 'boolean-style':\n        break;\n      // 16.27.23 <number:boolean-style>\n\n      case 'boolean':\n        break;\n      // 16.27.24 <number:boolean>\n\n      case 'text-style':\n        break;\n      // 16.27.25 <number:text-style>\n\n      case 'text':\n        // 16.27.26 <number:text>\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") switch (state[state.length - 1][0]) {\n          case 'number-style':\n          case 'date-style':\n          case 'time-style':\n            NF += str.slice(pidx, Rn.index);\n            break;\n        } else pidx = Rn.index + Rn[0].length;\n        break;\n\n      case 'named-range':\n        // 9.4.12 <table:named-range>\n        tag = parsexmltag(Rn[0], false);\n        _Ref = ods_to_csf_3D(tag['cell-range-address']);\n        var nrange = {\n          Name: tag.name,\n          Ref: _Ref[0] + '!' + _Ref[1]\n        }\n        /*:any*/\n        ;\n        if (intable) nrange.Sheet = SheetNames.length;\n        WB.Names.push(nrange);\n        break;\n\n      case 'text-content':\n        break;\n      // 16.27.27 <number:text-content>\n\n      case 'text-properties':\n        break;\n      // 16.27.27 <style:text-properties>\n\n      case 'embedded-text':\n        break;\n      // 16.27.4 <number:embedded-text>\n\n      case 'body':\n      case '电子表格':\n        break;\n      // 3.3 16.9.6 19.726.3\n\n      case 'forms':\n        break;\n      // 12.25.2 13.2\n\n      case 'table-column':\n        break;\n      // 9.1.6 <table:table-column>\n\n      case 'table-header-rows':\n        break;\n      // 9.1.7 <table:table-header-rows>\n\n      case 'table-rows':\n        break;\n      // 9.1.12 <table:table-rows>\n\n      /* TODO: outline levels */\n\n      case 'table-column-group':\n        break;\n      // 9.1.10 <table:table-column-group>\n\n      case 'table-header-columns':\n        break;\n      // 9.1.11 <table:table-header-columns>\n\n      case 'table-columns':\n        break;\n      // 9.1.12 <table:table-columns>\n\n      case 'null-date':\n        break;\n      // 9.4.2 <table:null-date> TODO: date1904\n\n      case 'graphic-properties':\n        break;\n      // 17.21 <style:graphic-properties>\n\n      case 'calculation-settings':\n        break;\n      // 9.4.1 <table:calculation-settings>\n\n      case 'named-expressions':\n        break;\n      // 9.4.11 <table:named-expressions>\n\n      case 'label-range':\n        break;\n      // 9.4.9 <table:label-range>\n\n      case 'label-ranges':\n        break;\n      // 9.4.10 <table:label-ranges>\n\n      case 'named-expression':\n        break;\n      // 9.4.13 <table:named-expression>\n\n      case 'sort':\n        break;\n      // 9.4.19 <table:sort>\n\n      case 'sort-by':\n        break;\n      // 9.4.20 <table:sort-by>\n\n      case 'sort-groups':\n        break;\n      // 9.4.22 <table:sort-groups>\n\n      case 'tab':\n        break;\n      // 6.1.4 <text:tab>\n\n      case 'line-break':\n        break;\n      // 6.1.5 <text:line-break>\n\n      case 'span':\n        break;\n      // 6.1.7 <text:span>\n\n      case 'p':\n      case '文本串':\n        // 5.1.3 <text:p>\n        if (['master-styles'].indexOf(state[state.length - 1][0]) > -1) break;\n\n        if (Rn[1] === '/' && (!ctag || !ctag['string-value'])) {\n          var ptp = parse_text_p(str.slice(textpidx, Rn.index));\n          textp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n        } else {\n          parsexmltag(Rn[0], false);\n          textpidx = Rn.index + Rn[0].length;\n        }\n\n        break;\n      // <text:p>\n\n      case 's':\n        break;\n      // <text:s>\n\n      case 'database-range':\n        // 9.4.15 <table:database-range>\n        if (Rn[1] === '/') break;\n\n        try {\n          _Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n          Sheets[_Ref[0]]['!autofilter'] = {\n            ref: _Ref[1]\n          };\n        } catch (e) {\n          /* empty */\n        }\n\n        break;\n\n      case 'date':\n        break;\n      // <*:date>\n\n      case 'object':\n        break;\n      // 10.4.6.2 <draw:object>\n\n      case 'title':\n      case '标题':\n        break;\n      // <*:title> OR <uof:标题>\n\n      case 'desc':\n        break;\n      // <*:desc>\n\n      case 'binary-data':\n        break;\n      // 10.4.5 TODO: b64 blob\n\n      /* 9.2 Advanced Tables */\n\n      case 'table-source':\n        break;\n      // 9.2.6\n\n      case 'scenario':\n        break;\n      // 9.2.6\n\n      case 'iteration':\n        break;\n      // 9.4.3 <table:iteration>\n\n      case 'content-validations':\n        break;\n      // 9.4.4 <table:\n\n      case 'content-validation':\n        break;\n      // 9.4.5 <table:\n\n      case 'help-message':\n        break;\n      // 9.4.6 <table:\n\n      case 'error-message':\n        break;\n      // 9.4.7 <table:\n\n      case 'database-ranges':\n        break;\n      // 9.4.14 <table:database-ranges>\n\n      case 'filter':\n        break;\n      // 9.5.2 <table:filter>\n\n      case 'filter-and':\n        break;\n      // 9.5.3 <table:filter-and>\n\n      case 'filter-or':\n        break;\n      // 9.5.4 <table:filter-or>\n\n      case 'filter-condition':\n        break;\n      // 9.5.5 <table:filter-condition>\n\n      case 'list-level-style-bullet':\n        break;\n      // 16.31 <text:\n\n      case 'list-level-style-number':\n        break;\n      // 16.32 <text:\n\n      case 'list-level-properties':\n        break;\n      // 17.19 <style:\n\n      /* 7.3 Document Fields */\n\n      case 'sender-firstname': // 7.3.6.2\n\n      case 'sender-lastname': // 7.3.6.3\n\n      case 'sender-initials': // 7.3.6.4\n\n      case 'sender-title': // 7.3.6.5\n\n      case 'sender-position': // 7.3.6.6\n\n      case 'sender-email': // 7.3.6.7\n\n      case 'sender-phone-private': // 7.3.6.8\n\n      case 'sender-fax': // 7.3.6.9\n\n      case 'sender-company': // 7.3.6.10\n\n      case 'sender-phone-work': // 7.3.6.11\n\n      case 'sender-street': // 7.3.6.12\n\n      case 'sender-city': // 7.3.6.13\n\n      case 'sender-postal-code': // 7.3.6.14\n\n      case 'sender-country': // 7.3.6.15\n\n      case 'sender-state-or-province': // 7.3.6.16\n\n      case 'author-name': // 7.3.7.1\n\n      case 'author-initials': // 7.3.7.2\n\n      case 'chapter': // 7.3.8\n\n      case 'file-name': // 7.3.9\n\n      case 'template-name': // 7.3.9\n\n      case 'sheet-name':\n        // 7.3.9\n        break;\n\n      case 'event-listener':\n        break;\n\n      /* TODO: FODS Properties */\n\n      case 'initial-creator':\n      case 'creation-date':\n      case 'print-date':\n      case 'generator':\n      case 'document-statistic':\n      case 'user-defined':\n      case 'editing-duration':\n      case 'editing-cycles':\n        break;\n\n      /* TODO: FODS Config */\n\n      case 'config-item':\n        break;\n\n      /* TODO: style tokens */\n\n      case 'page-number':\n        break;\n      // TODO <text:page-number>\n\n      case 'page-count':\n        break;\n      // TODO <text:page-count>\n\n      case 'time':\n        break;\n      // TODO <text:time>\n\n      /* 9.3 Advanced Table Cells */\n\n      case 'cell-range-source':\n        break;\n      // 9.3.1 <table:\n\n      case 'detective':\n        break;\n      // 9.3.2 <table:\n\n      case 'operation':\n        break;\n      // 9.3.3 <table:\n\n      case 'highlighted-range':\n        break;\n      // 9.3.4 <table:\n\n      /* 9.6 Data Pilot Tables <table: */\n\n      case 'data-pilot-table': // 9.6.3\n\n      case 'source-cell-range': // 9.6.5\n\n      case 'source-service': // 9.6.6\n\n      case 'data-pilot-field': // 9.6.7\n\n      case 'data-pilot-level': // 9.6.8\n\n      case 'data-pilot-subtotals': // 9.6.9\n\n      case 'data-pilot-subtotal': // 9.6.10\n\n      case 'data-pilot-members': // 9.6.11\n\n      case 'data-pilot-member': // 9.6.12\n\n      case 'data-pilot-display-info': // 9.6.13\n\n      case 'data-pilot-sort-info': // 9.6.14\n\n      case 'data-pilot-layout-info': // 9.6.15\n\n      case 'data-pilot-field-reference': // 9.6.16\n\n      case 'data-pilot-groups': // 9.6.17\n\n      case 'data-pilot-group': // 9.6.18\n\n      case 'data-pilot-group-member':\n        // 9.6.19\n        break;\n\n      /* 10.3 Drawing Shapes */\n\n      case 'rect':\n        // 10.3.2\n        break;\n\n      /* 14.6 DDE Connections */\n\n      case 'dde-connection-decls': // 14.6.2 <text:\n\n      case 'dde-connection-decl': // 14.6.3 <text:\n\n      case 'dde-link': // 14.6.4 <table:\n\n      case 'dde-source':\n        // 14.6.5 <office:\n        break;\n\n      case 'properties':\n        break;\n      // 13.7 <form:properties>\n\n      case 'property':\n        break;\n      // 13.8 <form:property>\n\n      case 'a':\n        // 6.1.8 hyperlink\n        if (Rn[1] !== '/') {\n          atag = parsexmltag(Rn[0], false);\n          if (!atag.href) break;\n          atag.Target = unescapexml(atag.href);\n          delete atag.href;\n\n          if (atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n            _Ref = ods_to_csf_3D(atag.Target.slice(1));\n            atag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n          } else if (atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n        }\n\n        break;\n\n      /* non-standard */\n\n      case 'table-protection':\n        break;\n\n      case 'data-pilot-grand-total':\n        break;\n      // <table:\n\n      case 'office-document-common-attrs':\n        break;\n      // bare\n\n      default:\n        switch (Rn[2]) {\n          case 'dc:': // TODO: properties\n\n          case 'calcext:': // ignore undocumented extensions\n\n          case 'loext:': // ignore undocumented extensions\n\n          case 'ooo:': // ignore undocumented extensions\n\n          case 'chartooo:': // ignore undocumented extensions\n\n          case 'draw:': // TODO: drawing\n\n          case 'style:': // TODO: styles\n\n          case 'chart:': // TODO: charts\n\n          case 'form:': // TODO: forms\n\n          case 'uof:': // TODO: uof\n\n          case '表:': // TODO: uof\n\n          case '字:':\n            // TODO: uof\n            break;\n\n          default:\n            if (opts.WTF) throw new Error(Rn);\n        }\n\n    }\n  }\n\n  var out\n  /*:Workbook*/\n  = {\n    Sheets: Sheets,\n    SheetNames: SheetNames,\n    Workbook: WB\n  }\n  /*:any*/\n  ;\n  if (opts.bookSheets) delete\n  /*::(*/\n  out\n  /*:: :any)*/\n  .Sheets;\n  return out;\n}\n\nfunction parse_ods(zip\n/*:ZIPFile*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  opts = opts || {}\n  /*:any*/\n  ;\n  if (safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n  var content = getzipstr(zip, 'content.xml');\n  if (!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n  var wb = parse_content_xml(utf8read(content), opts);\n  if (safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n  return wb;\n}\n\nfunction parse_fods(data\n/*:string*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  return parse_content_xml(data, opts);\n}\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\n\n\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\n\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\n\nfunction u8concat(u8a) {\n  var len = u8a.reduce(function (acc, x) {\n    return acc + x.length;\n  }, 0);\n  var out = new Uint8Array(len);\n  var off = 0;\n  u8a.forEach(function (u8) {\n    out.set(u8, off);\n    off += u8.length;\n  });\n  return out;\n}\n\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\n\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n\n  for (var j = offset + 13; j >= offset; --j) {\n    mantissa = mantissa * 256 + buf[j];\n  }\n\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\n\nfunction parse_varint49(buf, ptr) {\n  var l = ptr ? ptr[0] : 0;\n  var usz = buf[l] & 127;\n\n  varint: if (buf[l++] >= 128) {\n    usz |= (buf[l] & 127) << 7;\n    if (buf[l++] < 128) break varint;\n    usz |= (buf[l] & 127) << 14;\n    if (buf[l++] < 128) break varint;\n    usz |= (buf[l] & 127) << 21;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 28);\n    ++l;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 35);\n    ++l;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 42);\n    ++l;\n    if (buf[l++] < 128) break varint;\n  }\n\n  if (ptr) ptr[0] = l;\n  return usz;\n}\n\nfunction varint_to_i32(buf) {\n  var l = 0,\n      i32 = buf[l] & 127;\n\n  varint: if (buf[l++] >= 128) {\n    i32 |= (buf[l] & 127) << 7;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 14;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 21;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 28;\n  }\n\n  return i32;\n}\n\nfunction parse_shallow(buf) {\n  var out = [],\n      ptr = [0];\n\n  while (ptr[0] < buf.length) {\n    var off = ptr[0];\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = Math.floor(num / 8);\n    var len = 0;\n    var res;\n    if (num == 0) break;\n\n    switch (type) {\n      case 0:\n        {\n          var l = ptr[0];\n\n          while (buf[ptr[0]++] >= 128) {\n            ;\n          }\n\n          res = buf.slice(l, ptr[0]);\n        }\n        break;\n\n      case 5:\n        len = 4;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 1:\n        len = 8;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 2:\n        len = parse_varint49(buf, ptr);\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 3:\n      case 4:\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n\n    var v = {\n      data: res,\n      type: type\n    };\n    if (out[num] == null) out[num] = [v];else out[num].push(v);\n  }\n\n  return out;\n}\n\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function (d) {\n    return cb(d.data);\n  })) || [];\n}\n\nfunction parse_iwa_file(buf) {\n  var _a;\n\n  var out = [],\n      ptr = [0];\n\n  while (ptr[0] < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));\n    ptr[0] += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function (b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf.slice(ptr[0], ptr[0] + fl)\n      });\n      ptr[0] += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0]) res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n\n  return out;\n}\n\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0) throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = [0];\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n\n  while (ptr[0] < buf.length) {\n    var tag = buf[ptr[0]] & 3;\n\n    if (tag == 0) {\n      var len = buf[ptr[0]++] >> 2;\n      if (len < 60) ++len;else {\n        var c = len - 59;\n        len = buf[ptr[0]];\n        if (c > 1) len |= buf[ptr[0] + 1] << 8;\n        if (c > 2) len |= buf[ptr[0] + 2] << 16;\n        if (c > 3) len |= buf[ptr[0] + 3] << 24;\n        len >>>= 0;\n        len++;\n        ptr[0] += c;\n      }\n      chunks.push(buf.slice(ptr[0], ptr[0] + len));\n      ptr[0] += len;\n      continue;\n    } else {\n      var offset = 0,\n          length = 0;\n\n      if (tag == 1) {\n        length = (buf[ptr[0]] >> 2 & 7) + 4;\n        offset = (buf[ptr[0]++] & 224) << 3;\n        offset |= buf[ptr[0]++];\n      } else {\n        length = (buf[ptr[0]++] >> 2) + 1;\n\n        if (tag == 2) {\n          offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;\n          ptr[0] += 2;\n        } else {\n          offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;\n          ptr[0] += 4;\n        }\n      }\n\n      chunks = [u8concat(chunks)];\n      if (offset == 0) throw new Error(\"Invalid offset 0\");\n      if (offset > chunks[0].length) throw new Error(\"Invalid offset beyond length\");\n\n      if (length >= offset) {\n        chunks.push(chunks[0].slice(-offset));\n        length -= offset;\n\n        while (length >= chunks[chunks.length - 1].length) {\n          chunks.push(chunks[chunks.length - 1]);\n          length -= chunks[chunks.length - 1].length;\n        }\n      }\n\n      chunks.push(chunks[0].slice(-offset, -offset + length));\n    }\n  }\n\n  var o = u8concat(chunks);\n  if (o.length != usz) throw new Error(\"Unexpected length: \".concat(o.length, \" != \").concat(usz));\n  return o;\n}\n\nfunction decompress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));\n    l += len;\n  }\n\n  if (l !== buf.length) throw new Error(\"data is not a valid framed stream!\");\n  return u8concat(out);\n}\n\nfunction parse_old_storage(buf, sst, rsst, v) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var data_offset = (v > 1 ? 12 : 8) + popcnt(flags & (v > 1 ? 3470 : 398)) * 4;\n  var ridx = -1,\n      sidx = -1,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n\n  if (flags & 512) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  data_offset += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n\n  if (flags & 16) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  if (flags & 32) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n\n  var ret;\n\n  switch (buf[2]) {\n    case 0:\n      break;\n\n    case 2:\n      ret = {\n        t: \"n\",\n        v: ieee\n      };\n      break;\n\n    case 3:\n      ret = {\n        t: \"s\",\n        v: sst[sidx]\n      };\n      break;\n\n    case 5:\n      ret = {\n        t: \"d\",\n        v: dt\n      };\n      break;\n\n    case 6:\n      ret = {\n        t: \"b\",\n        v: ieee > 0\n      };\n      break;\n\n    case 7:\n      ret = {\n        t: \"n\",\n        v: ieee / 86400\n      };\n      break;\n\n    case 8:\n      ret = {\n        t: \"e\",\n        v: 0\n      };\n      break;\n\n    case 9:\n      {\n        if (ridx > -1) ret = {\n          t: \"s\",\n          v: rsst[ridx]\n        };else if (sidx > -1) ret = {\n          t: \"s\",\n          v: sst[sidx]\n        };else if (!isNaN(ieee)) ret = {\n          t: \"n\",\n          v: ieee\n        };else throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n      }\n      break;\n\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n  }\n\n  return ret;\n}\n\nfunction parse_new_storage(buf, sst, rsst) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(8, true);\n  var data_offset = 12;\n  var ridx = -1,\n      sidx = -1,\n      d128 = NaN,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n\n  if (flags & 1) {\n    d128 = readDecimal128LE(buf, data_offset);\n    data_offset += 16;\n  }\n\n  if (flags & 2) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n\n  if (flags & 4) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n\n  if (flags & 8) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  if (flags & 16) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  var ret;\n\n  switch (buf[1]) {\n    case 0:\n      break;\n\n    case 2:\n      ret = {\n        t: \"n\",\n        v: d128\n      };\n      break;\n\n    case 3:\n      ret = {\n        t: \"s\",\n        v: sst[sidx]\n      };\n      break;\n\n    case 5:\n      ret = {\n        t: \"d\",\n        v: dt\n      };\n      break;\n\n    case 6:\n      ret = {\n        t: \"b\",\n        v: ieee > 0\n      };\n      break;\n\n    case 7:\n      ret = {\n        t: \"n\",\n        v: ieee / 86400\n      };\n      break;\n\n    case 8:\n      ret = {\n        t: \"e\",\n        v: 0\n      };\n      break;\n\n    case 9:\n      {\n        if (ridx > -1) ret = {\n          t: \"s\",\n          v: rsst[ridx]\n        };else throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n      }\n      break;\n\n    case 10:\n      ret = {\n        t: \"n\",\n        v: d128\n      };\n      break;\n\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n  }\n\n  return ret;\n}\n\nfunction parse_cell_storage(buf, sst, rsst) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n      return parse_old_storage(buf, sst, rsst, buf[0]);\n\n    case 5:\n      return parse_new_storage(buf, sst, rsst);\n\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\n\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return parse_varint49(pb[1][0].data);\n}\n\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function (entry) {\n    var le = parse_shallow(entry.data);\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001) throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          data[key] = tswpsa[3].map(function (x) {\n            return u8str(x.data);\n          }).join(\"\");\n        }\n        break;\n    }\n  });\n  return data;\n}\n\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535) offsets.push([C, off]);\n  }\n\n  if (offsets.length != cnt) throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n\n  for (C = 0; C < offsets.length - 1; ++C) {\n    cells[offsets[C][0]] = used_storage.subarray(offsets[C][1] * width, offsets[C + 1][1] * width);\n  }\n\n  if (offsets.length >= 1) cells[offsets[offsets.length - 1][0]] = used_storage.subarray(offsets[offsets.length - 1][1] * width);\n  return {\n    R: R,\n    cells: cells\n  };\n}\n\nfunction parse_TST_Tile(M, root) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var storage = ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) ? varint_to_i32(pb[7][0].data) >>> 0 > 0 ? 1 : 0 : -1;\n  var ri = mappa(pb[5], function (u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function (acc, x) {\n      if (!acc[x.R]) acc[x.R] = [];\n      x.cells.forEach(function (cell, C) {\n        if (acc[x.R][C]) throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\n\nfunction parse_TST_TableModelArchive(M, root, ws) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var range = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0) throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0) throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var store = parse_shallow(pb[4][0].data);\n  var sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  var rsst = ((_a = store[17]) == null ? void 0 : _a[0]) ? parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]) : [];\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  tile[1].forEach(function (t) {\n    var tl = parse_shallow(t.data);\n    var ref = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6002) throw new Error(\"6001 unexpected reference to \".concat(mtype));\n\n    var _tile = parse_TST_Tile(M, ref);\n\n    _tile.data.forEach(function (row, R) {\n      row.forEach(function (buf, C) {\n        var addr = encode_cell({\n          r: _R + R,\n          c: C\n        });\n        var res = parse_cell_storage(buf, sst, rsst);\n        if (res) ws[addr] = res;\n      });\n    });\n\n    _R += _tile.nrows;\n  });\n}\n\nfunction parse_TST_TableInfoArchive(M, root) {\n  var pb = parse_shallow(root.data);\n  var out = {\n    \"!ref\": \"A1\"\n  };\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001) throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out);\n  return out;\n}\n\nfunction parse_TN_SheetArchive(M, root) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function (off) {\n    M[off].forEach(function (m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3) out.sheets.push(parse_TST_TableInfoArchive(M, m));\n    });\n  });\n  return out;\n}\n\nfunction parse_TN_DocumentArchive(M, root) {\n  var out = book_new();\n  var pb = parse_shallow(root.data);\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function (off) {\n    M[off].forEach(function (m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m);\n        root2.sheets.forEach(function (sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0) throw new Error(\"Empty NUMBERS file\");\n  return out;\n}\n\nfunction parse_numbers_iwa(cfb) {\n  var _a, _b, _c, _d;\n\n  var M = {},\n      indices = [];\n  cfb.FullPaths.forEach(function (p) {\n    if (p.match(/\\.iwpv2/)) throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function (s) {\n    if (!s.name.match(/\\.iwa$/)) return;\n    var o;\n\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n\n    var packets;\n\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n\n    packets.forEach(function (packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length) throw new Error(\"File has no messages\");\n  var docroot = ((_d = (_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.meta) == null ? void 0 : _c[1]) == null ? void 0 : _d[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot) indices.forEach(function (idx) {\n    M[idx].forEach(function (iwam) {\n      var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n\n      if (mtype == 1) {\n        if (!docroot) docroot = iwam;else throw new Error(\"Document has multiple roots\");\n      }\n    });\n  });\n  if (!docroot) throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot);\n}\n\nfunction fix_opts_func(defaults\n/*:Array<Array<any> >*/\n)\n/*:{(o:any):void}*/\n{\n  return function fix_opts(opts) {\n    for (var i = 0; i != defaults.length; ++i) {\n      var d = defaults[i];\n      if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n      if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n    }\n  };\n}\n\nfunction fix_read_opts(opts) {\n  fix_opts_func([['cellNF', false],\n  /* emit cell number format string as .z */\n  ['cellHTML', true],\n  /* emit html string as .h */\n  ['cellFormula', true],\n  /* emit formulae as .f */\n  ['cellStyles', false],\n  /* emits style/theme as .s */\n  ['cellText', true],\n  /* emit formatted text as .w */\n  ['cellDates', false],\n  /* emit date cells with type `d` */\n  ['sheetStubs', false],\n  /* emit empty cells */\n  ['sheetRows', 0, 'n'],\n  /* read n rows (0 = read all rows) */\n  ['bookDeps', false],\n  /* parse calculation chains */\n  ['bookSheets', false],\n  /* only try to get sheet names (no Sheets) */\n  ['bookProps', false],\n  /* only try to get properties (no Sheets) */\n  ['bookFiles', false],\n  /* include raw file structure (keys, files, cfb) */\n  ['bookVBA', false],\n  /* include vba raw data (vbaraw) */\n  ['password', ''],\n  /* password */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ])(opts);\n}\n\nfunction get_sheet_type(n\n/*:string*/\n)\n/*:string*/\n{\n  if (RELS.WS.indexOf(n) > -1) return \"sheet\";\n  if (n == RELS.CS) return \"chart\";\n  if (n == RELS.DS) return \"dialog\";\n  if (n == RELS.MS) return \"macro\";\n  return n && n.length ? n : \"sheet\";\n}\n\nfunction safe_parse_wbrels(wbrels, sheets) {\n  if (!wbrels) return 0;\n\n  try {\n    wbrels = sheets.map(function pwbr(w) {\n      if (!w.id) w.id = w.strRelID;\n      return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)];\n    });\n  } catch (e) {\n    return null;\n  }\n\n  return !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction safe_parse_sheet(zip, path\n/*:string*/\n, relsPath\n/*:string*/\n, sheet, idx\n/*:number*/\n, sheetRels, sheets, stype\n/*:string*/\n, opts, wb, themes, styles) {\n  try {\n    sheetRels[sheet] = parse_rels(getzipstr(zip, relsPath, true), path);\n    var data = getzipdata(zip, path);\n\n    var _ws;\n\n    switch (stype) {\n      case 'sheet':\n        _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      case 'chart':\n        _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        if (!_ws || !_ws['!drawel']) break;\n        var dfile = resolve_path(_ws['!drawel'].Target, path);\n        var drelsp = get_rels_path(dfile);\n        var draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n        var chartp = resolve_path(draw, dfile);\n        var crelsp = get_rels_path(chartp);\n        _ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n        break;\n\n      case 'macro':\n        _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      case 'dialog':\n        _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      default:\n        throw new Error(\"Unrecognized sheet type \" + stype);\n    }\n\n    sheets[sheet] = _ws;\n    /* scan rels for comments and threaded comments */\n\n    var tcomments = [];\n    if (sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function (n) {\n      var dfile = \"\";\n\n      if (sheetRels[sheet][n].Type == RELS.CMNT) {\n        dfile = resolve_path(sheetRels[sheet][n].Target, path);\n        var comments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n        if (!comments || !comments.length) return;\n        sheet_insert_comments(_ws, comments, false);\n      }\n\n      if (sheetRels[sheet][n].Type == RELS.TCMNT) {\n        dfile = resolve_path(sheetRels[sheet][n].Target, path);\n        tcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n      }\n    });\n    if (tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n}\n\nfunction strip_front_slash(x\n/*:string*/\n)\n/*:string*/\n{\n  return x.charAt(0) == '/' ? x.slice(1) : x;\n}\n\nfunction parse_zip(zip\n/*:ZIP*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  make_ssf();\n  opts = opts || {};\n  fix_read_opts(opts);\n  /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\n  if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n  /* UOC */\n\n  if (safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n  /* Numbers */\n\n  if (safegetzipfile(zip, 'Index/Document.iwa')) {\n    if (typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\n    if (typeof parse_numbers_iwa != \"undefined\") {\n      if (zip.FileIndex) return parse_numbers_iwa(zip);\n\n      var _zip = CFB.utils.cfb_new();\n\n      zipentries(zip).forEach(function (e) {\n        zip_add_file(_zip, e, getzipbin(zip, e));\n      });\n      return parse_numbers_iwa(_zip);\n    }\n\n    throw new Error('Unsupported NUMBERS file');\n  }\n\n  if (!safegetzipfile(zip, '[Content_Types].xml')) {\n    if (safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n    if (safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n    throw new Error('Unsupported ZIP file');\n  }\n\n  var entries = zipentries(zip);\n  var dir = parse_ct(getzipstr(zip, '[Content_Types].xml')\n  /*:?any*/\n  );\n  var xlsb = false;\n  var sheets, binname;\n\n  if (dir.workbooks.length === 0) {\n    binname = \"xl/workbook.xml\";\n    if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n  }\n\n  if (dir.workbooks.length === 0) {\n    binname = \"xl/workbook.bin\";\n    if (!getzipdata(zip, binname, true)) throw new Error(\"Could not find workbook\");\n    dir.workbooks.push(binname);\n    xlsb = true;\n  }\n\n  if (dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n  var themes = {}\n  /*:any*/\n  ;\n  var styles = {}\n  /*:any*/\n  ;\n\n  if (!opts.bookSheets && !opts.bookProps) {\n    strs = [];\n    if (dir.sst) try {\n      strs = parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//, ''), true) || \"\", dir.themes[0], opts);\n    if (dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n  }\n  /*var externbooks = */\n\n\n  dir.links.map(function (link) {\n    try {\n      var rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n      return parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n    } catch (e) {}\n  });\n  var wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n  var props = {},\n      propdata = \"\";\n\n  if (dir.coreprops.length) {\n    propdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n    if (propdata) props = parse_core_props(propdata);\n\n    if (dir.extprops.length !== 0) {\n      propdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n      if (propdata) parse_ext_props(propdata, props, opts);\n    }\n  }\n\n  var custprops = {};\n\n  if (!opts.bookSheets || opts.bookProps) {\n    if (dir.custprops.length !== 0) {\n      propdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n      if (propdata) custprops = parse_cust_props(propdata, opts);\n    }\n  }\n\n  var out = {}\n  /*:any*/\n  ;\n\n  if (opts.bookSheets || opts.bookProps) {\n    if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) {\n      return x.name;\n    });else if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;\n\n    if (opts.bookProps) {\n      out.Props = props;\n      out.Custprops = custprops;\n    }\n\n    if (opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n    if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n  }\n\n  sheets = {};\n  var deps = {};\n  if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)), dir.calcchain);\n  var i = 0;\n  var sheetRels = {}\n  /*:any*/\n  ;\n  var path, relsPath;\n  {\n    var wbsheets = wb.Sheets;\n    props.Worksheets = wbsheets.length;\n    props.SheetNames = [];\n\n    for (var j = 0; j != wbsheets.length; ++j) {\n      props.SheetNames[j] = wbsheets[j].name;\n    }\n  }\n  var wbext = xlsb ? \"bin\" : \"xml\";\n  var wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n  var wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi + 1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi + 1) + \".rels\").replace(/^\\//, \"\");\n  if (!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n  var wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n  if ((dir.metadata || []).length >= 1) {\n    /* TODO: MDX and other types of metadata */\n    opts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])), dir.metadata[0], opts);\n  }\n\n  if ((dir.people || []).length >= 1) {\n    opts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])), opts);\n  }\n\n  if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n  /* Numbers iOS hack */\n\n  var nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n\n  wsloop: for (i = 0; i != props.Worksheets; ++i) {\n    var stype = \"sheet\";\n\n    if (wbrels && wbrels[i]) {\n      path = 'xl/' + wbrels[i][1].replace(/[\\/]?xl\\//, \"\");\n      if (!safegetzipfile(zip, path)) path = wbrels[i][1];\n      if (!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/, \"\") + wbrels[i][1];\n      stype = wbrels[i][2];\n    } else {\n      path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\n      path = path.replace(/sheet0\\./, \"sheet.\");\n    }\n\n    relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n    if (opts && opts.sheets != null) switch (typeof opts.sheets) {\n      case \"number\":\n        if (i != opts.sheets) continue wsloop;\n        break;\n\n      case \"string\":\n        if (props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop;\n        break;\n\n      default:\n        if (Array.isArray && Array.isArray(opts.sheets)) {\n          var snjseen = false;\n\n          for (var snj = 0; snj != opts.sheets.length; ++snj) {\n            if (typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen = 1;\n            if (typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n          }\n\n          if (!snjseen) continue wsloop;\n        }\n\n    }\n    safe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n  }\n\n  out = {\n    Directory: dir,\n    Workbook: wb,\n    Props: props,\n    Custprops: custprops,\n    Deps: deps,\n    Sheets: sheets,\n    SheetNames: props.SheetNames,\n    Strings: strs,\n    Styles: styles,\n    Themes: themes,\n    SSF: dup(table_fmt)\n  }\n  /*:any*/\n  ;\n\n  if (opts && opts.bookFiles) {\n    if (zip.files) {\n      out.keys = entries;\n      out.files = zip.files;\n    } else {\n      out.keys = [];\n      out.files = {};\n      zip.FullPaths.forEach(function (p, idx) {\n        p = p.replace(/^Root Entry[\\/]/, \"\");\n        out.keys.push(p);\n        out.files[p] = zip.FileIndex[idx];\n      });\n    }\n  }\n\n  if (opts && opts.bookVBA) {\n    if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, strip_front_slash(dir.vba[0]), true);else if (dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\n  }\n\n  return out;\n}\n/* [MS-OFFCRYPTO] 2.1.1 */\n\n\nfunction parse_xlsxcfb(cfb, _opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  var f = 'Workbook',\n      data = CFB.find(cfb, f);\n\n  try {\n    f = '/!DataSpaces/Version';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    /*var version = */\n\n    parse_DataSpaceVersionInfo(data.content);\n    /* 2.3.4.1 */\n\n    f = '/!DataSpaces/DataSpaceMap';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    var dsm = parse_DataSpaceMap(data.content);\n    if (dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n    /* 2.3.4.2 */\n\n    f = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    var seds = parse_DataSpaceDefinition(data.content);\n    if (seds.length != 1 || seds[0] != \"StrongEncryptionTransform\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n    /* 2.3.4.3 */\n\n    f = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    /*var hdr = */\n\n    parse_Primary(data.content);\n  } catch (e) {}\n\n  f = '/EncryptionInfo';\n  data = CFB.find(cfb, f);\n  if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n  var einfo = parse_EncryptionInfo(data.content);\n  /* 2.3.4.4 */\n\n  f = '/EncryptedPackage';\n  data = CFB.find(cfb, f);\n  if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n  /*global decrypt_agile */\n\n  /*:: declare var decrypt_agile:any; */\n\n  if (einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n  /*global decrypt_std76 */\n\n  /*:: declare var decrypt_std76:any; */\n\n  if (einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n  throw new Error(\"File is password-protected\");\n}\n\nfunction firstbyte(f\n/*:RawData*/\n, o\n/*:?TypeOpts*/\n)\n/*:Array<number>*/\n{\n  var x = \"\";\n\n  switch ((o || {}).type || \"base64\") {\n    case 'buffer':\n      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\n    case 'base64':\n      x = Base64_decode(f.slice(0, 12));\n      break;\n\n    case 'binary':\n      x = f;\n      break;\n\n    case 'array':\n      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\n    default:\n      throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n  }\n\n  return [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb\n/*:CFBContainer*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  if (CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n  return parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data\n/*:RawData*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  var zip,\n      d = data;\n  var o = opts || {};\n  if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n  zip = zip_read(d, o);\n  return parse_zip(zip, o);\n}\n\nfunction read_plaintext(data\n/*:string*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var i = 0;\n\n  main: while (i < data.length) {\n    switch (data.charCodeAt(i)) {\n      case 0x0A:\n      case 0x0D:\n      case 0x20:\n        ++i;\n        break;\n\n      case 0x3C:\n        return parse_xlml(data.slice(i), o);\n\n      default:\n        break main;\n    }\n  }\n\n  return PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data\n/*:RawData*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var str = \"\",\n      bytes = firstbyte(data, o);\n\n  switch (o.type) {\n    case 'base64':\n      str = Base64_decode(data);\n      break;\n\n    case 'binary':\n      str = data;\n      break;\n\n    case 'buffer':\n      str = data.toString('binary');\n      break;\n\n    case 'array':\n      str = cc2str(data);\n      break;\n\n    default:\n      throw new Error(\"Unrecognized type \" + o.type);\n  }\n\n  if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n  o.type = \"binary\";\n  return read_plaintext(str, o);\n}\n\nfunction read_utf16(data\n/*:RawData*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var d = data;\n  if (o.type == 'base64') d = Base64_decode(d);\n  d = $cptable.utils.decode(1200, d.slice(2), 'str');\n  o.type = \"binary\";\n  return read_plaintext(d, o);\n}\n\nfunction bstrify(data\n/*:string*/\n)\n/*:string*/\n{\n  return !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n  if (str) {\n    o.type = \"string\";\n    return PRN.to_workbook(data, o);\n  }\n\n  return PRN.to_workbook(d, o);\n}\n\nfunction readSync(data\n/*:RawData*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  reset_cp();\n  var o = opts || {};\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n  if (typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n  var d = data,\n      n = [0, 0, 0, 0],\n      str = false;\n\n  if (o.cellStyles) {\n    o.cellNF = true;\n    o.sheetStubs = true;\n  }\n\n  _ssfopts = {};\n  if (o.dateNF) _ssfopts.dateNF = o.dateNF;\n  if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n  if (o.type == \"file\") {\n    o.type = has_buf ? \"buffer\" : \"binary\";\n    d = read_binary(data);\n    if (typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\";\n  }\n\n  if (o.type == \"string\") {\n    str = true;\n    o.type = \"binary\";\n    o.codepage = 65001;\n    d = bstrify(data);\n  }\n\n  if (o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n    // $FlowIgnore\n    var ab = new ArrayBuffer(3),\n        vu = new Uint8Array(ab);\n    vu.foo = \"bar\"; // $FlowIgnore\n\n    if (!vu.foo) {\n      o = dup(o);\n      o.type = 'array';\n      return readSync(ab2a(d), o);\n    }\n  }\n\n  switch ((n = firstbyte(d, o))[0]) {\n    case 0xD0:\n      if (n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o);\n      break;\n\n    case 0x09:\n      if (n[1] <= 0x08) return parse_xlscfb(d, o);\n      break;\n\n    case 0x3C:\n      return parse_xlml(d, o);\n\n    case 0x49:\n      if (n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n      if (n[1] === 0x44) return read_wb_ID(d, o);\n      break;\n\n    case 0x54:\n      if (n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o);\n      break;\n\n    case 0x50:\n      return n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09 ? read_zip(d, o) : read_prn(data, d, o, str);\n\n    case 0xEF:\n      return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\n    case 0xFF:\n      if (n[1] === 0xFE) {\n        return read_utf16(d, o);\n      } else if (n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\n      break;\n\n    case 0x00:\n      if (n[1] === 0x00) {\n        if (n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n        if (n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n      }\n\n      break;\n\n    case 0x03:\n    case 0x83:\n    case 0x8B:\n    case 0x8C:\n      return DBF.to_workbook(d, o);\n\n    case 0x7B:\n      if (n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o);\n      break;\n\n    case 0x0A:\n    case 0x0D:\n    case 0x20:\n      return read_plaintext_raw(d, o);\n\n    case 0x89:\n      if (n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\");\n      break;\n  }\n\n  if (DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n  return read_prn(data, d, o, str);\n}\n/*::\ntype MJRObject = {\n\trow: any;\n\tisempty: boolean;\n};\n*/\n\n\nfunction make_json_row(sheet\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, cols\n/*:Array<string>*/\n, header\n/*:number*/\n, hdr\n/*:Array<any>*/\n, dense\n/*:boolean*/\n, o\n/*:Sheet2JSONOpts*/\n)\n/*:MJRObject*/\n{\n  var rr = encode_row(R);\n  var defval = o.defval,\n      raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n  var isempty = true;\n  var row\n  /*:any*/\n  = header === 1 ? [] : {};\n\n  if (header !== 1) {\n    if (Object.defineProperty) try {\n      Object.defineProperty(row, '__rowNum__', {\n        value: R,\n        enumerable: false\n      });\n    } catch (e) {\n      row.__rowNum__ = R;\n    } else row.__rowNum__ = R;\n  }\n\n  if (!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n    var val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\n    if (val === undefined || val.t === undefined) {\n      if (defval === undefined) continue;\n\n      if (hdr[C] != null) {\n        row[hdr[C]] = defval;\n      }\n\n      continue;\n    }\n\n    var v = val.v;\n\n    switch (val.t) {\n      case 'z':\n        if (v == null) break;\n        continue;\n\n      case 'e':\n        v = v == 0 ? null : void 0;\n        break;\n\n      case 's':\n      case 'd':\n      case 'b':\n      case 'n':\n        break;\n\n      default:\n        throw new Error('unrecognized type ' + val.t);\n    }\n\n    if (hdr[C] != null) {\n      if (v == null) {\n        if (val.t == \"e\" && v === null) row[hdr[C]] = null;else if (defval !== undefined) row[hdr[C]] = defval;else if (raw && v === null) row[hdr[C]] = null;else continue;\n      } else {\n        row[hdr[C]] = raw && (val.t !== \"n\" || val.t === \"n\" && o.rawNumbers !== false) ? v : format_cell(val, v, o);\n      }\n\n      if (v != null) isempty = false;\n    }\n  }\n  return {\n    row: row,\n    isempty: isempty\n  };\n}\n\nfunction sheet_to_json(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2JSONOpts*/\n) {\n  if (sheet == null || sheet[\"!ref\"] == null) return [];\n  var val = {\n    t: 'n',\n    v: 0\n  },\n      header = 0,\n      offset = 1,\n      hdr\n  /*:Array<any>*/\n  = [],\n      v = 0,\n      vv = \"\";\n  var r = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var o = opts || {};\n  var range = o.range != null ? o.range : sheet[\"!ref\"];\n  if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;else if (o.header == null) header = 0;\n\n  switch (typeof range) {\n    case 'string':\n      r = safe_decode_range(range);\n      break;\n\n    case 'number':\n      r = safe_decode_range(sheet[\"!ref\"]);\n      r.s.r = range;\n      break;\n\n    default:\n      r = range;\n  }\n\n  if (header > 0) offset = 0;\n  var rr = encode_row(r.s.r);\n  var cols\n  /*:Array<string>*/\n  = [];\n  var out\n  /*:Array<any>*/\n  = [];\n  var outi = 0,\n      counter = 0;\n  var dense = Array.isArray(sheet);\n  var R = r.s.r,\n      C = 0;\n  var header_cnt = {};\n  if (dense && !sheet[R]) sheet[R] = [];\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (C = r.s.c; C <= r.e.c; ++C) {\n    if ((colinfo[C] || {}).hidden) continue;\n    cols[C] = encode_col(C);\n    val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\n    switch (header) {\n      case 1:\n        hdr[C] = C - r.s.c;\n        break;\n\n      case 2:\n        hdr[C] = cols[C];\n        break;\n\n      case 3:\n        hdr[C] = o.header[C - r.s.c];\n        break;\n\n      default:\n        if (val == null) val = {\n          w: \"__EMPTY\",\n          t: \"s\"\n        };\n        vv = v = format_cell(val, null, o);\n        counter = header_cnt[v] || 0;\n        if (!counter) header_cnt[v] = 1;else {\n          do {\n            vv = v + \"_\" + counter++;\n          } while (header_cnt[vv]);\n\n          header_cnt[v] = counter;\n          header_cnt[vv] = 1;\n        }\n        hdr[C] = vv;\n    }\n  }\n\n  for (R = r.s.r + offset; R <= r.e.r; ++R) {\n    if ((rowinfo[R] || {}).hidden) continue;\n    var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n    if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n  }\n\n  out.length = outi;\n  return out;\n}\n\nvar qreg = /\"/g;\n\nfunction make_csv_row(sheet\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, cols\n/*:Array<string>*/\n, fs\n/*:number*/\n, rs\n/*:number*/\n, FS\n/*:string*/\n, o\n/*:Sheet2CSVOpts*/\n)\n/*:?string*/\n{\n  var isempty = true;\n  var row\n  /*:Array<string>*/\n  = [],\n      txt = \"\",\n      rr = encode_row(R);\n\n  for (var C = r.s.c; C <= r.e.c; ++C) {\n    if (!cols[C]) continue;\n    var val = o.dense ? (sheet[R] || [])[C] : sheet[cols[C] + rr];\n    if (val == null) txt = \"\";else if (val.v != null) {\n      isempty = false;\n      txt = '' + (o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\n      for (var i = 0, cc = 0; i !== txt.length; ++i) {\n        if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {\n          txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n          break;\n        }\n      }\n\n      if (txt == \"ID\") txt = '\"ID\"';\n    } else if (val.f != null && !val.F) {\n      isempty = false;\n      txt = '=' + val.f;\n      if (txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n    } else txt = \"\";\n    /* NOTE: Excel CSV does not support array formulae */\n\n    row.push(txt);\n  }\n\n  if (o.blankrows === false && isempty) return null;\n  return row.join(FS);\n}\n\nfunction sheet_to_csv(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  var o = opts == null ? {} : opts;\n  if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n  var r = safe_decode_range(sheet[\"!ref\"]);\n  var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n  var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n  var endregex = new RegExp((FS == \"|\" ? \"\\\\|\" : FS) + \"+$\");\n  var row = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n  o.dense = Array.isArray(sheet);\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (var C = r.s.c; C <= r.e.c; ++C) {\n    if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);\n  }\n\n  var w = 0;\n\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    if ((rowinfo[R] || {}).hidden) continue;\n    row = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n\n    if (row == null) {\n      continue;\n    }\n\n    if (o.strip) row = row.replace(endregex, \"\");\n    if (row || o.blankrows !== false) out.push((w++ ? RS : \"\") + row);\n  }\n\n  delete o.dense;\n  return out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n) {\n  if (!opts) opts = {};\n  opts.FS = \"\\t\";\n  opts.RS = \"\\n\";\n  var s = sheet_to_csv(sheet, opts);\n  return s;\n}\n\nfunction sheet_to_formulae(sheet\n/*:Worksheet*/\n)\n/*:Array<string>*/\n{\n  var y = \"\",\n      x,\n      val = \"\";\n  if (sheet == null || sheet[\"!ref\"] == null) return [];\n  var r = safe_decode_range(sheet['!ref']),\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [],\n      C;\n  var cmds\n  /*:Array<string>*/\n  = [];\n  var dense = Array.isArray(sheet);\n\n  for (C = r.s.c; C <= r.e.c; ++C) {\n    cols[C] = encode_col(C);\n  }\n\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    rr = encode_row(R);\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      y = cols[C] + rr;\n      x = dense ? (sheet[R] || [])[C] : sheet[y];\n      val = \"\";\n      if (x === undefined) continue;else if (x.F != null) {\n        y = x.F;\n        if (!x.f) continue;\n        val = x.f;\n        if (y.indexOf(\":\") == -1) y = y + \":\" + y;\n      }\n      if (x.f != null) val = x.f;else if (x.t == 'z') continue;else if (x.t == 'n' && x.v != null) val = \"\" + x.v;else if (x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else if (x.t == 's') val = \"'\" + x.v;else val = \"\" + x.v;\n      cmds[cmds.length] = y + \"=\" + val;\n    }\n  }\n\n  return cmds;\n}\n\nfunction sheet_add_json(_ws\n/*:?Worksheet*/\n, js\n/*:Array<any>*/\n, opts)\n/*:Worksheet*/\n{\n  var o = opts || {};\n  var offset = +!o.skipHeader;\n  var ws\n  /*:Worksheet*/\n  = _ws || {}\n  /*:any*/\n  ;\n  var _R = 0,\n      _C = 0;\n\n  if (ws && o.origin != null) {\n    if (typeof o.origin == 'number') _R = o.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\n      _R = _origin.r;\n      _C = _origin.c;\n    }\n  }\n\n  var cell\n  /*:Cell*/\n  ;\n  var range\n  /*:Range*/\n  = {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: _C,\n      r: _R + js.length - 1 + offset\n    }\n  }\n  /*:any*/\n  ;\n\n  if (ws['!ref']) {\n    var _range = safe_decode_range(ws['!ref']);\n\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n\n    if (_R == -1) {\n      _R = _range.e.r + 1;\n      range.e.r = _R + js.length - 1 + offset;\n    }\n  } else {\n    if (_R == -1) {\n      _R = 0;\n      range.e.r = js.length - 1 + offset;\n    }\n  }\n\n  var hdr\n  /*:Array<string>*/\n  = o.header || [],\n      C = 0;\n  js.forEach(function (JS, R\n  /*:number*/\n  ) {\n    keys(JS).forEach(function (k) {\n      if ((C = hdr.indexOf(k)) == -1) hdr[C = hdr.length] = k;\n      var v = JS[k];\n      var t = 'z';\n      var z = \"\";\n      var ref = encode_cell({\n        c: _C + C,\n        r: _R + R + offset\n      });\n      cell = ws_get_cell_stub(ws, ref);\n\n      if (v && typeof v === 'object' && !(v instanceof Date)) {\n        ws[ref] = v;\n      } else {\n        if (typeof v == 'number') t = 'n';else if (typeof v == 'boolean') t = 'b';else if (typeof v == 'string') t = 's';else if (v instanceof Date) {\n          t = 'd';\n\n          if (!o.cellDates) {\n            t = 'n';\n            v = datenum(v);\n          }\n\n          z = o.dateNF || table_fmt[14];\n        } else if (v === null && o.nullError) {\n          t = 'e';\n          v = 0;\n        }\n        if (!cell) ws[ref] = cell = {\n          t: t,\n          v: v\n        }\n        /*:any*/\n        ;else {\n          cell.t = t;\n          cell.v = v;\n          delete cell.w;\n          delete cell.R;\n          if (z) cell.z = z;\n        }\n        if (z) cell.z = z;\n      }\n    });\n  });\n  range.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\n  var __R = encode_row(_R);\n\n  if (offset) for (C = 0; C < hdr.length; ++C) {\n    ws[encode_col(C + _C) + __R] = {\n      t: 's',\n      v: hdr[C]\n    };\n  }\n  ws['!ref'] = encode_range(range);\n  return ws;\n}\n\nfunction json_to_sheet(js\n/*:Array<any>*/\n, opts)\n/*:Worksheet*/\n{\n  return sheet_add_json(null, js, opts);\n}\n/* get cell, creating a stub if necessary */\n\n\nfunction ws_get_cell_stub(ws\n/*:Worksheet*/\n, R, C\n/*:?number*/\n)\n/*:Cell*/\n{\n  /* A1 cell address */\n  if (typeof R == \"string\") {\n    /* dense */\n    if (Array.isArray(ws)) {\n      var RC = decode_cell(R);\n      if (!ws[RC.r]) ws[RC.r] = [];\n      return ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {\n        t: 'z'\n      });\n    }\n\n    return ws[R] || (ws[R] = {\n      t: 'z'\n    });\n  }\n  /* cell address object */\n\n\n  if (typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n  /* R and C are 0-based indices */\n\n  return ws_get_cell_stub(ws, encode_cell({\n    r: R,\n    c: C || 0\n  }));\n}\n/* find sheet index for given name / validate index */\n\n\nfunction wb_sheet_idx(wb\n/*:Workbook*/\n, sh\n/*:number|string*/\n) {\n  if (typeof sh == \"number\") {\n    if (sh >= 0 && wb.SheetNames.length > sh) return sh;\n    throw new Error(\"Cannot find sheet # \" + sh);\n  } else if (typeof sh == \"string\") {\n    var idx = wb.SheetNames.indexOf(sh);\n    if (idx > -1) return idx;\n    throw new Error(\"Cannot find sheet name |\" + sh + \"|\");\n  } else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n/* simple blank workbook object */\n\n\nfunction book_new()\n/*:Workbook*/\n{\n  return {\n    SheetNames: [],\n    Sheets: {}\n  };\n}\n/* add a worksheet to the end of a given workbook */\n\n\nfunction book_append_sheet(wb\n/*:Workbook*/\n, ws\n/*:Worksheet*/\n, name\n/*:?string*/\n, roll\n/*:?boolean*/\n)\n/*:string*/\n{\n  var i = 1;\n  if (!name) for (; i <= 0xFFFF; ++i, name = undefined) {\n    if (wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n  }\n  if (!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\n  if (roll && wb.SheetNames.indexOf(name) >= 0) {\n    var m = name.match(/(^.*?)(\\d+)$/);\n    i = m && +m[2] || 0;\n    var root = m && m[1] || name;\n\n    for (++i; i <= 0xFFFF; ++i) {\n      if (wb.SheetNames.indexOf(name = root + i) == -1) break;\n    }\n  }\n\n  check_ws_name(name);\n  if (wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n  wb.SheetNames.push(name);\n  wb.Sheets[name] = ws;\n  return name;\n}\n/* set sheet visibility (visible/hidden/very hidden) */\n\n\nfunction book_set_sheet_visibility(wb\n/*:Workbook*/\n, sh\n/*:number|string*/\n, vis\n/*:number*/\n) {\n  if (!wb.Workbook) wb.Workbook = {};\n  if (!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n  var idx = wb_sheet_idx(wb, sh); // $FlowIgnore\n\n  if (!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n  switch (vis) {\n    case 0:\n    case 1:\n    case 2:\n      break;\n\n    default:\n      throw new Error(\"Bad sheet visibility setting \" + vis);\n  } // $FlowIgnore\n\n\n  wb.Workbook.Sheets[idx].Hidden = vis;\n}\n/* set number format */\n\n\nfunction cell_set_number_format(cell\n/*:Cell*/\n, fmt\n/*:string|number*/\n) {\n  cell.z = fmt;\n  return cell;\n}\n/* set cell hyperlink */\n\n\nfunction cell_set_hyperlink(cell\n/*:Cell*/\n, target\n/*:string*/\n, tooltip\n/*:?string*/\n) {\n  if (!target) {\n    delete cell.l;\n  } else {\n    cell.l = {\n      Target: target\n    }\n    /*:Hyperlink*/\n    ;\n    if (tooltip) cell.l.Tooltip = tooltip;\n  }\n\n  return cell;\n}\n\nfunction cell_set_internal_link(cell\n/*:Cell*/\n, range\n/*:string*/\n, tooltip\n/*:?string*/\n) {\n  return cell_set_hyperlink(cell, \"#\" + range, tooltip);\n}\n/* add to cell comments */\n\n\nfunction cell_add_comment(cell\n/*:Cell*/\n, text\n/*:string*/\n, author\n/*:?string*/\n) {\n  if (!cell.c) cell.c = [];\n  cell.c.push({\n    t: text,\n    a: author || \"SheetJS\"\n  });\n}\n/* set array formula and flush related cells */\n\n\nfunction sheet_set_array_formula(ws\n/*:Worksheet*/\n, range, formula\n/*:string*/\n, dynamic\n/*:boolean*/\n) {\n  var rng = typeof range != \"string\" ? range : safe_decode_range(range);\n  var rngstr = typeof range == \"string\" ? range : encode_range(range);\n\n  for (var R = rng.s.r; R <= rng.e.r; ++R) {\n    for (var C = rng.s.c; C <= rng.e.c; ++C) {\n      var cell = ws_get_cell_stub(ws, R, C);\n      cell.t = 'n';\n      cell.F = rngstr;\n      delete cell.v;\n\n      if (R == rng.s.r && C == rng.s.c) {\n        cell.f = formula;\n        if (dynamic) cell.D = true;\n      }\n    }\n  }\n\n  return ws;\n}\n\nvar utils\n/*:any*/\n= {\n  encode_col: encode_col,\n  encode_row: encode_row,\n  encode_cell: encode_cell,\n  encode_range: encode_range,\n  decode_col: decode_col,\n  decode_row: decode_row,\n  split_cell: split_cell,\n  decode_cell: decode_cell,\n  decode_range: decode_range,\n  format_cell: format_cell,\n  sheet_add_aoa: sheet_add_aoa,\n  sheet_add_json: sheet_add_json,\n  sheet_add_dom: sheet_add_dom,\n  aoa_to_sheet: aoa_to_sheet,\n  json_to_sheet: json_to_sheet,\n  table_to_sheet: parse_dom_table,\n  table_to_book: table_to_book,\n  sheet_to_csv: sheet_to_csv,\n  sheet_to_txt: sheet_to_txt,\n  sheet_to_json: sheet_to_json,\n  sheet_to_html: sheet_to_html,\n  sheet_to_formulae: sheet_to_formulae,\n  sheet_to_row_object_array: sheet_to_json,\n  sheet_get_cell: ws_get_cell_stub,\n  book_new: book_new,\n  book_append_sheet: book_append_sheet,\n  book_set_sheet_visibility: book_set_sheet_visibility,\n  cell_set_number_format: cell_set_number_format,\n  cell_set_hyperlink: cell_set_hyperlink,\n  cell_set_internal_link: cell_set_internal_link,\n  cell_add_comment: cell_add_comment,\n  sheet_set_array_formula: sheet_set_array_formula,\n  consts: {\n    SHEET_VISIBLE: 0,\n    SHEET_HIDDEN: 1,\n    SHEET_VERY_HIDDEN: 2\n  }\n};\n\nvar _castCellValueToStr = function _castCellValueToStr(cellValue) {\n  if (cellValue === null || cellValue === undefined) {\n    return '';\n  }\n\n  return '' + cellValue;\n};\n\nvar read = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(fileBlob, forceStr, emptyCols) {\n    var data, buffer, workbook, worksheetName, worksheet;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return fileBlob.arrayBuffer();\n\n          case 3:\n            buffer = _context.sent;\n            workbook = readSync(buffer);\n            worksheetName = workbook.SheetNames[0];\n            worksheet = workbook.Sheets[worksheetName];\n            data = utils.sheet_to_json(worksheet, emptyCols ? {\n              header: 1,\n              defval: ''\n            } : {\n              header: 1\n            });\n            _context.next = 13;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](0);\n            throw new Error(\"Can't parse file. Please provide a valid XLSX file.\");\n\n          case 13:\n            if (forceStr) {\n              data = data.map(function (row) {\n                return row.map(function (cell) {\n                  return _castCellValueToStr(cell);\n                });\n              });\n            }\n\n            return _context.abrupt(\"return\", data);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 10]]);\n  }));\n\n  return function read(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar XLSXUtils = {\n  read: read\n};\nvar validator$1 = {\n  exports: {}\n};\nvar toDate$1 = {\n  exports: {}\n};\nvar assertString = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = assertString;\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function assertString(input) {\n    var isString = typeof input === 'string' || input instanceof String;\n\n    if (!isString) {\n      var invalidType = _typeof(input);\n\n      if (input === null) invalidType = 'null';else if (invalidType === 'object') invalidType = input.constructor.name;\n      throw new TypeError(\"Expected a string but received a \".concat(invalidType));\n    }\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(assertString, assertString.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = toDate;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function toDate(date) {\n    (0, _assertString.default)(date);\n    date = Date.parse(date);\n    return !isNaN(date) ? new Date(date) : null;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(toDate$1, toDate$1.exports);\n\nvar toFloat = {\n  exports: {}\n};\nvar isFloat$1 = {};\nvar alpha$1 = {};\nObject.defineProperty(alpha$1, \"__esModule\", {\n  value: true\n});\nalpha$1.commaDecimal = alpha$1.dotDecimal = alpha$1.farsiLocales = alpha$1.arabicLocales = alpha$1.englishLocales = alpha$1.decimal = alpha$1.alphanumeric = alpha$1.alpha = void 0;\nvar alpha = {\n  'en-US': /^[A-Z]+$/i,\n  'az-AZ': /^[A-VXYZÇƏĞİıÖŞÜ]+$/i,\n  'bg-BG': /^[А-Я]+$/i,\n  'cs-CZ': /^[A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,\n  'da-DK': /^[A-ZÆØÅ]+$/i,\n  'de-DE': /^[A-ZÄÖÜß]+$/i,\n  'el-GR': /^[Α-ώ]+$/i,\n  'es-ES': /^[A-ZÁÉÍÑÓÚÜ]+$/i,\n  'fa-IR': /^[ابپتثجچحخدذرزژسشصضطظعغفقکگلمنوهی]+$/i,\n  'fi-FI': /^[A-ZÅÄÖ]+$/i,\n  'fr-FR': /^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,\n  'it-IT': /^[A-ZÀÉÈÌÎÓÒÙ]+$/i,\n  'nb-NO': /^[A-ZÆØÅ]+$/i,\n  'nl-NL': /^[A-ZÁÉËÏÓÖÜÚ]+$/i,\n  'nn-NO': /^[A-ZÆØÅ]+$/i,\n  'hu-HU': /^[A-ZÁÉÍÓÖŐÚÜŰ]+$/i,\n  'pl-PL': /^[A-ZĄĆĘŚŁŃÓŻŹ]+$/i,\n  'pt-PT': /^[A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i,\n  'ru-RU': /^[А-ЯЁ]+$/i,\n  'sl-SI': /^[A-ZČĆĐŠŽ]+$/i,\n  'sk-SK': /^[A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,\n  'sr-RS@latin': /^[A-ZČĆŽŠĐ]+$/i,\n  'sr-RS': /^[А-ЯЂЈЉЊЋЏ]+$/i,\n  'sv-SE': /^[A-ZÅÄÖ]+$/i,\n  'th-TH': /^[ก-๐\\s]+$/i,\n  'tr-TR': /^[A-ZÇĞİıÖŞÜ]+$/i,\n  'uk-UA': /^[А-ЩЬЮЯЄIЇҐі]+$/i,\n  'vi-VN': /^[A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i,\n  'ku-IQ': /^[ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,\n  ar: /^[ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/,\n  he: /^[א-ת]+$/,\n  fa: /^['آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی']+$/i,\n  'hi-IN': /^[\\u0900-\\u0961]+[\\u0972-\\u097F]*$/i\n};\nalpha$1.alpha = alpha;\nvar alphanumeric = {\n  'en-US': /^[0-9A-Z]+$/i,\n  'az-AZ': /^[0-9A-VXYZÇƏĞİıÖŞÜ]+$/i,\n  'bg-BG': /^[0-9А-Я]+$/i,\n  'cs-CZ': /^[0-9A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,\n  'da-DK': /^[0-9A-ZÆØÅ]+$/i,\n  'de-DE': /^[0-9A-ZÄÖÜß]+$/i,\n  'el-GR': /^[0-9Α-ω]+$/i,\n  'es-ES': /^[0-9A-ZÁÉÍÑÓÚÜ]+$/i,\n  'fi-FI': /^[0-9A-ZÅÄÖ]+$/i,\n  'fr-FR': /^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,\n  'it-IT': /^[0-9A-ZÀÉÈÌÎÓÒÙ]+$/i,\n  'hu-HU': /^[0-9A-ZÁÉÍÓÖŐÚÜŰ]+$/i,\n  'nb-NO': /^[0-9A-ZÆØÅ]+$/i,\n  'nl-NL': /^[0-9A-ZÁÉËÏÓÖÜÚ]+$/i,\n  'nn-NO': /^[0-9A-ZÆØÅ]+$/i,\n  'pl-PL': /^[0-9A-ZĄĆĘŚŁŃÓŻŹ]+$/i,\n  'pt-PT': /^[0-9A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i,\n  'ru-RU': /^[0-9А-ЯЁ]+$/i,\n  'sl-SI': /^[0-9A-ZČĆĐŠŽ]+$/i,\n  'sk-SK': /^[0-9A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,\n  'sr-RS@latin': /^[0-9A-ZČĆŽŠĐ]+$/i,\n  'sr-RS': /^[0-9А-ЯЂЈЉЊЋЏ]+$/i,\n  'sv-SE': /^[0-9A-ZÅÄÖ]+$/i,\n  'th-TH': /^[ก-๙\\s]+$/i,\n  'tr-TR': /^[0-9A-ZÇĞİıÖŞÜ]+$/i,\n  'uk-UA': /^[0-9А-ЩЬЮЯЄIЇҐі]+$/i,\n  'ku-IQ': /^[٠١٢٣٤٥٦٧٨٩0-9ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,\n  'vi-VN': /^[0-9A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i,\n  ar: /^[٠١٢٣٤٥٦٧٨٩0-9ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/,\n  he: /^[0-9א-ת]+$/,\n  fa: /^['0-9آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی۱۲۳۴۵۶۷۸۹۰']+$/i,\n  'hi-IN': /^[\\u0900-\\u0963]+[\\u0966-\\u097F]*$/i\n};\nalpha$1.alphanumeric = alphanumeric;\nvar decimal = {\n  'en-US': '.',\n  ar: '٫'\n};\nalpha$1.decimal = decimal;\nvar englishLocales = ['AU', 'GB', 'HK', 'IN', 'NZ', 'ZA', 'ZM'];\nalpha$1.englishLocales = englishLocales;\n\nfor (var locale$1, i = 0; i < englishLocales.length; i++) {\n  locale$1 = \"en-\".concat(englishLocales[i]);\n  alpha[locale$1] = alpha['en-US'];\n  alphanumeric[locale$1] = alphanumeric['en-US'];\n  decimal[locale$1] = decimal['en-US'];\n} // Source: http://www.localeplanet.com/java/\n\n\nvar arabicLocales = ['AE', 'BH', 'DZ', 'EG', 'IQ', 'JO', 'KW', 'LB', 'LY', 'MA', 'QM', 'QA', 'SA', 'SD', 'SY', 'TN', 'YE'];\nalpha$1.arabicLocales = arabicLocales;\n\nfor (var _locale, _i = 0; _i < arabicLocales.length; _i++) {\n  _locale = \"ar-\".concat(arabicLocales[_i]);\n  alpha[_locale] = alpha.ar;\n  alphanumeric[_locale] = alphanumeric.ar;\n  decimal[_locale] = decimal.ar;\n}\n\nvar farsiLocales = ['IR', 'AF'];\nalpha$1.farsiLocales = farsiLocales;\n\nfor (var _locale2, _i2 = 0; _i2 < farsiLocales.length; _i2++) {\n  _locale2 = \"fa-\".concat(farsiLocales[_i2]);\n  alphanumeric[_locale2] = alphanumeric.fa;\n  decimal[_locale2] = decimal.ar;\n} // Source: https://en.wikipedia.org/wiki/Decimal_mark\n\n\nvar dotDecimal = ['ar-EG', 'ar-LB', 'ar-LY'];\nalpha$1.dotDecimal = dotDecimal;\nvar commaDecimal = ['bg-BG', 'cs-CZ', 'da-DK', 'de-DE', 'el-GR', 'en-ZM', 'es-ES', 'fr-CA', 'fr-FR', 'id-ID', 'it-IT', 'ku-IQ', 'hi-IN', 'hu-HU', 'nb-NO', 'nn-NO', 'nl-NL', 'pl-PL', 'pt-PT', 'ru-RU', 'sl-SI', 'sr-RS@latin', 'sr-RS', 'sv-SE', 'tr-TR', 'uk-UA', 'vi-VN'];\nalpha$1.commaDecimal = commaDecimal;\n\nfor (var _i3 = 0; _i3 < dotDecimal.length; _i3++) {\n  decimal[dotDecimal[_i3]] = decimal['en-US'];\n}\n\nfor (var _i4 = 0; _i4 < commaDecimal.length; _i4++) {\n  decimal[commaDecimal[_i4]] = ',';\n}\n\nalpha['fr-CA'] = alpha['fr-FR'];\nalphanumeric['fr-CA'] = alphanumeric['fr-FR'];\nalpha['pt-BR'] = alpha['pt-PT'];\nalphanumeric['pt-BR'] = alphanumeric['pt-PT'];\ndecimal['pt-BR'] = decimal['pt-PT']; // see #862\n\nalpha['pl-Pl'] = alpha['pl-PL'];\nalphanumeric['pl-Pl'] = alphanumeric['pl-PL'];\ndecimal['pl-Pl'] = decimal['pl-PL']; // see #1455\n\nalpha['fa-AF'] = alpha.fa;\nObject.defineProperty(isFloat$1, \"__esModule\", {\n  value: true\n});\nisFloat$1.default = isFloat;\nisFloat$1.locales = void 0;\n\nvar _assertString$a = _interopRequireDefault$a(assertString.exports);\n\nvar _alpha$2 = alpha$1;\n\nfunction _interopRequireDefault$a(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction isFloat(str, options) {\n  (0, _assertString$a.default)(str);\n  options = options || {};\n  var float = new RegExp(\"^(?:[-+])?(?:[0-9]+)?(?:\\\\\".concat(options.locale ? _alpha$2.decimal[options.locale] : '.', \"[0-9]*)?(?:[eE][\\\\+\\\\-]?(?:[0-9]+))?$\"));\n\n  if (str === '' || str === '.' || str === '-' || str === '+') {\n    return false;\n  }\n\n  var value = parseFloat(str.replace(',', '.'));\n  return float.test(str) && (!options.hasOwnProperty('min') || value >= options.min) && (!options.hasOwnProperty('max') || value <= options.max) && (!options.hasOwnProperty('lt') || value < options.lt) && (!options.hasOwnProperty('gt') || value > options.gt);\n}\n\nvar locales$5 = Object.keys(_alpha$2.decimal);\nisFloat$1.locales = locales$5;\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = toFloat;\n\n  var _isFloat = _interopRequireDefault(isFloat$1);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function toFloat(str) {\n    if (!(0, _isFloat.default)(str)) return NaN;\n    return parseFloat(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(toFloat, toFloat.exports);\n\nvar toInt = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = toInt;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function toInt(str, radix) {\n    (0, _assertString.default)(str);\n    return parseInt(str, radix || 10);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(toInt, toInt.exports);\n\nvar toBoolean = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = toBoolean;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function toBoolean(str, strict) {\n    (0, _assertString.default)(str);\n\n    if (strict) {\n      return str === '1' || /^true$/i.test(str);\n    }\n\n    return str !== '0' && !/^false$/i.test(str) && str !== '';\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(toBoolean, toBoolean.exports);\n\nvar equals = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = equals;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function equals(str, comparison) {\n    (0, _assertString.default)(str);\n    return str === comparison;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(equals, equals.exports);\n\nvar contains = {\n  exports: {}\n};\nvar toString$1 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = toString;\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function toString(input) {\n    if (_typeof(input) === 'object' && input !== null) {\n      if (typeof input.toString === 'function') {\n        input = input.toString();\n      } else {\n        input = '[object Object]';\n      }\n    } else if (input === null || typeof input === 'undefined' || isNaN(input) && !input.length) {\n      input = '';\n    }\n\n    return String(input);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(toString$1, toString$1.exports);\n\nvar merge = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = merge;\n\n  function merge() {\n    var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var defaults = arguments.length > 1 ? arguments[1] : undefined;\n\n    for (var key in defaults) {\n      if (typeof obj[key] === 'undefined') {\n        obj[key] = defaults[key];\n      }\n    }\n\n    return obj;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(merge, merge.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = contains;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _toString = _interopRequireDefault(toString$1.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var defaulContainsOptions = {\n    ignoreCase: false,\n    minOccurrences: 1\n  };\n\n  function contains(str, elem, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, defaulContainsOptions);\n\n    if (options.ignoreCase) {\n      return str.toLowerCase().split((0, _toString.default)(elem).toLowerCase()).length > options.minOccurrences;\n    }\n\n    return str.split((0, _toString.default)(elem)).length > options.minOccurrences;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(contains, contains.exports);\n\nvar matches = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = matches;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function matches(str, pattern, modifiers) {\n    (0, _assertString.default)(str);\n\n    if (Object.prototype.toString.call(pattern) !== '[object RegExp]') {\n      pattern = new RegExp(pattern, modifiers);\n    }\n\n    return pattern.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(matches, matches.exports);\n\nvar isEmail = {\n  exports: {}\n};\nvar isByteLength = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isByteLength;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n  /* eslint-disable prefer-rest-params */\n\n\n  function isByteLength(str, options) {\n    (0, _assertString.default)(str);\n    var min;\n    var max;\n\n    if (_typeof(options) === 'object') {\n      min = options.min || 0;\n      max = options.max;\n    } else {\n      // backwards compatibility: isByteLength(str, min [, max])\n      min = arguments[1];\n      max = arguments[2];\n    }\n\n    var len = encodeURI(str).split(/%..|./).length - 1;\n    return len >= min && (typeof max === 'undefined' || len <= max);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isByteLength, isByteLength.exports);\n\nvar isFQDN = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isFQDN;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var default_fqdn_options = {\n    require_tld: true,\n    allow_underscores: false,\n    allow_trailing_dot: false,\n    allow_numeric_tld: false,\n    allow_wildcard: false\n  };\n\n  function isFQDN(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, default_fqdn_options);\n    /* Remove the optional trailing dot before checking validity */\n\n    if (options.allow_trailing_dot && str[str.length - 1] === '.') {\n      str = str.substring(0, str.length - 1);\n    }\n    /* Remove the optional wildcard before checking validity */\n\n\n    if (options.allow_wildcard === true && str.indexOf('*.') === 0) {\n      str = str.substring(2);\n    }\n\n    var parts = str.split('.');\n    var tld = parts[parts.length - 1];\n\n    if (options.require_tld) {\n      // disallow fqdns without tld\n      if (parts.length < 2) {\n        return false;\n      }\n\n      if (!/^([a-z\\u00A1-\\u00A8\\u00AA-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(tld)) {\n        return false;\n      } // disallow spaces\n\n\n      if (/\\s/.test(tld)) {\n        return false;\n      }\n    } // reject numeric TLDs\n\n\n    if (!options.allow_numeric_tld && /^\\d+$/.test(tld)) {\n      return false;\n    }\n\n    return parts.every(function (part) {\n      if (part.length > 63) {\n        return false;\n      }\n\n      if (!/^[a-z_\\u00a1-\\uffff0-9-]+$/i.test(part)) {\n        return false;\n      } // disallow full-width chars\n\n\n      if (/[\\uff01-\\uff5e]/.test(part)) {\n        return false;\n      } // disallow parts starting or ending with hyphen\n\n\n      if (/^-|-$/.test(part)) {\n        return false;\n      }\n\n      if (!options.allow_underscores && /_/.test(part)) {\n        return false;\n      }\n\n      return true;\n    });\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isFQDN, isFQDN.exports);\n\nvar isIP = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isIP;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /**\n  11.3.  Examples\n  \n     The following addresses\n  \n               fe80::1234 (on the 1st link of the node)\n               ff02::5678 (on the 5th link of the node)\n               ff08::9abc (on the 10th organization of the node)\n  \n     would be represented as follows:\n  \n               fe80::1234%1\n               ff02::5678%5\n               ff08::9abc%10\n  \n     (Here we assume a natural translation from a zone index to the\n     <zone_id> part, where the Nth zone of any scope is translated into\n     \"N\".)\n  \n     If we use interface names as <zone_id>, those addresses could also be\n     represented as follows:\n  \n              fe80::1234%ne0\n              ff02::5678%pvc1.3\n              ff08::9abc%interface10\n  \n     where the interface \"ne0\" belongs to the 1st link, \"pvc1.3\" belongs\n     to the 5th link, and \"interface10\" belongs to the 10th organization.\n   * * */\n\n\n  var IPv4SegmentFormat = '(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])';\n  var IPv4AddressFormat = \"(\".concat(IPv4SegmentFormat, \"[.]){3}\").concat(IPv4SegmentFormat);\n  var IPv4AddressRegExp = new RegExp(\"^\".concat(IPv4AddressFormat, \"$\"));\n  var IPv6SegmentFormat = '(?:[0-9a-fA-F]{1,4})';\n  var IPv6AddressRegExp = new RegExp('^(' + \"(?:\".concat(IPv6SegmentFormat, \":){7}(?:\").concat(IPv6SegmentFormat, \"|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){6}(?:\").concat(IPv4AddressFormat, \"|:\").concat(IPv6SegmentFormat, \"|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){5}(?::\").concat(IPv4AddressFormat, \"|(:\").concat(IPv6SegmentFormat, \"){1,2}|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){4}(?:(:\").concat(IPv6SegmentFormat, \"){0,1}:\").concat(IPv4AddressFormat, \"|(:\").concat(IPv6SegmentFormat, \"){1,3}|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){3}(?:(:\").concat(IPv6SegmentFormat, \"){0,2}:\").concat(IPv4AddressFormat, \"|(:\").concat(IPv6SegmentFormat, \"){1,4}|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){2}(?:(:\").concat(IPv6SegmentFormat, \"){0,3}:\").concat(IPv4AddressFormat, \"|(:\").concat(IPv6SegmentFormat, \"){1,5}|:)|\") + \"(?:\".concat(IPv6SegmentFormat, \":){1}(?:(:\").concat(IPv6SegmentFormat, \"){0,4}:\").concat(IPv4AddressFormat, \"|(:\").concat(IPv6SegmentFormat, \"){1,6}|:)|\") + \"(?::((?::\".concat(IPv6SegmentFormat, \"){0,5}:\").concat(IPv4AddressFormat, \"|(?::\").concat(IPv6SegmentFormat, \"){1,7}|:))\") + ')(%[0-9a-zA-Z-.:]{1,})?$');\n\n  function isIP(str) {\n    var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    (0, _assertString.default)(str);\n    version = String(version);\n\n    if (!version) {\n      return isIP(str, 4) || isIP(str, 6);\n    }\n\n    if (version === '4') {\n      if (!IPv4AddressRegExp.test(str)) {\n        return false;\n      }\n\n      var parts = str.split('.').sort(function (a, b) {\n        return a - b;\n      });\n      return parts[3] <= 255;\n    }\n\n    if (version === '6') {\n      return !!IPv6AddressRegExp.test(str);\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isIP, isIP.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isEmail;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  var _isByteLength = _interopRequireDefault(isByteLength.exports);\n\n  var _isFQDN = _interopRequireDefault(isFQDN.exports);\n\n  var _isIP = _interopRequireDefault(isIP.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var default_email_options = {\n    allow_display_name: false,\n    require_display_name: false,\n    allow_utf8_local_part: true,\n    require_tld: true,\n    blacklisted_chars: '',\n    ignore_max_length: false,\n    host_blacklist: []\n  };\n  /* eslint-disable max-len */\n\n  /* eslint-disable no-control-regex */\n\n  var splitNameAddress = /^([^\\x00-\\x1F\\x7F-\\x9F\\cX]+)</i;\n  var emailUserPart = /^[a-z\\d!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]+$/i;\n  var gmailUserPart = /^[a-z\\d]+$/;\n  var quotedEmailUser = /^([\\s\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e]|(\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]))*$/i;\n  var emailUserUtf8Part = /^[a-z\\d!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+$/i;\n  var quotedEmailUserUtf8 = /^([\\s\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|(\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))*$/i;\n  var defaultMaxEmailLength = 254;\n  /* eslint-enable max-len */\n\n  /* eslint-enable no-control-regex */\n\n  /**\n   * Validate display name according to the RFC2822: https://tools.ietf.org/html/rfc2822#appendix-A.1.2\n   * @param {String} display_name\n   */\n\n  function validateDisplayName(display_name) {\n    var display_name_without_quotes = display_name.replace(/^\"(.+)\"$/, '$1'); // display name with only spaces is not valid\n\n    if (!display_name_without_quotes.trim()) {\n      return false;\n    } // check whether display name contains illegal character\n\n\n    var contains_illegal = /[\\.\";<>]/.test(display_name_without_quotes);\n\n    if (contains_illegal) {\n      // if contains illegal characters,\n      // must to be enclosed in double-quotes, otherwise it's not a valid display name\n      if (display_name_without_quotes === display_name) {\n        return false;\n      } // the quotes in display name must start with character symbol \\\n\n\n      var all_start_with_back_slash = display_name_without_quotes.split('\"').length === display_name_without_quotes.split('\\\\\"').length;\n\n      if (!all_start_with_back_slash) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function isEmail(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, default_email_options);\n\n    if (options.require_display_name || options.allow_display_name) {\n      var display_email = str.match(splitNameAddress);\n\n      if (display_email) {\n        var display_name = display_email[1]; // Remove display name and angle brackets to get email address\n        // Can be done in the regex but will introduce a ReDOS (See  #1597 for more info)\n\n        str = str.replace(display_name, '').replace(/(^<|>$)/g, ''); // sometimes need to trim the last space to get the display name\n        // because there may be a space between display name and email address\n        // eg. myname <address@gmail.com>\n        // the display name is `myname` instead of `myname `, so need to trim the last space\n\n        if (display_name.endsWith(' ')) {\n          display_name = display_name.substr(0, display_name.length - 1);\n        }\n\n        if (!validateDisplayName(display_name)) {\n          return false;\n        }\n      } else if (options.require_display_name) {\n        return false;\n      }\n    }\n\n    if (!options.ignore_max_length && str.length > defaultMaxEmailLength) {\n      return false;\n    }\n\n    var parts = str.split('@');\n    var domain = parts.pop();\n    var lower_domain = domain.toLowerCase();\n\n    if (options.host_blacklist.includes(lower_domain)) {\n      return false;\n    }\n\n    var user = parts.join('@');\n\n    if (options.domain_specific_validation && (lower_domain === 'gmail.com' || lower_domain === 'googlemail.com')) {\n      /*\n        Previously we removed dots for gmail addresses before validating.\n        This was removed because it allows `multiple..dots@gmail.com`\n        to be reported as valid, but it is not.\n        Gmail only normalizes single dots, removing them from here is pointless,\n        should be done in normalizeEmail\n      */\n      user = user.toLowerCase(); // Removing sub-address from username before gmail validation\n\n      var username = user.split('+')[0]; // Dots are not included in gmail length restriction\n\n      if (!(0, _isByteLength.default)(username.replace(/\\./g, ''), {\n        min: 6,\n        max: 30\n      })) {\n        return false;\n      }\n\n      var _user_parts = username.split('.');\n\n      for (var i = 0; i < _user_parts.length; i++) {\n        if (!gmailUserPart.test(_user_parts[i])) {\n          return false;\n        }\n      }\n    }\n\n    if (options.ignore_max_length === false && (!(0, _isByteLength.default)(user, {\n      max: 64\n    }) || !(0, _isByteLength.default)(domain, {\n      max: 254\n    }))) {\n      return false;\n    }\n\n    if (!(0, _isFQDN.default)(domain, {\n      require_tld: options.require_tld\n    })) {\n      if (!options.allow_ip_domain) {\n        return false;\n      }\n\n      if (!(0, _isIP.default)(domain)) {\n        if (!domain.startsWith('[') || !domain.endsWith(']')) {\n          return false;\n        }\n\n        var noBracketdomain = domain.substr(1, domain.length - 2);\n\n        if (noBracketdomain.length === 0 || !(0, _isIP.default)(noBracketdomain)) {\n          return false;\n        }\n      }\n    }\n\n    if (user[0] === '\"') {\n      user = user.slice(1, user.length - 1);\n      return options.allow_utf8_local_part ? quotedEmailUserUtf8.test(user) : quotedEmailUser.test(user);\n    }\n\n    var pattern = options.allow_utf8_local_part ? emailUserUtf8Part : emailUserPart;\n    var user_parts = user.split('.');\n\n    for (var _i = 0; _i < user_parts.length; _i++) {\n      if (!pattern.test(user_parts[_i])) {\n        return false;\n      }\n    }\n\n    if (options.blacklisted_chars) {\n      if (user.search(new RegExp(\"[\".concat(options.blacklisted_chars, \"]+\"), 'g')) !== -1) return false;\n    }\n\n    return true;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isEmail, isEmail.exports);\n\nvar isURL = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isURL;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isFQDN = _interopRequireDefault(isFQDN.exports);\n\n  var _isIP = _interopRequireDefault(isIP.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n  /*\n  options for isURL method\n  \n  require_protocol - if set as true isURL will return false if protocol is not present in the URL\n  require_valid_protocol - isURL will check if the URL's protocol is present in the protocols option\n  protocols - valid protocols can be modified with this option\n  require_host - if set as false isURL will not check if host is present in the URL\n  require_port - if set as true isURL will check if port is present in the URL\n  allow_protocol_relative_urls - if set as true protocol relative URLs will be allowed\n  validate_length - if set as false isURL will skip string length validation (IE maximum is 2083)\n  \n  */\n\n\n  var default_url_options = {\n    protocols: ['http', 'https', 'ftp'],\n    require_tld: true,\n    require_protocol: false,\n    require_host: true,\n    require_port: false,\n    require_valid_protocol: true,\n    allow_underscores: false,\n    allow_trailing_dot: false,\n    allow_protocol_relative_urls: false,\n    allow_fragments: true,\n    allow_query_components: true,\n    validate_length: true\n  };\n  var wrapped_ipv6 = /^\\[([^\\]]+)\\](?::([0-9]+))?$/;\n\n  function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n  }\n\n  function checkHost(host, matches) {\n    for (var i = 0; i < matches.length; i++) {\n      var match = matches[i];\n\n      if (host === match || isRegExp(match) && match.test(host)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function isURL(url, options) {\n    (0, _assertString.default)(url);\n\n    if (!url || /[\\s<>]/.test(url)) {\n      return false;\n    }\n\n    if (url.indexOf('mailto:') === 0) {\n      return false;\n    }\n\n    options = (0, _merge.default)(options, default_url_options);\n\n    if (options.validate_length && url.length >= 2083) {\n      return false;\n    }\n\n    if (!options.allow_fragments && url.includes('#')) {\n      return false;\n    }\n\n    if (!options.allow_query_components && (url.includes('?') || url.includes('&'))) {\n      return false;\n    }\n\n    var protocol, auth, host, hostname, port, port_str, split, ipv6;\n    split = url.split('#');\n    url = split.shift();\n    split = url.split('?');\n    url = split.shift();\n    split = url.split('://');\n\n    if (split.length > 1) {\n      protocol = split.shift().toLowerCase();\n\n      if (options.require_valid_protocol && options.protocols.indexOf(protocol) === -1) {\n        return false;\n      }\n    } else if (options.require_protocol) {\n      return false;\n    } else if (url.substr(0, 2) === '//') {\n      if (!options.allow_protocol_relative_urls) {\n        return false;\n      }\n\n      split[0] = url.substr(2);\n    }\n\n    url = split.join('://');\n\n    if (url === '') {\n      return false;\n    }\n\n    split = url.split('/');\n    url = split.shift();\n\n    if (url === '' && !options.require_host) {\n      return true;\n    }\n\n    split = url.split('@');\n\n    if (split.length > 1) {\n      if (options.disallow_auth) {\n        return false;\n      }\n\n      if (split[0] === '') {\n        return false;\n      }\n\n      auth = split.shift();\n\n      if (auth.indexOf(':') >= 0 && auth.split(':').length > 2) {\n        return false;\n      }\n\n      var _auth$split = auth.split(':'),\n          _auth$split2 = _slicedToArray(_auth$split, 2),\n          user = _auth$split2[0],\n          password = _auth$split2[1];\n\n      if (user === '' && password === '') {\n        return false;\n      }\n    }\n\n    hostname = split.join('@');\n    port_str = null;\n    ipv6 = null;\n    var ipv6_match = hostname.match(wrapped_ipv6);\n\n    if (ipv6_match) {\n      host = '';\n      ipv6 = ipv6_match[1];\n      port_str = ipv6_match[2] || null;\n    } else {\n      split = hostname.split(':');\n      host = split.shift();\n\n      if (split.length) {\n        port_str = split.join(':');\n      }\n    }\n\n    if (port_str !== null && port_str.length > 0) {\n      port = parseInt(port_str, 10);\n\n      if (!/^[0-9]+$/.test(port_str) || port <= 0 || port > 65535) {\n        return false;\n      }\n    } else if (options.require_port) {\n      return false;\n    }\n\n    if (options.host_whitelist) {\n      return checkHost(host, options.host_whitelist);\n    }\n\n    if (!(0, _isIP.default)(host) && !(0, _isFQDN.default)(host, options) && (!ipv6 || !(0, _isIP.default)(ipv6, 6))) {\n      return false;\n    }\n\n    host = host || ipv6;\n\n    if (options.host_blacklist && checkHost(host, options.host_blacklist)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isURL, isURL.exports);\n\nvar isMACAddress = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMACAddress;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var macAddress = /^(?:[0-9a-fA-F]{2}([-:\\s]))([0-9a-fA-F]{2}\\1){4}([0-9a-fA-F]{2})$/;\n  var macAddressNoSeparators = /^([0-9a-fA-F]){12}$/;\n  var macAddressWithDots = /^([0-9a-fA-F]{4}\\.){2}([0-9a-fA-F]{4})$/;\n\n  function isMACAddress(str, options) {\n    (0, _assertString.default)(str);\n    /**\n     * @deprecated `no_colons` TODO: remove it in the next major\n    */\n\n    if (options && (options.no_colons || options.no_separators)) {\n      return macAddressNoSeparators.test(str);\n    }\n\n    return macAddress.test(str) || macAddressWithDots.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMACAddress, isMACAddress.exports);\n\nvar isIPRange = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isIPRange;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isIP = _interopRequireDefault(isIP.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var subnetMaybe = /^\\d{1,3}$/;\n  var v4Subnet = 32;\n  var v6Subnet = 128;\n\n  function isIPRange(str) {\n    var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    (0, _assertString.default)(str);\n    var parts = str.split('/'); // parts[0] -> ip, parts[1] -> subnet\n\n    if (parts.length !== 2) {\n      return false;\n    }\n\n    if (!subnetMaybe.test(parts[1])) {\n      return false;\n    } // Disallow preceding 0 i.e. 01, 02, ...\n\n\n    if (parts[1].length > 1 && parts[1].startsWith('0')) {\n      return false;\n    }\n\n    var isValidIP = (0, _isIP.default)(parts[0], version);\n\n    if (!isValidIP) {\n      return false;\n    } // Define valid subnet according to IP's version\n\n\n    var expectedSubnet = null;\n\n    switch (String(version)) {\n      case '4':\n        expectedSubnet = v4Subnet;\n        break;\n\n      case '6':\n        expectedSubnet = v6Subnet;\n        break;\n\n      default:\n        expectedSubnet = (0, _isIP.default)(parts[0], '6') ? v6Subnet : v4Subnet;\n    }\n\n    return parts[1] <= expectedSubnet && parts[1] >= 0;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isIPRange, isIPRange.exports);\n\nvar isDate$2 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isDate;\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _createForOfIteratorHelper(o, allowArrayLike) {\n    var it;\n\n    if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n      if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n        if (it) o = it;\n        var i = 0;\n\n        var F = function F() {};\n\n        return {\n          s: F,\n          n: function n() {\n            if (i >= o.length) return {\n              done: true\n            };\n            return {\n              done: false,\n              value: o[i++]\n            };\n          },\n          e: function e(_e2) {\n            throw _e2;\n          },\n          f: F\n        };\n      }\n\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n\n    var normalCompletion = true,\n        didErr = false,\n        err;\n    return {\n      s: function s() {\n        it = o[Symbol.iterator]();\n      },\n      n: function n() {\n        var step = it.next();\n        normalCompletion = step.done;\n        return step;\n      },\n      e: function e(_e3) {\n        didErr = true;\n        err = _e3;\n      },\n      f: function f() {\n        try {\n          if (!normalCompletion && it.return != null) it.return();\n        } finally {\n          if (didErr) throw err;\n        }\n      }\n    };\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n\n  var default_date_options = {\n    format: 'YYYY/MM/DD',\n    delimiters: ['/', '-'],\n    strictMode: false\n  };\n\n  function isValidFormat(format) {\n    return /(^(y{4}|y{2})[.\\/-](m{1,2})[.\\/-](d{1,2})$)|(^(m{1,2})[.\\/-](d{1,2})[.\\/-]((y{4}|y{2})$))|(^(d{1,2})[.\\/-](m{1,2})[.\\/-]((y{4}|y{2})$))/gi.test(format);\n  }\n\n  function zip(date, format) {\n    var zippedArr = [],\n        len = Math.min(date.length, format.length);\n\n    for (var i = 0; i < len; i++) {\n      zippedArr.push([date[i], format[i]]);\n    }\n\n    return zippedArr;\n  }\n\n  function isDate(input, options) {\n    if (typeof options === 'string') {\n      // Allow backward compatbility for old format isDate(input [, format])\n      options = (0, _merge.default)({\n        format: options\n      }, default_date_options);\n    } else {\n      options = (0, _merge.default)(options, default_date_options);\n    }\n\n    if (typeof input === 'string' && isValidFormat(options.format)) {\n      var formatDelimiter = options.delimiters.find(function (delimiter) {\n        return options.format.indexOf(delimiter) !== -1;\n      });\n      var dateDelimiter = options.strictMode ? formatDelimiter : options.delimiters.find(function (delimiter) {\n        return input.indexOf(delimiter) !== -1;\n      });\n      var dateAndFormat = zip(input.split(dateDelimiter), options.format.toLowerCase().split(formatDelimiter));\n      var dateObj = {};\n\n      var _iterator = _createForOfIteratorHelper(dateAndFormat),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _step$value = _slicedToArray(_step.value, 2),\n              dateWord = _step$value[0],\n              formatWord = _step$value[1];\n\n          if (dateWord.length !== formatWord.length) {\n            return false;\n          }\n\n          dateObj[formatWord.charAt(0)] = dateWord;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return new Date(\"\".concat(dateObj.m, \"/\").concat(dateObj.d, \"/\").concat(dateObj.y)).getDate() === +dateObj.d;\n    }\n\n    if (!options.strictMode) {\n      return Object.prototype.toString.call(input) === '[object Date]' && isFinite(input);\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isDate$2, isDate$2.exports);\n\nvar isBoolean = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBoolean;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var defaultOptions = {\n    loose: false\n  };\n  var strictBooleans = ['true', 'false', '1', '0'];\n  var looseBooleans = [].concat(strictBooleans, ['yes', 'no']);\n\n  function isBoolean(str) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultOptions;\n    (0, _assertString.default)(str);\n\n    if (options.loose) {\n      return looseBooleans.includes(str.toLowerCase());\n    }\n\n    return strictBooleans.includes(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBoolean, isBoolean.exports);\n\nvar isLocale = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isLocale;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var localeReg = /^[A-Za-z]{2,4}([_-]([A-Za-z]{4}|[\\d]{3}))?([_-]([A-Za-z]{2}|[\\d]{3}))?$/;\n\n  function isLocale(str) {\n    (0, _assertString.default)(str);\n\n    if (str === 'en_US_POSIX' || str === 'ca_ES_VALENCIA') {\n      return true;\n    }\n\n    return localeReg.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isLocale, isLocale.exports);\n\nvar isAlpha$1 = {};\nObject.defineProperty(isAlpha$1, \"__esModule\", {\n  value: true\n});\nisAlpha$1.default = isAlpha;\nisAlpha$1.locales = void 0;\n\nvar _assertString$9 = _interopRequireDefault$9(assertString.exports);\n\nvar _alpha$1 = alpha$1;\n\nfunction _interopRequireDefault$9(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction isAlpha(_str) {\n  var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'en-US';\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  (0, _assertString$9.default)(_str);\n  var str = _str;\n  var ignore = options.ignore;\n\n  if (ignore) {\n    if (ignore instanceof RegExp) {\n      str = str.replace(ignore, '');\n    } else if (typeof ignore === 'string') {\n      str = str.replace(new RegExp(\"[\".concat(ignore.replace(/[-[\\]{}()*+?.,\\\\^$|#\\\\s]/g, '\\\\$&'), \"]\"), 'g'), ''); // escape regex for ignore\n    } else {\n      throw new Error('ignore should be instance of a String or RegExp');\n    }\n  }\n\n  if (locale in _alpha$1.alpha) {\n    return _alpha$1.alpha[locale].test(str);\n  }\n\n  throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n}\n\nvar locales$4 = Object.keys(_alpha$1.alpha);\nisAlpha$1.locales = locales$4;\nvar isAlphanumeric$1 = {};\nObject.defineProperty(isAlphanumeric$1, \"__esModule\", {\n  value: true\n});\nisAlphanumeric$1.default = isAlphanumeric;\nisAlphanumeric$1.locales = void 0;\n\nvar _assertString$8 = _interopRequireDefault$8(assertString.exports);\n\nvar _alpha = alpha$1;\n\nfunction _interopRequireDefault$8(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction isAlphanumeric(_str) {\n  var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'en-US';\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  (0, _assertString$8.default)(_str);\n  var str = _str;\n  var ignore = options.ignore;\n\n  if (ignore) {\n    if (ignore instanceof RegExp) {\n      str = str.replace(ignore, '');\n    } else if (typeof ignore === 'string') {\n      str = str.replace(new RegExp(\"[\".concat(ignore.replace(/[-[\\]{}()*+?.,\\\\^$|#\\\\s]/g, '\\\\$&'), \"]\"), 'g'), ''); // escape regex for ignore\n    } else {\n      throw new Error('ignore should be instance of a String or RegExp');\n    }\n  }\n\n  if (locale in _alpha.alphanumeric) {\n    return _alpha.alphanumeric[locale].test(str);\n  }\n\n  throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n}\n\nvar locales$3 = Object.keys(_alpha.alphanumeric);\nisAlphanumeric$1.locales = locales$3;\nvar isNumeric = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isNumeric;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _alpha = alpha$1;\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var numericNoSymbols = /^[0-9]+$/;\n\n  function isNumeric(str, options) {\n    (0, _assertString.default)(str);\n\n    if (options && options.no_symbols) {\n      return numericNoSymbols.test(str);\n    }\n\n    return new RegExp(\"^[+-]?([0-9]*[\".concat((options || {}).locale ? _alpha.decimal[options.locale] : '.', \"])?[0-9]+$\")).test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isNumeric, isNumeric.exports);\n\nvar isPassportNumber = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isPassportNumber;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /**\n   * Reference:\n   * https://en.wikipedia.org/ -- Wikipedia\n   * https://docs.microsoft.com/en-us/microsoft-365/compliance/eu-passport-number -- EU Passport Number\n   * https://countrycode.org/ -- Country Codes\n   */\n\n\n  var passportRegexByCountryCode = {\n    AM: /^[A-Z]{2}\\d{7}$/,\n    // ARMENIA\n    AR: /^[A-Z]{3}\\d{6}$/,\n    // ARGENTINA\n    AT: /^[A-Z]\\d{7}$/,\n    // AUSTRIA\n    AU: /^[A-Z]\\d{7}$/,\n    // AUSTRALIA\n    BE: /^[A-Z]{2}\\d{6}$/,\n    // BELGIUM\n    BG: /^\\d{9}$/,\n    // BULGARIA\n    BR: /^[A-Z]{2}\\d{6}$/,\n    // BRAZIL\n    BY: /^[A-Z]{2}\\d{7}$/,\n    // BELARUS\n    CA: /^[A-Z]{2}\\d{6}$/,\n    // CANADA\n    CH: /^[A-Z]\\d{7}$/,\n    // SWITZERLAND\n    CN: /^G\\d{8}$|^E(?![IO])[A-Z0-9]\\d{7}$/,\n    // CHINA [G=Ordinary, E=Electronic] followed by 8-digits, or E followed by any UPPERCASE letter (except I and O) followed by 7 digits\n    CY: /^[A-Z](\\d{6}|\\d{8})$/,\n    // CYPRUS\n    CZ: /^\\d{8}$/,\n    // CZECH REPUBLIC\n    DE: /^[CFGHJKLMNPRTVWXYZ0-9]{9}$/,\n    // GERMANY\n    DK: /^\\d{9}$/,\n    // DENMARK\n    DZ: /^\\d{9}$/,\n    // ALGERIA\n    EE: /^([A-Z]\\d{7}|[A-Z]{2}\\d{7})$/,\n    // ESTONIA (K followed by 7-digits), e-passports have 2 UPPERCASE followed by 7 digits\n    ES: /^[A-Z0-9]{2}([A-Z0-9]?)\\d{6}$/,\n    // SPAIN\n    FI: /^[A-Z]{2}\\d{7}$/,\n    // FINLAND\n    FR: /^\\d{2}[A-Z]{2}\\d{5}$/,\n    // FRANCE\n    GB: /^\\d{9}$/,\n    // UNITED KINGDOM\n    GR: /^[A-Z]{2}\\d{7}$/,\n    // GREECE\n    HR: /^\\d{9}$/,\n    // CROATIA\n    HU: /^[A-Z]{2}(\\d{6}|\\d{7})$/,\n    // HUNGARY\n    IE: /^[A-Z0-9]{2}\\d{7}$/,\n    // IRELAND\n    IN: /^[A-Z]{1}-?\\d{7}$/,\n    // INDIA\n    ID: /^[A-C]\\d{7}$/,\n    // INDONESIA\n    IR: /^[A-Z]\\d{8}$/,\n    // IRAN\n    IS: /^(A)\\d{7}$/,\n    // ICELAND\n    IT: /^[A-Z0-9]{2}\\d{7}$/,\n    // ITALY\n    JP: /^[A-Z]{2}\\d{7}$/,\n    // JAPAN\n    KR: /^[MS]\\d{8}$/,\n    // SOUTH KOREA, REPUBLIC OF KOREA, [S=PS Passports, M=PM Passports]\n    LT: /^[A-Z0-9]{8}$/,\n    // LITHUANIA\n    LU: /^[A-Z0-9]{8}$/,\n    // LUXEMBURG\n    LV: /^[A-Z0-9]{2}\\d{7}$/,\n    // LATVIA\n    LY: /^[A-Z0-9]{8}$/,\n    // LIBYA\n    MT: /^\\d{7}$/,\n    // MALTA\n    MZ: /^([A-Z]{2}\\d{7})|(\\d{2}[A-Z]{2}\\d{5})$/,\n    // MOZAMBIQUE\n    MY: /^[AHK]\\d{8}$/,\n    // MALAYSIA\n    NL: /^[A-Z]{2}[A-Z0-9]{6}\\d$/,\n    // NETHERLANDS\n    PL: /^[A-Z]{2}\\d{7}$/,\n    // POLAND\n    PT: /^[A-Z]\\d{6}$/,\n    // PORTUGAL\n    RO: /^\\d{8,9}$/,\n    // ROMANIA\n    RU: /^\\d{9}$/,\n    // RUSSIAN FEDERATION\n    SE: /^\\d{8}$/,\n    // SWEDEN\n    SL: /^(P)[A-Z]\\d{7}$/,\n    // SLOVANIA\n    SK: /^[0-9A-Z]\\d{7}$/,\n    // SLOVAKIA\n    TR: /^[A-Z]\\d{8}$/,\n    // TURKEY\n    UA: /^[A-Z]{2}\\d{6}$/,\n    // UKRAINE\n    US: /^\\d{9}$/ // UNITED STATES\n\n  };\n  /**\n   * Check if str is a valid passport number\n   * relative to provided ISO Country Code.\n   *\n   * @param {string} str\n   * @param {string} countryCode\n   * @return {boolean}\n   */\n\n  function isPassportNumber(str, countryCode) {\n    (0, _assertString.default)(str);\n    /** Remove All Whitespaces, Convert to UPPERCASE */\n\n    var normalizedStr = str.replace(/\\s/g, '').toUpperCase();\n    return countryCode.toUpperCase() in passportRegexByCountryCode && passportRegexByCountryCode[countryCode].test(normalizedStr);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isPassportNumber, isPassportNumber.exports);\n\nvar isPort = {\n  exports: {}\n};\nvar isInt$1 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isInt;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var int = /^(?:[-+]?(?:0|[1-9][0-9]*))$/;\n  var intLeadingZeroes = /^[-+]?[0-9]+$/;\n\n  function isInt(str, options) {\n    (0, _assertString.default)(str);\n    options = options || {}; // Get the regex to use for testing, based on whether\n    // leading zeroes are allowed or not.\n\n    var regex = options.hasOwnProperty('allow_leading_zeroes') && !options.allow_leading_zeroes ? int : intLeadingZeroes; // Check min/max/lt/gt\n\n    var minCheckPassed = !options.hasOwnProperty('min') || str >= options.min;\n    var maxCheckPassed = !options.hasOwnProperty('max') || str <= options.max;\n    var ltCheckPassed = !options.hasOwnProperty('lt') || str < options.lt;\n    var gtCheckPassed = !options.hasOwnProperty('gt') || str > options.gt;\n    return regex.test(str) && minCheckPassed && maxCheckPassed && ltCheckPassed && gtCheckPassed;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isInt$1, isInt$1.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isPort;\n\n  var _isInt = _interopRequireDefault(isInt$1.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isPort(str) {\n    return (0, _isInt.default)(str, {\n      min: 0,\n      max: 65535\n    });\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isPort, isPort.exports);\n\nvar isLowercase = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isLowercase;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isLowercase(str) {\n    (0, _assertString.default)(str);\n    return str === str.toLowerCase();\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isLowercase, isLowercase.exports);\n\nvar isUppercase = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isUppercase;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isUppercase(str) {\n    (0, _assertString.default)(str);\n    return str === str.toUpperCase();\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isUppercase, isUppercase.exports);\n\nvar isIMEI = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isIMEI;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var imeiRegexWithoutHypens = /^[0-9]{15}$/;\n  var imeiRegexWithHypens = /^\\d{2}-\\d{6}-\\d{6}-\\d{1}$/;\n\n  function isIMEI(str, options) {\n    (0, _assertString.default)(str);\n    options = options || {}; // default regex for checking imei is the one without hyphens\n\n    var imeiRegex = imeiRegexWithoutHypens;\n\n    if (options.allow_hyphens) {\n      imeiRegex = imeiRegexWithHypens;\n    }\n\n    if (!imeiRegex.test(str)) {\n      return false;\n    }\n\n    str = str.replace(/-/g, '');\n    var sum = 0,\n        mul = 2,\n        l = 14;\n\n    for (var i = 0; i < l; i++) {\n      var digit = str.substring(l - i - 1, l - i);\n      var tp = parseInt(digit, 10) * mul;\n\n      if (tp >= 10) {\n        sum += tp % 10 + 1;\n      } else {\n        sum += tp;\n      }\n\n      if (mul === 1) {\n        mul += 1;\n      } else {\n        mul -= 1;\n      }\n    }\n\n    var chk = (10 - sum % 10) % 10;\n\n    if (chk !== parseInt(str.substring(14, 15), 10)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isIMEI, isIMEI.exports);\n\nvar isAscii = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isAscii;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /* eslint-disable no-control-regex */\n\n\n  var ascii = /^[\\x00-\\x7F]+$/;\n  /* eslint-enable no-control-regex */\n\n  function isAscii(str) {\n    (0, _assertString.default)(str);\n    return ascii.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isAscii, isAscii.exports);\n\nvar isFullWidth$1 = {};\nObject.defineProperty(isFullWidth$1, \"__esModule\", {\n  value: true\n});\nisFullWidth$1.default = isFullWidth;\nisFullWidth$1.fullWidth = void 0;\n\nvar _assertString$7 = _interopRequireDefault$7(assertString.exports);\n\nfunction _interopRequireDefault$7(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar fullWidth = /[^\\u0020-\\u007E\\uFF61-\\uFF9F\\uFFA0-\\uFFDC\\uFFE8-\\uFFEE0-9a-zA-Z]/;\nisFullWidth$1.fullWidth = fullWidth;\n\nfunction isFullWidth(str) {\n  (0, _assertString$7.default)(str);\n  return fullWidth.test(str);\n}\n\nvar isHalfWidth$1 = {};\nObject.defineProperty(isHalfWidth$1, \"__esModule\", {\n  value: true\n});\nisHalfWidth$1.default = isHalfWidth;\nisHalfWidth$1.halfWidth = void 0;\n\nvar _assertString$6 = _interopRequireDefault$6(assertString.exports);\n\nfunction _interopRequireDefault$6(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar halfWidth = /[\\u0020-\\u007E\\uFF61-\\uFF9F\\uFFA0-\\uFFDC\\uFFE8-\\uFFEE0-9a-zA-Z]/;\nisHalfWidth$1.halfWidth = halfWidth;\n\nfunction isHalfWidth(str) {\n  (0, _assertString$6.default)(str);\n  return halfWidth.test(str);\n}\n\nvar isVariableWidth = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isVariableWidth;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isFullWidth = isFullWidth$1;\n  var _isHalfWidth = isHalfWidth$1;\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isVariableWidth(str) {\n    (0, _assertString.default)(str);\n    return _isFullWidth.fullWidth.test(str) && _isHalfWidth.halfWidth.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isVariableWidth, isVariableWidth.exports);\n\nvar isMultibyte = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMultibyte;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /* eslint-disable no-control-regex */\n\n\n  var multibyte = /[^\\x00-\\x7F]/;\n  /* eslint-enable no-control-regex */\n\n  function isMultibyte(str) {\n    (0, _assertString.default)(str);\n    return multibyte.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMultibyte, isMultibyte.exports);\n\nvar isSemVer = {\n  exports: {}\n};\nvar multilineRegex = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = multilineRegexp;\n  /**\n   * Build RegExp object from an array\n   * of multiple/multi-line regexp parts\n   *\n   * @param {string[]} parts\n   * @param {string} flags\n   * @return {object} - RegExp object\n   */\n\n  function multilineRegexp(parts, flags) {\n    var regexpAsStringLiteral = parts.join('');\n    return new RegExp(regexpAsStringLiteral, flags);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(multilineRegex, multilineRegex.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isSemVer;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _multilineRegex = _interopRequireDefault(multilineRegex.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /**\n   * Regular Expression to match\n   * semantic versioning (SemVer)\n   * built from multi-line, multi-parts regexp\n   * Reference: https://semver.org/\n   */\n\n\n  var semanticVersioningRegex = (0, _multilineRegex.default)(['^(0|[1-9]\\\\d*)\\\\.(0|[1-9]\\\\d*)\\\\.(0|[1-9]\\\\d*)', '(?:-((?:0|[1-9]\\\\d*|\\\\d*[a-z-][0-9a-z-]*)(?:\\\\.(?:0|[1-9]\\\\d*|\\\\d*[a-z-][0-9a-z-]*))*))', '?(?:\\\\+([0-9a-z-]+(?:\\\\.[0-9a-z-]+)*))?$'], 'i');\n\n  function isSemVer(str) {\n    (0, _assertString.default)(str);\n    return semanticVersioningRegex.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isSemVer, isSemVer.exports);\n\nvar isSurrogatePair = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isSurrogatePair;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var surrogatePair = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/;\n\n  function isSurrogatePair(str) {\n    (0, _assertString.default)(str);\n    return surrogatePair.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isSurrogatePair, isSurrogatePair.exports);\n\nvar isDecimal = {\n  exports: {}\n};\nvar includes = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n\n  var includes = function includes(arr, val) {\n    return arr.some(function (arrVal) {\n      return val === arrVal;\n    });\n  };\n\n  var _default = includes;\n  exports.default = _default;\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(includes, includes.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isDecimal;\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _includes = _interopRequireDefault(includes.exports);\n\n  var _alpha = alpha$1;\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function decimalRegExp(options) {\n    var regExp = new RegExp(\"^[-+]?([0-9]+)?(\\\\\".concat(_alpha.decimal[options.locale], \"[0-9]{\").concat(options.decimal_digits, \"})\").concat(options.force_decimal ? '' : '?', \"$\"));\n    return regExp;\n  }\n\n  var default_decimal_options = {\n    force_decimal: false,\n    decimal_digits: '1,',\n    locale: 'en-US'\n  };\n  var blacklist = ['', '-', '+'];\n\n  function isDecimal(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, default_decimal_options);\n\n    if (options.locale in _alpha.decimal) {\n      return !(0, _includes.default)(blacklist, str.replace(/ /g, '')) && decimalRegExp(options).test(str);\n    }\n\n    throw new Error(\"Invalid locale '\".concat(options.locale, \"'\"));\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isDecimal, isDecimal.exports);\n\nvar isHexadecimal = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isHexadecimal;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var hexadecimal = /^(0x|0h)?[0-9A-F]+$/i;\n\n  function isHexadecimal(str) {\n    (0, _assertString.default)(str);\n    return hexadecimal.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isHexadecimal, isHexadecimal.exports);\n\nvar isOctal = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isOctal;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var octal = /^(0o)?[0-7]+$/i;\n\n  function isOctal(str) {\n    (0, _assertString.default)(str);\n    return octal.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isOctal, isOctal.exports);\n\nvar isDivisibleBy = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isDivisibleBy;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _toFloat = _interopRequireDefault(toFloat.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isDivisibleBy(str, num) {\n    (0, _assertString.default)(str);\n    return (0, _toFloat.default)(str) % parseInt(num, 10) === 0;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isDivisibleBy, isDivisibleBy.exports);\n\nvar isHexColor = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isHexColor;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var hexcolor = /^#?([0-9A-F]{3}|[0-9A-F]{4}|[0-9A-F]{6}|[0-9A-F]{8})$/i;\n\n  function isHexColor(str) {\n    (0, _assertString.default)(str);\n    return hexcolor.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isHexColor, isHexColor.exports);\n\nvar isRgbColor = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isRgbColor;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var rgbColor = /^rgb\\((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),){2}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\)$/;\n  var rgbaColor = /^rgba\\((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),){3}(0?\\.\\d|1(\\.0)?|0(\\.0)?)\\)$/;\n  var rgbColorPercent = /^rgb\\((([0-9]%|[1-9][0-9]%|100%),){2}([0-9]%|[1-9][0-9]%|100%)\\)/;\n  var rgbaColorPercent = /^rgba\\((([0-9]%|[1-9][0-9]%|100%),){3}(0?\\.\\d|1(\\.0)?|0(\\.0)?)\\)/;\n\n  function isRgbColor(str) {\n    var includePercentValues = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    (0, _assertString.default)(str);\n\n    if (!includePercentValues) {\n      return rgbColor.test(str) || rgbaColor.test(str);\n    }\n\n    return rgbColor.test(str) || rgbaColor.test(str) || rgbColorPercent.test(str) || rgbaColorPercent.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isRgbColor, isRgbColor.exports);\n\nvar isHSL = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isHSL;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var hslComma = /^hsla?\\(((\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?))(deg|grad|rad|turn)?(,(\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?)%){2}(,((\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?)%?))?\\)$/i;\n  var hslSpace = /^hsla?\\(((\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?))(deg|grad|rad|turn)?(\\s(\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?)%){2}\\s?(\\/\\s((\\+|\\-)?([0-9]+(\\.[0-9]+)?(e(\\+|\\-)?[0-9]+)?|\\.[0-9]+(e(\\+|\\-)?[0-9]+)?)%?)\\s?)?\\)$/i;\n\n  function isHSL(str) {\n    (0, _assertString.default)(str); // Strip duplicate spaces before calling the validation regex (See  #1598 for more info)\n\n    var strippedStr = str.replace(/\\s+/g, ' ').replace(/\\s?(hsla?\\(|\\)|,)\\s?/ig, '$1');\n\n    if (strippedStr.indexOf(',') !== -1) {\n      return hslComma.test(strippedStr);\n    }\n\n    return hslSpace.test(strippedStr);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isHSL, isHSL.exports);\n\nvar isISRC = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISRC;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  } // see http://isrc.ifpi.org/en/isrc-standard/code-syntax\n\n\n  var isrc = /^[A-Z]{2}[0-9A-Z]{3}\\d{2}\\d{5}$/;\n\n  function isISRC(str) {\n    (0, _assertString.default)(str);\n    return isrc.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISRC, isISRC.exports);\n\nvar isIBAN$1 = {};\nObject.defineProperty(isIBAN$1, \"__esModule\", {\n  value: true\n});\nisIBAN$1.default = isIBAN;\nisIBAN$1.locales = void 0;\n\nvar _assertString$5 = _interopRequireDefault$5(assertString.exports);\n\nfunction _interopRequireDefault$5(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * List of country codes with\n * corresponding IBAN regular expression\n * Reference: https://en.wikipedia.org/wiki/International_Bank_Account_Number\n */\n\n\nvar ibanRegexThroughCountryCode = {\n  AD: /^(AD[0-9]{2})\\d{8}[A-Z0-9]{12}$/,\n  AE: /^(AE[0-9]{2})\\d{3}\\d{16}$/,\n  AL: /^(AL[0-9]{2})\\d{8}[A-Z0-9]{16}$/,\n  AT: /^(AT[0-9]{2})\\d{16}$/,\n  AZ: /^(AZ[0-9]{2})[A-Z0-9]{4}\\d{20}$/,\n  BA: /^(BA[0-9]{2})\\d{16}$/,\n  BE: /^(BE[0-9]{2})\\d{12}$/,\n  BG: /^(BG[0-9]{2})[A-Z]{4}\\d{6}[A-Z0-9]{8}$/,\n  BH: /^(BH[0-9]{2})[A-Z]{4}[A-Z0-9]{14}$/,\n  BR: /^(BR[0-9]{2})\\d{23}[A-Z]{1}[A-Z0-9]{1}$/,\n  BY: /^(BY[0-9]{2})[A-Z0-9]{4}\\d{20}$/,\n  CH: /^(CH[0-9]{2})\\d{5}[A-Z0-9]{12}$/,\n  CR: /^(CR[0-9]{2})\\d{18}$/,\n  CY: /^(CY[0-9]{2})\\d{8}[A-Z0-9]{16}$/,\n  CZ: /^(CZ[0-9]{2})\\d{20}$/,\n  DE: /^(DE[0-9]{2})\\d{18}$/,\n  DK: /^(DK[0-9]{2})\\d{14}$/,\n  DO: /^(DO[0-9]{2})[A-Z]{4}\\d{20}$/,\n  EE: /^(EE[0-9]{2})\\d{16}$/,\n  EG: /^(EG[0-9]{2})\\d{25}$/,\n  ES: /^(ES[0-9]{2})\\d{20}$/,\n  FI: /^(FI[0-9]{2})\\d{14}$/,\n  FO: /^(FO[0-9]{2})\\d{14}$/,\n  FR: /^(FR[0-9]{2})\\d{10}[A-Z0-9]{11}\\d{2}$/,\n  GB: /^(GB[0-9]{2})[A-Z]{4}\\d{14}$/,\n  GE: /^(GE[0-9]{2})[A-Z0-9]{2}\\d{16}$/,\n  GI: /^(GI[0-9]{2})[A-Z]{4}[A-Z0-9]{15}$/,\n  GL: /^(GL[0-9]{2})\\d{14}$/,\n  GR: /^(GR[0-9]{2})\\d{7}[A-Z0-9]{16}$/,\n  GT: /^(GT[0-9]{2})[A-Z0-9]{4}[A-Z0-9]{20}$/,\n  HR: /^(HR[0-9]{2})\\d{17}$/,\n  HU: /^(HU[0-9]{2})\\d{24}$/,\n  IE: /^(IE[0-9]{2})[A-Z0-9]{4}\\d{14}$/,\n  IL: /^(IL[0-9]{2})\\d{19}$/,\n  IQ: /^(IQ[0-9]{2})[A-Z]{4}\\d{15}$/,\n  IR: /^(IR[0-9]{2})0\\d{2}0\\d{18}$/,\n  IS: /^(IS[0-9]{2})\\d{22}$/,\n  IT: /^(IT[0-9]{2})[A-Z]{1}\\d{10}[A-Z0-9]{12}$/,\n  JO: /^(JO[0-9]{2})[A-Z]{4}\\d{22}$/,\n  KW: /^(KW[0-9]{2})[A-Z]{4}[A-Z0-9]{22}$/,\n  KZ: /^(KZ[0-9]{2})\\d{3}[A-Z0-9]{13}$/,\n  LB: /^(LB[0-9]{2})\\d{4}[A-Z0-9]{20}$/,\n  LC: /^(LC[0-9]{2})[A-Z]{4}[A-Z0-9]{24}$/,\n  LI: /^(LI[0-9]{2})\\d{5}[A-Z0-9]{12}$/,\n  LT: /^(LT[0-9]{2})\\d{16}$/,\n  LU: /^(LU[0-9]{2})\\d{3}[A-Z0-9]{13}$/,\n  LV: /^(LV[0-9]{2})[A-Z]{4}[A-Z0-9]{13}$/,\n  MC: /^(MC[0-9]{2})\\d{10}[A-Z0-9]{11}\\d{2}$/,\n  MD: /^(MD[0-9]{2})[A-Z0-9]{20}$/,\n  ME: /^(ME[0-9]{2})\\d{18}$/,\n  MK: /^(MK[0-9]{2})\\d{3}[A-Z0-9]{10}\\d{2}$/,\n  MR: /^(MR[0-9]{2})\\d{23}$/,\n  MT: /^(MT[0-9]{2})[A-Z]{4}\\d{5}[A-Z0-9]{18}$/,\n  MU: /^(MU[0-9]{2})[A-Z]{4}\\d{19}[A-Z]{3}$/,\n  MZ: /^(MZ[0-9]{2})\\d{21}$/,\n  NL: /^(NL[0-9]{2})[A-Z]{4}\\d{10}$/,\n  NO: /^(NO[0-9]{2})\\d{11}$/,\n  PK: /^(PK[0-9]{2})[A-Z0-9]{4}\\d{16}$/,\n  PL: /^(PL[0-9]{2})\\d{24}$/,\n  PS: /^(PS[0-9]{2})[A-Z0-9]{4}\\d{21}$/,\n  PT: /^(PT[0-9]{2})\\d{21}$/,\n  QA: /^(QA[0-9]{2})[A-Z]{4}[A-Z0-9]{21}$/,\n  RO: /^(RO[0-9]{2})[A-Z]{4}[A-Z0-9]{16}$/,\n  RS: /^(RS[0-9]{2})\\d{18}$/,\n  SA: /^(SA[0-9]{2})\\d{2}[A-Z0-9]{18}$/,\n  SC: /^(SC[0-9]{2})[A-Z]{4}\\d{20}[A-Z]{3}$/,\n  SE: /^(SE[0-9]{2})\\d{20}$/,\n  SI: /^(SI[0-9]{2})\\d{15}$/,\n  SK: /^(SK[0-9]{2})\\d{20}$/,\n  SM: /^(SM[0-9]{2})[A-Z]{1}\\d{10}[A-Z0-9]{12}$/,\n  SV: /^(SV[0-9]{2})[A-Z0-9]{4}\\d{20}$/,\n  TL: /^(TL[0-9]{2})\\d{19}$/,\n  TN: /^(TN[0-9]{2})\\d{20}$/,\n  TR: /^(TR[0-9]{2})\\d{5}[A-Z0-9]{17}$/,\n  UA: /^(UA[0-9]{2})\\d{6}[A-Z0-9]{19}$/,\n  VA: /^(VA[0-9]{2})\\d{18}$/,\n  VG: /^(VG[0-9]{2})[A-Z0-9]{4}\\d{16}$/,\n  XK: /^(XK[0-9]{2})\\d{16}$/\n};\n/**\n * Check whether string has correct universal IBAN format\n * The IBAN consists of up to 34 alphanumeric characters, as follows:\n * Country Code using ISO 3166-1 alpha-2, two letters\n * check digits, two digits and\n * Basic Bank Account Number (BBAN), up to 30 alphanumeric characters.\n * NOTE: Permitted IBAN characters are: digits [0-9] and the 26 latin alphabetic [A-Z]\n *\n * @param {string} str - string under validation\n * @return {boolean}\n */\n\nfunction hasValidIbanFormat(str) {\n  // Strip white spaces and hyphens\n  var strippedStr = str.replace(/[\\s\\-]+/gi, '').toUpperCase();\n  var isoCountryCode = strippedStr.slice(0, 2).toUpperCase();\n  return isoCountryCode in ibanRegexThroughCountryCode && ibanRegexThroughCountryCode[isoCountryCode].test(strippedStr);\n}\n/**\n   * Check whether string has valid IBAN Checksum\n   * by performing basic mod-97 operation and\n   * the remainder should equal 1\n   * -- Start by rearranging the IBAN by moving the four initial characters to the end of the string\n   * -- Replace each letter in the string with two digits, A -> 10, B = 11, Z = 35\n   * -- Interpret the string as a decimal integer and\n   * -- compute the remainder on division by 97 (mod 97)\n   * Reference: https://en.wikipedia.org/wiki/International_Bank_Account_Number\n   *\n   * @param {string} str\n   * @return {boolean}\n   */\n\n\nfunction hasValidIbanChecksum(str) {\n  var strippedStr = str.replace(/[^A-Z0-9]+/gi, '').toUpperCase(); // Keep only digits and A-Z latin alphabetic\n\n  var rearranged = strippedStr.slice(4) + strippedStr.slice(0, 4);\n  var alphaCapsReplacedWithDigits = rearranged.replace(/[A-Z]/g, function (char) {\n    return char.charCodeAt(0) - 55;\n  });\n  var remainder = alphaCapsReplacedWithDigits.match(/\\d{1,7}/g).reduce(function (acc, value) {\n    return Number(acc + value) % 97;\n  }, '');\n  return remainder === 1;\n}\n\nfunction isIBAN(str) {\n  (0, _assertString$5.default)(str);\n  return hasValidIbanFormat(str) && hasValidIbanChecksum(str);\n}\n\nvar locales$2 = Object.keys(ibanRegexThroughCountryCode);\nisIBAN$1.locales = locales$2;\nvar isBIC = {\n  exports: {}\n};\nvar isISO31661Alpha2$1 = {};\nObject.defineProperty(isISO31661Alpha2$1, \"__esModule\", {\n  value: true\n});\nisISO31661Alpha2$1.default = isISO31661Alpha2;\nisISO31661Alpha2$1.CountryCodes = void 0;\n\nvar _assertString$4 = _interopRequireDefault$4(assertString.exports);\n\nfunction _interopRequireDefault$4(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} // from https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2\n\n\nvar validISO31661Alpha2CountriesCodes = new Set(['AD', 'AE', 'AF', 'AG', 'AI', 'AL', 'AM', 'AO', 'AQ', 'AR', 'AS', 'AT', 'AU', 'AW', 'AX', 'AZ', 'BA', 'BB', 'BD', 'BE', 'BF', 'BG', 'BH', 'BI', 'BJ', 'BL', 'BM', 'BN', 'BO', 'BQ', 'BR', 'BS', 'BT', 'BV', 'BW', 'BY', 'BZ', 'CA', 'CC', 'CD', 'CF', 'CG', 'CH', 'CI', 'CK', 'CL', 'CM', 'CN', 'CO', 'CR', 'CU', 'CV', 'CW', 'CX', 'CY', 'CZ', 'DE', 'DJ', 'DK', 'DM', 'DO', 'DZ', 'EC', 'EE', 'EG', 'EH', 'ER', 'ES', 'ET', 'FI', 'FJ', 'FK', 'FM', 'FO', 'FR', 'GA', 'GB', 'GD', 'GE', 'GF', 'GG', 'GH', 'GI', 'GL', 'GM', 'GN', 'GP', 'GQ', 'GR', 'GS', 'GT', 'GU', 'GW', 'GY', 'HK', 'HM', 'HN', 'HR', 'HT', 'HU', 'ID', 'IE', 'IL', 'IM', 'IN', 'IO', 'IQ', 'IR', 'IS', 'IT', 'JE', 'JM', 'JO', 'JP', 'KE', 'KG', 'KH', 'KI', 'KM', 'KN', 'KP', 'KR', 'KW', 'KY', 'KZ', 'LA', 'LB', 'LC', 'LI', 'LK', 'LR', 'LS', 'LT', 'LU', 'LV', 'LY', 'MA', 'MC', 'MD', 'ME', 'MF', 'MG', 'MH', 'MK', 'ML', 'MM', 'MN', 'MO', 'MP', 'MQ', 'MR', 'MS', 'MT', 'MU', 'MV', 'MW', 'MX', 'MY', 'MZ', 'NA', 'NC', 'NE', 'NF', 'NG', 'NI', 'NL', 'NO', 'NP', 'NR', 'NU', 'NZ', 'OM', 'PA', 'PE', 'PF', 'PG', 'PH', 'PK', 'PL', 'PM', 'PN', 'PR', 'PS', 'PT', 'PW', 'PY', 'QA', 'RE', 'RO', 'RS', 'RU', 'RW', 'SA', 'SB', 'SC', 'SD', 'SE', 'SG', 'SH', 'SI', 'SJ', 'SK', 'SL', 'SM', 'SN', 'SO', 'SR', 'SS', 'ST', 'SV', 'SX', 'SY', 'SZ', 'TC', 'TD', 'TF', 'TG', 'TH', 'TJ', 'TK', 'TL', 'TM', 'TN', 'TO', 'TR', 'TT', 'TV', 'TW', 'TZ', 'UA', 'UG', 'UM', 'US', 'UY', 'UZ', 'VA', 'VC', 'VE', 'VG', 'VI', 'VN', 'VU', 'WF', 'WS', 'YE', 'YT', 'ZA', 'ZM', 'ZW']);\n\nfunction isISO31661Alpha2(str) {\n  (0, _assertString$4.default)(str);\n  return validISO31661Alpha2CountriesCodes.has(str.toUpperCase());\n}\n\nvar CountryCodes = validISO31661Alpha2CountriesCodes;\nisISO31661Alpha2$1.CountryCodes = CountryCodes;\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBIC;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isISO31661Alpha = isISO31661Alpha2$1;\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  } // https://en.wikipedia.org/wiki/ISO_9362\n\n\n  var isBICReg = /^[A-Za-z]{6}[A-Za-z0-9]{2}([A-Za-z0-9]{3})?$/;\n\n  function isBIC(str) {\n    (0, _assertString.default)(str); // toUpperCase() should be removed when a new major version goes out that changes\n    // the regex to [A-Z] (per the spec).\n\n    if (!_isISO31661Alpha.CountryCodes.has(str.slice(4, 6).toUpperCase())) {\n      return false;\n    }\n\n    return isBICReg.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBIC, isBIC.exports);\n\nvar isMD5 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMD5;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var md5 = /^[a-f0-9]{32}$/;\n\n  function isMD5(str) {\n    (0, _assertString.default)(str);\n    return md5.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMD5, isMD5.exports);\n\nvar isHash = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isHash;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var lengths = {\n    md5: 32,\n    md4: 32,\n    sha1: 40,\n    sha256: 64,\n    sha384: 96,\n    sha512: 128,\n    ripemd128: 32,\n    ripemd160: 40,\n    tiger128: 32,\n    tiger160: 40,\n    tiger192: 48,\n    crc32: 8,\n    crc32b: 8\n  };\n\n  function isHash(str, algorithm) {\n    (0, _assertString.default)(str);\n    var hash = new RegExp(\"^[a-fA-F0-9]{\".concat(lengths[algorithm], \"}$\"));\n    return hash.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isHash, isHash.exports);\n\nvar isJWT = {\n  exports: {}\n};\nvar isBase64 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBase64;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var notBase64 = /[^A-Z0-9+\\/=]/i;\n  var urlSafeBase64 = /^[A-Z0-9_\\-]*$/i;\n  var defaultBase64Options = {\n    urlSafe: false\n  };\n\n  function isBase64(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, defaultBase64Options);\n    var len = str.length;\n\n    if (options.urlSafe) {\n      return urlSafeBase64.test(str);\n    }\n\n    if (len % 4 !== 0 || notBase64.test(str)) {\n      return false;\n    }\n\n    var firstPaddingChar = str.indexOf('=');\n    return firstPaddingChar === -1 || firstPaddingChar === len - 1 || firstPaddingChar === len - 2 && str[len - 1] === '=';\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBase64, isBase64.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isJWT;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isBase = _interopRequireDefault(isBase64.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isJWT(str) {\n    (0, _assertString.default)(str);\n    var dotSplit = str.split('.');\n    var len = dotSplit.length;\n\n    if (len > 3 || len < 2) {\n      return false;\n    }\n\n    return dotSplit.reduce(function (acc, currElem) {\n      return acc && (0, _isBase.default)(currElem, {\n        urlSafe: true\n      });\n    }, true);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isJWT, isJWT.exports);\n\nvar isJSON = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isJSON;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var default_json_options = {\n    allow_primitives: false\n  };\n\n  function isJSON(str, options) {\n    (0, _assertString.default)(str);\n\n    try {\n      options = (0, _merge.default)(options, default_json_options);\n      var primitives = [];\n\n      if (options.allow_primitives) {\n        primitives = [null, false, true];\n      }\n\n      var obj = JSON.parse(str);\n      return primitives.includes(obj) || !!obj && _typeof(obj) === 'object';\n    } catch (e) {\n      /* ignore */\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isJSON, isJSON.exports);\n\nvar isEmpty = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isEmpty;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var default_is_empty_options = {\n    ignore_whitespace: false\n  };\n\n  function isEmpty(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, default_is_empty_options);\n    return (options.ignore_whitespace ? str.trim().length : str.length) === 0;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isEmpty, isEmpty.exports);\n\nvar isLength = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isLength;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n  /* eslint-disable prefer-rest-params */\n\n\n  function isLength(str, options) {\n    (0, _assertString.default)(str);\n    var min;\n    var max;\n\n    if (_typeof(options) === 'object') {\n      min = options.min || 0;\n      max = options.max;\n    } else {\n      // backwards compatibility: isLength(str, min [, max])\n      min = arguments[1] || 0;\n      max = arguments[2];\n    }\n\n    var surrogatePairs = str.match(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g) || [];\n    var len = str.length - surrogatePairs.length;\n    return len >= min && (typeof max === 'undefined' || len <= max);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isLength, isLength.exports);\n\nvar isUUID = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isUUID;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var uuid = {\n    1: /^[0-9A-F]{8}-[0-9A-F]{4}-1[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,\n    2: /^[0-9A-F]{8}-[0-9A-F]{4}-2[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,\n    3: /^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,\n    4: /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,\n    5: /^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,\n    all: /^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i\n  };\n\n  function isUUID(str, version) {\n    (0, _assertString.default)(str);\n    var pattern = uuid[![undefined, null].includes(version) ? version : 'all'];\n    return !!pattern && pattern.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isUUID, isUUID.exports);\n\nvar isMongoId = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMongoId;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isHexadecimal = _interopRequireDefault(isHexadecimal.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isMongoId(str) {\n    (0, _assertString.default)(str);\n    return (0, _isHexadecimal.default)(str) && str.length === 24;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMongoId, isMongoId.exports);\n\nvar isAfter = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isAfter;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _toDate = _interopRequireDefault(toDate$1.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isAfter(str) {\n    var date = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : String(new Date());\n    (0, _assertString.default)(str);\n    var comparison = (0, _toDate.default)(date);\n    var original = (0, _toDate.default)(str);\n    return !!(original && comparison && original > comparison);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isAfter, isAfter.exports);\n\nvar isBefore = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBefore;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _toDate = _interopRequireDefault(toDate$1.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isBefore(str) {\n    var date = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : String(new Date());\n    (0, _assertString.default)(str);\n    var comparison = (0, _toDate.default)(date);\n    var original = (0, _toDate.default)(str);\n    return !!(original && comparison && original < comparison);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBefore, isBefore.exports);\n\nvar isIn = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isIn;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _toString = _interopRequireDefault(toString$1.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function isIn(str, options) {\n    (0, _assertString.default)(str);\n    var i;\n\n    if (Object.prototype.toString.call(options) === '[object Array]') {\n      var array = [];\n\n      for (i in options) {\n        // https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\n        // istanbul ignore else\n        if ({}.hasOwnProperty.call(options, i)) {\n          array[i] = (0, _toString.default)(options[i]);\n        }\n      }\n\n      return array.indexOf(str) >= 0;\n    } else if (_typeof(options) === 'object') {\n      return options.hasOwnProperty(str);\n    } else if (options && typeof options.indexOf === 'function') {\n      return options.indexOf(str) >= 0;\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isIn, isIn.exports);\n\nvar isCreditCard = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isCreditCard;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /* eslint-disable max-len */\n\n\n  var creditCard = /^(?:4[0-9]{12}(?:[0-9]{3,6})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12,15}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\\d{3})\\d{11}|6[27][0-9]{14}|^(81[0-9]{14,17}))$/;\n  /* eslint-enable max-len */\n\n  function isCreditCard(str) {\n    (0, _assertString.default)(str);\n    var sanitized = str.replace(/[- ]+/g, '');\n\n    if (!creditCard.test(sanitized)) {\n      return false;\n    }\n\n    var sum = 0;\n    var digit;\n    var tmpNum;\n    var shouldDouble;\n\n    for (var i = sanitized.length - 1; i >= 0; i--) {\n      digit = sanitized.substring(i, i + 1);\n      tmpNum = parseInt(digit, 10);\n\n      if (shouldDouble) {\n        tmpNum *= 2;\n\n        if (tmpNum >= 10) {\n          sum += tmpNum % 10 + 1;\n        } else {\n          sum += tmpNum;\n        }\n      } else {\n        sum += tmpNum;\n      }\n\n      shouldDouble = !shouldDouble;\n    }\n\n    return !!(sum % 10 === 0 ? sanitized : false);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isCreditCard, isCreditCard.exports);\n\nvar isIdentityCard = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isIdentityCard;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _isInt = _interopRequireDefault(isInt$1.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var validators = {\n    PL: function PL(str) {\n      (0, _assertString.default)(str);\n      var weightOfDigits = {\n        1: 1,\n        2: 3,\n        3: 7,\n        4: 9,\n        5: 1,\n        6: 3,\n        7: 7,\n        8: 9,\n        9: 1,\n        10: 3,\n        11: 0\n      };\n\n      if (str != null && str.length === 11 && (0, _isInt.default)(str, {\n        allow_leading_zeroes: true\n      })) {\n        var digits = str.split('').slice(0, -1);\n        var sum = digits.reduce(function (acc, digit, index) {\n          return acc + Number(digit) * weightOfDigits[index + 1];\n        }, 0);\n        var modulo = sum % 10;\n        var lastDigit = Number(str.charAt(str.length - 1));\n\n        if (modulo === 0 && lastDigit === 0 || lastDigit === 10 - modulo) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n    ES: function ES(str) {\n      (0, _assertString.default)(str);\n      var DNI = /^[0-9X-Z][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$/;\n      var charsValue = {\n        X: 0,\n        Y: 1,\n        Z: 2\n      };\n      var controlDigits = ['T', 'R', 'W', 'A', 'G', 'M', 'Y', 'F', 'P', 'D', 'X', 'B', 'N', 'J', 'Z', 'S', 'Q', 'V', 'H', 'L', 'C', 'K', 'E']; // sanitize user input\n\n      var sanitized = str.trim().toUpperCase(); // validate the data structure\n\n      if (!DNI.test(sanitized)) {\n        return false;\n      } // validate the control digit\n\n\n      var number = sanitized.slice(0, -1).replace(/[X,Y,Z]/g, function (char) {\n        return charsValue[char];\n      });\n      return sanitized.endsWith(controlDigits[number % 23]);\n    },\n    FI: function FI(str) {\n      // https://dvv.fi/en/personal-identity-code#:~:text=control%20character%20for%20a-,personal,-identity%20code%20calculated\n      (0, _assertString.default)(str);\n\n      if (str.length !== 11) {\n        return false;\n      }\n\n      if (!str.match(/^\\d{6}[\\-A\\+]\\d{3}[0-9ABCDEFHJKLMNPRSTUVWXY]{1}$/)) {\n        return false;\n      }\n\n      var checkDigits = '0123456789ABCDEFHJKLMNPRSTUVWXY';\n      var idAsNumber = parseInt(str.slice(0, 6), 10) * 1000 + parseInt(str.slice(7, 10), 10);\n      var remainder = idAsNumber % 31;\n      var checkDigit = checkDigits[remainder];\n      return checkDigit === str.slice(10, 11);\n    },\n    IN: function IN(str) {\n      var DNI = /^[1-9]\\d{3}\\s?\\d{4}\\s?\\d{4}$/; // multiplication table\n\n      var d = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [1, 2, 3, 4, 0, 6, 7, 8, 9, 5], [2, 3, 4, 0, 1, 7, 8, 9, 5, 6], [3, 4, 0, 1, 2, 8, 9, 5, 6, 7], [4, 0, 1, 2, 3, 9, 5, 6, 7, 8], [5, 9, 8, 7, 6, 0, 4, 3, 2, 1], [6, 5, 9, 8, 7, 1, 0, 4, 3, 2], [7, 6, 5, 9, 8, 2, 1, 0, 4, 3], [8, 7, 6, 5, 9, 3, 2, 1, 0, 4], [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]]; // permutation table\n\n      var p = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [1, 5, 7, 6, 2, 8, 3, 0, 9, 4], [5, 8, 0, 3, 7, 9, 6, 1, 4, 2], [8, 9, 1, 6, 0, 4, 3, 5, 2, 7], [9, 4, 5, 3, 1, 2, 6, 8, 7, 0], [4, 2, 8, 6, 5, 7, 3, 9, 0, 1], [2, 7, 9, 3, 8, 0, 6, 4, 1, 5], [7, 0, 4, 6, 9, 1, 3, 2, 5, 8]]; // sanitize user input\n\n      var sanitized = str.trim(); // validate the data structure\n\n      if (!DNI.test(sanitized)) {\n        return false;\n      }\n\n      var c = 0;\n      var invertedArray = sanitized.replace(/\\s/g, '').split('').map(Number).reverse();\n      invertedArray.forEach(function (val, i) {\n        c = d[c][p[i % 8][val]];\n      });\n      return c === 0;\n    },\n    IR: function IR(str) {\n      if (!str.match(/^\\d{10}$/)) return false;\n      str = \"0000\".concat(str).substr(str.length - 6);\n      if (parseInt(str.substr(3, 6), 10) === 0) return false;\n      var lastNumber = parseInt(str.substr(9, 1), 10);\n      var sum = 0;\n\n      for (var i = 0; i < 9; i++) {\n        sum += parseInt(str.substr(i, 1), 10) * (10 - i);\n      }\n\n      sum %= 11;\n      return sum < 2 && lastNumber === sum || sum >= 2 && lastNumber === 11 - sum;\n    },\n    IT: function IT(str) {\n      if (str.length !== 9) return false;\n      if (str === 'CA00000AA') return false; // https://it.wikipedia.org/wiki/Carta_d%27identit%C3%A0_elettronica_italiana\n\n      return str.search(/C[A-Z][0-9]{5}[A-Z]{2}/i) > -1;\n    },\n    NO: function NO(str) {\n      var sanitized = str.trim();\n      if (isNaN(Number(sanitized))) return false;\n      if (sanitized.length !== 11) return false;\n      if (sanitized === '00000000000') return false; // https://no.wikipedia.org/wiki/F%C3%B8dselsnummer\n\n      var f = sanitized.split('').map(Number);\n      var k1 = (11 - (3 * f[0] + 7 * f[1] + 6 * f[2] + 1 * f[3] + 8 * f[4] + 9 * f[5] + 4 * f[6] + 5 * f[7] + 2 * f[8]) % 11) % 11;\n      var k2 = (11 - (5 * f[0] + 4 * f[1] + 3 * f[2] + 2 * f[3] + 7 * f[4] + 6 * f[5] + 5 * f[6] + 4 * f[7] + 3 * f[8] + 2 * k1) % 11) % 11;\n      if (k1 !== f[9] || k2 !== f[10]) return false;\n      return true;\n    },\n    TH: function TH(str) {\n      if (!str.match(/^[1-8]\\d{12}$/)) return false; // validate check digit\n\n      var sum = 0;\n\n      for (var i = 0; i < 12; i++) {\n        sum += parseInt(str[i], 10) * (13 - i);\n      }\n\n      return str[12] === ((11 - sum % 11) % 10).toString();\n    },\n    LK: function LK(str) {\n      var old_nic = /^[1-9]\\d{8}[vx]$/i;\n      var new_nic = /^[1-9]\\d{11}$/i;\n      if (str.length === 10 && old_nic.test(str)) return true;else if (str.length === 12 && new_nic.test(str)) return true;\n      return false;\n    },\n    'he-IL': function heIL(str) {\n      var DNI = /^\\d{9}$/; // sanitize user input\n\n      var sanitized = str.trim(); // validate the data structure\n\n      if (!DNI.test(sanitized)) {\n        return false;\n      }\n\n      var id = sanitized;\n      var sum = 0,\n          incNum;\n\n      for (var i = 0; i < id.length; i++) {\n        incNum = Number(id[i]) * (i % 2 + 1); // Multiply number by 1 or 2\n\n        sum += incNum > 9 ? incNum - 9 : incNum; // Sum the digits up and add to total\n      }\n\n      return sum % 10 === 0;\n    },\n    'ar-LY': function arLY(str) {\n      // Libya National Identity Number NIN is 12 digits, the first digit is either 1 or 2\n      var NIN = /^(1|2)\\d{11}$/; // sanitize user input\n\n      var sanitized = str.trim(); // validate the data structure\n\n      if (!NIN.test(sanitized)) {\n        return false;\n      }\n\n      return true;\n    },\n    'ar-TN': function arTN(str) {\n      var DNI = /^\\d{8}$/; // sanitize user input\n\n      var sanitized = str.trim(); // validate the data structure\n\n      if (!DNI.test(sanitized)) {\n        return false;\n      }\n\n      return true;\n    },\n    'zh-CN': function zhCN(str) {\n      var provincesAndCities = ['11', // 北京\n      '12', // 天津\n      '13', // 河北\n      '14', // 山西\n      '15', // 内蒙古\n      '21', // 辽宁\n      '22', // 吉林\n      '23', // 黑龙江\n      '31', // 上海\n      '32', // 江苏\n      '33', // 浙江\n      '34', // 安徽\n      '35', // 福建\n      '36', // 江西\n      '37', // 山东\n      '41', // 河南\n      '42', // 湖北\n      '43', // 湖南\n      '44', // 广东\n      '45', // 广西\n      '46', // 海南\n      '50', // 重庆\n      '51', // 四川\n      '52', // 贵州\n      '53', // 云南\n      '54', // 西藏\n      '61', // 陕西\n      '62', // 甘肃\n      '63', // 青海\n      '64', // 宁夏\n      '65', // 新疆\n      '71', // 台湾\n      '81', // 香港\n      '82', // 澳门\n      '91' // 国外\n      ];\n      var powers = ['7', '9', '10', '5', '8', '4', '2', '1', '6', '3', '7', '9', '10', '5', '8', '4', '2'];\n      var parityBit = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];\n\n      var checkAddressCode = function checkAddressCode(addressCode) {\n        return provincesAndCities.includes(addressCode);\n      };\n\n      var checkBirthDayCode = function checkBirthDayCode(birDayCode) {\n        var yyyy = parseInt(birDayCode.substring(0, 4), 10);\n        var mm = parseInt(birDayCode.substring(4, 6), 10);\n        var dd = parseInt(birDayCode.substring(6), 10);\n        var xdata = new Date(yyyy, mm - 1, dd);\n\n        if (xdata > new Date()) {\n          return false; // eslint-disable-next-line max-len\n        } else if (xdata.getFullYear() === yyyy && xdata.getMonth() === mm - 1 && xdata.getDate() === dd) {\n          return true;\n        }\n\n        return false;\n      };\n\n      var getParityBit = function getParityBit(idCardNo) {\n        var id17 = idCardNo.substring(0, 17);\n        var power = 0;\n\n        for (var i = 0; i < 17; i++) {\n          power += parseInt(id17.charAt(i), 10) * parseInt(powers[i], 10);\n        }\n\n        var mod = power % 11;\n        return parityBit[mod];\n      };\n\n      var checkParityBit = function checkParityBit(idCardNo) {\n        return getParityBit(idCardNo) === idCardNo.charAt(17).toUpperCase();\n      };\n\n      var check15IdCardNo = function check15IdCardNo(idCardNo) {\n        var check = /^[1-9]\\d{7}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\\d{3}$/.test(idCardNo);\n        if (!check) return false;\n        var addressCode = idCardNo.substring(0, 2);\n        check = checkAddressCode(addressCode);\n        if (!check) return false;\n        var birDayCode = \"19\".concat(idCardNo.substring(6, 12));\n        check = checkBirthDayCode(birDayCode);\n        if (!check) return false;\n        return true;\n      };\n\n      var check18IdCardNo = function check18IdCardNo(idCardNo) {\n        var check = /^[1-9]\\d{5}[1-9]\\d{3}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\\d{3}(\\d|x|X)$/.test(idCardNo);\n        if (!check) return false;\n        var addressCode = idCardNo.substring(0, 2);\n        check = checkAddressCode(addressCode);\n        if (!check) return false;\n        var birDayCode = idCardNo.substring(6, 14);\n        check = checkBirthDayCode(birDayCode);\n        if (!check) return false;\n        return checkParityBit(idCardNo);\n      };\n\n      var checkIdCardNo = function checkIdCardNo(idCardNo) {\n        var check = /^\\d{15}|(\\d{17}(\\d|x|X))$/.test(idCardNo);\n        if (!check) return false;\n\n        if (idCardNo.length === 15) {\n          return check15IdCardNo(idCardNo);\n        }\n\n        return check18IdCardNo(idCardNo);\n      };\n\n      return checkIdCardNo(str);\n    },\n    'zh-TW': function zhTW(str) {\n      var ALPHABET_CODES = {\n        A: 10,\n        B: 11,\n        C: 12,\n        D: 13,\n        E: 14,\n        F: 15,\n        G: 16,\n        H: 17,\n        I: 34,\n        J: 18,\n        K: 19,\n        L: 20,\n        M: 21,\n        N: 22,\n        O: 35,\n        P: 23,\n        Q: 24,\n        R: 25,\n        S: 26,\n        T: 27,\n        U: 28,\n        V: 29,\n        W: 32,\n        X: 30,\n        Y: 31,\n        Z: 33\n      };\n      var sanitized = str.trim().toUpperCase();\n      if (!/^[A-Z][0-9]{9}$/.test(sanitized)) return false;\n      return Array.from(sanitized).reduce(function (sum, number, index) {\n        if (index === 0) {\n          var code = ALPHABET_CODES[number];\n          return code % 10 * 9 + Math.floor(code / 10);\n        }\n\n        if (index === 9) {\n          return (10 - sum % 10 - Number(number)) % 10 === 0;\n        }\n\n        return sum + Number(number) * (9 - index);\n      }, 0);\n    }\n  };\n\n  function isIdentityCard(str, locale) {\n    (0, _assertString.default)(str);\n\n    if (locale in validators) {\n      return validators[locale](str);\n    } else if (locale === 'any') {\n      for (var key in validators) {\n        // https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\n        // istanbul ignore else\n        if (validators.hasOwnProperty(key)) {\n          var validator = validators[key];\n\n          if (validator(str)) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isIdentityCard, isIdentityCard.exports);\n\nvar isEAN = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isEAN;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /**\n   * The most commonly used EAN standard is\n   * the thirteen-digit EAN-13, while the\n   * less commonly used 8-digit EAN-8 barcode was\n   * introduced for use on small packages.\n   * Also EAN/UCC-14 is used for Grouping of individual\n   * trade items above unit level(Intermediate, Carton or Pallet).\n   * For more info about EAN-14 checkout: https://www.gtin.info/itf-14-barcodes/\n   * EAN consists of:\n   * GS1 prefix, manufacturer code, product code and check digit\n   * Reference: https://en.wikipedia.org/wiki/International_Article_Number\n   * Reference: https://www.gtin.info/\n   */\n\n  /**\n   * Define EAN Lenghts; 8 for EAN-8; 13 for EAN-13; 14 for EAN-14\n   * and Regular Expression for valid EANs (EAN-8, EAN-13, EAN-14),\n   * with exact numberic matching of 8 or 13 or 14 digits [0-9]\n   */\n\n\n  var LENGTH_EAN_8 = 8;\n  var LENGTH_EAN_14 = 14;\n  var validEanRegex = /^(\\d{8}|\\d{13}|\\d{14})$/;\n  /**\n   * Get position weight given:\n   * EAN length and digit index/position\n   *\n   * @param {number} length\n   * @param {number} index\n   * @return {number}\n   */\n\n  function getPositionWeightThroughLengthAndIndex(length, index) {\n    if (length === LENGTH_EAN_8 || length === LENGTH_EAN_14) {\n      return index % 2 === 0 ? 3 : 1;\n    }\n\n    return index % 2 === 0 ? 1 : 3;\n  }\n  /**\n   * Calculate EAN Check Digit\n   * Reference: https://en.wikipedia.org/wiki/International_Article_Number#Calculation_of_checksum_digit\n   *\n   * @param {string} ean\n   * @return {number}\n   */\n\n\n  function calculateCheckDigit(ean) {\n    var checksum = ean.slice(0, -1).split('').map(function (char, index) {\n      return Number(char) * getPositionWeightThroughLengthAndIndex(ean.length, index);\n    }).reduce(function (acc, partialSum) {\n      return acc + partialSum;\n    }, 0);\n    var remainder = 10 - checksum % 10;\n    return remainder < 10 ? remainder : 0;\n  }\n  /**\n   * Check if string is valid EAN:\n   * Matches EAN-8/EAN-13/EAN-14 regex\n   * Has valid check digit.\n   *\n   * @param {string} str\n   * @return {boolean}\n   */\n\n\n  function isEAN(str) {\n    (0, _assertString.default)(str);\n    var actualCheckDigit = Number(str.slice(-1));\n    return validEanRegex.test(str) && actualCheckDigit === calculateCheckDigit(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isEAN, isEAN.exports);\n\nvar isISIN = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISIN;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var isin = /^[A-Z]{2}[0-9A-Z]{9}[0-9]$/; // this link details how the check digit is calculated:\n  // https://www.isin.org/isin-format/. it is a little bit\n  // odd in that it works with digits, not numbers. in order\n  // to make only one pass through the ISIN characters, the\n  // each alpha character is handled as 2 characters within\n  // the loop.\n\n  function isISIN(str) {\n    (0, _assertString.default)(str);\n\n    if (!isin.test(str)) {\n      return false;\n    }\n\n    var double = true;\n    var sum = 0; // convert values\n\n    for (var i = str.length - 2; i >= 0; i--) {\n      if (str[i] >= 'A' && str[i] <= 'Z') {\n        var value = str[i].charCodeAt(0) - 55;\n        var lo = value % 10;\n        var hi = Math.trunc(value / 10); // letters have two digits, so handle the low order\n        // and high order digits separately.\n\n        for (var _i = 0, _arr = [lo, hi]; _i < _arr.length; _i++) {\n          var digit = _arr[_i];\n\n          if (double) {\n            if (digit >= 5) {\n              sum += 1 + (digit - 5) * 2;\n            } else {\n              sum += digit * 2;\n            }\n          } else {\n            sum += digit;\n          }\n\n          double = !double;\n        }\n      } else {\n        var _digit = str[i].charCodeAt(0) - '0'.charCodeAt(0);\n\n        if (double) {\n          if (_digit >= 5) {\n            sum += 1 + (_digit - 5) * 2;\n          } else {\n            sum += _digit * 2;\n          }\n        } else {\n          sum += _digit;\n        }\n\n        double = !double;\n      }\n    }\n\n    var check = Math.trunc((sum + 9) / 10) * 10 - sum;\n    return +str[str.length - 1] === check;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISIN, isISIN.exports);\n\nvar isISBN = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISBN;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var isbn10Maybe = /^(?:[0-9]{9}X|[0-9]{10})$/;\n  var isbn13Maybe = /^(?:[0-9]{13})$/;\n  var factor = [1, 3];\n\n  function isISBN(str) {\n    var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    (0, _assertString.default)(str);\n    version = String(version);\n\n    if (!version) {\n      return isISBN(str, 10) || isISBN(str, 13);\n    }\n\n    var sanitized = str.replace(/[\\s-]+/g, '');\n    var checksum = 0;\n    var i;\n\n    if (version === '10') {\n      if (!isbn10Maybe.test(sanitized)) {\n        return false;\n      }\n\n      for (i = 0; i < 9; i++) {\n        checksum += (i + 1) * sanitized.charAt(i);\n      }\n\n      if (sanitized.charAt(9) === 'X') {\n        checksum += 10 * 10;\n      } else {\n        checksum += 10 * sanitized.charAt(9);\n      }\n\n      if (checksum % 11 === 0) {\n        return !!sanitized;\n      }\n    } else if (version === '13') {\n      if (!isbn13Maybe.test(sanitized)) {\n        return false;\n      }\n\n      for (i = 0; i < 12; i++) {\n        checksum += factor[i % 2] * sanitized.charAt(i);\n      }\n\n      if (sanitized.charAt(12) - (10 - checksum % 10) % 10 === 0) {\n        return !!sanitized;\n      }\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISBN, isISBN.exports);\n\nvar isISSN = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISSN;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var issn = '^\\\\d{4}-?\\\\d{3}[\\\\dX]$';\n\n  function isISSN(str) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    (0, _assertString.default)(str);\n    var testIssn = issn;\n    testIssn = options.require_hyphen ? testIssn.replace('?', '') : testIssn;\n    testIssn = options.case_sensitive ? new RegExp(testIssn) : new RegExp(testIssn, 'i');\n\n    if (!testIssn.test(str)) {\n      return false;\n    }\n\n    var digits = str.replace('-', '').toUpperCase();\n    var checksum = 0;\n\n    for (var i = 0; i < digits.length; i++) {\n      var digit = digits[i];\n      checksum += (digit === 'X' ? 10 : +digit) * (8 - i);\n    }\n\n    return checksum % 11 === 0;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISSN, isISSN.exports);\n\nvar isTaxID = {\n  exports: {}\n};\nvar algorithms = {};\nObject.defineProperty(algorithms, \"__esModule\", {\n  value: true\n});\nalgorithms.iso7064Check = iso7064Check;\nalgorithms.luhnCheck = luhnCheck;\nalgorithms.reverseMultiplyAndSum = reverseMultiplyAndSum;\nalgorithms.verhoeffCheck = verhoeffCheck;\n/**\n * Algorithmic validation functions\n * May be used as is or implemented in the workflow of other validators.\n */\n\n/*\n * ISO 7064 validation function\n * Called with a string of numbers (incl. check digit)\n * to validate according to ISO 7064 (MOD 11, 10).\n */\n\nfunction iso7064Check(str) {\n  var checkvalue = 10;\n\n  for (var i = 0; i < str.length - 1; i++) {\n    checkvalue = (parseInt(str[i], 10) + checkvalue) % 10 === 0 ? 10 * 2 % 11 : (parseInt(str[i], 10) + checkvalue) % 10 * 2 % 11;\n  }\n\n  checkvalue = checkvalue === 1 ? 0 : 11 - checkvalue;\n  return checkvalue === parseInt(str[10], 10);\n}\n/*\n * Luhn (mod 10) validation function\n * Called with a string of numbers (incl. check digit)\n * to validate according to the Luhn algorithm.\n */\n\n\nfunction luhnCheck(str) {\n  var checksum = 0;\n  var second = false;\n\n  for (var i = str.length - 1; i >= 0; i--) {\n    if (second) {\n      var product = parseInt(str[i], 10) * 2;\n\n      if (product > 9) {\n        // sum digits of product and add to checksum\n        checksum += product.toString().split('').map(function (a) {\n          return parseInt(a, 10);\n        }).reduce(function (a, b) {\n          return a + b;\n        }, 0);\n      } else {\n        checksum += product;\n      }\n    } else {\n      checksum += parseInt(str[i], 10);\n    }\n\n    second = !second;\n  }\n\n  return checksum % 10 === 0;\n}\n/*\n * Reverse TIN multiplication and summation helper function\n * Called with an array of single-digit integers and a base multiplier\n * to calculate the sum of the digits multiplied in reverse.\n * Normally used in variations of MOD 11 algorithmic checks.\n */\n\n\nfunction reverseMultiplyAndSum(digits, base) {\n  var total = 0;\n\n  for (var i = 0; i < digits.length; i++) {\n    total += digits[i] * (base - i);\n  }\n\n  return total;\n}\n/*\n * Verhoeff validation helper function\n * Called with a string of numbers\n * to validate according to the Verhoeff algorithm.\n */\n\n\nfunction verhoeffCheck(str) {\n  var d_table = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [1, 2, 3, 4, 0, 6, 7, 8, 9, 5], [2, 3, 4, 0, 1, 7, 8, 9, 5, 6], [3, 4, 0, 1, 2, 8, 9, 5, 6, 7], [4, 0, 1, 2, 3, 9, 5, 6, 7, 8], [5, 9, 8, 7, 6, 0, 4, 3, 2, 1], [6, 5, 9, 8, 7, 1, 0, 4, 3, 2], [7, 6, 5, 9, 8, 2, 1, 0, 4, 3], [8, 7, 6, 5, 9, 3, 2, 1, 0, 4], [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]];\n  var p_table = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [1, 5, 7, 6, 2, 8, 3, 0, 9, 4], [5, 8, 0, 3, 7, 9, 6, 1, 4, 2], [8, 9, 1, 6, 0, 4, 3, 5, 2, 7], [9, 4, 5, 3, 1, 2, 6, 8, 7, 0], [4, 2, 8, 6, 5, 7, 3, 9, 0, 1], [2, 7, 9, 3, 8, 0, 6, 4, 1, 5], [7, 0, 4, 6, 9, 1, 3, 2, 5, 8]]; // Copy (to prevent replacement) and reverse\n\n  var str_copy = str.split('').reverse().join('');\n  var checksum = 0;\n\n  for (var i = 0; i < str_copy.length; i++) {\n    checksum = d_table[checksum][p_table[i % 8][parseInt(str_copy[i], 10)]];\n  }\n\n  return checksum === 0;\n}\n\n(function (module, exports) {\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isTaxID;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var algorithms$1 = _interopRequireWildcard(algorithms);\n\n  var _isDate = _interopRequireDefault(isDate$2.exports);\n\n  function _getRequireWildcardCache() {\n    if (typeof WeakMap !== \"function\") return null;\n    var cache = new WeakMap();\n\n    _getRequireWildcardCache = function _getRequireWildcardCache() {\n      return cache;\n    };\n\n    return cache;\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    }\n\n    if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n      return {\n        default: obj\n      };\n    }\n\n    var cache = _getRequireWildcardCache();\n\n    if (cache && cache.has(obj)) {\n      return cache.get(obj);\n    }\n\n    var newObj = {};\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n        if (desc && (desc.get || desc.set)) {\n          Object.defineProperty(newObj, key, desc);\n        } else {\n          newObj[key] = obj[key];\n        }\n      }\n    }\n\n    newObj.default = obj;\n\n    if (cache) {\n      cache.set(obj, newObj);\n    }\n\n    return newObj;\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n  /**\n   * TIN Validation\n   * Validates Tax Identification Numbers (TINs) from the US, EU member states and the United Kingdom.\n   *\n   * EU-UK:\n   * National TIN validity is calculated using public algorithms as made available by DG TAXUD.\n   *\n   * See `https://ec.europa.eu/taxation_customs/tin/specs/FS-TIN%20Algorithms-Public.docx` for more information.\n   *\n   * US:\n   * An Employer Identification Number (EIN), also known as a Federal Tax Identification Number,\n   *  is used to identify a business entity.\n   *\n   * NOTES:\n   *  - Prefix 47 is being reserved for future use\n   *  - Prefixes 26, 27, 45, 46 and 47 were previously assigned by the Philadelphia campus.\n   *\n   * See `http://www.irs.gov/Businesses/Small-Businesses-&-Self-Employed/How-EINs-are-Assigned-and-Valid-EIN-Prefixes`\n   * for more information.\n   */\n  // Locale functions\n\n  /*\n   * bg-BG validation function\n   * (Edinen graždanski nomer (EGN/ЕГН), persons only)\n   * Checks if birth date (first six digits) is valid and calculates check (last) digit\n   */\n\n\n  function bgBgCheck(tin) {\n    // Extract full year, normalize month and check birth date validity\n    var century_year = tin.slice(0, 2);\n    var month = parseInt(tin.slice(2, 4), 10);\n\n    if (month > 40) {\n      month -= 40;\n      century_year = \"20\".concat(century_year);\n    } else if (month > 20) {\n      month -= 20;\n      century_year = \"18\".concat(century_year);\n    } else {\n      century_year = \"19\".concat(century_year);\n    }\n\n    if (month < 10) {\n      month = \"0\".concat(month);\n    }\n\n    var date = \"\".concat(century_year, \"/\").concat(month, \"/\").concat(tin.slice(4, 6));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // split digits into an array for further processing\n\n\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    }); // Calculate checksum by multiplying digits with fixed values\n\n    var multip_lookup = [2, 4, 8, 5, 10, 9, 7, 3, 6];\n    var checksum = 0;\n\n    for (var i = 0; i < multip_lookup.length; i++) {\n      checksum += digits[i] * multip_lookup[i];\n    }\n\n    checksum = checksum % 11 === 10 ? 0 : checksum % 11;\n    return checksum === digits[9];\n  }\n  /*\n   * cs-CZ validation function\n   * (Rodné číslo (RČ), persons only)\n   * Checks if birth date (first six digits) is valid and divisibility by 11\n   * Material not in DG TAXUD document sourced from:\n   * -`https://lorenc.info/3MA381/overeni-spravnosti-rodneho-cisla.htm`\n   * -`https://www.mvcr.cz/clanek/rady-a-sluzby-dokumenty-rodne-cislo.aspx`\n   */\n\n\n  function csCzCheck(tin) {\n    tin = tin.replace(/\\W/, ''); // Extract full year from TIN length\n\n    var full_year = parseInt(tin.slice(0, 2), 10);\n\n    if (tin.length === 10) {\n      if (full_year < 54) {\n        full_year = \"20\".concat(full_year);\n      } else {\n        full_year = \"19\".concat(full_year);\n      }\n    } else {\n      if (tin.slice(6) === '000') {\n        return false;\n      } // Three-zero serial not assigned before 1954\n\n\n      if (full_year < 54) {\n        full_year = \"19\".concat(full_year);\n      } else {\n        return false; // No 18XX years seen in any of the resources\n      }\n    } // Add missing zero if needed\n\n\n    if (full_year.length === 3) {\n      full_year = [full_year.slice(0, 2), '0', full_year.slice(2)].join('');\n    } // Extract month from TIN and normalize\n\n\n    var month = parseInt(tin.slice(2, 4), 10);\n\n    if (month > 50) {\n      month -= 50;\n    }\n\n    if (month > 20) {\n      // Month-plus-twenty was only introduced in 2004\n      if (parseInt(full_year, 10) < 2004) {\n        return false;\n      }\n\n      month -= 20;\n    }\n\n    if (month < 10) {\n      month = \"0\".concat(month);\n    } // Check date validity\n\n\n    var date = \"\".concat(full_year, \"/\").concat(month, \"/\").concat(tin.slice(4, 6));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Verify divisibility by 11\n\n\n    if (tin.length === 10) {\n      if (parseInt(tin, 10) % 11 !== 0) {\n        // Some numbers up to and including 1985 are still valid if\n        // check (last) digit equals 0 and modulo of first 9 digits equals 10\n        var checkdigit = parseInt(tin.slice(0, 9), 10) % 11;\n\n        if (parseInt(full_year, 10) < 1986 && checkdigit === 10) {\n          if (parseInt(tin.slice(9), 10) !== 0) {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n  /*\n   * de-AT validation function\n   * (Abgabenkontonummer, persons/entities)\n   * Verify TIN validity by calling luhnCheck()\n   */\n\n\n  function deAtCheck(tin) {\n    return algorithms$1.luhnCheck(tin);\n  }\n  /*\n   * de-DE validation function\n   * (Steueridentifikationsnummer (Steuer-IdNr.), persons only)\n   * Tests for single duplicate/triplicate value, then calculates ISO 7064 check (last) digit\n   * Partial implementation of spec (same result with both algorithms always)\n   */\n\n\n  function deDeCheck(tin) {\n    // Split digits into an array for further processing\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    }); // Fill array with strings of number positions\n\n    var occurences = [];\n\n    for (var i = 0; i < digits.length - 1; i++) {\n      occurences.push('');\n\n      for (var j = 0; j < digits.length - 1; j++) {\n        if (digits[i] === digits[j]) {\n          occurences[i] += j;\n        }\n      }\n    } // Remove digits with one occurence and test for only one duplicate/triplicate\n\n\n    occurences = occurences.filter(function (a) {\n      return a.length > 1;\n    });\n\n    if (occurences.length !== 2 && occurences.length !== 3) {\n      return false;\n    } // In case of triplicate value only two digits are allowed next to each other\n\n\n    if (occurences[0].length === 3) {\n      var trip_locations = occurences[0].split('').map(function (a) {\n        return parseInt(a, 10);\n      });\n      var recurrent = 0; // Amount of neighbour occurences\n\n      for (var _i = 0; _i < trip_locations.length - 1; _i++) {\n        if (trip_locations[_i] + 1 === trip_locations[_i + 1]) {\n          recurrent += 1;\n        }\n      }\n\n      if (recurrent === 2) {\n        return false;\n      }\n    }\n\n    return algorithms$1.iso7064Check(tin);\n  }\n  /*\n   * dk-DK validation function\n   * (CPR-nummer (personnummer), persons only)\n   * Checks if birth date (first six digits) is valid and assigned to century (seventh) digit,\n   * and calculates check (last) digit\n   */\n\n\n  function dkDkCheck(tin) {\n    tin = tin.replace(/\\W/, ''); // Extract year, check if valid for given century digit and add century\n\n    var year = parseInt(tin.slice(4, 6), 10);\n    var century_digit = tin.slice(6, 7);\n\n    switch (century_digit) {\n      case '0':\n      case '1':\n      case '2':\n      case '3':\n        year = \"19\".concat(year);\n        break;\n\n      case '4':\n      case '9':\n        if (year < 37) {\n          year = \"20\".concat(year);\n        } else {\n          year = \"19\".concat(year);\n        }\n\n        break;\n\n      default:\n        if (year < 37) {\n          year = \"20\".concat(year);\n        } else if (year > 58) {\n          year = \"18\".concat(year);\n        } else {\n          return false;\n        }\n\n        break;\n    } // Add missing zero if needed\n\n\n    if (year.length === 3) {\n      year = [year.slice(0, 2), '0', year.slice(2)].join('');\n    } // Check date validity\n\n\n    var date = \"\".concat(year, \"/\").concat(tin.slice(2, 4), \"/\").concat(tin.slice(0, 2));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Split digits into an array for further processing\n\n\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    });\n    var checksum = 0;\n    var weight = 4; // Multiply by weight and add to checksum\n\n    for (var i = 0; i < 9; i++) {\n      checksum += digits[i] * weight;\n      weight -= 1;\n\n      if (weight === 1) {\n        weight = 7;\n      }\n    }\n\n    checksum %= 11;\n\n    if (checksum === 1) {\n      return false;\n    }\n\n    return checksum === 0 ? digits[9] === 0 : digits[9] === 11 - checksum;\n  }\n  /*\n   * el-CY validation function\n   * (Arithmos Forologikou Mitroou (AFM/ΑΦΜ), persons only)\n   * Verify TIN validity by calculating ASCII value of check (last) character\n   */\n\n\n  function elCyCheck(tin) {\n    // split digits into an array for further processing\n    var digits = tin.slice(0, 8).split('').map(function (a) {\n      return parseInt(a, 10);\n    });\n    var checksum = 0; // add digits in even places\n\n    for (var i = 1; i < digits.length; i += 2) {\n      checksum += digits[i];\n    } // add digits in odd places\n\n\n    for (var _i2 = 0; _i2 < digits.length; _i2 += 2) {\n      if (digits[_i2] < 2) {\n        checksum += 1 - digits[_i2];\n      } else {\n        checksum += 2 * (digits[_i2] - 2) + 5;\n\n        if (digits[_i2] > 4) {\n          checksum += 2;\n        }\n      }\n    }\n\n    return String.fromCharCode(checksum % 26 + 65) === tin.charAt(8);\n  }\n  /*\n   * el-GR validation function\n   * (Arithmos Forologikou Mitroou (AFM/ΑΦΜ), persons/entities)\n   * Verify TIN validity by calculating check (last) digit\n   * Algorithm not in DG TAXUD document- sourced from:\n   * - `http://epixeirisi.gr/%CE%9A%CE%A1%CE%99%CE%A3%CE%99%CE%9C%CE%91-%CE%98%CE%95%CE%9C%CE%91%CE%A4%CE%91-%CE%A6%CE%9F%CE%A1%CE%9F%CE%9B%CE%9F%CE%93%CE%99%CE%91%CE%A3-%CE%9A%CE%91%CE%99-%CE%9B%CE%9F%CE%93%CE%99%CE%A3%CE%A4%CE%99%CE%9A%CE%97%CE%A3/23791/%CE%91%CF%81%CE%B9%CE%B8%CE%BC%CF%8C%CF%82-%CE%A6%CE%BF%CF%81%CE%BF%CE%BB%CE%BF%CE%B3%CE%B9%CE%BA%CE%BF%CF%8D-%CE%9C%CE%B7%CF%84%CF%81%CF%8E%CE%BF%CF%85`\n   */\n\n\n  function elGrCheck(tin) {\n    // split digits into an array for further processing\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    });\n    var checksum = 0;\n\n    for (var i = 0; i < 8; i++) {\n      checksum += digits[i] * Math.pow(2, 8 - i);\n    }\n\n    return checksum % 11 % 10 === digits[8];\n  }\n  /*\n   * en-GB validation function (should go here if needed)\n   * (National Insurance Number (NINO) or Unique Taxpayer Reference (UTR),\n   * persons/entities respectively)\n   */\n\n  /*\n   * en-IE validation function\n   * (Personal Public Service Number (PPS No), persons only)\n   * Verify TIN validity by calculating check (second to last) character\n   */\n\n\n  function enIeCheck(tin) {\n    var checksum = algorithms$1.reverseMultiplyAndSum(tin.split('').slice(0, 7).map(function (a) {\n      return parseInt(a, 10);\n    }), 8);\n\n    if (tin.length === 9 && tin[8] !== 'W') {\n      checksum += (tin[8].charCodeAt(0) - 64) * 9;\n    }\n\n    checksum %= 23;\n\n    if (checksum === 0) {\n      return tin[7].toUpperCase() === 'W';\n    }\n\n    return tin[7].toUpperCase() === String.fromCharCode(64 + checksum);\n  } // Valid US IRS campus prefixes\n\n\n  var enUsCampusPrefix = {\n    andover: ['10', '12'],\n    atlanta: ['60', '67'],\n    austin: ['50', '53'],\n    brookhaven: ['01', '02', '03', '04', '05', '06', '11', '13', '14', '16', '21', '22', '23', '25', '34', '51', '52', '54', '55', '56', '57', '58', '59', '65'],\n    cincinnati: ['30', '32', '35', '36', '37', '38', '61'],\n    fresno: ['15', '24'],\n    internet: ['20', '26', '27', '45', '46', '47'],\n    kansas: ['40', '44'],\n    memphis: ['94', '95'],\n    ogden: ['80', '90'],\n    philadelphia: ['33', '39', '41', '42', '43', '46', '48', '62', '63', '64', '66', '68', '71', '72', '73', '74', '75', '76', '77', '81', '82', '83', '84', '85', '86', '87', '88', '91', '92', '93', '98', '99'],\n    sba: ['31']\n  }; // Return an array of all US IRS campus prefixes\n\n  function enUsGetPrefixes() {\n    var prefixes = [];\n\n    for (var location in enUsCampusPrefix) {\n      // https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\n      // istanbul ignore else\n      if (enUsCampusPrefix.hasOwnProperty(location)) {\n        prefixes.push.apply(prefixes, _toConsumableArray(enUsCampusPrefix[location]));\n      }\n    }\n\n    return prefixes;\n  }\n  /*\n   * en-US validation function\n   * Verify that the TIN starts with a valid IRS campus prefix\n   */\n\n\n  function enUsCheck(tin) {\n    return enUsGetPrefixes().indexOf(tin.substr(0, 2)) !== -1;\n  }\n  /*\n   * es-ES validation function\n   * (Documento Nacional de Identidad (DNI)\n   * or Número de Identificación de Extranjero (NIE), persons only)\n   * Verify TIN validity by calculating check (last) character\n   */\n\n\n  function esEsCheck(tin) {\n    // Split characters into an array for further processing\n    var chars = tin.toUpperCase().split(''); // Replace initial letter if needed\n\n    if (isNaN(parseInt(chars[0], 10)) && chars.length > 1) {\n      var lead_replace = 0;\n\n      switch (chars[0]) {\n        case 'Y':\n          lead_replace = 1;\n          break;\n\n        case 'Z':\n          lead_replace = 2;\n          break;\n      }\n\n      chars.splice(0, 1, lead_replace); // Fill with zeros if smaller than proper\n    } else {\n      while (chars.length < 9) {\n        chars.unshift(0);\n      }\n    } // Calculate checksum and check according to lookup\n\n\n    var lookup = ['T', 'R', 'W', 'A', 'G', 'M', 'Y', 'F', 'P', 'D', 'X', 'B', 'N', 'J', 'Z', 'S', 'Q', 'V', 'H', 'L', 'C', 'K', 'E'];\n    chars = chars.join('');\n    var checksum = parseInt(chars.slice(0, 8), 10) % 23;\n    return chars[8] === lookup[checksum];\n  }\n  /*\n   * et-EE validation function\n   * (Isikukood (IK), persons only)\n   * Checks if birth date (century digit and six following) is valid and calculates check (last) digit\n   * Material not in DG TAXUD document sourced from:\n   * - `https://www.oecd.org/tax/automatic-exchange/crs-implementation-and-assistance/tax-identification-numbers/Estonia-TIN.pdf`\n   */\n\n\n  function etEeCheck(tin) {\n    // Extract year and add century\n    var full_year = tin.slice(1, 3);\n    var century_digit = tin.slice(0, 1);\n\n    switch (century_digit) {\n      case '1':\n      case '2':\n        full_year = \"18\".concat(full_year);\n        break;\n\n      case '3':\n      case '4':\n        full_year = \"19\".concat(full_year);\n        break;\n\n      default:\n        full_year = \"20\".concat(full_year);\n        break;\n    } // Check date validity\n\n\n    var date = \"\".concat(full_year, \"/\").concat(tin.slice(3, 5), \"/\").concat(tin.slice(5, 7));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Split digits into an array for further processing\n\n\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    });\n    var checksum = 0;\n    var weight = 1; // Multiply by weight and add to checksum\n\n    for (var i = 0; i < 10; i++) {\n      checksum += digits[i] * weight;\n      weight += 1;\n\n      if (weight === 10) {\n        weight = 1;\n      }\n    } // Do again if modulo 11 of checksum is 10\n\n\n    if (checksum % 11 === 10) {\n      checksum = 0;\n      weight = 3;\n\n      for (var _i3 = 0; _i3 < 10; _i3++) {\n        checksum += digits[_i3] * weight;\n        weight += 1;\n\n        if (weight === 10) {\n          weight = 1;\n        }\n      }\n\n      if (checksum % 11 === 10) {\n        return digits[10] === 0;\n      }\n    }\n\n    return checksum % 11 === digits[10];\n  }\n  /*\n   * fi-FI validation function\n   * (Henkilötunnus (HETU), persons only)\n   * Checks if birth date (first six digits plus century symbol) is valid\n   * and calculates check (last) digit\n   */\n\n\n  function fiFiCheck(tin) {\n    // Extract year and add century\n    var full_year = tin.slice(4, 6);\n    var century_symbol = tin.slice(6, 7);\n\n    switch (century_symbol) {\n      case '+':\n        full_year = \"18\".concat(full_year);\n        break;\n\n      case '-':\n        full_year = \"19\".concat(full_year);\n        break;\n\n      default:\n        full_year = \"20\".concat(full_year);\n        break;\n    } // Check date validity\n\n\n    var date = \"\".concat(full_year, \"/\").concat(tin.slice(2, 4), \"/\").concat(tin.slice(0, 2));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Calculate check character\n\n\n    var checksum = parseInt(tin.slice(0, 6) + tin.slice(7, 10), 10) % 31;\n\n    if (checksum < 10) {\n      return checksum === parseInt(tin.slice(10), 10);\n    }\n\n    checksum -= 10;\n    var letters_lookup = ['A', 'B', 'C', 'D', 'E', 'F', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y'];\n    return letters_lookup[checksum] === tin.slice(10);\n  }\n  /*\n   * fr/nl-BE validation function\n   * (Numéro national (N.N.), persons only)\n   * Checks if birth date (first six digits) is valid and calculates check (last two) digits\n   */\n\n\n  function frBeCheck(tin) {\n    // Zero month/day value is acceptable\n    if (tin.slice(2, 4) !== '00' || tin.slice(4, 6) !== '00') {\n      // Extract date from first six digits of TIN\n      var date = \"\".concat(tin.slice(0, 2), \"/\").concat(tin.slice(2, 4), \"/\").concat(tin.slice(4, 6));\n\n      if (!(0, _isDate.default)(date, 'YY/MM/DD')) {\n        return false;\n      }\n    }\n\n    var checksum = 97 - parseInt(tin.slice(0, 9), 10) % 97;\n    var checkdigits = parseInt(tin.slice(9, 11), 10);\n\n    if (checksum !== checkdigits) {\n      checksum = 97 - parseInt(\"2\".concat(tin.slice(0, 9)), 10) % 97;\n\n      if (checksum !== checkdigits) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n  /*\n   * fr-FR validation function\n   * (Numéro fiscal de référence (numéro SPI), persons only)\n   * Verify TIN validity by calculating check (last three) digits\n   */\n\n\n  function frFrCheck(tin) {\n    tin = tin.replace(/\\s/g, '');\n    var checksum = parseInt(tin.slice(0, 10), 10) % 511;\n    var checkdigits = parseInt(tin.slice(10, 13), 10);\n    return checksum === checkdigits;\n  }\n  /*\n   * fr/lb-LU validation function\n   * (numéro d’identification personnelle, persons only)\n   * Verify birth date validity and run Luhn and Verhoeff checks\n   */\n\n\n  function frLuCheck(tin) {\n    // Extract date and check validity\n    var date = \"\".concat(tin.slice(0, 4), \"/\").concat(tin.slice(4, 6), \"/\").concat(tin.slice(6, 8));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Run Luhn check\n\n\n    if (!algorithms$1.luhnCheck(tin.slice(0, 12))) {\n      return false;\n    } // Remove Luhn check digit and run Verhoeff check\n\n\n    return algorithms$1.verhoeffCheck(\"\".concat(tin.slice(0, 11)).concat(tin[12]));\n  }\n  /*\n   * hr-HR validation function\n   * (Osobni identifikacijski broj (OIB), persons/entities)\n   * Verify TIN validity by calling iso7064Check(digits)\n   */\n\n\n  function hrHrCheck(tin) {\n    return algorithms$1.iso7064Check(tin);\n  }\n  /*\n   * hu-HU validation function\n   * (Adóazonosító jel, persons only)\n   * Verify TIN validity by calculating check (last) digit\n   */\n\n\n  function huHuCheck(tin) {\n    // split digits into an array for further processing\n    var digits = tin.split('').map(function (a) {\n      return parseInt(a, 10);\n    });\n    var checksum = 8;\n\n    for (var i = 1; i < 9; i++) {\n      checksum += digits[i] * (i + 1);\n    }\n\n    return checksum % 11 === digits[9];\n  }\n  /*\n   * lt-LT validation function (should go here if needed)\n   * (Asmens kodas, persons/entities respectively)\n   * Current validation check is alias of etEeCheck- same format applies\n   */\n\n  /*\n   * it-IT first/last name validity check\n   * Accepts it-IT TIN-encoded names as a three-element character array and checks their validity\n   * Due to lack of clarity between resources (\"Are only Italian consonants used?\n   * What happens if a person has X in their name?\" etc.) only two test conditions\n   * have been implemented:\n   * Vowels may only be followed by other vowels or an X character\n   * and X characters after vowels may only be followed by other X characters.\n   */\n\n\n  function itItNameCheck(name) {\n    // true at the first occurence of a vowel\n    var vowelflag = false; // true at the first occurence of an X AFTER vowel\n    // (to properly handle last names with X as consonant)\n\n    var xflag = false;\n\n    for (var i = 0; i < 3; i++) {\n      if (!vowelflag && /[AEIOU]/.test(name[i])) {\n        vowelflag = true;\n      } else if (!xflag && vowelflag && name[i] === 'X') {\n        xflag = true;\n      } else if (i > 0) {\n        if (vowelflag && !xflag) {\n          if (!/[AEIOU]/.test(name[i])) {\n            return false;\n          }\n        }\n\n        if (xflag) {\n          if (!/X/.test(name[i])) {\n            return false;\n          }\n        }\n      }\n    }\n\n    return true;\n  }\n  /*\n   * it-IT validation function\n   * (Codice fiscale (TIN-IT), persons only)\n   * Verify name, birth date and codice catastale validity\n   * and calculate check character.\n   * Material not in DG-TAXUD document sourced from:\n   * `https://en.wikipedia.org/wiki/Italian_fiscal_code`\n   */\n\n\n  function itItCheck(tin) {\n    // Capitalize and split characters into an array for further processing\n    var chars = tin.toUpperCase().split(''); // Check first and last name validity calling itItNameCheck()\n\n    if (!itItNameCheck(chars.slice(0, 3))) {\n      return false;\n    }\n\n    if (!itItNameCheck(chars.slice(3, 6))) {\n      return false;\n    } // Convert letters in number spaces back to numbers if any\n\n\n    var number_locations = [6, 7, 9, 10, 12, 13, 14];\n    var number_replace = {\n      L: '0',\n      M: '1',\n      N: '2',\n      P: '3',\n      Q: '4',\n      R: '5',\n      S: '6',\n      T: '7',\n      U: '8',\n      V: '9'\n    };\n\n    for (var _i4 = 0, _number_locations = number_locations; _i4 < _number_locations.length; _i4++) {\n      var i = _number_locations[_i4];\n\n      if (chars[i] in number_replace) {\n        chars.splice(i, 1, number_replace[chars[i]]);\n      }\n    } // Extract month and day, and check date validity\n\n\n    var month_replace = {\n      A: '01',\n      B: '02',\n      C: '03',\n      D: '04',\n      E: '05',\n      H: '06',\n      L: '07',\n      M: '08',\n      P: '09',\n      R: '10',\n      S: '11',\n      T: '12'\n    };\n    var month = month_replace[chars[8]];\n    var day = parseInt(chars[9] + chars[10], 10);\n\n    if (day > 40) {\n      day -= 40;\n    }\n\n    if (day < 10) {\n      day = \"0\".concat(day);\n    }\n\n    var date = \"\".concat(chars[6]).concat(chars[7], \"/\").concat(month, \"/\").concat(day);\n\n    if (!(0, _isDate.default)(date, 'YY/MM/DD')) {\n      return false;\n    } // Calculate check character by adding up even and odd characters as numbers\n\n\n    var checksum = 0;\n\n    for (var _i5 = 1; _i5 < chars.length - 1; _i5 += 2) {\n      var char_to_int = parseInt(chars[_i5], 10);\n\n      if (isNaN(char_to_int)) {\n        char_to_int = chars[_i5].charCodeAt(0) - 65;\n      }\n\n      checksum += char_to_int;\n    }\n\n    var odd_convert = {\n      // Maps of characters at odd places\n      A: 1,\n      B: 0,\n      C: 5,\n      D: 7,\n      E: 9,\n      F: 13,\n      G: 15,\n      H: 17,\n      I: 19,\n      J: 21,\n      K: 2,\n      L: 4,\n      M: 18,\n      N: 20,\n      O: 11,\n      P: 3,\n      Q: 6,\n      R: 8,\n      S: 12,\n      T: 14,\n      U: 16,\n      V: 10,\n      W: 22,\n      X: 25,\n      Y: 24,\n      Z: 23,\n      0: 1,\n      1: 0\n    };\n\n    for (var _i6 = 0; _i6 < chars.length - 1; _i6 += 2) {\n      var _char_to_int = 0;\n\n      if (chars[_i6] in odd_convert) {\n        _char_to_int = odd_convert[chars[_i6]];\n      } else {\n        var multiplier = parseInt(chars[_i6], 10);\n        _char_to_int = 2 * multiplier + 1;\n\n        if (multiplier > 4) {\n          _char_to_int += 2;\n        }\n      }\n\n      checksum += _char_to_int;\n    }\n\n    if (String.fromCharCode(65 + checksum % 26) !== chars[15]) {\n      return false;\n    }\n\n    return true;\n  }\n  /*\n   * lv-LV validation function\n   * (Personas kods (PK), persons only)\n   * Check validity of birth date and calculate check (last) digit\n   * Support only for old format numbers (not starting with '32', issued before 2017/07/01)\n   * Material not in DG TAXUD document sourced from:\n   * `https://boot.ritakafija.lv/forums/index.php?/topic/88314-personas-koda-algoritms-%C4%8Deksumma/`\n   */\n\n\n  function lvLvCheck(tin) {\n    tin = tin.replace(/\\W/, ''); // Extract date from TIN\n\n    var day = tin.slice(0, 2);\n\n    if (day !== '32') {\n      // No date/checksum check if new format\n      var month = tin.slice(2, 4);\n\n      if (month !== '00') {\n        // No date check if unknown month\n        var full_year = tin.slice(4, 6);\n\n        switch (tin[6]) {\n          case '0':\n            full_year = \"18\".concat(full_year);\n            break;\n\n          case '1':\n            full_year = \"19\".concat(full_year);\n            break;\n\n          default:\n            full_year = \"20\".concat(full_year);\n            break;\n        } // Check date validity\n\n\n        var date = \"\".concat(full_year, \"/\").concat(tin.slice(2, 4), \"/\").concat(day);\n\n        if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n          return false;\n        }\n      } // Calculate check digit\n\n\n      var checksum = 1101;\n      var multip_lookup = [1, 6, 3, 7, 9, 10, 5, 8, 4, 2];\n\n      for (var i = 0; i < tin.length - 1; i++) {\n        checksum -= parseInt(tin[i], 10) * multip_lookup[i];\n      }\n\n      return parseInt(tin[10], 10) === checksum % 11;\n    }\n\n    return true;\n  }\n  /*\n   * mt-MT validation function\n   * (Identity Card Number or Unique Taxpayer Reference, persons/entities)\n   * Verify Identity Card Number structure (no other tests found)\n   */\n\n\n  function mtMtCheck(tin) {\n    if (tin.length !== 9) {\n      // No tests for UTR\n      var chars = tin.toUpperCase().split(''); // Fill with zeros if smaller than proper\n\n      while (chars.length < 8) {\n        chars.unshift(0);\n      } // Validate format according to last character\n\n\n      switch (tin[7]) {\n        case 'A':\n        case 'P':\n          if (parseInt(chars[6], 10) === 0) {\n            return false;\n          }\n\n          break;\n\n        default:\n          {\n            var first_part = parseInt(chars.join('').slice(0, 5), 10);\n\n            if (first_part > 32000) {\n              return false;\n            }\n\n            var second_part = parseInt(chars.join('').slice(5, 7), 10);\n\n            if (first_part === second_part) {\n              return false;\n            }\n          }\n      }\n    }\n\n    return true;\n  }\n  /*\n   * nl-NL validation function\n   * (Burgerservicenummer (BSN) or Rechtspersonen Samenwerkingsverbanden Informatie Nummer (RSIN),\n   * persons/entities respectively)\n   * Verify TIN validity by calculating check (last) digit (variant of MOD 11)\n   */\n\n\n  function nlNlCheck(tin) {\n    return algorithms$1.reverseMultiplyAndSum(tin.split('').slice(0, 8).map(function (a) {\n      return parseInt(a, 10);\n    }), 9) % 11 === parseInt(tin[8], 10);\n  }\n  /*\n   * pl-PL validation function\n   * (Powszechny Elektroniczny System Ewidencji Ludności (PESEL)\n   * or Numer identyfikacji podatkowej (NIP), persons/entities)\n   * Verify TIN validity by validating birth date (PESEL) and calculating check (last) digit\n   */\n\n\n  function plPlCheck(tin) {\n    // NIP\n    if (tin.length === 10) {\n      // Calculate last digit by multiplying with lookup\n      var lookup = [6, 5, 7, 2, 3, 4, 5, 6, 7];\n      var _checksum = 0;\n\n      for (var i = 0; i < lookup.length; i++) {\n        _checksum += parseInt(tin[i], 10) * lookup[i];\n      }\n\n      _checksum %= 11;\n\n      if (_checksum === 10) {\n        return false;\n      }\n\n      return _checksum === parseInt(tin[9], 10);\n    } // PESEL\n    // Extract full year using month\n\n\n    var full_year = tin.slice(0, 2);\n    var month = parseInt(tin.slice(2, 4), 10);\n\n    if (month > 80) {\n      full_year = \"18\".concat(full_year);\n      month -= 80;\n    } else if (month > 60) {\n      full_year = \"22\".concat(full_year);\n      month -= 60;\n    } else if (month > 40) {\n      full_year = \"21\".concat(full_year);\n      month -= 40;\n    } else if (month > 20) {\n      full_year = \"20\".concat(full_year);\n      month -= 20;\n    } else {\n      full_year = \"19\".concat(full_year);\n    } // Add leading zero to month if needed\n\n\n    if (month < 10) {\n      month = \"0\".concat(month);\n    } // Check date validity\n\n\n    var date = \"\".concat(full_year, \"/\").concat(month, \"/\").concat(tin.slice(4, 6));\n\n    if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    } // Calculate last digit by mulitplying with odd one-digit numbers except 5\n\n\n    var checksum = 0;\n    var multiplier = 1;\n\n    for (var _i7 = 0; _i7 < tin.length - 1; _i7++) {\n      checksum += parseInt(tin[_i7], 10) * multiplier % 10;\n      multiplier += 2;\n\n      if (multiplier > 10) {\n        multiplier = 1;\n      } else if (multiplier === 5) {\n        multiplier += 2;\n      }\n    }\n\n    checksum = 10 - checksum % 10;\n    return checksum === parseInt(tin[10], 10);\n  }\n  /*\n  * pt-BR validation function\n  * (Cadastro de Pessoas Físicas (CPF, persons)\n  * Cadastro Nacional de Pessoas Jurídicas (CNPJ, entities)\n  * Both inputs will be validated\n  */\n\n\n  function ptBrCheck(tin) {\n    if (tin.length === 11) {\n      var _sum;\n\n      var remainder;\n      _sum = 0;\n      if ( // Reject known invalid CPFs\n      tin === '11111111111' || tin === '22222222222' || tin === '33333333333' || tin === '44444444444' || tin === '55555555555' || tin === '66666666666' || tin === '77777777777' || tin === '88888888888' || tin === '99999999999' || tin === '00000000000') return false;\n\n      for (var i = 1; i <= 9; i++) {\n        _sum += parseInt(tin.substring(i - 1, i), 10) * (11 - i);\n      }\n\n      remainder = _sum * 10 % 11;\n      if (remainder === 10) remainder = 0;\n      if (remainder !== parseInt(tin.substring(9, 10), 10)) return false;\n      _sum = 0;\n\n      for (var _i8 = 1; _i8 <= 10; _i8++) {\n        _sum += parseInt(tin.substring(_i8 - 1, _i8), 10) * (12 - _i8);\n      }\n\n      remainder = _sum * 10 % 11;\n      if (remainder === 10) remainder = 0;\n      if (remainder !== parseInt(tin.substring(10, 11), 10)) return false;\n      return true;\n    }\n\n    if ( // Reject know invalid CNPJs\n    tin === '00000000000000' || tin === '11111111111111' || tin === '22222222222222' || tin === '33333333333333' || tin === '44444444444444' || tin === '55555555555555' || tin === '66666666666666' || tin === '77777777777777' || tin === '88888888888888' || tin === '99999999999999') {\n      return false;\n    }\n\n    var length = tin.length - 2;\n    var identifiers = tin.substring(0, length);\n    var verificators = tin.substring(length);\n    var sum = 0;\n    var pos = length - 7;\n\n    for (var _i9 = length; _i9 >= 1; _i9--) {\n      sum += identifiers.charAt(length - _i9) * pos;\n      pos -= 1;\n\n      if (pos < 2) {\n        pos = 9;\n      }\n    }\n\n    var result = sum % 11 < 2 ? 0 : 11 - sum % 11;\n\n    if (result !== parseInt(verificators.charAt(0), 10)) {\n      return false;\n    }\n\n    length += 1;\n    identifiers = tin.substring(0, length);\n    sum = 0;\n    pos = length - 7;\n\n    for (var _i10 = length; _i10 >= 1; _i10--) {\n      sum += identifiers.charAt(length - _i10) * pos;\n      pos -= 1;\n\n      if (pos < 2) {\n        pos = 9;\n      }\n    }\n\n    result = sum % 11 < 2 ? 0 : 11 - sum % 11;\n\n    if (result !== parseInt(verificators.charAt(1), 10)) {\n      return false;\n    }\n\n    return true;\n  }\n  /*\n   * pt-PT validation function\n   * (Número de identificação fiscal (NIF), persons/entities)\n   * Verify TIN validity by calculating check (last) digit (variant of MOD 11)\n   */\n\n\n  function ptPtCheck(tin) {\n    var checksum = 11 - algorithms$1.reverseMultiplyAndSum(tin.split('').slice(0, 8).map(function (a) {\n      return parseInt(a, 10);\n    }), 9) % 11;\n\n    if (checksum > 9) {\n      return parseInt(tin[8], 10) === 0;\n    }\n\n    return checksum === parseInt(tin[8], 10);\n  }\n  /*\n   * ro-RO validation function\n   * (Cod Numeric Personal (CNP) or Cod de înregistrare fiscală (CIF),\n   * persons only)\n   * Verify CNP validity by calculating check (last) digit (test not found for CIF)\n   * Material not in DG TAXUD document sourced from:\n   * `https://en.wikipedia.org/wiki/National_identification_number#Romania`\n   */\n\n\n  function roRoCheck(tin) {\n    if (tin.slice(0, 4) !== '9000') {\n      // No test found for this format\n      // Extract full year using century digit if possible\n      var full_year = tin.slice(1, 3);\n\n      switch (tin[0]) {\n        case '1':\n        case '2':\n          full_year = \"19\".concat(full_year);\n          break;\n\n        case '3':\n        case '4':\n          full_year = \"18\".concat(full_year);\n          break;\n\n        case '5':\n        case '6':\n          full_year = \"20\".concat(full_year);\n          break;\n      } // Check date validity\n\n\n      var date = \"\".concat(full_year, \"/\").concat(tin.slice(3, 5), \"/\").concat(tin.slice(5, 7));\n\n      if (date.length === 8) {\n        if (!(0, _isDate.default)(date, 'YY/MM/DD')) {\n          return false;\n        }\n      } else if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n        return false;\n      } // Calculate check digit\n\n\n      var digits = tin.split('').map(function (a) {\n        return parseInt(a, 10);\n      });\n      var multipliers = [2, 7, 9, 1, 4, 6, 3, 5, 8, 2, 7, 9];\n      var checksum = 0;\n\n      for (var i = 0; i < multipliers.length; i++) {\n        checksum += digits[i] * multipliers[i];\n      }\n\n      if (checksum % 11 === 10) {\n        return digits[12] === 1;\n      }\n\n      return digits[12] === checksum % 11;\n    }\n\n    return true;\n  }\n  /*\n   * sk-SK validation function\n   * (Rodné číslo (RČ) or bezvýznamové identifikačné číslo (BIČ), persons only)\n   * Checks validity of pre-1954 birth numbers (rodné číslo) only\n   * Due to the introduction of the pseudo-random BIČ it is not possible to test\n   * post-1954 birth numbers without knowing whether they are BIČ or RČ beforehand\n   */\n\n\n  function skSkCheck(tin) {\n    if (tin.length === 9) {\n      tin = tin.replace(/\\W/, '');\n\n      if (tin.slice(6) === '000') {\n        return false;\n      } // Three-zero serial not assigned before 1954\n      // Extract full year from TIN length\n\n\n      var full_year = parseInt(tin.slice(0, 2), 10);\n\n      if (full_year > 53) {\n        return false;\n      }\n\n      if (full_year < 10) {\n        full_year = \"190\".concat(full_year);\n      } else {\n        full_year = \"19\".concat(full_year);\n      } // Extract month from TIN and normalize\n\n\n      var month = parseInt(tin.slice(2, 4), 10);\n\n      if (month > 50) {\n        month -= 50;\n      }\n\n      if (month < 10) {\n        month = \"0\".concat(month);\n      } // Check date validity\n\n\n      var date = \"\".concat(full_year, \"/\").concat(month, \"/\").concat(tin.slice(4, 6));\n\n      if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n  /*\n   * sl-SI validation function\n   * (Davčna številka, persons/entities)\n   * Verify TIN validity by calculating check (last) digit (variant of MOD 11)\n   */\n\n\n  function slSiCheck(tin) {\n    var checksum = 11 - algorithms$1.reverseMultiplyAndSum(tin.split('').slice(0, 7).map(function (a) {\n      return parseInt(a, 10);\n    }), 8) % 11;\n\n    if (checksum === 10) {\n      return parseInt(tin[7], 10) === 0;\n    }\n\n    return checksum === parseInt(tin[7], 10);\n  }\n  /*\n   * sv-SE validation function\n   * (Personnummer or samordningsnummer, persons only)\n   * Checks validity of birth date and calls luhnCheck() to validate check (last) digit\n   */\n\n\n  function svSeCheck(tin) {\n    // Make copy of TIN and normalize to two-digit year form\n    var tin_copy = tin.slice(0);\n\n    if (tin.length > 11) {\n      tin_copy = tin_copy.slice(2);\n    } // Extract date of birth\n\n\n    var full_year = '';\n    var month = tin_copy.slice(2, 4);\n    var day = parseInt(tin_copy.slice(4, 6), 10);\n\n    if (tin.length > 11) {\n      full_year = tin.slice(0, 4);\n    } else {\n      full_year = tin.slice(0, 2);\n\n      if (tin.length === 11 && day < 60) {\n        // Extract full year from centenarian symbol\n        // Should work just fine until year 10000 or so\n        var current_year = new Date().getFullYear().toString();\n        var current_century = parseInt(current_year.slice(0, 2), 10);\n        current_year = parseInt(current_year, 10);\n\n        if (tin[6] === '-') {\n          if (parseInt(\"\".concat(current_century).concat(full_year), 10) > current_year) {\n            full_year = \"\".concat(current_century - 1).concat(full_year);\n          } else {\n            full_year = \"\".concat(current_century).concat(full_year);\n          }\n        } else {\n          full_year = \"\".concat(current_century - 1).concat(full_year);\n\n          if (current_year - parseInt(full_year, 10) < 100) {\n            return false;\n          }\n        }\n      }\n    } // Normalize day and check date validity\n\n\n    if (day > 60) {\n      day -= 60;\n    }\n\n    if (day < 10) {\n      day = \"0\".concat(day);\n    }\n\n    var date = \"\".concat(full_year, \"/\").concat(month, \"/\").concat(day);\n\n    if (date.length === 8) {\n      if (!(0, _isDate.default)(date, 'YY/MM/DD')) {\n        return false;\n      }\n    } else if (!(0, _isDate.default)(date, 'YYYY/MM/DD')) {\n      return false;\n    }\n\n    return algorithms$1.luhnCheck(tin.replace(/\\W/, ''));\n  } // Locale lookup objects\n\n  /*\n   * Tax id regex formats for various locales\n   *\n   * Where not explicitly specified in DG-TAXUD document both\n   * uppercase and lowercase letters are acceptable.\n   */\n\n\n  var taxIdFormat = {\n    'bg-BG': /^\\d{10}$/,\n    'cs-CZ': /^\\d{6}\\/{0,1}\\d{3,4}$/,\n    'de-AT': /^\\d{9}$/,\n    'de-DE': /^[1-9]\\d{10}$/,\n    'dk-DK': /^\\d{6}-{0,1}\\d{4}$/,\n    'el-CY': /^[09]\\d{7}[A-Z]$/,\n    'el-GR': /^([0-4]|[7-9])\\d{8}$/,\n    'en-GB': /^\\d{10}$|^(?!GB|NK|TN|ZZ)(?![DFIQUV])[A-Z](?![DFIQUVO])[A-Z]\\d{6}[ABCD ]$/i,\n    'en-IE': /^\\d{7}[A-W][A-IW]{0,1}$/i,\n    'en-US': /^\\d{2}[- ]{0,1}\\d{7}$/,\n    'es-ES': /^(\\d{0,8}|[XYZKLM]\\d{7})[A-HJ-NP-TV-Z]$/i,\n    'et-EE': /^[1-6]\\d{6}(00[1-9]|0[1-9][0-9]|[1-6][0-9]{2}|70[0-9]|710)\\d$/,\n    'fi-FI': /^\\d{6}[-+A]\\d{3}[0-9A-FHJ-NPR-Y]$/i,\n    'fr-BE': /^\\d{11}$/,\n    'fr-FR': /^[0-3]\\d{12}$|^[0-3]\\d\\s\\d{2}(\\s\\d{3}){3}$/,\n    // Conforms both to official spec and provided example\n    'fr-LU': /^\\d{13}$/,\n    'hr-HR': /^\\d{11}$/,\n    'hu-HU': /^8\\d{9}$/,\n    'it-IT': /^[A-Z]{6}[L-NP-V0-9]{2}[A-EHLMPRST][L-NP-V0-9]{2}[A-ILMZ][L-NP-V0-9]{3}[A-Z]$/i,\n    'lv-LV': /^\\d{6}-{0,1}\\d{5}$/,\n    // Conforms both to DG TAXUD spec and original research\n    'mt-MT': /^\\d{3,7}[APMGLHBZ]$|^([1-8])\\1\\d{7}$/i,\n    'nl-NL': /^\\d{9}$/,\n    'pl-PL': /^\\d{10,11}$/,\n    'pt-BR': /(?:^\\d{11}$)|(?:^\\d{14}$)/,\n    'pt-PT': /^\\d{9}$/,\n    'ro-RO': /^\\d{13}$/,\n    'sk-SK': /^\\d{6}\\/{0,1}\\d{3,4}$/,\n    'sl-SI': /^[1-9]\\d{7}$/,\n    'sv-SE': /^(\\d{6}[-+]{0,1}\\d{4}|(18|19|20)\\d{6}[-+]{0,1}\\d{4})$/\n  }; // taxIdFormat locale aliases\n\n  taxIdFormat['lb-LU'] = taxIdFormat['fr-LU'];\n  taxIdFormat['lt-LT'] = taxIdFormat['et-EE'];\n  taxIdFormat['nl-BE'] = taxIdFormat['fr-BE']; // Algorithmic tax id check functions for various locales\n\n  var taxIdCheck = {\n    'bg-BG': bgBgCheck,\n    'cs-CZ': csCzCheck,\n    'de-AT': deAtCheck,\n    'de-DE': deDeCheck,\n    'dk-DK': dkDkCheck,\n    'el-CY': elCyCheck,\n    'el-GR': elGrCheck,\n    'en-IE': enIeCheck,\n    'en-US': enUsCheck,\n    'es-ES': esEsCheck,\n    'et-EE': etEeCheck,\n    'fi-FI': fiFiCheck,\n    'fr-BE': frBeCheck,\n    'fr-FR': frFrCheck,\n    'fr-LU': frLuCheck,\n    'hr-HR': hrHrCheck,\n    'hu-HU': huHuCheck,\n    'it-IT': itItCheck,\n    'lv-LV': lvLvCheck,\n    'mt-MT': mtMtCheck,\n    'nl-NL': nlNlCheck,\n    'pl-PL': plPlCheck,\n    'pt-BR': ptBrCheck,\n    'pt-PT': ptPtCheck,\n    'ro-RO': roRoCheck,\n    'sk-SK': skSkCheck,\n    'sl-SI': slSiCheck,\n    'sv-SE': svSeCheck\n  }; // taxIdCheck locale aliases\n\n  taxIdCheck['lb-LU'] = taxIdCheck['fr-LU'];\n  taxIdCheck['lt-LT'] = taxIdCheck['et-EE'];\n  taxIdCheck['nl-BE'] = taxIdCheck['fr-BE']; // Regexes for locales where characters should be omitted before checking format\n\n  var allsymbols = /[-\\\\\\/!@#$%\\^&\\*\\(\\)\\+\\=\\[\\]]+/g;\n  var sanitizeRegexes = {\n    'de-AT': allsymbols,\n    'de-DE': /[\\/\\\\]/g,\n    'fr-BE': allsymbols\n  }; // sanitizeRegexes locale aliases\n\n  sanitizeRegexes['nl-BE'] = sanitizeRegexes['fr-BE'];\n  /*\n   * Validator function\n   * Return true if the passed string is a valid tax identification number\n   * for the specified locale.\n   * Throw an error exception if the locale is not supported.\n   */\n\n  function isTaxID(str) {\n    var locale = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'en-US';\n    (0, _assertString.default)(str); // Copy TIN to avoid replacement if sanitized\n\n    var strcopy = str.slice(0);\n\n    if (locale in taxIdFormat) {\n      if (locale in sanitizeRegexes) {\n        strcopy = strcopy.replace(sanitizeRegexes[locale], '');\n      }\n\n      if (!taxIdFormat[locale].test(strcopy)) {\n        return false;\n      }\n\n      if (locale in taxIdCheck) {\n        return taxIdCheck[locale](strcopy);\n      } // Fallthrough; not all locales have algorithmic checks\n\n\n      return true;\n    }\n\n    throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isTaxID, isTaxID.exports);\n\nvar isMobilePhone$1 = {};\nObject.defineProperty(isMobilePhone$1, \"__esModule\", {\n  value: true\n});\nisMobilePhone$1.default = isMobilePhone;\nisMobilePhone$1.locales = void 0;\n\nvar _assertString$3 = _interopRequireDefault$3(assertString.exports);\n\nfunction _interopRequireDefault$3(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/* eslint-disable max-len */\n\n\nvar phones = {\n  'am-AM': /^(\\+?374|0)((10|[9|7][0-9])\\d{6}$|[2-4]\\d{7}$)/,\n  'ar-AE': /^((\\+?971)|0)?5[024568]\\d{7}$/,\n  'ar-BH': /^(\\+?973)?(3|6)\\d{7}$/,\n  'ar-DZ': /^(\\+?213|0)(5|6|7)\\d{8}$/,\n  'ar-LB': /^(\\+?961)?((3|81)\\d{6}|7\\d{7})$/,\n  'ar-EG': /^((\\+?20)|0)?1[0125]\\d{8}$/,\n  'ar-IQ': /^(\\+?964|0)?7[0-9]\\d{8}$/,\n  'ar-JO': /^(\\+?962|0)?7[789]\\d{7}$/,\n  'ar-KW': /^(\\+?965)[569]\\d{7}$/,\n  'ar-LY': /^((\\+?218)|0)?(9[1-6]\\d{7}|[1-8]\\d{7,9})$/,\n  'ar-MA': /^(?:(?:\\+|00)212|0)[5-7]\\d{8}$/,\n  'ar-OM': /^((\\+|00)968)?(9[1-9])\\d{6}$/,\n  'ar-PS': /^(\\+?970|0)5[6|9](\\d{7})$/,\n  'ar-SA': /^(!?(\\+?966)|0)?5\\d{8}$/,\n  'ar-SY': /^(!?(\\+?963)|0)?9\\d{8}$/,\n  'ar-TN': /^(\\+?216)?[2459]\\d{7}$/,\n  'az-AZ': /^(\\+994|0)(5[015]|7[07]|99)\\d{7}$/,\n  'bs-BA': /^((((\\+|00)3876)|06))((([0-3]|[5-6])\\d{6})|(4\\d{7}))$/,\n  'be-BY': /^(\\+?375)?(24|25|29|33|44)\\d{7}$/,\n  'bg-BG': /^(\\+?359|0)?8[789]\\d{7}$/,\n  'bn-BD': /^(\\+?880|0)1[13456789][0-9]{8}$/,\n  'ca-AD': /^(\\+376)?[346]\\d{5}$/,\n  'cs-CZ': /^(\\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,\n  'da-DK': /^(\\+?45)?\\s?\\d{2}\\s?\\d{2}\\s?\\d{2}\\s?\\d{2}$/,\n  'de-DE': /^((\\+49|0)[1|3])([0|5][0-45-9]\\d|6([23]|0\\d?)|7([0-57-9]|6\\d))\\d{7,9}$/,\n  'de-AT': /^(\\+43|0)\\d{1,4}\\d{3,12}$/,\n  'de-CH': /^(\\+41|0)([1-9])\\d{1,9}$/,\n  'de-LU': /^(\\+352)?((6\\d1)\\d{6})$/,\n  'dv-MV': /^(\\+?960)?(7[2-9]|91|9[3-9])\\d{7}$/,\n  'el-GR': /^(\\+?30|0)?(69\\d{8})$/,\n  'en-AU': /^(\\+?61|0)4\\d{8}$/,\n  'en-BM': /^(\\+?1)?441(((3|7)\\d{6}$)|(5[0-3][0-9]\\d{4}$)|(59\\d{5}))/,\n  'en-GB': /^(\\+?44|0)7\\d{9}$/,\n  'en-GG': /^(\\+?44|0)1481\\d{6}$/,\n  'en-GH': /^(\\+233|0)(20|50|24|54|27|57|26|56|23|28|55|59)\\d{7}$/,\n  'en-GY': /^(\\+592|0)6\\d{6}$/,\n  'en-HK': /^(\\+?852[-\\s]?)?[456789]\\d{3}[-\\s]?\\d{4}$/,\n  'en-MO': /^(\\+?853[-\\s]?)?[6]\\d{3}[-\\s]?\\d{4}$/,\n  'en-IE': /^(\\+?353|0)8[356789]\\d{7}$/,\n  'en-IN': /^(\\+?91|0)?[6789]\\d{9}$/,\n  'en-KE': /^(\\+?254|0)(7|1)\\d{8}$/,\n  'en-KI': /^((\\+686|686)?)?( )?((6|7)(2|3|8)[0-9]{6})$/,\n  'en-MT': /^(\\+?356|0)?(99|79|77|21|27|22|25)[0-9]{6}$/,\n  'en-MU': /^(\\+?230|0)?\\d{8}$/,\n  'en-NA': /^(\\+?264|0)(6|8)\\d{7}$/,\n  'en-NG': /^(\\+?234|0)?[789]\\d{9}$/,\n  'en-NZ': /^(\\+?64|0)[28]\\d{7,9}$/,\n  'en-PK': /^((00|\\+)?92|0)3[0-6]\\d{8}$/,\n  'en-PH': /^(09|\\+639)\\d{9}$/,\n  'en-RW': /^(\\+?250|0)?[7]\\d{8}$/,\n  'en-SG': /^(\\+65)?[3689]\\d{7}$/,\n  'en-SL': /^(\\+?232|0)\\d{8}$/,\n  'en-TZ': /^(\\+?255|0)?[67]\\d{8}$/,\n  'en-UG': /^(\\+?256|0)?[7]\\d{8}$/,\n  'en-US': /^((\\+1|1)?( |-)?)?(\\([2-9][0-9]{2}\\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,\n  'en-ZA': /^(\\+?27|0)\\d{9}$/,\n  'en-ZM': /^(\\+?26)?09[567]\\d{7}$/,\n  'en-ZW': /^(\\+263)[0-9]{9}$/,\n  'en-BW': /^(\\+?267)?(7[1-8]{1})\\d{6}$/,\n  'es-AR': /^\\+?549(11|[2368]\\d)\\d{8}$/,\n  'es-BO': /^(\\+?591)?(6|7)\\d{7}$/,\n  'es-CO': /^(\\+?57)?3(0(0|1|2|4|5)|1\\d|2[0-4]|5(0|1))\\d{7}$/,\n  'es-CL': /^(\\+?56|0)[2-9]\\d{1}\\d{7}$/,\n  'es-CR': /^(\\+506)?[2-8]\\d{7}$/,\n  'es-CU': /^(\\+53|0053)?5\\d{7}/,\n  'es-DO': /^(\\+?1)?8[024]9\\d{7}$/,\n  'es-HN': /^(\\+?504)?[9|8]\\d{7}$/,\n  'es-EC': /^(\\+?593|0)([2-7]|9[2-9])\\d{7}$/,\n  'es-ES': /^(\\+?34)?[6|7]\\d{8}$/,\n  'es-PE': /^(\\+?51)?9\\d{8}$/,\n  'es-MX': /^(\\+?52)?(1|01)?\\d{10,11}$/,\n  'es-PA': /^(\\+?507)\\d{7,8}$/,\n  'es-PY': /^(\\+?595|0)9[9876]\\d{7}$/,\n  'es-SV': /^(\\+?503)?[67]\\d{7}$/,\n  'es-UY': /^(\\+598|0)9[1-9][\\d]{6}$/,\n  'es-VE': /^(\\+?58)?(2|4)\\d{9}$/,\n  'et-EE': /^(\\+?372)?\\s?(5|8[1-4])\\s?([0-9]\\s?){6,7}$/,\n  'fa-IR': /^(\\+?98[\\-\\s]?|0)9[0-39]\\d[\\-\\s]?\\d{3}[\\-\\s]?\\d{4}$/,\n  'fi-FI': /^(\\+?358|0)\\s?(4(0|1|2|4|5|6)?|50)\\s?(\\d\\s?){4,8}\\d$/,\n  'fj-FJ': /^(\\+?679)?\\s?\\d{3}\\s?\\d{4}$/,\n  'fo-FO': /^(\\+?298)?\\s?\\d{2}\\s?\\d{2}\\s?\\d{2}$/,\n  'fr-BF': /^(\\+226|0)[67]\\d{7}$/,\n  'fr-CM': /^(\\+?237)6[0-9]{8}$/,\n  'fr-FR': /^(\\+?33|0)[67]\\d{8}$/,\n  'fr-GF': /^(\\+?594|0|00594)[67]\\d{8}$/,\n  'fr-GP': /^(\\+?590|0|00590)[67]\\d{8}$/,\n  'fr-MQ': /^(\\+?596|0|00596)[67]\\d{8}$/,\n  'fr-PF': /^(\\+?689)?8[789]\\d{6}$/,\n  'fr-RE': /^(\\+?262|0|00262)[67]\\d{8}$/,\n  'he-IL': /^(\\+972|0)([23489]|5[012345689]|77)[1-9]\\d{6}$/,\n  'hu-HU': /^(\\+?36|06)(20|30|31|50|70)\\d{7}$/,\n  'id-ID': /^(\\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\\s?|\\d]{5,11})$/,\n  'it-IT': /^(\\+?39)?\\s?3\\d{2} ?\\d{6,7}$/,\n  'it-SM': /^((\\+378)|(0549)|(\\+390549)|(\\+3780549))?6\\d{5,9}$/,\n  'ja-JP': /^(\\+81[ \\-]?(\\(0\\))?|0)[6789]0[ \\-]?\\d{4}[ \\-]?\\d{4}$/,\n  'ka-GE': /^(\\+?995)?(5|79)\\d{7}$/,\n  'kk-KZ': /^(\\+?7|8)?7\\d{9}$/,\n  'kl-GL': /^(\\+?299)?\\s?\\d{2}\\s?\\d{2}\\s?\\d{2}$/,\n  'ko-KR': /^((\\+?82)[ \\-]?)?0?1([0|1|6|7|8|9]{1})[ \\-]?\\d{3,4}[ \\-]?\\d{4}$/,\n  'lt-LT': /^(\\+370|8)\\d{8}$/,\n  'lv-LV': /^(\\+?371)2\\d{7}$/,\n  'ms-MY': /^(\\+?6?01){1}(([0145]{1}(\\-|\\s)?\\d{7,8})|([236789]{1}(\\s|\\-)?\\d{7}))$/,\n  'mz-MZ': /^(\\+?258)?8[234567]\\d{7}$/,\n  'nb-NO': /^(\\+?47)?[49]\\d{7}$/,\n  'ne-NP': /^(\\+?977)?9[78]\\d{8}$/,\n  'nl-BE': /^(\\+?32|0)4\\d{8}$/,\n  'nl-NL': /^(((\\+|00)?31\\(0\\))|((\\+|00)?31)|0)6{1}\\d{8}$/,\n  'nn-NO': /^(\\+?47)?[49]\\d{7}$/,\n  'pl-PL': /^(\\+?48)? ?[5-8]\\d ?\\d{3} ?\\d{2} ?\\d{2}$/,\n  'pt-BR': /^((\\+?55\\ ?[1-9]{2}\\ ?)|(\\+?55\\ ?\\([1-9]{2}\\)\\ ?)|(0[1-9]{2}\\ ?)|(\\([1-9]{2}\\)\\ ?)|([1-9]{2}\\ ?))((\\d{4}\\-?\\d{4})|(9[2-9]{1}\\d{3}\\-?\\d{4}))$/,\n  'pt-PT': /^(\\+?351)?9[1236]\\d{7}$/,\n  'pt-AO': /^(\\+244)\\d{9}$/,\n  'ro-RO': /^(\\+?4?0)\\s?7\\d{2}(\\/|\\s|\\.|\\-)?\\d{3}(\\s|\\.|\\-)?\\d{3}$/,\n  'ru-RU': /^(\\+?7|8)?9\\d{9}$/,\n  'si-LK': /^(?:0|94|\\+94)?(7(0|1|2|4|5|6|7|8)( |-)?)\\d{7}$/,\n  'sl-SI': /^(\\+386\\s?|0)(\\d{1}\\s?\\d{3}\\s?\\d{2}\\s?\\d{2}|\\d{2}\\s?\\d{3}\\s?\\d{3})$/,\n  'sk-SK': /^(\\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,\n  'sq-AL': /^(\\+355|0)6[789]\\d{6}$/,\n  'sr-RS': /^(\\+3816|06)[- \\d]{5,9}$/,\n  'sv-SE': /^(\\+?46|0)[\\s\\-]?7[\\s\\-]?[02369]([\\s\\-]?\\d){7}$/,\n  'tg-TJ': /^(\\+?992)?[5][5]\\d{7}$/,\n  'th-TH': /^(\\+66|66|0)\\d{9}$/,\n  'tr-TR': /^(\\+?90|0)?5\\d{9}$/,\n  'tk-TM': /^(\\+993|993|8)\\d{8}$/,\n  'uk-UA': /^(\\+?38|8)?0\\d{9}$/,\n  'uz-UZ': /^(\\+?998)?(6[125-79]|7[1-69]|88|9\\d)\\d{7}$/,\n  'vi-VN': /^((\\+?84)|0)((3([2-9]))|(5([25689]))|(7([0|6-9]))|(8([1-9]))|(9([0-9])))([0-9]{7})$/,\n  'zh-CN': /^((\\+|00)86)?(1[3-9]|9[28])\\d{9}$/,\n  'zh-TW': /^(\\+?886\\-?|0)?9\\d{8}$/,\n  'dz-BT': /^(\\+?975|0)?(17|16|77|02)\\d{6}$/\n};\n/* eslint-enable max-len */\n// aliases\n\nphones['en-CA'] = phones['en-US'];\nphones['fr-CA'] = phones['en-CA'];\nphones['fr-BE'] = phones['nl-BE'];\nphones['zh-HK'] = phones['en-HK'];\nphones['zh-MO'] = phones['en-MO'];\nphones['ga-IE'] = phones['en-IE'];\nphones['fr-CH'] = phones['de-CH'];\nphones['it-CH'] = phones['fr-CH'];\n\nfunction isMobilePhone(str, locale, options) {\n  (0, _assertString$3.default)(str);\n\n  if (options && options.strictMode && !str.startsWith('+')) {\n    return false;\n  }\n\n  if (Array.isArray(locale)) {\n    return locale.some(function (key) {\n      // https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\n      // istanbul ignore else\n      if (phones.hasOwnProperty(key)) {\n        var phone = phones[key];\n\n        if (phone.test(str)) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n  } else if (locale in phones) {\n    return phones[locale].test(str); // alias falsey locale as 'any'\n  } else if (!locale || locale === 'any') {\n    for (var key in phones) {\n      // istanbul ignore else\n      if (phones.hasOwnProperty(key)) {\n        var phone = phones[key];\n\n        if (phone.test(str)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n}\n\nvar locales$1 = Object.keys(phones);\nisMobilePhone$1.locales = locales$1;\nvar isEthereumAddress = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isEthereumAddress;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var eth = /^(0x)[0-9a-f]{40}$/i;\n\n  function isEthereumAddress(str) {\n    (0, _assertString.default)(str);\n    return eth.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isEthereumAddress, isEthereumAddress.exports);\n\nvar isCurrency = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isCurrency;\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function currencyRegex(options) {\n    var decimal_digits = \"\\\\d{\".concat(options.digits_after_decimal[0], \"}\");\n    options.digits_after_decimal.forEach(function (digit, index) {\n      if (index !== 0) decimal_digits = \"\".concat(decimal_digits, \"|\\\\d{\").concat(digit, \"}\");\n    });\n    var symbol = \"(\".concat(options.symbol.replace(/\\W/, function (m) {\n      return \"\\\\\".concat(m);\n    }), \")\").concat(options.require_symbol ? '' : '?'),\n        negative = '-?',\n        whole_dollar_amount_without_sep = '[1-9]\\\\d*',\n        whole_dollar_amount_with_sep = \"[1-9]\\\\d{0,2}(\\\\\".concat(options.thousands_separator, \"\\\\d{3})*\"),\n        valid_whole_dollar_amounts = ['0', whole_dollar_amount_without_sep, whole_dollar_amount_with_sep],\n        whole_dollar_amount = \"(\".concat(valid_whole_dollar_amounts.join('|'), \")?\"),\n        decimal_amount = \"(\\\\\".concat(options.decimal_separator, \"(\").concat(decimal_digits, \"))\").concat(options.require_decimal ? '' : '?');\n    var pattern = whole_dollar_amount + (options.allow_decimal || options.require_decimal ? decimal_amount : ''); // default is negative sign before symbol, but there are two other options (besides parens)\n\n    if (options.allow_negatives && !options.parens_for_negatives) {\n      if (options.negative_sign_after_digits) {\n        pattern += negative;\n      } else if (options.negative_sign_before_digits) {\n        pattern = negative + pattern;\n      }\n    } // South African Rand, for example, uses R 123 (space) and R-123 (no space)\n\n\n    if (options.allow_negative_sign_placeholder) {\n      pattern = \"( (?!\\\\-))?\".concat(pattern);\n    } else if (options.allow_space_after_symbol) {\n      pattern = \" ?\".concat(pattern);\n    } else if (options.allow_space_after_digits) {\n      pattern += '( (?!$))?';\n    }\n\n    if (options.symbol_after_digits) {\n      pattern += symbol;\n    } else {\n      pattern = symbol + pattern;\n    }\n\n    if (options.allow_negatives) {\n      if (options.parens_for_negatives) {\n        pattern = \"(\\\\(\".concat(pattern, \"\\\\)|\").concat(pattern, \")\");\n      } else if (!(options.negative_sign_before_digits || options.negative_sign_after_digits)) {\n        pattern = negative + pattern;\n      }\n    } // ensure there's a dollar and/or decimal amount, and that\n    // it doesn't start with a space or a negative sign followed by a space\n\n\n    return new RegExp(\"^(?!-? )(?=.*\\\\d)\".concat(pattern, \"$\"));\n  }\n\n  var default_currency_options = {\n    symbol: '$',\n    require_symbol: false,\n    allow_space_after_symbol: false,\n    symbol_after_digits: false,\n    allow_negatives: true,\n    parens_for_negatives: false,\n    negative_sign_before_digits: false,\n    negative_sign_after_digits: false,\n    allow_negative_sign_placeholder: false,\n    thousands_separator: ',',\n    decimal_separator: '.',\n    allow_decimal: true,\n    require_decimal: false,\n    digits_after_decimal: [2],\n    allow_space_after_digits: false\n  };\n\n  function isCurrency(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, default_currency_options);\n    return currencyRegex(options).test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isCurrency, isCurrency.exports);\n\nvar isBtcAddress = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBtcAddress;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  } // supports Bech32 addresses\n\n\n  var bech32 = /^(bc1)[a-z0-9]{25,39}$/;\n  var base58 = /^(1|3)[A-HJ-NP-Za-km-z1-9]{25,39}$/;\n\n  function isBtcAddress(str) {\n    (0, _assertString.default)(str); // check for bech32\n\n    if (str.startsWith('bc1')) {\n      return bech32.test(str);\n    }\n\n    return base58.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBtcAddress, isBtcAddress.exports);\n\nvar isISO8601 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISO8601;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /* eslint-disable max-len */\n  // from http://goo.gl/0ejHHW\n\n\n  var iso8601 = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/; // same as above, except with a strict 'T' separator between date and time\n\n  var iso8601StrictSeparator = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/;\n  /* eslint-enable max-len */\n\n  var isValidDate = function isValidDate(str) {\n    // str must have passed the ISO8601 check\n    // this check is meant to catch invalid dates\n    // like 2009-02-31\n    // first check for ordinal dates\n    var ordinalMatch = str.match(/^(\\d{4})-?(\\d{3})([ T]{1}\\.*|$)/);\n\n    if (ordinalMatch) {\n      var oYear = Number(ordinalMatch[1]);\n      var oDay = Number(ordinalMatch[2]); // if is leap year\n\n      if (oYear % 4 === 0 && oYear % 100 !== 0 || oYear % 400 === 0) return oDay <= 366;\n      return oDay <= 365;\n    }\n\n    var match = str.match(/(\\d{4})-?(\\d{0,2})-?(\\d*)/).map(Number);\n    var year = match[1];\n    var month = match[2];\n    var day = match[3];\n    var monthString = month ? \"0\".concat(month).slice(-2) : month;\n    var dayString = day ? \"0\".concat(day).slice(-2) : day; // create a date object and compare\n\n    var d = new Date(\"\".concat(year, \"-\").concat(monthString || '01', \"-\").concat(dayString || '01'));\n\n    if (month && day) {\n      return d.getUTCFullYear() === year && d.getUTCMonth() + 1 === month && d.getUTCDate() === day;\n    }\n\n    return true;\n  };\n\n  function isISO8601(str) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    (0, _assertString.default)(str);\n    var check = options.strictSeparator ? iso8601StrictSeparator.test(str) : iso8601.test(str);\n    if (check && options.strict) return isValidDate(str);\n    return check;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISO8601, isISO8601.exports);\n\nvar isRFC3339 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isRFC3339;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /* Based on https://tools.ietf.org/html/rfc3339#section-5.6 */\n\n\n  var dateFullYear = /[0-9]{4}/;\n  var dateMonth = /(0[1-9]|1[0-2])/;\n  var dateMDay = /([12]\\d|0[1-9]|3[01])/;\n  var timeHour = /([01][0-9]|2[0-3])/;\n  var timeMinute = /[0-5][0-9]/;\n  var timeSecond = /([0-5][0-9]|60)/;\n  var timeSecFrac = /(\\.[0-9]+)?/;\n  var timeNumOffset = new RegExp(\"[-+]\".concat(timeHour.source, \":\").concat(timeMinute.source));\n  var timeOffset = new RegExp(\"([zZ]|\".concat(timeNumOffset.source, \")\"));\n  var partialTime = new RegExp(\"\".concat(timeHour.source, \":\").concat(timeMinute.source, \":\").concat(timeSecond.source).concat(timeSecFrac.source));\n  var fullDate = new RegExp(\"\".concat(dateFullYear.source, \"-\").concat(dateMonth.source, \"-\").concat(dateMDay.source));\n  var fullTime = new RegExp(\"\".concat(partialTime.source).concat(timeOffset.source));\n  var rfc3339 = new RegExp(\"^\".concat(fullDate.source, \"[ tT]\").concat(fullTime.source, \"$\"));\n\n  function isRFC3339(str) {\n    (0, _assertString.default)(str);\n    return rfc3339.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isRFC3339, isRFC3339.exports);\n\nvar isISO31661Alpha3 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isISO31661Alpha3;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  } // from https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3\n\n\n  var validISO31661Alpha3CountriesCodes = new Set(['AFG', 'ALA', 'ALB', 'DZA', 'ASM', 'AND', 'AGO', 'AIA', 'ATA', 'ATG', 'ARG', 'ARM', 'ABW', 'AUS', 'AUT', 'AZE', 'BHS', 'BHR', 'BGD', 'BRB', 'BLR', 'BEL', 'BLZ', 'BEN', 'BMU', 'BTN', 'BOL', 'BES', 'BIH', 'BWA', 'BVT', 'BRA', 'IOT', 'BRN', 'BGR', 'BFA', 'BDI', 'KHM', 'CMR', 'CAN', 'CPV', 'CYM', 'CAF', 'TCD', 'CHL', 'CHN', 'CXR', 'CCK', 'COL', 'COM', 'COG', 'COD', 'COK', 'CRI', 'CIV', 'HRV', 'CUB', 'CUW', 'CYP', 'CZE', 'DNK', 'DJI', 'DMA', 'DOM', 'ECU', 'EGY', 'SLV', 'GNQ', 'ERI', 'EST', 'ETH', 'FLK', 'FRO', 'FJI', 'FIN', 'FRA', 'GUF', 'PYF', 'ATF', 'GAB', 'GMB', 'GEO', 'DEU', 'GHA', 'GIB', 'GRC', 'GRL', 'GRD', 'GLP', 'GUM', 'GTM', 'GGY', 'GIN', 'GNB', 'GUY', 'HTI', 'HMD', 'VAT', 'HND', 'HKG', 'HUN', 'ISL', 'IND', 'IDN', 'IRN', 'IRQ', 'IRL', 'IMN', 'ISR', 'ITA', 'JAM', 'JPN', 'JEY', 'JOR', 'KAZ', 'KEN', 'KIR', 'PRK', 'KOR', 'KWT', 'KGZ', 'LAO', 'LVA', 'LBN', 'LSO', 'LBR', 'LBY', 'LIE', 'LTU', 'LUX', 'MAC', 'MKD', 'MDG', 'MWI', 'MYS', 'MDV', 'MLI', 'MLT', 'MHL', 'MTQ', 'MRT', 'MUS', 'MYT', 'MEX', 'FSM', 'MDA', 'MCO', 'MNG', 'MNE', 'MSR', 'MAR', 'MOZ', 'MMR', 'NAM', 'NRU', 'NPL', 'NLD', 'NCL', 'NZL', 'NIC', 'NER', 'NGA', 'NIU', 'NFK', 'MNP', 'NOR', 'OMN', 'PAK', 'PLW', 'PSE', 'PAN', 'PNG', 'PRY', 'PER', 'PHL', 'PCN', 'POL', 'PRT', 'PRI', 'QAT', 'REU', 'ROU', 'RUS', 'RWA', 'BLM', 'SHN', 'KNA', 'LCA', 'MAF', 'SPM', 'VCT', 'WSM', 'SMR', 'STP', 'SAU', 'SEN', 'SRB', 'SYC', 'SLE', 'SGP', 'SXM', 'SVK', 'SVN', 'SLB', 'SOM', 'ZAF', 'SGS', 'SSD', 'ESP', 'LKA', 'SDN', 'SUR', 'SJM', 'SWZ', 'SWE', 'CHE', 'SYR', 'TWN', 'TJK', 'TZA', 'THA', 'TLS', 'TGO', 'TKL', 'TON', 'TTO', 'TUN', 'TUR', 'TKM', 'TCA', 'TUV', 'UGA', 'UKR', 'ARE', 'GBR', 'USA', 'UMI', 'URY', 'UZB', 'VUT', 'VEN', 'VNM', 'VGB', 'VIR', 'WLF', 'ESH', 'YEM', 'ZMB', 'ZWE']);\n\n  function isISO31661Alpha3(str) {\n    (0, _assertString.default)(str);\n    return validISO31661Alpha3CountriesCodes.has(str.toUpperCase());\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isISO31661Alpha3, isISO31661Alpha3.exports);\n\nvar isISO4217$1 = {};\nObject.defineProperty(isISO4217$1, \"__esModule\", {\n  value: true\n});\nisISO4217$1.default = isISO4217;\nisISO4217$1.CurrencyCodes = void 0;\n\nvar _assertString$2 = _interopRequireDefault$2(assertString.exports);\n\nfunction _interopRequireDefault$2(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} // from https://en.wikipedia.org/wiki/ISO_4217\n\n\nvar validISO4217CurrencyCodes = new Set(['AED', 'AFN', 'ALL', 'AMD', 'ANG', 'AOA', 'ARS', 'AUD', 'AWG', 'AZN', 'BAM', 'BBD', 'BDT', 'BGN', 'BHD', 'BIF', 'BMD', 'BND', 'BOB', 'BOV', 'BRL', 'BSD', 'BTN', 'BWP', 'BYN', 'BZD', 'CAD', 'CDF', 'CHE', 'CHF', 'CHW', 'CLF', 'CLP', 'CNY', 'COP', 'COU', 'CRC', 'CUC', 'CUP', 'CVE', 'CZK', 'DJF', 'DKK', 'DOP', 'DZD', 'EGP', 'ERN', 'ETB', 'EUR', 'FJD', 'FKP', 'GBP', 'GEL', 'GHS', 'GIP', 'GMD', 'GNF', 'GTQ', 'GYD', 'HKD', 'HNL', 'HRK', 'HTG', 'HUF', 'IDR', 'ILS', 'INR', 'IQD', 'IRR', 'ISK', 'JMD', 'JOD', 'JPY', 'KES', 'KGS', 'KHR', 'KMF', 'KPW', 'KRW', 'KWD', 'KYD', 'KZT', 'LAK', 'LBP', 'LKR', 'LRD', 'LSL', 'LYD', 'MAD', 'MDL', 'MGA', 'MKD', 'MMK', 'MNT', 'MOP', 'MRU', 'MUR', 'MVR', 'MWK', 'MXN', 'MXV', 'MYR', 'MZN', 'NAD', 'NGN', 'NIO', 'NOK', 'NPR', 'NZD', 'OMR', 'PAB', 'PEN', 'PGK', 'PHP', 'PKR', 'PLN', 'PYG', 'QAR', 'RON', 'RSD', 'RUB', 'RWF', 'SAR', 'SBD', 'SCR', 'SDG', 'SEK', 'SGD', 'SHP', 'SLL', 'SOS', 'SRD', 'SSP', 'STN', 'SVC', 'SYP', 'SZL', 'THB', 'TJS', 'TMT', 'TND', 'TOP', 'TRY', 'TTD', 'TWD', 'TZS', 'UAH', 'UGX', 'USD', 'USN', 'UYI', 'UYU', 'UYW', 'UZS', 'VES', 'VND', 'VUV', 'WST', 'XAF', 'XAG', 'XAU', 'XBA', 'XBB', 'XBC', 'XBD', 'XCD', 'XDR', 'XOF', 'XPD', 'XPF', 'XPT', 'XSU', 'XTS', 'XUA', 'XXX', 'YER', 'ZAR', 'ZMW', 'ZWL']);\n\nfunction isISO4217(str) {\n  (0, _assertString$2.default)(str);\n  return validISO4217CurrencyCodes.has(str.toUpperCase());\n}\n\nvar CurrencyCodes = validISO4217CurrencyCodes;\nisISO4217$1.CurrencyCodes = CurrencyCodes;\nvar isBase32 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBase32;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var base32 = /^[A-Z2-7]+=*$/;\n\n  function isBase32(str) {\n    (0, _assertString.default)(str);\n    var len = str.length;\n\n    if (len % 8 === 0 && base32.test(str)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBase32, isBase32.exports);\n\nvar isBase58 = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isBase58;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  } // Accepted chars - 123456789ABCDEFGH JKLMN PQRSTUVWXYZabcdefghijk mnopqrstuvwxyz\n\n\n  var base58Reg = /^[A-HJ-NP-Za-km-z1-9]*$/;\n\n  function isBase58(str) {\n    (0, _assertString.default)(str);\n\n    if (base58Reg.test(str)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isBase58, isBase58.exports);\n\nvar isDataURI = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isDataURI;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var validMediaType = /^[a-z]+\\/[a-z0-9\\-\\+]+$/i;\n  var validAttribute = /^[a-z\\-]+=[a-z0-9\\-]+$/i;\n  var validData = /^[a-z0-9!\\$&'\\(\\)\\*\\+,;=\\-\\._~:@\\/\\?%\\s]*$/i;\n\n  function isDataURI(str) {\n    (0, _assertString.default)(str);\n    var data = str.split(',');\n\n    if (data.length < 2) {\n      return false;\n    }\n\n    var attributes = data.shift().trim().split(';');\n    var schemeAndMediaType = attributes.shift();\n\n    if (schemeAndMediaType.substr(0, 5) !== 'data:') {\n      return false;\n    }\n\n    var mediaType = schemeAndMediaType.substr(5);\n\n    if (mediaType !== '' && !validMediaType.test(mediaType)) {\n      return false;\n    }\n\n    for (var i = 0; i < attributes.length; i++) {\n      if (!(i === attributes.length - 1 && attributes[i].toLowerCase() === 'base64') && !validAttribute.test(attributes[i])) {\n        return false;\n      }\n    }\n\n    for (var _i = 0; _i < data.length; _i++) {\n      if (!validData.test(data[_i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isDataURI, isDataURI.exports);\n\nvar isMagnetURI = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMagnetURI;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var magnetURI = /^magnet:\\?xt(?:\\.1)?=urn:(?:aich|bitprint|btih|ed2k|ed2khash|kzhash|md5|sha1|tree:tiger):[a-z0-9]{32}(?:[a-z0-9]{8})?($|&)/i;\n\n  function isMagnetURI(url) {\n    (0, _assertString.default)(url);\n    return magnetURI.test(url.trim());\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMagnetURI, isMagnetURI.exports);\n\nvar isMimeType = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isMimeType;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  /*\n    Checks if the provided string matches to a correct Media type format (MIME type)\n  \n    This function only checks is the string format follows the\n    etablished rules by the according RFC specifications.\n    This function supports 'charset' in textual media types\n    (https://tools.ietf.org/html/rfc6657).\n  \n    This function does not check against all the media types listed\n    by the IANA (https://www.iana.org/assignments/media-types/media-types.xhtml)\n    because of lightness purposes : it would require to include\n    all these MIME types in this librairy, which would weigh it\n    significantly. This kind of effort maybe is not worth for the use that\n    this function has in this entire librairy.\n  \n    More informations in the RFC specifications :\n    - https://tools.ietf.org/html/rfc2045\n    - https://tools.ietf.org/html/rfc2046\n    - https://tools.ietf.org/html/rfc7231#section-3.1.1.1\n    - https://tools.ietf.org/html/rfc7231#section-3.1.1.5\n  */\n  // Match simple MIME types\n  // NB :\n  //   Subtype length must not exceed 100 characters.\n  //   This rule does not comply to the RFC specs (what is the max length ?).\n\n\n  var mimeTypeSimple = /^(application|audio|font|image|message|model|multipart|text|video)\\/[a-zA-Z0-9\\.\\-\\+]{1,100}$/i; // eslint-disable-line max-len\n  // Handle \"charset\" in \"text/*\"\n\n  var mimeTypeText = /^text\\/[a-zA-Z0-9\\.\\-\\+]{1,100};\\s?charset=(\"[a-zA-Z0-9\\.\\-\\+\\s]{0,70}\"|[a-zA-Z0-9\\.\\-\\+]{0,70})(\\s?\\([a-zA-Z0-9\\.\\-\\+\\s]{1,20}\\))?$/i; // eslint-disable-line max-len\n  // Handle \"boundary\" in \"multipart/*\"\n\n  var mimeTypeMultipart = /^multipart\\/[a-zA-Z0-9\\.\\-\\+]{1,100}(;\\s?(boundary|charset)=(\"[a-zA-Z0-9\\.\\-\\+\\s]{0,70}\"|[a-zA-Z0-9\\.\\-\\+]{0,70})(\\s?\\([a-zA-Z0-9\\.\\-\\+\\s]{1,20}\\))?){0,2}$/i; // eslint-disable-line max-len\n\n  function isMimeType(str) {\n    (0, _assertString.default)(str);\n    return mimeTypeSimple.test(str) || mimeTypeText.test(str) || mimeTypeMultipart.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isMimeType, isMimeType.exports);\n\nvar isLatLong = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isLatLong;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var lat = /^\\(?[+-]?(90(\\.0+)?|[1-8]?\\d(\\.\\d+)?)$/;\n  var long = /^\\s?[+-]?(180(\\.0+)?|1[0-7]\\d(\\.\\d+)?|\\d{1,2}(\\.\\d+)?)\\)?$/;\n  var latDMS = /^(([1-8]?\\d)\\D+([1-5]?\\d|60)\\D+([1-5]?\\d|60)(\\.\\d+)?|90\\D+0\\D+0)\\D+[NSns]?$/i;\n  var longDMS = /^\\s*([1-7]?\\d{1,2}\\D+([1-5]?\\d|60)\\D+([1-5]?\\d|60)(\\.\\d+)?|180\\D+0\\D+0)\\D+[EWew]?$/i;\n  var defaultLatLongOptions = {\n    checkDMS: false\n  };\n\n  function isLatLong(str, options) {\n    (0, _assertString.default)(str);\n    options = (0, _merge.default)(options, defaultLatLongOptions);\n    if (!str.includes(',')) return false;\n    var pair = str.split(',');\n    if (pair[0].startsWith('(') && !pair[1].endsWith(')') || pair[1].endsWith(')') && !pair[0].startsWith('(')) return false;\n\n    if (options.checkDMS) {\n      return latDMS.test(pair[0]) && longDMS.test(pair[1]);\n    }\n\n    return lat.test(pair[0]) && long.test(pair[1]);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isLatLong, isLatLong.exports);\n\nvar isPostalCode$1 = {};\nObject.defineProperty(isPostalCode$1, \"__esModule\", {\n  value: true\n});\nisPostalCode$1.default = isPostalCode;\nisPostalCode$1.locales = void 0;\n\nvar _assertString$1 = _interopRequireDefault$1(assertString.exports);\n\nfunction _interopRequireDefault$1(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n} // common patterns\n\n\nvar threeDigit = /^\\d{3}$/;\nvar fourDigit = /^\\d{4}$/;\nvar fiveDigit = /^\\d{5}$/;\nvar sixDigit = /^\\d{6}$/;\nvar patterns = {\n  AD: /^AD\\d{3}$/,\n  AT: fourDigit,\n  AU: fourDigit,\n  AZ: /^AZ\\d{4}$/,\n  BE: fourDigit,\n  BG: fourDigit,\n  BR: /^\\d{5}-\\d{3}$/,\n  BY: /2[1-4]{1}\\d{4}$/,\n  CA: /^[ABCEGHJKLMNPRSTVXY]\\d[ABCEGHJ-NPRSTV-Z][\\s\\-]?\\d[ABCEGHJ-NPRSTV-Z]\\d$/i,\n  CH: fourDigit,\n  CN: /^(0[1-7]|1[012356]|2[0-7]|3[0-6]|4[0-7]|5[1-7]|6[1-7]|7[1-5]|8[1345]|9[09])\\d{4}$/,\n  CZ: /^\\d{3}\\s?\\d{2}$/,\n  DE: fiveDigit,\n  DK: fourDigit,\n  DO: fiveDigit,\n  DZ: fiveDigit,\n  EE: fiveDigit,\n  ES: /^(5[0-2]{1}|[0-4]{1}\\d{1})\\d{3}$/,\n  FI: fiveDigit,\n  FR: /^\\d{2}\\s?\\d{3}$/,\n  GB: /^(gir\\s?0aa|[a-z]{1,2}\\d[\\da-z]?\\s?(\\d[a-z]{2})?)$/i,\n  GR: /^\\d{3}\\s?\\d{2}$/,\n  HR: /^([1-5]\\d{4}$)/,\n  HT: /^HT\\d{4}$/,\n  HU: fourDigit,\n  ID: fiveDigit,\n  IE: /^(?!.*(?:o))[A-Za-z]\\d[\\dw]\\s\\w{4}$/i,\n  IL: /^(\\d{5}|\\d{7})$/,\n  IN: /^((?!10|29|35|54|55|65|66|86|87|88|89)[1-9][0-9]{5})$/,\n  IR: /\\b(?!(\\d)\\1{3})[13-9]{4}[1346-9][013-9]{5}\\b/,\n  IS: threeDigit,\n  IT: fiveDigit,\n  JP: /^\\d{3}\\-\\d{4}$/,\n  KE: fiveDigit,\n  KR: /^(\\d{5}|\\d{6})$/,\n  LI: /^(948[5-9]|949[0-7])$/,\n  LT: /^LT\\-\\d{5}$/,\n  LU: fourDigit,\n  LV: /^LV\\-\\d{4}$/,\n  LK: fiveDigit,\n  MX: fiveDigit,\n  MT: /^[A-Za-z]{3}\\s{0,1}\\d{4}$/,\n  MY: fiveDigit,\n  NL: /^\\d{4}\\s?[a-z]{2}$/i,\n  NO: fourDigit,\n  NP: /^(10|21|22|32|33|34|44|45|56|57)\\d{3}$|^(977)$/i,\n  NZ: fourDigit,\n  PL: /^\\d{2}\\-\\d{3}$/,\n  PR: /^00[679]\\d{2}([ -]\\d{4})?$/,\n  PT: /^\\d{4}\\-\\d{3}?$/,\n  RO: sixDigit,\n  RU: sixDigit,\n  SA: fiveDigit,\n  SE: /^[1-9]\\d{2}\\s?\\d{2}$/,\n  SG: sixDigit,\n  SI: fourDigit,\n  SK: /^\\d{3}\\s?\\d{2}$/,\n  TH: fiveDigit,\n  TN: fourDigit,\n  TW: /^\\d{3}(\\d{2})?$/,\n  UA: fiveDigit,\n  US: /^\\d{5}(-\\d{4})?$/,\n  ZA: fourDigit,\n  ZM: fiveDigit\n};\nvar locales = Object.keys(patterns);\nisPostalCode$1.locales = locales;\n\nfunction isPostalCode(str, locale) {\n  (0, _assertString$1.default)(str);\n\n  if (locale in patterns) {\n    return patterns[locale].test(str);\n  } else if (locale === 'any') {\n    for (var key in patterns) {\n      // https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md#ignoring-code-for-coverage-purposes\n      // istanbul ignore else\n      if (patterns.hasOwnProperty(key)) {\n        var pattern = patterns[key];\n\n        if (pattern.test(str)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n}\n\nvar ltrim = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = ltrim;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function ltrim(str, chars) {\n    (0, _assertString.default)(str); // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping\n\n    var pattern = chars ? new RegExp(\"^[\".concat(chars.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), \"]+\"), 'g') : /^\\s+/g;\n    return str.replace(pattern, '');\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(ltrim, ltrim.exports);\n\nvar rtrim = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = rtrim;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function rtrim(str, chars) {\n    (0, _assertString.default)(str);\n\n    if (chars) {\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping\n      var pattern = new RegExp(\"[\".concat(chars.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), \"]+$\"), 'g');\n      return str.replace(pattern, '');\n    } // Use a faster and more safe than regex trim method https://blog.stevenlevithan.com/archives/faster-trim-javascript\n\n\n    var strIndex = str.length - 1;\n\n    while (/\\s/.test(str.charAt(strIndex))) {\n      strIndex -= 1;\n    }\n\n    return str.slice(0, strIndex + 1);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(rtrim, rtrim.exports);\n\nvar trim = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = trim;\n\n  var _rtrim = _interopRequireDefault(rtrim.exports);\n\n  var _ltrim = _interopRequireDefault(ltrim.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function trim(str, chars) {\n    return (0, _rtrim.default)((0, _ltrim.default)(str, chars), chars);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(trim, trim.exports);\n\nvar _escape = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = escape;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function escape(str) {\n    (0, _assertString.default)(str);\n    return str.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#x27;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\\//g, '&#x2F;').replace(/\\\\/g, '&#x5C;').replace(/`/g, '&#96;');\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(_escape, _escape.exports);\n\nvar _unescape = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = unescape;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function unescape(str) {\n    (0, _assertString.default)(str);\n    return str.replace(/&quot;/g, '\"').replace(/&#x27;/g, \"'\").replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&#x2F;/g, '/').replace(/&#x5C;/g, '\\\\').replace(/&#96;/g, '`').replace(/&amp;/g, '&'); // &amp; replacement has to be the last one to prevent\n    // bugs with intermediate strings containing escape sequences\n    // See: https://github.com/validatorjs/validator.js/issues/1827\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(_unescape, _unescape.exports);\n\nvar stripLow = {\n  exports: {}\n};\nvar blacklist = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = blacklist;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function blacklist(str, chars) {\n    (0, _assertString.default)(str);\n    return str.replace(new RegExp(\"[\".concat(chars, \"]+\"), 'g'), '');\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(blacklist, blacklist.exports);\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = stripLow;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  var _blacklist = _interopRequireDefault(blacklist.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function stripLow(str, keep_new_lines) {\n    (0, _assertString.default)(str);\n    var chars = keep_new_lines ? '\\\\x00-\\\\x09\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x7F' : '\\\\x00-\\\\x1F\\\\x7F';\n    return (0, _blacklist.default)(str, chars);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(stripLow, stripLow.exports);\n\nvar whitelist = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = whitelist;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function whitelist(str, chars) {\n    (0, _assertString.default)(str);\n    return str.replace(new RegExp(\"[^\".concat(chars, \"]+\"), 'g'), '');\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(whitelist, whitelist.exports);\n\nvar isWhitelisted = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isWhitelisted;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function isWhitelisted(str, chars) {\n    (0, _assertString.default)(str);\n\n    for (var i = str.length - 1; i >= 0; i--) {\n      if (chars.indexOf(str[i]) === -1) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isWhitelisted, isWhitelisted.exports);\n\nvar normalizeEmail = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = normalizeEmail;\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var default_normalize_email_options = {\n    // The following options apply to all email addresses\n    // Lowercases the local part of the email address.\n    // Please note this may violate RFC 5321 as per http://stackoverflow.com/a/9808332/192024).\n    // The domain is always lowercased, as per RFC 1035\n    all_lowercase: true,\n    // The following conversions are specific to GMail\n    // Lowercases the local part of the GMail address (known to be case-insensitive)\n    gmail_lowercase: true,\n    // Removes dots from the local part of the email address, as that's ignored by GMail\n    gmail_remove_dots: true,\n    // Removes the subaddress (e.g. \"+foo\") from the email address\n    gmail_remove_subaddress: true,\n    // Conversts the googlemail.com domain to gmail.com\n    gmail_convert_googlemaildotcom: true,\n    // The following conversions are specific to Outlook.com / Windows Live / Hotmail\n    // Lowercases the local part of the Outlook.com address (known to be case-insensitive)\n    outlookdotcom_lowercase: true,\n    // Removes the subaddress (e.g. \"+foo\") from the email address\n    outlookdotcom_remove_subaddress: true,\n    // The following conversions are specific to Yahoo\n    // Lowercases the local part of the Yahoo address (known to be case-insensitive)\n    yahoo_lowercase: true,\n    // Removes the subaddress (e.g. \"-foo\") from the email address\n    yahoo_remove_subaddress: true,\n    // The following conversions are specific to Yandex\n    // Lowercases the local part of the Yandex address (known to be case-insensitive)\n    yandex_lowercase: true,\n    // The following conversions are specific to iCloud\n    // Lowercases the local part of the iCloud address (known to be case-insensitive)\n    icloud_lowercase: true,\n    // Removes the subaddress (e.g. \"+foo\") from the email address\n    icloud_remove_subaddress: true\n  }; // List of domains used by iCloud\n\n  var icloud_domains = ['icloud.com', 'me.com']; // List of domains used by Outlook.com and its predecessors\n  // This list is likely incomplete.\n  // Partial reference:\n  // https://blogs.office.com/2013/04/17/outlook-com-gets-two-step-verification-sign-in-by-alias-and-new-international-domains/\n\n  var outlookdotcom_domains = ['hotmail.at', 'hotmail.be', 'hotmail.ca', 'hotmail.cl', 'hotmail.co.il', 'hotmail.co.nz', 'hotmail.co.th', 'hotmail.co.uk', 'hotmail.com', 'hotmail.com.ar', 'hotmail.com.au', 'hotmail.com.br', 'hotmail.com.gr', 'hotmail.com.mx', 'hotmail.com.pe', 'hotmail.com.tr', 'hotmail.com.vn', 'hotmail.cz', 'hotmail.de', 'hotmail.dk', 'hotmail.es', 'hotmail.fr', 'hotmail.hu', 'hotmail.id', 'hotmail.ie', 'hotmail.in', 'hotmail.it', 'hotmail.jp', 'hotmail.kr', 'hotmail.lv', 'hotmail.my', 'hotmail.ph', 'hotmail.pt', 'hotmail.sa', 'hotmail.sg', 'hotmail.sk', 'live.be', 'live.co.uk', 'live.com', 'live.com.ar', 'live.com.mx', 'live.de', 'live.es', 'live.eu', 'live.fr', 'live.it', 'live.nl', 'msn.com', 'outlook.at', 'outlook.be', 'outlook.cl', 'outlook.co.il', 'outlook.co.nz', 'outlook.co.th', 'outlook.com', 'outlook.com.ar', 'outlook.com.au', 'outlook.com.br', 'outlook.com.gr', 'outlook.com.pe', 'outlook.com.tr', 'outlook.com.vn', 'outlook.cz', 'outlook.de', 'outlook.dk', 'outlook.es', 'outlook.fr', 'outlook.hu', 'outlook.id', 'outlook.ie', 'outlook.in', 'outlook.it', 'outlook.jp', 'outlook.kr', 'outlook.lv', 'outlook.my', 'outlook.ph', 'outlook.pt', 'outlook.sa', 'outlook.sg', 'outlook.sk', 'passport.com']; // List of domains used by Yahoo Mail\n  // This list is likely incomplete\n\n  var yahoo_domains = ['rocketmail.com', 'yahoo.ca', 'yahoo.co.uk', 'yahoo.com', 'yahoo.de', 'yahoo.fr', 'yahoo.in', 'yahoo.it', 'ymail.com']; // List of domains used by yandex.ru\n\n  var yandex_domains = ['yandex.ru', 'yandex.ua', 'yandex.kz', 'yandex.com', 'yandex.by', 'ya.ru']; // replace single dots, but not multiple consecutive dots\n\n  function dotsReplacer(match) {\n    if (match.length > 1) {\n      return match;\n    }\n\n    return '';\n  }\n\n  function normalizeEmail(email, options) {\n    options = (0, _merge.default)(options, default_normalize_email_options);\n    var raw_parts = email.split('@');\n    var domain = raw_parts.pop();\n    var user = raw_parts.join('@');\n    var parts = [user, domain]; // The domain is always lowercased, as it's case-insensitive per RFC 1035\n\n    parts[1] = parts[1].toLowerCase();\n\n    if (parts[1] === 'gmail.com' || parts[1] === 'googlemail.com') {\n      // Address is GMail\n      if (options.gmail_remove_subaddress) {\n        parts[0] = parts[0].split('+')[0];\n      }\n\n      if (options.gmail_remove_dots) {\n        // this does not replace consecutive dots like example..email@gmail.com\n        parts[0] = parts[0].replace(/\\.+/g, dotsReplacer);\n      }\n\n      if (!parts[0].length) {\n        return false;\n      }\n\n      if (options.all_lowercase || options.gmail_lowercase) {\n        parts[0] = parts[0].toLowerCase();\n      }\n\n      parts[1] = options.gmail_convert_googlemaildotcom ? 'gmail.com' : parts[1];\n    } else if (icloud_domains.indexOf(parts[1]) >= 0) {\n      // Address is iCloud\n      if (options.icloud_remove_subaddress) {\n        parts[0] = parts[0].split('+')[0];\n      }\n\n      if (!parts[0].length) {\n        return false;\n      }\n\n      if (options.all_lowercase || options.icloud_lowercase) {\n        parts[0] = parts[0].toLowerCase();\n      }\n    } else if (outlookdotcom_domains.indexOf(parts[1]) >= 0) {\n      // Address is Outlook.com\n      if (options.outlookdotcom_remove_subaddress) {\n        parts[0] = parts[0].split('+')[0];\n      }\n\n      if (!parts[0].length) {\n        return false;\n      }\n\n      if (options.all_lowercase || options.outlookdotcom_lowercase) {\n        parts[0] = parts[0].toLowerCase();\n      }\n    } else if (yahoo_domains.indexOf(parts[1]) >= 0) {\n      // Address is Yahoo\n      if (options.yahoo_remove_subaddress) {\n        var components = parts[0].split('-');\n        parts[0] = components.length > 1 ? components.slice(0, -1).join('-') : components[0];\n      }\n\n      if (!parts[0].length) {\n        return false;\n      }\n\n      if (options.all_lowercase || options.yahoo_lowercase) {\n        parts[0] = parts[0].toLowerCase();\n      }\n    } else if (yandex_domains.indexOf(parts[1]) >= 0) {\n      if (options.all_lowercase || options.yandex_lowercase) {\n        parts[0] = parts[0].toLowerCase();\n      }\n\n      parts[1] = 'yandex.ru'; // all yandex domains are equal, 1st preferred\n    } else if (options.all_lowercase) {\n      // Any other address\n      parts[0] = parts[0].toLowerCase();\n    }\n\n    return parts.join('@');\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(normalizeEmail, normalizeEmail.exports);\n\nvar isSlug = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isSlug;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var charsetRegex = /^[^\\s-_](?!.*?[-_]{2,})[a-z0-9-\\\\][^\\s]*[^-_\\s]$/;\n\n  function isSlug(str) {\n    (0, _assertString.default)(str);\n    return charsetRegex.test(str);\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isSlug, isSlug.exports);\n\nvar isLicensePlate = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isLicensePlate;\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var validators = {\n    'cs-CZ': function csCZ(str) {\n      return /^(([ABCDEFHKIJKLMNPRSTUVXYZ]|[0-9])-?){5,8}$/.test(str);\n    },\n    'de-DE': function deDE(str) {\n      return /^((AW|UL|AK|GA|AÖ|LF|AZ|AM|AS|ZE|AN|AB|A|KG|KH|BA|EW|BZ|HY|KM|BT|HP|B|BC|BI|BO|FN|TT|ÜB|BN|AH|BS|FR|HB|ZZ|BB|BK|BÖ|OC|OK|CW|CE|C|CO|LH|CB|KW|LC|LN|DA|DI|DE|DH|SY|NÖ|DO|DD|DU|DN|D|EI|EA|EE|FI|EM|EL|EN|PF|ED|EF|ER|AU|ZP|E|ES|NT|EU|FL|FO|FT|FF|F|FS|FD|FÜ|GE|G|GI|GF|GS|ZR|GG|GP|GR|NY|ZI|GÖ|GZ|GT|HA|HH|HM|HU|WL|HZ|WR|RN|HK|HD|HN|HS|GK|HE|HF|RZ|HI|HG|HO|HX|IK|IL|IN|J|JL|KL|KA|KS|KF|KE|KI|KT|KO|KN|KR|KC|KU|K|LD|LL|LA|L|OP|LM|LI|LB|LU|LÖ|HL|LG|MD|GN|MZ|MA|ML|MR|MY|AT|DM|MC|NZ|RM|RG|MM|ME|MB|MI|FG|DL|HC|MW|RL|MK|MG|MÜ|WS|MH|M|MS|NU|NB|ND|NM|NK|NW|NR|NI|NF|DZ|EB|OZ|TG|TO|N|OA|GM|OB|CA|EH|FW|OF|OL|OE|OG|BH|LR|OS|AA|GD|OH|KY|NP|WK|PB|PA|PE|PI|PS|P|PM|PR|RA|RV|RE|R|H|SB|WN|RS|RD|RT|BM|NE|GV|RP|SU|GL|RO|GÜ|RH|EG|RW|PN|SK|MQ|RU|SZ|RI|SL|SM|SC|HR|FZ|VS|SW|SN|CR|SE|SI|SO|LP|SG|NH|SP|IZ|ST|BF|TE|HV|OD|SR|S|AC|DW|ZW|TF|TS|TR|TÜ|UM|PZ|TP|UE|UN|UH|MN|KK|VB|V|AE|PL|RC|VG|GW|PW|VR|VK|KB|WA|WT|BE|WM|WE|AP|MO|WW|FB|WZ|WI|WB|JE|WF|WO|W|WÜ|BL|Z|GC)[- ]?[A-Z]{1,2}[- ]?\\d{1,4}|(AIC|FDB|ABG|SLN|SAW|KLZ|BUL|ESB|NAB|SUL|WST|ABI|AZE|BTF|KÖT|DKB|FEU|ROT|ALZ|SMÜ|WER|AUR|NOR|DÜW|BRK|HAB|TÖL|WOR|BAD|BAR|BER|BIW|EBS|KEM|MÜB|PEG|BGL|BGD|REI|WIL|BKS|BIR|WAT|BOR|BOH|BOT|BRB|BLK|HHM|NEB|NMB|WSF|LEO|HDL|WMS|WZL|BÜS|CHA|KÖZ|ROD|WÜM|CLP|NEC|COC|ZEL|COE|CUX|DAH|LDS|DEG|DEL|RSL|DLG|DGF|LAN|HEI|MED|DON|KIB|ROK|JÜL|MON|SLE|EBE|EIC|HIG|WBS|BIT|PRÜ|LIB|EMD|WIT|ERH|HÖS|ERZ|ANA|ASZ|MAB|MEK|STL|SZB|FDS|HCH|HOR|WOL|FRG|GRA|WOS|FRI|FFB|GAP|GER|BRL|CLZ|GTH|NOH|HGW|GRZ|LÖB|NOL|WSW|DUD|HMÜ|OHA|KRU|HAL|HAM|HBS|QLB|HVL|NAU|HAS|EBN|GEO|HOH|HDH|ERK|HER|WAN|HEF|ROF|HBN|ALF|HSK|USI|NAI|REH|SAN|KÜN|ÖHR|HOL|WAR|ARN|BRG|GNT|HOG|WOH|KEH|MAI|PAR|RID|ROL|KLE|GEL|KUS|KYF|ART|SDH|LDK|DIL|MAL|VIB|LER|BNA|GHA|GRM|MTL|WUR|LEV|LIF|STE|WEL|LIP|VAI|LUP|HGN|LBZ|LWL|PCH|STB|DAN|MKK|SLÜ|MSP|TBB|MGH|MTK|BIN|MSH|EIL|HET|SGH|BID|MYK|MSE|MST|MÜR|WRN|MEI|GRH|RIE|MZG|MIL|OBB|BED|FLÖ|MOL|FRW|SEE|SRB|AIB|MOS|BCH|ILL|SOB|NMS|NEA|SEF|UFF|NEW|VOH|NDH|TDO|NWM|GDB|GVM|WIS|NOM|EIN|GAN|LAU|HEB|OHV|OSL|SFB|ERB|LOS|BSK|KEL|BSB|MEL|WTL|OAL|FÜS|MOD|OHZ|OPR|BÜR|PAF|PLÖ|CAS|GLA|REG|VIT|ECK|SIM|GOA|EMS|DIZ|GOH|RÜD|SWA|NES|KÖN|MET|LRO|BÜZ|DBR|ROS|TET|HRO|ROW|BRV|HIP|PAN|GRI|SHK|EIS|SRO|SOK|LBS|SCZ|MER|QFT|SLF|SLS|HOM|SLK|ASL|BBG|SBK|SFT|SHG|MGN|MEG|ZIG|SAD|NEN|OVI|SHA|BLB|SIG|SON|SPN|FOR|GUB|SPB|IGB|WND|STD|STA|SDL|OBG|HST|BOG|SHL|PIR|FTL|SEB|SÖM|SÜW|TIR|SAB|TUT|ANG|SDT|LÜN|LSZ|MHL|VEC|VER|VIE|OVL|ANK|OVP|SBG|UEM|UER|WLG|GMN|NVP|RDG|RÜG|DAU|FKB|WAF|WAK|SLZ|WEN|SOG|APD|WUG|GUN|ESW|WIZ|WES|DIN|BRA|BÜD|WHV|HWI|GHC|WTM|WOB|WUN|MAK|SEL|OCH|HOT|WDA)[- ]?(([A-Z][- ]?\\d{1,4})|([A-Z]{2}[- ]?\\d{1,3})))[- ]?(E|H)?$/.test(str);\n    },\n    'de-LI': function deLI(str) {\n      return /^FL[- ]?\\d{1,5}[UZ]?$/.test(str);\n    },\n    'fi-FI': function fiFI(str) {\n      return /^(?=.{4,7})(([A-Z]{1,3}|[0-9]{1,3})[\\s-]?([A-Z]{1,3}|[0-9]{1,5}))$/.test(str);\n    },\n    'pt-PT': function ptPT(str) {\n      return /^([A-Z]{2}|[0-9]{2})[ -·]?([A-Z]{2}|[0-9]{2})[ -·]?([A-Z]{2}|[0-9]{2})$/.test(str);\n    },\n    'sq-AL': function sqAL(str) {\n      return /^[A-Z]{2}[- ]?((\\d{3}[- ]?(([A-Z]{2})|T))|(R[- ]?\\d{3}))$/.test(str);\n    },\n    'pt-BR': function ptBR(str) {\n      return /^[A-Z]{3}[ -]?[0-9][A-Z][0-9]{2}|[A-Z]{3}[ -]?[0-9]{4}$/.test(str);\n    }\n  };\n\n  function isLicensePlate(str, locale) {\n    (0, _assertString.default)(str);\n\n    if (locale in validators) {\n      return validators[locale](str);\n    } else if (locale === 'any') {\n      for (var key in validators) {\n        /* eslint guard-for-in: 0 */\n        var validator = validators[key];\n\n        if (validator(str)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    throw new Error(\"Invalid locale '\".concat(locale, \"'\"));\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isLicensePlate, isLicensePlate.exports);\n\nvar isStrongPassword = {\n  exports: {}\n};\n\n(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = isStrongPassword;\n\n  var _merge = _interopRequireDefault(merge.exports);\n\n  var _assertString = _interopRequireDefault(assertString.exports);\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var upperCaseRegex = /^[A-Z]$/;\n  var lowerCaseRegex = /^[a-z]$/;\n  var numberRegex = /^[0-9]$/;\n  var symbolRegex = /^[-#!$@%^&*()_+|~=`{}\\[\\]:\";'<>?,.\\/ ]$/;\n  var defaultOptions = {\n    minLength: 8,\n    minLowercase: 1,\n    minUppercase: 1,\n    minNumbers: 1,\n    minSymbols: 1,\n    returnScore: false,\n    pointsPerUnique: 1,\n    pointsPerRepeat: 0.5,\n    pointsForContainingLower: 10,\n    pointsForContainingUpper: 10,\n    pointsForContainingNumber: 10,\n    pointsForContainingSymbol: 10\n  };\n  /* Counts number of occurrences of each char in a string\n   * could be moved to util/ ?\n  */\n\n  function countChars(str) {\n    var result = {};\n    Array.from(str).forEach(function (char) {\n      var curVal = result[char];\n\n      if (curVal) {\n        result[char] += 1;\n      } else {\n        result[char] = 1;\n      }\n    });\n    return result;\n  }\n  /* Return information about a password */\n\n\n  function analyzePassword(password) {\n    var charMap = countChars(password);\n    var analysis = {\n      length: password.length,\n      uniqueChars: Object.keys(charMap).length,\n      uppercaseCount: 0,\n      lowercaseCount: 0,\n      numberCount: 0,\n      symbolCount: 0\n    };\n    Object.keys(charMap).forEach(function (char) {\n      /* istanbul ignore else */\n      if (upperCaseRegex.test(char)) {\n        analysis.uppercaseCount += charMap[char];\n      } else if (lowerCaseRegex.test(char)) {\n        analysis.lowercaseCount += charMap[char];\n      } else if (numberRegex.test(char)) {\n        analysis.numberCount += charMap[char];\n      } else if (symbolRegex.test(char)) {\n        analysis.symbolCount += charMap[char];\n      }\n    });\n    return analysis;\n  }\n\n  function scorePassword(analysis, scoringOptions) {\n    var points = 0;\n    points += analysis.uniqueChars * scoringOptions.pointsPerUnique;\n    points += (analysis.length - analysis.uniqueChars) * scoringOptions.pointsPerRepeat;\n\n    if (analysis.lowercaseCount > 0) {\n      points += scoringOptions.pointsForContainingLower;\n    }\n\n    if (analysis.uppercaseCount > 0) {\n      points += scoringOptions.pointsForContainingUpper;\n    }\n\n    if (analysis.numberCount > 0) {\n      points += scoringOptions.pointsForContainingNumber;\n    }\n\n    if (analysis.symbolCount > 0) {\n      points += scoringOptions.pointsForContainingSymbol;\n    }\n\n    return points;\n  }\n\n  function isStrongPassword(str) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    (0, _assertString.default)(str);\n    var analysis = analyzePassword(str);\n    options = (0, _merge.default)(options || {}, defaultOptions);\n\n    if (options.returnScore) {\n      return scorePassword(analysis, options);\n    }\n\n    return analysis.length >= options.minLength && analysis.lowercaseCount >= options.minLowercase && analysis.uppercaseCount >= options.minUppercase && analysis.numberCount >= options.minNumbers && analysis.symbolCount >= options.minSymbols;\n  }\n\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(isStrongPassword, isStrongPassword.exports);\n\nvar isVAT$1 = {};\nObject.defineProperty(isVAT$1, \"__esModule\", {\n  value: true\n});\nisVAT$1.default = isVAT;\nisVAT$1.vatMatchers = void 0;\n\nvar _assertString = _interopRequireDefault(assertString.exports);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar vatMatchers = {\n  GB: /^GB((\\d{3} \\d{4} ([0-8][0-9]|9[0-6]))|(\\d{9} \\d{3})|(((GD[0-4])|(HA[5-9]))[0-9]{2}))$/,\n  IT: /^(IT)?[0-9]{11}$/,\n  NL: /^(NL)?[0-9]{9}B[0-9]{2}$/\n};\nisVAT$1.vatMatchers = vatMatchers;\n\nfunction isVAT(str, countryCode) {\n  (0, _assertString.default)(str);\n  (0, _assertString.default)(countryCode);\n\n  if (countryCode in vatMatchers) {\n    return vatMatchers[countryCode].test(str);\n  }\n\n  throw new Error(\"Invalid country code: '\".concat(countryCode, \"'\"));\n}\n\n(function (module, exports) {\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n\n  var _toDate = _interopRequireDefault(toDate$1.exports);\n\n  var _toFloat = _interopRequireDefault(toFloat.exports);\n\n  var _toInt = _interopRequireDefault(toInt.exports);\n\n  var _toBoolean = _interopRequireDefault(toBoolean.exports);\n\n  var _equals = _interopRequireDefault(equals.exports);\n\n  var _contains = _interopRequireDefault(contains.exports);\n\n  var _matches = _interopRequireDefault(matches.exports);\n\n  var _isEmail = _interopRequireDefault(isEmail.exports);\n\n  var _isURL = _interopRequireDefault(isURL.exports);\n\n  var _isMACAddress = _interopRequireDefault(isMACAddress.exports);\n\n  var _isIP = _interopRequireDefault(isIP.exports);\n\n  var _isIPRange = _interopRequireDefault(isIPRange.exports);\n\n  var _isFQDN = _interopRequireDefault(isFQDN.exports);\n\n  var _isDate = _interopRequireDefault(isDate$2.exports);\n\n  var _isBoolean = _interopRequireDefault(isBoolean.exports);\n\n  var _isLocale = _interopRequireDefault(isLocale.exports);\n\n  var _isAlpha = _interopRequireWildcard(isAlpha$1);\n\n  var _isAlphanumeric = _interopRequireWildcard(isAlphanumeric$1);\n\n  var _isNumeric = _interopRequireDefault(isNumeric.exports);\n\n  var _isPassportNumber = _interopRequireDefault(isPassportNumber.exports);\n\n  var _isPort = _interopRequireDefault(isPort.exports);\n\n  var _isLowercase = _interopRequireDefault(isLowercase.exports);\n\n  var _isUppercase = _interopRequireDefault(isUppercase.exports);\n\n  var _isIMEI = _interopRequireDefault(isIMEI.exports);\n\n  var _isAscii = _interopRequireDefault(isAscii.exports);\n\n  var _isFullWidth = _interopRequireDefault(isFullWidth$1);\n\n  var _isHalfWidth = _interopRequireDefault(isHalfWidth$1);\n\n  var _isVariableWidth = _interopRequireDefault(isVariableWidth.exports);\n\n  var _isMultibyte = _interopRequireDefault(isMultibyte.exports);\n\n  var _isSemVer = _interopRequireDefault(isSemVer.exports);\n\n  var _isSurrogatePair = _interopRequireDefault(isSurrogatePair.exports);\n\n  var _isInt = _interopRequireDefault(isInt$1.exports);\n\n  var _isFloat = _interopRequireWildcard(isFloat$1);\n\n  var _isDecimal = _interopRequireDefault(isDecimal.exports);\n\n  var _isHexadecimal = _interopRequireDefault(isHexadecimal.exports);\n\n  var _isOctal = _interopRequireDefault(isOctal.exports);\n\n  var _isDivisibleBy = _interopRequireDefault(isDivisibleBy.exports);\n\n  var _isHexColor = _interopRequireDefault(isHexColor.exports);\n\n  var _isRgbColor = _interopRequireDefault(isRgbColor.exports);\n\n  var _isHSL = _interopRequireDefault(isHSL.exports);\n\n  var _isISRC = _interopRequireDefault(isISRC.exports);\n\n  var _isIBAN = _interopRequireWildcard(isIBAN$1);\n\n  var _isBIC = _interopRequireDefault(isBIC.exports);\n\n  var _isMD = _interopRequireDefault(isMD5.exports);\n\n  var _isHash = _interopRequireDefault(isHash.exports);\n\n  var _isJWT = _interopRequireDefault(isJWT.exports);\n\n  var _isJSON = _interopRequireDefault(isJSON.exports);\n\n  var _isEmpty = _interopRequireDefault(isEmpty.exports);\n\n  var _isLength = _interopRequireDefault(isLength.exports);\n\n  var _isByteLength = _interopRequireDefault(isByteLength.exports);\n\n  var _isUUID = _interopRequireDefault(isUUID.exports);\n\n  var _isMongoId = _interopRequireDefault(isMongoId.exports);\n\n  var _isAfter = _interopRequireDefault(isAfter.exports);\n\n  var _isBefore = _interopRequireDefault(isBefore.exports);\n\n  var _isIn = _interopRequireDefault(isIn.exports);\n\n  var _isCreditCard = _interopRequireDefault(isCreditCard.exports);\n\n  var _isIdentityCard = _interopRequireDefault(isIdentityCard.exports);\n\n  var _isEAN = _interopRequireDefault(isEAN.exports);\n\n  var _isISIN = _interopRequireDefault(isISIN.exports);\n\n  var _isISBN = _interopRequireDefault(isISBN.exports);\n\n  var _isISSN = _interopRequireDefault(isISSN.exports);\n\n  var _isTaxID = _interopRequireDefault(isTaxID.exports);\n\n  var _isMobilePhone = _interopRequireWildcard(isMobilePhone$1);\n\n  var _isEthereumAddress = _interopRequireDefault(isEthereumAddress.exports);\n\n  var _isCurrency = _interopRequireDefault(isCurrency.exports);\n\n  var _isBtcAddress = _interopRequireDefault(isBtcAddress.exports);\n\n  var _isISO = _interopRequireDefault(isISO8601.exports);\n\n  var _isRFC = _interopRequireDefault(isRFC3339.exports);\n\n  var _isISO31661Alpha = _interopRequireDefault(isISO31661Alpha2$1);\n\n  var _isISO31661Alpha2 = _interopRequireDefault(isISO31661Alpha3.exports);\n\n  var _isISO2 = _interopRequireDefault(isISO4217$1);\n\n  var _isBase = _interopRequireDefault(isBase32.exports);\n\n  var _isBase2 = _interopRequireDefault(isBase58.exports);\n\n  var _isBase3 = _interopRequireDefault(isBase64.exports);\n\n  var _isDataURI = _interopRequireDefault(isDataURI.exports);\n\n  var _isMagnetURI = _interopRequireDefault(isMagnetURI.exports);\n\n  var _isMimeType = _interopRequireDefault(isMimeType.exports);\n\n  var _isLatLong = _interopRequireDefault(isLatLong.exports);\n\n  var _isPostalCode = _interopRequireWildcard(isPostalCode$1);\n\n  var _ltrim = _interopRequireDefault(ltrim.exports);\n\n  var _rtrim = _interopRequireDefault(rtrim.exports);\n\n  var _trim = _interopRequireDefault(trim.exports);\n\n  var _escape$1 = _interopRequireDefault(_escape.exports);\n\n  var _unescape$1 = _interopRequireDefault(_unescape.exports);\n\n  var _stripLow = _interopRequireDefault(stripLow.exports);\n\n  var _whitelist = _interopRequireDefault(whitelist.exports);\n\n  var _blacklist = _interopRequireDefault(blacklist.exports);\n\n  var _isWhitelisted = _interopRequireDefault(isWhitelisted.exports);\n\n  var _normalizeEmail = _interopRequireDefault(normalizeEmail.exports);\n\n  var _isSlug = _interopRequireDefault(isSlug.exports);\n\n  var _isLicensePlate = _interopRequireDefault(isLicensePlate.exports);\n\n  var _isStrongPassword = _interopRequireDefault(isStrongPassword.exports);\n\n  var _isVAT = _interopRequireDefault(isVAT$1);\n\n  function _getRequireWildcardCache() {\n    if (typeof WeakMap !== \"function\") return null;\n    var cache = new WeakMap();\n\n    _getRequireWildcardCache = function _getRequireWildcardCache() {\n      return cache;\n    };\n\n    return cache;\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    }\n\n    if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n      return {\n        default: obj\n      };\n    }\n\n    var cache = _getRequireWildcardCache();\n\n    if (cache && cache.has(obj)) {\n      return cache.get(obj);\n    }\n\n    var newObj = {};\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n        if (desc && (desc.get || desc.set)) {\n          Object.defineProperty(newObj, key, desc);\n        } else {\n          newObj[key] = obj[key];\n        }\n      }\n    }\n\n    newObj.default = obj;\n\n    if (cache) {\n      cache.set(obj, newObj);\n    }\n\n    return newObj;\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  var version = '13.7.0';\n  var validator = {\n    version: version,\n    toDate: _toDate.default,\n    toFloat: _toFloat.default,\n    toInt: _toInt.default,\n    toBoolean: _toBoolean.default,\n    equals: _equals.default,\n    contains: _contains.default,\n    matches: _matches.default,\n    isEmail: _isEmail.default,\n    isURL: _isURL.default,\n    isMACAddress: _isMACAddress.default,\n    isIP: _isIP.default,\n    isIPRange: _isIPRange.default,\n    isFQDN: _isFQDN.default,\n    isBoolean: _isBoolean.default,\n    isIBAN: _isIBAN.default,\n    isBIC: _isBIC.default,\n    isAlpha: _isAlpha.default,\n    isAlphaLocales: _isAlpha.locales,\n    isAlphanumeric: _isAlphanumeric.default,\n    isAlphanumericLocales: _isAlphanumeric.locales,\n    isNumeric: _isNumeric.default,\n    isPassportNumber: _isPassportNumber.default,\n    isPort: _isPort.default,\n    isLowercase: _isLowercase.default,\n    isUppercase: _isUppercase.default,\n    isAscii: _isAscii.default,\n    isFullWidth: _isFullWidth.default,\n    isHalfWidth: _isHalfWidth.default,\n    isVariableWidth: _isVariableWidth.default,\n    isMultibyte: _isMultibyte.default,\n    isSemVer: _isSemVer.default,\n    isSurrogatePair: _isSurrogatePair.default,\n    isInt: _isInt.default,\n    isIMEI: _isIMEI.default,\n    isFloat: _isFloat.default,\n    isFloatLocales: _isFloat.locales,\n    isDecimal: _isDecimal.default,\n    isHexadecimal: _isHexadecimal.default,\n    isOctal: _isOctal.default,\n    isDivisibleBy: _isDivisibleBy.default,\n    isHexColor: _isHexColor.default,\n    isRgbColor: _isRgbColor.default,\n    isHSL: _isHSL.default,\n    isISRC: _isISRC.default,\n    isMD5: _isMD.default,\n    isHash: _isHash.default,\n    isJWT: _isJWT.default,\n    isJSON: _isJSON.default,\n    isEmpty: _isEmpty.default,\n    isLength: _isLength.default,\n    isLocale: _isLocale.default,\n    isByteLength: _isByteLength.default,\n    isUUID: _isUUID.default,\n    isMongoId: _isMongoId.default,\n    isAfter: _isAfter.default,\n    isBefore: _isBefore.default,\n    isIn: _isIn.default,\n    isCreditCard: _isCreditCard.default,\n    isIdentityCard: _isIdentityCard.default,\n    isEAN: _isEAN.default,\n    isISIN: _isISIN.default,\n    isISBN: _isISBN.default,\n    isISSN: _isISSN.default,\n    isMobilePhone: _isMobilePhone.default,\n    isMobilePhoneLocales: _isMobilePhone.locales,\n    isPostalCode: _isPostalCode.default,\n    isPostalCodeLocales: _isPostalCode.locales,\n    isEthereumAddress: _isEthereumAddress.default,\n    isCurrency: _isCurrency.default,\n    isBtcAddress: _isBtcAddress.default,\n    isISO8601: _isISO.default,\n    isRFC3339: _isRFC.default,\n    isISO31661Alpha2: _isISO31661Alpha.default,\n    isISO31661Alpha3: _isISO31661Alpha2.default,\n    isISO4217: _isISO2.default,\n    isBase32: _isBase.default,\n    isBase58: _isBase2.default,\n    isBase64: _isBase3.default,\n    isDataURI: _isDataURI.default,\n    isMagnetURI: _isMagnetURI.default,\n    isMimeType: _isMimeType.default,\n    isLatLong: _isLatLong.default,\n    ltrim: _ltrim.default,\n    rtrim: _rtrim.default,\n    trim: _trim.default,\n    escape: _escape$1.default,\n    unescape: _unescape$1.default,\n    stripLow: _stripLow.default,\n    whitelist: _whitelist.default,\n    blacklist: _blacklist.default,\n    isWhitelisted: _isWhitelisted.default,\n    normalizeEmail: _normalizeEmail.default,\n    toString: toString,\n    isSlug: _isSlug.default,\n    isStrongPassword: _isStrongPassword.default,\n    isTaxID: _isTaxID.default,\n    isDate: _isDate.default,\n    isLicensePlate: _isLicensePlate.default,\n    isVAT: _isVAT.default,\n    ibanLocales: _isIBAN.locales\n  };\n  var _default = validator;\n  exports.default = _default;\n  module.exports = exports.default;\n  module.exports.default = exports.default;\n})(validator$1, validator$1.exports);\n\nvar validator = /*@__PURE__*/getDefaultExportFromCjs(validator$1.exports);\n\nfunction toInteger(dirtyNumber) {\n  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {\n    return NaN;\n  }\n\n  var number = Number(dirtyNumber);\n\n  if (isNaN(number)) {\n    return number;\n  }\n\n  return number < 0 ? Math.ceil(number) : Math.floor(number);\n}\n\nfunction requiredArgs(required, args) {\n  if (args.length < required) {\n    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');\n  }\n}\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\n\n\nfunction toDate(argument) {\n  requiredArgs(1, arguments);\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}\n/**\n * @name addMilliseconds\n * @category Millisecond Helpers\n * @summary Add the specified number of milliseconds to the given date.\n *\n * @description\n * Add the specified number of milliseconds to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the milliseconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 750 milliseconds to 10 July 2014 12:45:30.000:\n * const result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:30.750\n */\n\n\nfunction addMilliseconds(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var timestamp = toDate(dirtyDate).getTime();\n  var amount = toInteger(dirtyAmount);\n  return new Date(timestamp + amount);\n}\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\n\n\nfunction getTimezoneOffsetInMilliseconds(date) {\n  var utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));\n  utcDate.setUTCFullYear(date.getFullYear());\n  return date.getTime() - utcDate.getTime();\n}\n/**\n * @name isDate\n * @category Common Helpers\n * @summary Is the given value a date?\n *\n * @description\n * Returns true if the given value is an instance of Date. The function works for dates transferred across iframes.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {*} value - the value to check\n * @returns {boolean} true if the given value is a date\n * @throws {TypeError} 1 arguments required\n *\n * @example\n * // For a valid date:\n * const result = isDate(new Date())\n * //=> true\n *\n * @example\n * // For an invalid date:\n * const result = isDate(new Date(NaN))\n * //=> true\n *\n * @example\n * // For some value:\n * const result = isDate('2014-02-31')\n * //=> false\n *\n * @example\n * // For an object:\n * const result = isDate({})\n * //=> false\n */\n\n\nfunction isDate$1(value) {\n  requiredArgs(1, arguments);\n  return value instanceof Date || typeof value === 'object' && Object.prototype.toString.call(value) === '[object Date]';\n}\n/**\n * @name isValid\n * @category Common Helpers\n * @summary Is the given date valid?\n *\n * @description\n * Returns false if argument is Invalid Date and true otherwise.\n * Argument is converted to Date using `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}\n * Invalid Date is a Date, whose time value is NaN.\n *\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - Now `isValid` doesn't throw an exception\n *   if the first argument is not an instance of Date.\n *   Instead, argument is converted beforehand using `toDate`.\n *\n *   Examples:\n *\n *   | `isValid` argument        | Before v2.0.0 | v2.0.0 onward |\n *   |---------------------------|---------------|---------------|\n *   | `new Date()`              | `true`        | `true`        |\n *   | `new Date('2016-01-01')`  | `true`        | `true`        |\n *   | `new Date('')`            | `false`       | `false`       |\n *   | `new Date(1488370835081)` | `true`        | `true`        |\n *   | `new Date(NaN)`           | `false`       | `false`       |\n *   | `'2016-01-01'`            | `TypeError`   | `false`       |\n *   | `''`                      | `TypeError`   | `false`       |\n *   | `1488370835081`           | `TypeError`   | `true`        |\n *   | `NaN`                     | `TypeError`   | `false`       |\n *\n *   We introduce this change to make *date-fns* consistent with ECMAScript behavior\n *   that try to coerce arguments to the expected type\n *   (which is also the case with other *date-fns* functions).\n *\n * @param {*} date - the date to check\n * @returns {Boolean} the date is valid\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // For the valid date:\n * const result = isValid(new Date(2014, 1, 31))\n * //=> true\n *\n * @example\n * // For the value, convertable into a date:\n * const result = isValid(1393804800000)\n * //=> true\n *\n * @example\n * // For the invalid date:\n * const result = isValid(new Date(''))\n * //=> false\n */\n\n\nfunction isValid$2(dirtyDate) {\n  requiredArgs(1, arguments);\n\n  if (!isDate$1(dirtyDate) && typeof dirtyDate !== 'number') {\n    return false;\n  }\n\n  var date = toDate(dirtyDate);\n  return !isNaN(Number(date));\n}\n\nvar formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: 'less than a second',\n    other: 'less than {{count}} seconds'\n  },\n  xSeconds: {\n    one: '1 second',\n    other: '{{count}} seconds'\n  },\n  halfAMinute: 'half a minute',\n  lessThanXMinutes: {\n    one: 'less than a minute',\n    other: 'less than {{count}} minutes'\n  },\n  xMinutes: {\n    one: '1 minute',\n    other: '{{count}} minutes'\n  },\n  aboutXHours: {\n    one: 'about 1 hour',\n    other: 'about {{count}} hours'\n  },\n  xHours: {\n    one: '1 hour',\n    other: '{{count}} hours'\n  },\n  xDays: {\n    one: '1 day',\n    other: '{{count}} days'\n  },\n  aboutXWeeks: {\n    one: 'about 1 week',\n    other: 'about {{count}} weeks'\n  },\n  xWeeks: {\n    one: '1 week',\n    other: '{{count}} weeks'\n  },\n  aboutXMonths: {\n    one: 'about 1 month',\n    other: 'about {{count}} months'\n  },\n  xMonths: {\n    one: '1 month',\n    other: '{{count}} months'\n  },\n  aboutXYears: {\n    one: 'about 1 year',\n    other: 'about {{count}} years'\n  },\n  xYears: {\n    one: '1 year',\n    other: '{{count}} years'\n  },\n  overXYears: {\n    one: 'over 1 year',\n    other: 'over {{count}} years'\n  },\n  almostXYears: {\n    one: 'almost 1 year',\n    other: 'almost {{count}} years'\n  }\n};\n\nvar formatDistance = function formatDistance(token, count, options) {\n  var result;\n  var tokenValue = formatDistanceLocale[token];\n\n  if (typeof tokenValue === 'string') {\n    result = tokenValue;\n  } else if (count === 1) {\n    result = tokenValue.one;\n  } else {\n    result = tokenValue.other.replace('{{count}}', count.toString());\n  }\n\n  if (options !== null && options !== void 0 && options.addSuffix) {\n    if (options.comparison && options.comparison > 0) {\n      return 'in ' + result;\n    } else {\n      return result + ' ago';\n    }\n  }\n\n  return result;\n};\n\nvar formatDistance$1 = formatDistance;\n\nfunction buildFormatLongFn(args) {\n  return function () {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // TODO: Remove String()\n\n    var width = options.width ? String(options.width) : args.defaultWidth;\n    var format = args.formats[width] || args.formats[args.defaultWidth];\n    return format;\n  };\n}\n\nvar dateFormats = {\n  full: 'EEEE, MMMM do, y',\n  long: 'MMMM do, y',\n  medium: 'MMM d, y',\n  short: 'MM/dd/yyyy'\n};\nvar timeFormats = {\n  full: 'h:mm:ss a zzzz',\n  long: 'h:mm:ss a z',\n  medium: 'h:mm:ss a',\n  short: 'h:mm a'\n};\nvar dateTimeFormats = {\n  full: \"{{date}} 'at' {{time}}\",\n  long: \"{{date}} 'at' {{time}}\",\n  medium: '{{date}}, {{time}}',\n  short: '{{date}}, {{time}}'\n};\nvar formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: 'full'\n  }),\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: 'full'\n  }),\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: 'full'\n  })\n};\nvar formatLong$1 = formatLong;\nvar formatRelativeLocale = {\n  lastWeek: \"'last' eeee 'at' p\",\n  yesterday: \"'yesterday at' p\",\n  today: \"'today at' p\",\n  tomorrow: \"'tomorrow at' p\",\n  nextWeek: \"eeee 'at' p\",\n  other: 'P'\n};\n\nvar formatRelative = function formatRelative(token, _date, _baseDate, _options) {\n  return formatRelativeLocale[token];\n};\n\nvar formatRelative$1 = formatRelative;\n\nfunction buildLocalizeFn(args) {\n  return function (dirtyIndex, dirtyOptions) {\n    var options = dirtyOptions || {};\n    var context = options.context ? String(options.context) : 'standalone';\n    var valuesArray;\n\n    if (context === 'formatting' && args.formattingValues) {\n      var defaultWidth = args.defaultFormattingWidth || args.defaultWidth;\n      var width = options.width ? String(options.width) : defaultWidth;\n      valuesArray = args.formattingValues[width] || args.formattingValues[defaultWidth];\n    } else {\n      var _defaultWidth = args.defaultWidth;\n\n      var _width = options.width ? String(options.width) : args.defaultWidth;\n\n      valuesArray = args.values[_width] || args.values[_defaultWidth];\n    }\n\n    var index = args.argumentCallback ? args.argumentCallback(dirtyIndex) : dirtyIndex; // @ts-ignore: For some reason TypeScript just don't want to match it, no matter how hard we try. I challenge you to try to remove it!\n\n    return valuesArray[index];\n  };\n}\n\nvar eraValues = {\n  narrow: ['B', 'A'],\n  abbreviated: ['BC', 'AD'],\n  wide: ['Before Christ', 'Anno Domini']\n};\nvar quarterValues = {\n  narrow: ['1', '2', '3', '4'],\n  abbreviated: ['Q1', 'Q2', 'Q3', 'Q4'],\n  wide: ['1st quarter', '2nd quarter', '3rd quarter', '4th quarter']\n}; // Note: in English, the names of days of the week and months are capitalized.\n// If you are making a new locale based on this one, check if the same is true for the language you're working on.\n// Generally, formatted dates should look like they are in the middle of a sentence,\n// e.g. in Spanish language the weekdays and months should be in the lowercase.\n\nvar monthValues = {\n  narrow: ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'],\n  abbreviated: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n  wide: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']\n};\nvar dayValues = {\n  narrow: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n  short: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n  abbreviated: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n  wide: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\n};\nvar dayPeriodValues = {\n  narrow: {\n    am: 'a',\n    pm: 'p',\n    midnight: 'mi',\n    noon: 'n',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  },\n  abbreviated: {\n    am: 'AM',\n    pm: 'PM',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  },\n  wide: {\n    am: 'a.m.',\n    pm: 'p.m.',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  }\n};\nvar formattingDayPeriodValues = {\n  narrow: {\n    am: 'a',\n    pm: 'p',\n    midnight: 'mi',\n    noon: 'n',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  },\n  abbreviated: {\n    am: 'AM',\n    pm: 'PM',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  },\n  wide: {\n    am: 'a.m.',\n    pm: 'p.m.',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  }\n};\n\nvar ordinalNumber = function ordinalNumber(dirtyNumber, _options) {\n  var number = Number(dirtyNumber); // If ordinal numbers depend on context, for example,\n  // if they are different for different grammatical genders,\n  // use `options.unit`.\n  //\n  // `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',\n  // 'day', 'hour', 'minute', 'second'.\n\n  var rem100 = number % 100;\n\n  if (rem100 > 20 || rem100 < 10) {\n    switch (rem100 % 10) {\n      case 1:\n        return number + 'st';\n\n      case 2:\n        return number + 'nd';\n\n      case 3:\n        return number + 'rd';\n    }\n  }\n\n  return number + 'th';\n};\n\nvar localize = {\n  ordinalNumber: ordinalNumber,\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: 'wide'\n  }),\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: 'wide',\n    argumentCallback: function argumentCallback(quarter) {\n      return quarter - 1;\n    }\n  }),\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: 'wide'\n  }),\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: 'wide'\n  }),\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: 'wide',\n    formattingValues: formattingDayPeriodValues,\n    defaultFormattingWidth: 'wide'\n  })\n};\nvar localize$1 = localize;\n\nfunction buildMatchFn(args) {\n  return function (string) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var width = options.width;\n    var matchPattern = width && args.matchPatterns[width] || args.matchPatterns[args.defaultMatchWidth];\n    var matchResult = string.match(matchPattern);\n\n    if (!matchResult) {\n      return null;\n    }\n\n    var matchedString = matchResult[0];\n    var parsePatterns = width && args.parsePatterns[width] || args.parsePatterns[args.defaultParseWidth];\n    var key = Array.isArray(parsePatterns) ? findIndex(parsePatterns, function (pattern) {\n      return pattern.test(matchedString);\n    }) : findKey(parsePatterns, function (pattern) {\n      return pattern.test(matchedString);\n    });\n    var value;\n    value = args.valueCallback ? args.valueCallback(key) : key;\n    value = options.valueCallback ? options.valueCallback(value) : value;\n    var rest = string.slice(matchedString.length);\n    return {\n      value: value,\n      rest: rest\n    };\n  };\n}\n\nfunction findKey(object, predicate) {\n  for (var key in object) {\n    if (object.hasOwnProperty(key) && predicate(object[key])) {\n      return key;\n    }\n  }\n\n  return undefined;\n}\n\nfunction findIndex(array, predicate) {\n  for (var key = 0; key < array.length; key++) {\n    if (predicate(array[key])) {\n      return key;\n    }\n  }\n\n  return undefined;\n}\n\nfunction buildMatchPatternFn(args) {\n  return function (string) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var matchResult = string.match(args.matchPattern);\n    if (!matchResult) return null;\n    var matchedString = matchResult[0];\n    var parseResult = string.match(args.parsePattern);\n    if (!parseResult) return null;\n    var value = args.valueCallback ? args.valueCallback(parseResult[0]) : parseResult[0];\n    value = options.valueCallback ? options.valueCallback(value) : value;\n    var rest = string.slice(matchedString.length);\n    return {\n      value: value,\n      rest: rest\n    };\n  };\n}\n\nvar matchOrdinalNumberPattern = /^(\\d+)(th|st|nd|rd)?/i;\nvar parseOrdinalNumberPattern = /\\d+/i;\nvar matchEraPatterns = {\n  narrow: /^(b|a)/i,\n  abbreviated: /^(b\\.?\\s?c\\.?|b\\.?\\s?c\\.?\\s?e\\.?|a\\.?\\s?d\\.?|c\\.?\\s?e\\.?)/i,\n  wide: /^(before christ|before common era|anno domini|common era)/i\n};\nvar parseEraPatterns = {\n  any: [/^b/i, /^(a|c)/i]\n};\nvar matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^q[1234]/i,\n  wide: /^[1234](th|st|nd|rd)? quarter/i\n};\nvar parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i]\n};\nvar matchMonthPatterns = {\n  narrow: /^[jfmasond]/i,\n  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,\n  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i\n};\nvar parseMonthPatterns = {\n  narrow: [/^j/i, /^f/i, /^m/i, /^a/i, /^m/i, /^j/i, /^j/i, /^a/i, /^s/i, /^o/i, /^n/i, /^d/i],\n  any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i]\n};\nvar matchDayPatterns = {\n  narrow: /^[smtwf]/i,\n  short: /^(su|mo|tu|we|th|fr|sa)/i,\n  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,\n  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i\n};\nvar parseDayPatterns = {\n  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],\n  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]\n};\nvar matchDayPeriodPatterns = {\n  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,\n  any: /^([ap]\\.?\\s?m\\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i\n};\nvar parseDayPeriodPatterns = {\n  any: {\n    am: /^a/i,\n    pm: /^p/i,\n    midnight: /^mi/i,\n    noon: /^no/i,\n    morning: /morning/i,\n    afternoon: /afternoon/i,\n    evening: /evening/i,\n    night: /night/i\n  }\n};\nvar match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: function valueCallback(value) {\n      return parseInt(value, 10);\n    }\n  }),\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: 'any'\n  }),\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: 'any',\n    valueCallback: function valueCallback(index) {\n      return index + 1;\n    }\n  }),\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: 'any'\n  }),\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: 'any'\n  }),\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: 'any',\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: 'any'\n  })\n};\nvar match$1 = match;\n/**\n * @type {Locale}\n * @category Locales\n * @summary English locale (United States).\n * @language English\n * @iso-639-2 eng\n * @author Sasha Koss [@kossnocorp]{@link https://github.com/kossnocorp}\n * @author Lesha Koss [@leshakoss]{@link https://github.com/leshakoss}\n */\n\nvar locale = {\n  code: 'en-US',\n  formatDistance: formatDistance$1,\n  formatLong: formatLong$1,\n  formatRelative: formatRelative$1,\n  localize: localize$1,\n  match: match$1,\n  options: {\n    weekStartsOn: 0\n    /* Sunday */\n    ,\n    firstWeekContainsDate: 1\n  }\n};\nvar defaultLocale = locale;\n/**\n * @name subMilliseconds\n * @category Millisecond Helpers\n * @summary Subtract the specified number of milliseconds from the given date.\n *\n * @description\n * Subtract the specified number of milliseconds from the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be subtracted. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the milliseconds subtracted\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Subtract 750 milliseconds from 10 July 2014 12:45:30.000:\n * const result = subMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:29.250\n */\n\nfunction subMilliseconds(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, -amount);\n}\n\nvar MILLISECONDS_IN_DAY = 86400000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nfunction getUTCDayOfYear(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var timestamp = date.getTime();\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n  var startOfYearTimestamp = date.getTime();\n  var difference = timestamp - startOfYearTimestamp;\n  return Math.floor(difference / MILLISECONDS_IN_DAY) + 1;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction startOfUTCISOWeek(dirtyDate) {\n  requiredArgs(1, arguments);\n  var weekStartsOn = 1;\n  var date = toDate(dirtyDate);\n  var day = date.getUTCDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setUTCDate(date.getUTCDate() - diff);\n  date.setUTCHours(0, 0, 0, 0);\n  return date;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction getUTCISOWeekYear(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var year = date.getUTCFullYear();\n  var fourthOfJanuaryOfNextYear = new Date(0);\n  fourthOfJanuaryOfNextYear.setUTCFullYear(year + 1, 0, 4);\n  fourthOfJanuaryOfNextYear.setUTCHours(0, 0, 0, 0);\n  var startOfNextYear = startOfUTCISOWeek(fourthOfJanuaryOfNextYear);\n  var fourthOfJanuaryOfThisYear = new Date(0);\n  fourthOfJanuaryOfThisYear.setUTCFullYear(year, 0, 4);\n  fourthOfJanuaryOfThisYear.setUTCHours(0, 0, 0, 0);\n  var startOfThisYear = startOfUTCISOWeek(fourthOfJanuaryOfThisYear);\n\n  if (date.getTime() >= startOfNextYear.getTime()) {\n    return year + 1;\n  } else if (date.getTime() >= startOfThisYear.getTime()) {\n    return year;\n  } else {\n    return year - 1;\n  }\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction startOfUTCISOWeekYear(dirtyDate) {\n  requiredArgs(1, arguments);\n  var year = getUTCISOWeekYear(dirtyDate);\n  var fourthOfJanuary = new Date(0);\n  fourthOfJanuary.setUTCFullYear(year, 0, 4);\n  fourthOfJanuary.setUTCHours(0, 0, 0, 0);\n  var date = startOfUTCISOWeek(fourthOfJanuary);\n  return date;\n}\n\nvar MILLISECONDS_IN_WEEK$1 = 604800000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nfunction getUTCISOWeek(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var diff = startOfUTCISOWeek(date).getTime() - startOfUTCISOWeekYear(date).getTime(); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round(diff / MILLISECONDS_IN_WEEK$1) + 1;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction startOfUTCWeek(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = date.getUTCDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setUTCDate(date.getUTCDate() - diff);\n  date.setUTCHours(0, 0, 0, 0);\n  return date;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction getUTCWeekYear(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var year = date.getUTCFullYear();\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeFirstWeekContainsDate = locale && locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var firstWeekOfNextYear = new Date(0);\n  firstWeekOfNextYear.setUTCFullYear(year + 1, 0, firstWeekContainsDate);\n  firstWeekOfNextYear.setUTCHours(0, 0, 0, 0);\n  var startOfNextYear = startOfUTCWeek(firstWeekOfNextYear, dirtyOptions);\n  var firstWeekOfThisYear = new Date(0);\n  firstWeekOfThisYear.setUTCFullYear(year, 0, firstWeekContainsDate);\n  firstWeekOfThisYear.setUTCHours(0, 0, 0, 0);\n  var startOfThisYear = startOfUTCWeek(firstWeekOfThisYear, dirtyOptions);\n\n  if (date.getTime() >= startOfNextYear.getTime()) {\n    return year + 1;\n  } else if (date.getTime() >= startOfThisYear.getTime()) {\n    return year;\n  } else {\n    return year - 1;\n  }\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction startOfUTCWeekYear(dirtyDate, dirtyOptions) {\n  requiredArgs(1, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeFirstWeekContainsDate = locale && locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate);\n  var year = getUTCWeekYear(dirtyDate, dirtyOptions);\n  var firstWeek = new Date(0);\n  firstWeek.setUTCFullYear(year, 0, firstWeekContainsDate);\n  firstWeek.setUTCHours(0, 0, 0, 0);\n  var date = startOfUTCWeek(firstWeek, dirtyOptions);\n  return date;\n}\n\nvar MILLISECONDS_IN_WEEK = 604800000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nfunction getUTCWeek(dirtyDate, options) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var diff = startOfUTCWeek(date, options).getTime() - startOfUTCWeekYear(date, options).getTime(); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round(diff / MILLISECONDS_IN_WEEK) + 1;\n}\n\nfunction addLeadingZeros(number, targetLength) {\n  var sign = number < 0 ? '-' : '';\n  var output = Math.abs(number).toString();\n\n  while (output.length < targetLength) {\n    output = '0' + output;\n  }\n\n  return sign + output;\n}\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* |                                |\n * |  d  | Day of month                   |  D  |                                |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  m  | Minute                         |  M  | Month                          |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  y  | Year (abs)                     |  Y  |                                |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n */\n\n\nvar formatters$2 = {\n  // Year\n  y: function y(date, token) {\n    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_tokens\n    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |\n    // |----------|-------|----|-------|-------|-------|\n    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |\n    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |\n    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |\n    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |\n    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |\n    var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n    var year = signedYear > 0 ? signedYear : 1 - signedYear;\n    return addLeadingZeros(token === 'yy' ? year % 100 : year, token.length);\n  },\n  // Month\n  M: function M(date, token) {\n    var month = date.getUTCMonth();\n    return token === 'M' ? String(month + 1) : addLeadingZeros(month + 1, 2);\n  },\n  // Day of the month\n  d: function d(date, token) {\n    return addLeadingZeros(date.getUTCDate(), token.length);\n  },\n  // AM or PM\n  a: function a(date, token) {\n    var dayPeriodEnumValue = date.getUTCHours() / 12 >= 1 ? 'pm' : 'am';\n\n    switch (token) {\n      case 'a':\n      case 'aa':\n        return dayPeriodEnumValue.toUpperCase();\n\n      case 'aaa':\n        return dayPeriodEnumValue;\n\n      case 'aaaaa':\n        return dayPeriodEnumValue[0];\n\n      case 'aaaa':\n      default:\n        return dayPeriodEnumValue === 'am' ? 'a.m.' : 'p.m.';\n    }\n  },\n  // Hour [1-12]\n  h: function h(date, token) {\n    return addLeadingZeros(date.getUTCHours() % 12 || 12, token.length);\n  },\n  // Hour [0-23]\n  H: function H(date, token) {\n    return addLeadingZeros(date.getUTCHours(), token.length);\n  },\n  // Minute\n  m: function m(date, token) {\n    return addLeadingZeros(date.getUTCMinutes(), token.length);\n  },\n  // Second\n  s: function s(date, token) {\n    return addLeadingZeros(date.getUTCSeconds(), token.length);\n  },\n  // Fraction of second\n  S: function S(date, token) {\n    var numberOfDigits = token.length;\n    var milliseconds = date.getUTCMilliseconds();\n    var fractionalSeconds = Math.floor(milliseconds * Math.pow(10, numberOfDigits - 3));\n    return addLeadingZeros(fractionalSeconds, token.length);\n  }\n};\nvar formatters$3 = formatters$2;\nvar dayPeriodEnum = {\n  am: 'am',\n  pm: 'pm',\n  midnight: 'midnight',\n  noon: 'noon',\n  morning: 'morning',\n  afternoon: 'afternoon',\n  evening: 'evening',\n  night: 'night'\n};\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* | Milliseconds in day            |\n * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |\n * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |\n * |  d  | Day of month                   |  D  | Day of year                    |\n * |  e  | Local day of week              |  E  | Day of week                    |\n * |  f  |                                |  F* | Day of week in month           |\n * |  g* | Modified Julian day            |  G  | Era                            |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  i! | ISO day of week                |  I! | ISO week of year               |\n * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |\n * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |\n * |  l* | (deprecated)                   |  L  | Stand-alone month              |\n * |  m  | Minute                         |  M  | Month                          |\n * |  n  |                                |  N  |                                |\n * |  o! | Ordinal number modifier        |  O  | Timezone (GMT)                 |\n * |  p! | Long localized time            |  P! | Long localized date            |\n * |  q  | Stand-alone quarter            |  Q  | Quarter                        |\n * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |\n * |  u  | Extended year                  |  U* | Cyclic year                    |\n * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |\n * |  w  | Local week of year             |  W* | Week of month                  |\n * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |\n * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |\n * |  z  | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n *\n * Letters marked by ! are non-standard, but implemented by date-fns:\n * - `o` modifies the previous token to turn it into an ordinal (see `format` docs)\n * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,\n *   i.e. 7 for Sunday, 1 for Monday, etc.\n * - `I` is ISO week of year, as opposed to `w` which is local week of year.\n * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.\n *   `R` is supposed to be used in conjunction with `I` and `i`\n *   for universal ISO week-numbering date, whereas\n *   `Y` is supposed to be used in conjunction with `w` and `e`\n *   for week-numbering date specific to the locale.\n * - `P` is long localized date format\n * - `p` is long localized time format\n */\n\nvar formatters = {\n  // Era\n  G: function G(date, token, localize) {\n    var era = date.getUTCFullYear() > 0 ? 1 : 0;\n\n    switch (token) {\n      // AD, BC\n      case 'G':\n      case 'GG':\n      case 'GGG':\n        return localize.era(era, {\n          width: 'abbreviated'\n        });\n      // A, B\n\n      case 'GGGGG':\n        return localize.era(era, {\n          width: 'narrow'\n        });\n      // Anno Domini, Before Christ\n\n      case 'GGGG':\n      default:\n        return localize.era(era, {\n          width: 'wide'\n        });\n    }\n  },\n  // Year\n  y: function y(date, token, localize) {\n    // Ordinal number\n    if (token === 'yo') {\n      var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n      var year = signedYear > 0 ? signedYear : 1 - signedYear;\n      return localize.ordinalNumber(year, {\n        unit: 'year'\n      });\n    }\n\n    return formatters$3.y(date, token);\n  },\n  // Local week-numbering year\n  Y: function Y(date, token, localize, options) {\n    var signedWeekYear = getUTCWeekYear(date, options); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n    var weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear; // Two digit year\n\n    if (token === 'YY') {\n      var twoDigitYear = weekYear % 100;\n      return addLeadingZeros(twoDigitYear, 2);\n    } // Ordinal number\n\n\n    if (token === 'Yo') {\n      return localize.ordinalNumber(weekYear, {\n        unit: 'year'\n      });\n    } // Padding\n\n\n    return addLeadingZeros(weekYear, token.length);\n  },\n  // ISO week-numbering year\n  R: function R(date, token) {\n    var isoWeekYear = getUTCISOWeekYear(date); // Padding\n\n    return addLeadingZeros(isoWeekYear, token.length);\n  },\n  // Extended year. This is a single number designating the year of this calendar system.\n  // The main difference between `y` and `u` localizers are B.C. years:\n  // | Year | `y` | `u` |\n  // |------|-----|-----|\n  // | AC 1 |   1 |   1 |\n  // | BC 1 |   1 |   0 |\n  // | BC 2 |   2 |  -1 |\n  // Also `yy` always returns the last two digits of a year,\n  // while `uu` pads single digit years to 2 characters and returns other years unchanged.\n  u: function u(date, token) {\n    var year = date.getUTCFullYear();\n    return addLeadingZeros(year, token.length);\n  },\n  // Quarter\n  Q: function Q(date, token, localize) {\n    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);\n\n    switch (token) {\n      // 1, 2, 3, 4\n      case 'Q':\n        return String(quarter);\n      // 01, 02, 03, 04\n\n      case 'QQ':\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n\n      case 'Qo':\n        return localize.ordinalNumber(quarter, {\n          unit: 'quarter'\n        });\n      // Q1, Q2, Q3, Q4\n\n      case 'QQQ':\n        return localize.quarter(quarter, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n      case 'QQQQQ':\n        return localize.quarter(quarter, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // 1st quarter, 2nd quarter, ...\n\n      case 'QQQQ':\n      default:\n        return localize.quarter(quarter, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone quarter\n  q: function q(date, token, localize) {\n    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);\n\n    switch (token) {\n      // 1, 2, 3, 4\n      case 'q':\n        return String(quarter);\n      // 01, 02, 03, 04\n\n      case 'qq':\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n\n      case 'qo':\n        return localize.ordinalNumber(quarter, {\n          unit: 'quarter'\n        });\n      // Q1, Q2, Q3, Q4\n\n      case 'qqq':\n        return localize.quarter(quarter, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n      case 'qqqqq':\n        return localize.quarter(quarter, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // 1st quarter, 2nd quarter, ...\n\n      case 'qqqq':\n      default:\n        return localize.quarter(quarter, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // Month\n  M: function M(date, token, localize) {\n    var month = date.getUTCMonth();\n\n    switch (token) {\n      case 'M':\n      case 'MM':\n        return formatters$3.M(date, token);\n      // 1st, 2nd, ..., 12th\n\n      case 'Mo':\n        return localize.ordinalNumber(month + 1, {\n          unit: 'month'\n        });\n      // Jan, Feb, ..., Dec\n\n      case 'MMM':\n        return localize.month(month, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // J, F, ..., D\n\n      case 'MMMMM':\n        return localize.month(month, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // January, February, ..., December\n\n      case 'MMMM':\n      default:\n        return localize.month(month, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone month\n  L: function L(date, token, localize) {\n    var month = date.getUTCMonth();\n\n    switch (token) {\n      // 1, 2, ..., 12\n      case 'L':\n        return String(month + 1);\n      // 01, 02, ..., 12\n\n      case 'LL':\n        return addLeadingZeros(month + 1, 2);\n      // 1st, 2nd, ..., 12th\n\n      case 'Lo':\n        return localize.ordinalNumber(month + 1, {\n          unit: 'month'\n        });\n      // Jan, Feb, ..., Dec\n\n      case 'LLL':\n        return localize.month(month, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // J, F, ..., D\n\n      case 'LLLLL':\n        return localize.month(month, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // January, February, ..., December\n\n      case 'LLLL':\n      default:\n        return localize.month(month, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // Local week of year\n  w: function w(date, token, localize, options) {\n    var week = getUTCWeek(date, options);\n\n    if (token === 'wo') {\n      return localize.ordinalNumber(week, {\n        unit: 'week'\n      });\n    }\n\n    return addLeadingZeros(week, token.length);\n  },\n  // ISO week of year\n  I: function I(date, token, localize) {\n    var isoWeek = getUTCISOWeek(date);\n\n    if (token === 'Io') {\n      return localize.ordinalNumber(isoWeek, {\n        unit: 'week'\n      });\n    }\n\n    return addLeadingZeros(isoWeek, token.length);\n  },\n  // Day of the month\n  d: function d(date, token, localize) {\n    if (token === 'do') {\n      return localize.ordinalNumber(date.getUTCDate(), {\n        unit: 'date'\n      });\n    }\n\n    return formatters$3.d(date, token);\n  },\n  // Day of year\n  D: function D(date, token, localize) {\n    var dayOfYear = getUTCDayOfYear(date);\n\n    if (token === 'Do') {\n      return localize.ordinalNumber(dayOfYear, {\n        unit: 'dayOfYear'\n      });\n    }\n\n    return addLeadingZeros(dayOfYear, token.length);\n  },\n  // Day of week\n  E: function E(date, token, localize) {\n    var dayOfWeek = date.getUTCDay();\n\n    switch (token) {\n      // Tue\n      case 'E':\n      case 'EE':\n      case 'EEE':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'EEEEE':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'EEEEEE':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'EEEE':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Local day of week\n  e: function e(date, token, localize, options) {\n    var dayOfWeek = date.getUTCDay();\n    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n\n    switch (token) {\n      // Numerical value (Nth day of week with current locale or weekStartsOn)\n      case 'e':\n        return String(localDayOfWeek);\n      // Padded numerical value\n\n      case 'ee':\n        return addLeadingZeros(localDayOfWeek, 2);\n      // 1st, 2nd, ..., 7th\n\n      case 'eo':\n        return localize.ordinalNumber(localDayOfWeek, {\n          unit: 'day'\n        });\n\n      case 'eee':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'eeeee':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'eeeeee':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'eeee':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone local day of week\n  c: function c(date, token, localize, options) {\n    var dayOfWeek = date.getUTCDay();\n    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n\n    switch (token) {\n      // Numerical value (same as in `e`)\n      case 'c':\n        return String(localDayOfWeek);\n      // Padded numerical value\n\n      case 'cc':\n        return addLeadingZeros(localDayOfWeek, token.length);\n      // 1st, 2nd, ..., 7th\n\n      case 'co':\n        return localize.ordinalNumber(localDayOfWeek, {\n          unit: 'day'\n        });\n\n      case 'ccc':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // T\n\n      case 'ccccc':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // Tu\n\n      case 'cccccc':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'standalone'\n        });\n      // Tuesday\n\n      case 'cccc':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // ISO day of week\n  i: function i(date, token, localize) {\n    var dayOfWeek = date.getUTCDay();\n    var isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;\n\n    switch (token) {\n      // 2\n      case 'i':\n        return String(isoDayOfWeek);\n      // 02\n\n      case 'ii':\n        return addLeadingZeros(isoDayOfWeek, token.length);\n      // 2nd\n\n      case 'io':\n        return localize.ordinalNumber(isoDayOfWeek, {\n          unit: 'day'\n        });\n      // Tue\n\n      case 'iii':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'iiiii':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'iiiiii':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'iiii':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // AM or PM\n  a: function a(date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';\n\n    switch (token) {\n      case 'a':\n      case 'aa':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'aaa':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        }).toLowerCase();\n\n      case 'aaaaa':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'aaaa':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // AM, PM, midnight, noon\n  b: function b(date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue;\n\n    if (hours === 12) {\n      dayPeriodEnumValue = dayPeriodEnum.noon;\n    } else if (hours === 0) {\n      dayPeriodEnumValue = dayPeriodEnum.midnight;\n    } else {\n      dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';\n    }\n\n    switch (token) {\n      case 'b':\n      case 'bb':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'bbb':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        }).toLowerCase();\n\n      case 'bbbbb':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'bbbb':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // in the morning, in the afternoon, in the evening, at night\n  B: function B(date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue;\n\n    if (hours >= 17) {\n      dayPeriodEnumValue = dayPeriodEnum.evening;\n    } else if (hours >= 12) {\n      dayPeriodEnumValue = dayPeriodEnum.afternoon;\n    } else if (hours >= 4) {\n      dayPeriodEnumValue = dayPeriodEnum.morning;\n    } else {\n      dayPeriodEnumValue = dayPeriodEnum.night;\n    }\n\n    switch (token) {\n      case 'B':\n      case 'BB':\n      case 'BBB':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'BBBBB':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'BBBB':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Hour [1-12]\n  h: function h(date, token, localize) {\n    if (token === 'ho') {\n      var hours = date.getUTCHours() % 12;\n      if (hours === 0) hours = 12;\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return formatters$3.h(date, token);\n  },\n  // Hour [0-23]\n  H: function H(date, token, localize) {\n    if (token === 'Ho') {\n      return localize.ordinalNumber(date.getUTCHours(), {\n        unit: 'hour'\n      });\n    }\n\n    return formatters$3.H(date, token);\n  },\n  // Hour [0-11]\n  K: function K(date, token, localize) {\n    var hours = date.getUTCHours() % 12;\n\n    if (token === 'Ko') {\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n  // Hour [1-24]\n  k: function k(date, token, localize) {\n    var hours = date.getUTCHours();\n    if (hours === 0) hours = 24;\n\n    if (token === 'ko') {\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n  // Minute\n  m: function m(date, token, localize) {\n    if (token === 'mo') {\n      return localize.ordinalNumber(date.getUTCMinutes(), {\n        unit: 'minute'\n      });\n    }\n\n    return formatters$3.m(date, token);\n  },\n  // Second\n  s: function s(date, token, localize) {\n    if (token === 'so') {\n      return localize.ordinalNumber(date.getUTCSeconds(), {\n        unit: 'second'\n      });\n    }\n\n    return formatters$3.s(date, token);\n  },\n  // Fraction of second\n  S: function S(date, token) {\n    return formatters$3.S(date, token);\n  },\n  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)\n  X: function X(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    if (timezoneOffset === 0) {\n      return 'Z';\n    }\n\n    switch (token) {\n      // Hours and optional minutes\n      case 'X':\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XX`\n\n      case 'XXXX':\n      case 'XX':\n        // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XXX`\n\n      case 'XXXXX':\n      case 'XXX': // Hours and minutes with `:` delimiter\n\n      default:\n        return formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)\n  x: function x(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Hours and optional minutes\n      case 'x':\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xx`\n\n      case 'xxxx':\n      case 'xx':\n        // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xxx`\n\n      case 'xxxxx':\n      case 'xxx': // Hours and minutes with `:` delimiter\n\n      default:\n        return formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (GMT)\n  O: function O(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case 'O':\n      case 'OO':\n      case 'OOO':\n        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');\n      // Long\n\n      case 'OOOO':\n      default:\n        return 'GMT' + formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (specific non-location)\n  z: function z(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case 'z':\n      case 'zz':\n      case 'zzz':\n        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');\n      // Long\n\n      case 'zzzz':\n      default:\n        return 'GMT' + formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Seconds timestamp\n  t: function t(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timestamp = Math.floor(originalDate.getTime() / 1000);\n    return addLeadingZeros(timestamp, token.length);\n  },\n  // Milliseconds timestamp\n  T: function T(date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timestamp = originalDate.getTime();\n    return addLeadingZeros(timestamp, token.length);\n  }\n};\n\nfunction formatTimezoneShort(offset, dirtyDelimiter) {\n  var sign = offset > 0 ? '-' : '+';\n  var absOffset = Math.abs(offset);\n  var hours = Math.floor(absOffset / 60);\n  var minutes = absOffset % 60;\n\n  if (minutes === 0) {\n    return sign + String(hours);\n  }\n\n  var delimiter = dirtyDelimiter || '';\n  return sign + String(hours) + delimiter + addLeadingZeros(minutes, 2);\n}\n\nfunction formatTimezoneWithOptionalMinutes(offset, dirtyDelimiter) {\n  if (offset % 60 === 0) {\n    var sign = offset > 0 ? '-' : '+';\n    return sign + addLeadingZeros(Math.abs(offset) / 60, 2);\n  }\n\n  return formatTimezone(offset, dirtyDelimiter);\n}\n\nfunction formatTimezone(offset, dirtyDelimiter) {\n  var delimiter = dirtyDelimiter || '';\n  var sign = offset > 0 ? '-' : '+';\n  var absOffset = Math.abs(offset);\n  var hours = addLeadingZeros(Math.floor(absOffset / 60), 2);\n  var minutes = addLeadingZeros(absOffset % 60, 2);\n  return sign + hours + delimiter + minutes;\n}\n\nvar formatters$1 = formatters;\n\nfunction dateLongFormatter(pattern, formatLong) {\n  switch (pattern) {\n    case 'P':\n      return formatLong.date({\n        width: 'short'\n      });\n\n    case 'PP':\n      return formatLong.date({\n        width: 'medium'\n      });\n\n    case 'PPP':\n      return formatLong.date({\n        width: 'long'\n      });\n\n    case 'PPPP':\n    default:\n      return formatLong.date({\n        width: 'full'\n      });\n  }\n}\n\nfunction timeLongFormatter(pattern, formatLong) {\n  switch (pattern) {\n    case 'p':\n      return formatLong.time({\n        width: 'short'\n      });\n\n    case 'pp':\n      return formatLong.time({\n        width: 'medium'\n      });\n\n    case 'ppp':\n      return formatLong.time({\n        width: 'long'\n      });\n\n    case 'pppp':\n    default:\n      return formatLong.time({\n        width: 'full'\n      });\n  }\n}\n\nfunction dateTimeLongFormatter(pattern, formatLong) {\n  var matchResult = pattern.match(/(P+)(p+)?/) || [];\n  var datePattern = matchResult[1];\n  var timePattern = matchResult[2];\n\n  if (!timePattern) {\n    return dateLongFormatter(pattern, formatLong);\n  }\n\n  var dateTimeFormat;\n\n  switch (datePattern) {\n    case 'P':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'short'\n      });\n      break;\n\n    case 'PP':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'medium'\n      });\n      break;\n\n    case 'PPP':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'long'\n      });\n      break;\n\n    case 'PPPP':\n    default:\n      dateTimeFormat = formatLong.dateTime({\n        width: 'full'\n      });\n      break;\n  }\n\n  return dateTimeFormat.replace('{{date}}', dateLongFormatter(datePattern, formatLong)).replace('{{time}}', timeLongFormatter(timePattern, formatLong));\n}\n\nvar longFormatters = {\n  p: timeLongFormatter,\n  P: dateTimeLongFormatter\n};\nvar longFormatters$1 = longFormatters;\nvar protectedDayOfYearTokens = ['D', 'DD'];\nvar protectedWeekYearTokens = ['YY', 'YYYY'];\n\nfunction isProtectedDayOfYearToken(token) {\n  return protectedDayOfYearTokens.indexOf(token) !== -1;\n}\n\nfunction isProtectedWeekYearToken(token) {\n  return protectedWeekYearTokens.indexOf(token) !== -1;\n}\n\nfunction throwProtectedError(token, format, input) {\n  if (token === 'YYYY') {\n    throw new RangeError(\"Use `yyyy` instead of `YYYY` (in `\".concat(format, \"`) for formatting years to the input `\").concat(input, \"`; see: https://git.io/fxCyr\"));\n  } else if (token === 'YY') {\n    throw new RangeError(\"Use `yy` instead of `YY` (in `\".concat(format, \"`) for formatting years to the input `\").concat(input, \"`; see: https://git.io/fxCyr\"));\n  } else if (token === 'D') {\n    throw new RangeError(\"Use `d` instead of `D` (in `\".concat(format, \"`) for formatting days of the month to the input `\").concat(input, \"`; see: https://git.io/fxCyr\"));\n  } else if (token === 'DD') {\n    throw new RangeError(\"Use `dd` instead of `DD` (in `\".concat(format, \"`) for formatting days of the month to the input `\").concat(input, \"`; see: https://git.io/fxCyr\"));\n  }\n} // - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token\n//   (one of the certain letters followed by `o`)\n// - (\\w)\\1* matches any sequences of the same letter\n// - '' matches two quote characters in a row\n// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),\n//   except a single quote symbol, which ends the sequence.\n//   Two quote characters do not end the sequence.\n//   If there is no matching single quote\n//   then the sequence will continue until the end of the string.\n// - . matches any single character unmatched by previous parts of the RegExps\n\n\nvar formattingTokensRegExp$1 = /[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also\n// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`\n\nvar longFormattingTokensRegExp$1 = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;\nvar escapedStringRegExp$1 = /^'([^]*?)'?$/;\nvar doubleQuoteRegExp$1 = /''/g;\nvar unescapedLatinCharacterRegExp$1 = /[a-zA-Z]/;\n/**\n * @name format\n * @category Common Helpers\n * @summary Format the date.\n *\n * @description\n * Return the formatted date string in the given format. The result may vary by locale.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://git.io/fxCyr\n *\n * The characters wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n * (see the last example)\n *\n * Format of the string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 7 below the table).\n *\n * Accepted patterns:\n * | Unit                            | Pattern | Result examples                   | Notes |\n * |---------------------------------|---------|-----------------------------------|-------|\n * | Era                             | G..GGG  | AD, BC                            |       |\n * |                                 | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 | GGGGG   | A, B                              |       |\n * | Calendar year                   | y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | yo      | 44th, 1st, 0th, 17th              | 5,7   |\n * |                                 | yy      | 44, 01, 00, 17                    | 5     |\n * |                                 | yyy     | 044, 001, 1900, 2017              | 5     |\n * |                                 | yyyy    | 0044, 0001, 1900, 2017            | 5     |\n * |                                 | yyyyy   | ...                               | 3,5   |\n * | Local week-numbering year       | Y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | Yo      | 44th, 1st, 1900th, 2017th         | 5,7   |\n * |                                 | YY      | 44, 01, 00, 17                    | 5,8   |\n * |                                 | YYY     | 044, 001, 1900, 2017              | 5     |\n * |                                 | YYYY    | 0044, 0001, 1900, 2017            | 5,8   |\n * |                                 | YYYYY   | ...                               | 3,5   |\n * | ISO week-numbering year         | R       | -43, 0, 1, 1900, 2017             | 5,7   |\n * |                                 | RR      | -43, 00, 01, 1900, 2017           | 5,7   |\n * |                                 | RRR     | -043, 000, 001, 1900, 2017        | 5,7   |\n * |                                 | RRRR    | -0043, 0000, 0001, 1900, 2017     | 5,7   |\n * |                                 | RRRRR   | ...                               | 3,5,7 |\n * | Extended year                   | u       | -43, 0, 1, 1900, 2017             | 5     |\n * |                                 | uu      | -43, 01, 1900, 2017               | 5     |\n * |                                 | uuu     | -043, 001, 1900, 2017             | 5     |\n * |                                 | uuuu    | -0043, 0001, 1900, 2017           | 5     |\n * |                                 | uuuuu   | ...                               | 3,5   |\n * | Quarter (formatting)            | Q       | 1, 2, 3, 4                        |       |\n * |                                 | Qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | QQ      | 01, 02, 03, 04                    |       |\n * |                                 | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | q       | 1, 2, 3, 4                        |       |\n * |                                 | qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | qq      | 01, 02, 03, 04                    |       |\n * |                                 | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | qqqqq   | 1, 2, 3, 4                        | 4     |\n * | Month (formatting)              | M       | 1, 2, ..., 12                     |       |\n * |                                 | Mo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | MM      | 01, 02, ..., 12                   |       |\n * |                                 | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 | MMMM    | January, February, ..., December  | 2     |\n * |                                 | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | L       | 1, 2, ..., 12                     |       |\n * |                                 | Lo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | LL      | 01, 02, ..., 12                   |       |\n * |                                 | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 | LLLL    | January, February, ..., December  | 2     |\n * |                                 | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | w       | 1, 2, ..., 53                     |       |\n * |                                 | wo      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | I       | 1, 2, ..., 53                     | 7     |\n * |                                 | Io      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | II      | 01, 02, ..., 53                   | 7     |\n * | Day of month                    | d       | 1, 2, ..., 31                     |       |\n * |                                 | do      | 1st, 2nd, ..., 31st               | 7     |\n * |                                 | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     | D       | 1, 2, ..., 365, 366               | 9     |\n * |                                 | Do      | 1st, 2nd, ..., 365th, 366th       | 7     |\n * |                                 | DD      | 01, 02, ..., 365, 366             | 9     |\n * |                                 | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 | DDDD    | ...                               | 3     |\n * | Day of week (formatting)        | E..EEE  | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | ISO day of week (formatting)    | i       | 1, 2, 3, ..., 7                   | 7     |\n * |                                 | io      | 1st, 2nd, ..., 7th                | 7     |\n * |                                 | ii      | 01, 02, ..., 07                   | 7     |\n * |                                 | iii     | Mon, Tue, Wed, ..., Sun           | 7     |\n * |                                 | iiii    | Monday, Tuesday, ..., Sunday      | 2,7   |\n * |                                 | iiiii   | M, T, W, T, F, S, S               | 7     |\n * |                                 | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 7     |\n * | Local day of week (formatting)  | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 | eo      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | ee      | 02, 03, ..., 01                   |       |\n * |                                 | eee     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | Local day of week (stand-alone) | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 | co      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | cc      | 02, 03, ..., 01                   |       |\n * |                                 | ccc     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | AM, PM                          | a..aa   | AM, PM                            |       |\n * |                                 | aaa     | am, pm                            |       |\n * |                                 | aaaa    | a.m., p.m.                        | 2     |\n * |                                 | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          | b..bb   | AM, PM, noon, midnight            |       |\n * |                                 | bbb     | am, pm, noon, midnight            |       |\n * |                                 | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             | B..BBB  | at night, in the morning, ...     |       |\n * |                                 | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 | ho      | 1st, 2nd, ..., 11th, 12th         | 7     |\n * |                                 | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 | Ho      | 0th, 1st, 2nd, ..., 23rd          | 7     |\n * |                                 | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 | Ko      | 1st, 2nd, ..., 11th, 0th          | 7     |\n * |                                 | KK      | 01, 02, ..., 11, 00               |       |\n * | Hour [1-24]                     | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 | ko      | 24th, 1st, 2nd, ..., 23rd         | 7     |\n * |                                 | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          | m       | 0, 1, ..., 59                     |       |\n * |                                 | mo      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | mm      | 00, 01, ..., 59                   |       |\n * | Second                          | s       | 0, 1, ..., 59                     |       |\n * |                                 | so      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | ss      | 00, 01, ..., 59                   |       |\n * | Fraction of second              | S       | 0, 1, ..., 9                      |       |\n * |                                 | SS      | 00, 01, ..., 99                   |       |\n * |                                 | SSS     | 000, 001, ..., 999                |       |\n * |                                 | SSSS    | ...                               | 3     |\n * | Timezone (ISO-8601 w/ Z)        | X       | -08, +0530, Z                     |       |\n * |                                 | XX      | -0800, +0530, Z                   |       |\n * |                                 | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       | x       | -08, +0530, +00                   |       |\n * |                                 | xx      | -0800, +0530, +0000               |       |\n * |                                 | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Timezone (GMT)                  | O...OOO | GMT-8, GMT+5:30, GMT+0            |       |\n * |                                 | OOOO    | GMT-08:00, GMT+05:30, GMT+00:00   | 2     |\n * | Timezone (specific non-locat.)  | z...zzz | GMT-8, GMT+5:30, GMT+0            | 6     |\n * |                                 | zzzz    | GMT-08:00, GMT+05:30, GMT+00:00   | 2,6   |\n * | Seconds timestamp               | t       | 512969520                         | 7     |\n * |                                 | tt      | ...                               | 3,7   |\n * | Milliseconds timestamp          | T       | 512969520900                      | 7     |\n * |                                 | TT      | ...                               | 3,7   |\n * | Long localized date             | P       | 04/29/1453                        | 7     |\n * |                                 | PP      | Apr 29, 1453                      | 7     |\n * |                                 | PPP     | April 29th, 1453                  | 7     |\n * |                                 | PPPP    | Friday, April 29th, 1453          | 2,7   |\n * | Long localized time             | p       | 12:00 AM                          | 7     |\n * |                                 | pp      | 12:00:00 AM                       | 7     |\n * |                                 | ppp     | 12:00:00 AM GMT+2                 | 7     |\n * |                                 | pppp    | 12:00:00 AM GMT+02:00             | 2,7   |\n * | Combination of date and time    | Pp      | 04/29/1453, 12:00 AM              | 7     |\n * |                                 | PPpp    | Apr 29, 1453, 12:00:00 AM         | 7     |\n * |                                 | PPPppp  | April 29th, 1453 at ...           | 7     |\n * |                                 | PPPPpppp| Friday, April 29th, 1453 at ...   | 2,7   |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table (e.g. `EEEEEEEEEEE`)\n *    the output will be the same as default pattern for this unit, usually\n *    the longest one (in case of ISO weekdays, `EEEE`). Default patterns for units\n *    are marked with \"2\" in the last column of the table.\n *\n *    `format(new Date(2017, 10, 6), 'MMM') //=> 'Nov'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMM') //=> 'N'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMMM') //=> 'November'`\n *\n * 3. Some patterns could be unlimited length (such as `yyyyyyyy`).\n *    The output will be padded with zeros to match the length of the pattern.\n *\n *    `format(new Date(2017, 10, 6), 'yyyyyyyy') //=> '00002017'`\n *\n * 4. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 5. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` always returns the last two digits of a year,\n *    while `uu` pads single digit years to 2 characters and returns other years unchanged:\n *\n *    | Year | `yy` | `uu` |\n *    |------|------|------|\n *    | 1    |   01 |   01 |\n *    | 14   |   14 |   14 |\n *    | 376  |   76 |  376 |\n *    | 1453 |   53 | 1453 |\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [getISOWeekYear]{@link https://date-fns.org/docs/getISOWeekYear}\n *    and [getWeekYear]{@link https://date-fns.org/docs/getWeekYear}).\n *\n * 6. Specific non-location timezones are currently unavailable in `date-fns`,\n *    so right now these tokens fall back to GMT timezones.\n *\n * 7. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `t`: seconds timestamp\n *    - `T`: milliseconds timestamp\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 8. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 9. `D` and `DD` tokens represent days of the year but they are often confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://git.io/fxCyr\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - The second argument is now required for the sake of explicitness.\n *\n *   ```javascript\n *   // Before v2.0.0\n *   format(new Date(2016, 0, 1))\n *\n *   // v2.0.0 onward\n *   format(new Date(2016, 0, 1), \"yyyy-MM-dd'T'HH:mm:ss.SSSxxx\")\n *   ```\n *\n * - New format string API for `format` function\n *   which is based on [Unicode Technical Standard #35](https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table).\n *   See [this post](https://blog.date-fns.org/post/unicode-tokens-in-date-fns-v2-sreatyki91jg) for more details.\n *\n * - Characters are now escaped using single quote symbols (`'`) instead of square brackets.\n *\n * @param {Date|Number} date - the original date\n * @param {String} format - the string of tokens\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @param {Number} [options.firstWeekContainsDate=1] - the day of January, which is\n * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;\n *   see: https://git.io/fxCyr\n * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;\n *   see: https://git.io/fxCyr\n * @returns {String} the formatted date string\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `date` must not be Invalid Date\n * @throws {RangeError} `options.locale` must contain `localize` property\n * @throws {RangeError} `options.locale` must contain `formatLong` property\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7\n * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `yy` instead of `YY` for formatting years using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `d` instead of `D` for formatting days of the month using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} format string contains an unescaped latin alphabet character\n *\n * @example\n * // Represent 11 February 2014 in middle-endian format:\n * var result = format(new Date(2014, 1, 11), 'MM/dd/yyyy')\n * //=> '02/11/2014'\n *\n * @example\n * // Represent 2 July 2014 in Esperanto:\n * import { eoLocale } from 'date-fns/locale/eo'\n * var result = format(new Date(2014, 6, 2), \"do 'de' MMMM yyyy\", {\n *   locale: eoLocale\n * })\n * //=> '2-a de julio 2014'\n *\n * @example\n * // Escape string by single quote characters:\n * var result = format(new Date(2014, 6, 2, 15), \"h 'o''clock'\")\n * //=> \"3 o'clock\"\n */\n\nfunction format$1(dirtyDate, dirtyFormatStr, dirtyOptions) {\n  requiredArgs(2, arguments);\n  var formatStr = String(dirtyFormatStr);\n  var options = dirtyOptions || {};\n  var locale = options.locale || defaultLocale;\n  var localeFirstWeekContainsDate = locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var localeWeekStartsOn = locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  if (!locale.localize) {\n    throw new RangeError('locale must contain localize property');\n  }\n\n  if (!locale.formatLong) {\n    throw new RangeError('locale must contain formatLong property');\n  }\n\n  var originalDate = toDate(dirtyDate);\n\n  if (!isValid$2(originalDate)) {\n    throw new RangeError('Invalid time value');\n  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.\n  // This ensures that when UTC functions will be implemented, locales will be compatible with them.\n  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/376\n\n\n  var timezoneOffset = getTimezoneOffsetInMilliseconds(originalDate);\n  var utcDate = subMilliseconds(originalDate, timezoneOffset);\n  var formatterOptions = {\n    firstWeekContainsDate: firstWeekContainsDate,\n    weekStartsOn: weekStartsOn,\n    locale: locale,\n    _originalDate: originalDate\n  };\n  var result = formatStr.match(longFormattingTokensRegExp$1).map(function (substring) {\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === 'p' || firstCharacter === 'P') {\n      var longFormatter = longFormatters$1[firstCharacter];\n      return longFormatter(substring, locale.formatLong, formatterOptions);\n    }\n\n    return substring;\n  }).join('').match(formattingTokensRegExp$1).map(function (substring) {\n    // Replace two single quote characters with one single quote character\n    if (substring === \"''\") {\n      return \"'\";\n    }\n\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === \"'\") {\n      return cleanEscapedString$1(substring);\n    }\n\n    var formatter = formatters$1[firstCharacter];\n\n    if (formatter) {\n      if (!options.useAdditionalWeekYearTokens && isProtectedWeekYearToken(substring)) {\n        throwProtectedError(substring, dirtyFormatStr, dirtyDate);\n      }\n\n      if (!options.useAdditionalDayOfYearTokens && isProtectedDayOfYearToken(substring)) {\n        throwProtectedError(substring, dirtyFormatStr, dirtyDate);\n      }\n\n      return formatter(utcDate, substring, locale.localize, formatterOptions);\n    }\n\n    if (firstCharacter.match(unescapedLatinCharacterRegExp$1)) {\n      throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');\n    }\n\n    return substring;\n  }).join('');\n  return result;\n}\n\nfunction cleanEscapedString$1(input) {\n  return input.match(escapedStringRegExp$1)[1].replace(doubleQuoteRegExp$1, \"'\");\n}\n\nfunction assign(target, dirtyObject) {\n  if (target == null) {\n    throw new TypeError('assign requires that input parameter not be null or undefined');\n  }\n\n  dirtyObject = dirtyObject || {};\n\n  for (var property in dirtyObject) {\n    if (Object.prototype.hasOwnProperty.call(dirtyObject, property)) {\n      target[property] = dirtyObject[property];\n    }\n  }\n\n  return target;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction setUTCDay(dirtyDate, dirtyDay, dirtyOptions) {\n  requiredArgs(2, arguments);\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = toInteger(dirtyDay);\n  var currentDay = date.getUTCDay();\n  var remainder = day % 7;\n  var dayIndex = (remainder + 7) % 7;\n  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;\n  date.setUTCDate(date.getUTCDate() + diff);\n  return date;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction setUTCISODay(dirtyDate, dirtyDay) {\n  requiredArgs(2, arguments);\n  var day = toInteger(dirtyDay);\n\n  if (day % 7 === 0) {\n    day = day - 7;\n  }\n\n  var weekStartsOn = 1;\n  var date = toDate(dirtyDate);\n  var currentDay = date.getUTCDay();\n  var remainder = day % 7;\n  var dayIndex = (remainder + 7) % 7;\n  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;\n  date.setUTCDate(date.getUTCDate() + diff);\n  return date;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction setUTCISOWeek(dirtyDate, dirtyISOWeek) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var isoWeek = toInteger(dirtyISOWeek);\n  var diff = getUTCISOWeek(date) - isoWeek;\n  date.setUTCDate(date.getUTCDate() - diff * 7);\n  return date;\n} // See issue: https://github.com/date-fns/date-fns/issues/376\n\n\nfunction setUTCWeek(dirtyDate, dirtyWeek, options) {\n  requiredArgs(2, arguments);\n  var date = toDate(dirtyDate);\n  var week = toInteger(dirtyWeek);\n  var diff = getUTCWeek(date, options) - week;\n  date.setUTCDate(date.getUTCDate() - diff * 7);\n  return date;\n}\n\nvar MILLISECONDS_IN_HOUR = 3600000;\nvar MILLISECONDS_IN_MINUTE = 60000;\nvar MILLISECONDS_IN_SECOND = 1000;\nvar numericPatterns = {\n  month: /^(1[0-2]|0?\\d)/,\n  // 0 to 12\n  date: /^(3[0-1]|[0-2]?\\d)/,\n  // 0 to 31\n  dayOfYear: /^(36[0-6]|3[0-5]\\d|[0-2]?\\d?\\d)/,\n  // 0 to 366\n  week: /^(5[0-3]|[0-4]?\\d)/,\n  // 0 to 53\n  hour23h: /^(2[0-3]|[0-1]?\\d)/,\n  // 0 to 23\n  hour24h: /^(2[0-4]|[0-1]?\\d)/,\n  // 0 to 24\n  hour11h: /^(1[0-1]|0?\\d)/,\n  // 0 to 11\n  hour12h: /^(1[0-2]|0?\\d)/,\n  // 0 to 12\n  minute: /^[0-5]?\\d/,\n  // 0 to 59\n  second: /^[0-5]?\\d/,\n  // 0 to 59\n  singleDigit: /^\\d/,\n  // 0 to 9\n  twoDigits: /^\\d{1,2}/,\n  // 0 to 99\n  threeDigits: /^\\d{1,3}/,\n  // 0 to 999\n  fourDigits: /^\\d{1,4}/,\n  // 0 to 9999\n  anyDigitsSigned: /^-?\\d+/,\n  singleDigitSigned: /^-?\\d/,\n  // 0 to 9, -0 to -9\n  twoDigitsSigned: /^-?\\d{1,2}/,\n  // 0 to 99, -0 to -99\n  threeDigitsSigned: /^-?\\d{1,3}/,\n  // 0 to 999, -0 to -999\n  fourDigitsSigned: /^-?\\d{1,4}/ // 0 to 9999, -0 to -9999\n\n};\nvar timezonePatterns = {\n  basicOptionalMinutes: /^([+-])(\\d{2})(\\d{2})?|Z/,\n  basic: /^([+-])(\\d{2})(\\d{2})|Z/,\n  basicOptionalSeconds: /^([+-])(\\d{2})(\\d{2})((\\d{2}))?|Z/,\n  extended: /^([+-])(\\d{2}):(\\d{2})|Z/,\n  extendedOptionalSeconds: /^([+-])(\\d{2}):(\\d{2})(:(\\d{2}))?|Z/\n};\n\nfunction parseNumericPattern(pattern, string, valueCallback) {\n  var matchResult = string.match(pattern);\n\n  if (!matchResult) {\n    return null;\n  }\n\n  var value = parseInt(matchResult[0], 10);\n  return {\n    value: valueCallback ? valueCallback(value) : value,\n    rest: string.slice(matchResult[0].length)\n  };\n}\n\nfunction parseTimezonePattern(pattern, string) {\n  var matchResult = string.match(pattern);\n\n  if (!matchResult) {\n    return null;\n  } // Input is 'Z'\n\n\n  if (matchResult[0] === 'Z') {\n    return {\n      value: 0,\n      rest: string.slice(1)\n    };\n  }\n\n  var sign = matchResult[1] === '+' ? 1 : -1;\n  var hours = matchResult[2] ? parseInt(matchResult[2], 10) : 0;\n  var minutes = matchResult[3] ? parseInt(matchResult[3], 10) : 0;\n  var seconds = matchResult[5] ? parseInt(matchResult[5], 10) : 0;\n  return {\n    value: sign * (hours * MILLISECONDS_IN_HOUR + minutes * MILLISECONDS_IN_MINUTE + seconds * MILLISECONDS_IN_SECOND),\n    rest: string.slice(matchResult[0].length)\n  };\n}\n\nfunction parseAnyDigitsSigned(string, valueCallback) {\n  return parseNumericPattern(numericPatterns.anyDigitsSigned, string, valueCallback);\n}\n\nfunction parseNDigits(n, string, valueCallback) {\n  switch (n) {\n    case 1:\n      return parseNumericPattern(numericPatterns.singleDigit, string, valueCallback);\n\n    case 2:\n      return parseNumericPattern(numericPatterns.twoDigits, string, valueCallback);\n\n    case 3:\n      return parseNumericPattern(numericPatterns.threeDigits, string, valueCallback);\n\n    case 4:\n      return parseNumericPattern(numericPatterns.fourDigits, string, valueCallback);\n\n    default:\n      return parseNumericPattern(new RegExp('^\\\\d{1,' + n + '}'), string, valueCallback);\n  }\n}\n\nfunction parseNDigitsSigned(n, string, valueCallback) {\n  switch (n) {\n    case 1:\n      return parseNumericPattern(numericPatterns.singleDigitSigned, string, valueCallback);\n\n    case 2:\n      return parseNumericPattern(numericPatterns.twoDigitsSigned, string, valueCallback);\n\n    case 3:\n      return parseNumericPattern(numericPatterns.threeDigitsSigned, string, valueCallback);\n\n    case 4:\n      return parseNumericPattern(numericPatterns.fourDigitsSigned, string, valueCallback);\n\n    default:\n      return parseNumericPattern(new RegExp('^-?\\\\d{1,' + n + '}'), string, valueCallback);\n  }\n}\n\nfunction dayPeriodEnumToHours(enumValue) {\n  switch (enumValue) {\n    case 'morning':\n      return 4;\n\n    case 'evening':\n      return 17;\n\n    case 'pm':\n    case 'noon':\n    case 'afternoon':\n      return 12;\n\n    case 'am':\n    case 'midnight':\n    case 'night':\n    default:\n      return 0;\n  }\n}\n\nfunction normalizeTwoDigitYear(twoDigitYear, currentYear) {\n  var isCommonEra = currentYear > 0; // Absolute number of the current year:\n  // 1 -> 1 AC\n  // 0 -> 1 BC\n  // -1 -> 2 BC\n\n  var absCurrentYear = isCommonEra ? currentYear : 1 - currentYear;\n  var result;\n\n  if (absCurrentYear <= 50) {\n    result = twoDigitYear || 100;\n  } else {\n    var rangeEnd = absCurrentYear + 50;\n    var rangeEndCentury = Math.floor(rangeEnd / 100) * 100;\n    var isPreviousCentury = twoDigitYear >= rangeEnd % 100;\n    result = twoDigitYear + rangeEndCentury - (isPreviousCentury ? 100 : 0);\n  }\n\n  return isCommonEra ? result : 1 - result;\n}\n\nvar DAYS_IN_MONTH = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\nvar DAYS_IN_MONTH_LEAP_YEAR = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; // User for validation\n\nfunction isLeapYearIndex(year) {\n  return year % 400 === 0 || year % 4 === 0 && year % 100 !== 0;\n}\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* | Milliseconds in day            |\n * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |\n * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |\n * |  d  | Day of month                   |  D  | Day of year                    |\n * |  e  | Local day of week              |  E  | Day of week                    |\n * |  f  |                                |  F* | Day of week in month           |\n * |  g* | Modified Julian day            |  G  | Era                            |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  i! | ISO day of week                |  I! | ISO week of year               |\n * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |\n * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |\n * |  l* | (deprecated)                   |  L  | Stand-alone month              |\n * |  m  | Minute                         |  M  | Month                          |\n * |  n  |                                |  N  |                                |\n * |  o! | Ordinal number modifier        |  O* | Timezone (GMT)                 |\n * |  p  |                                |  P  |                                |\n * |  q  | Stand-alone quarter            |  Q  | Quarter                        |\n * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |\n * |  u  | Extended year                  |  U* | Cyclic year                    |\n * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |\n * |  w  | Local week of year             |  W* | Week of month                  |\n * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |\n * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |\n * |  z* | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n *\n * Letters marked by ! are non-standard, but implemented by date-fns:\n * - `o` modifies the previous token to turn it into an ordinal (see `parse` docs)\n * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,\n *   i.e. 7 for Sunday, 1 for Monday, etc.\n * - `I` is ISO week of year, as opposed to `w` which is local week of year.\n * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.\n *   `R` is supposed to be used in conjunction with `I` and `i`\n *   for universal ISO week-numbering date, whereas\n *   `Y` is supposed to be used in conjunction with `w` and `e`\n *   for week-numbering date specific to the locale.\n */\n\n\nvar parsers = {\n  // Era\n  G: {\n    priority: 140,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        // AD, BC\n        case 'G':\n        case 'GG':\n        case 'GGG':\n          return match.era(string, {\n            width: 'abbreviated'\n          }) || match.era(string, {\n            width: 'narrow'\n          });\n        // A, B\n\n        case 'GGGGG':\n          return match.era(string, {\n            width: 'narrow'\n          });\n        // Anno Domini, Before Christ\n\n        case 'GGGG':\n        default:\n          return match.era(string, {\n            width: 'wide'\n          }) || match.era(string, {\n            width: 'abbreviated'\n          }) || match.era(string, {\n            width: 'narrow'\n          });\n      }\n    },\n    set: function set(date, flags, value, _options) {\n      flags.era = value;\n      date.setUTCFullYear(value, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['R', 'u', 't', 'T']\n  },\n  // Year\n  y: {\n    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_Patterns\n    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |\n    // |----------|-------|----|-------|-------|-------|\n    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |\n    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |\n    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |\n    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |\n    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |\n    priority: 130,\n    parse: function parse(string, token, match, _options) {\n      var valueCallback = function valueCallback(year) {\n        return {\n          year: year,\n          isTwoDigitYear: token === 'yy'\n        };\n      };\n\n      switch (token) {\n        case 'y':\n          return parseNDigits(4, string, valueCallback);\n\n        case 'yo':\n          return match.ordinalNumber(string, {\n            unit: 'year',\n            valueCallback: valueCallback\n          });\n\n        default:\n          return parseNDigits(token.length, string, valueCallback);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value.isTwoDigitYear || value.year > 0;\n    },\n    set: function set(date, flags, value, _options) {\n      var currentYear = date.getUTCFullYear();\n\n      if (value.isTwoDigitYear) {\n        var normalizedTwoDigitYear = normalizeTwoDigitYear(value.year, currentYear);\n        date.setUTCFullYear(normalizedTwoDigitYear, 0, 1);\n        date.setUTCHours(0, 0, 0, 0);\n        return date;\n      }\n\n      var year = !('era' in flags) || flags.era === 1 ? value.year : 1 - value.year;\n      date.setUTCFullYear(year, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'u', 'w', 'I', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local week-numbering year\n  Y: {\n    priority: 130,\n    parse: function parse(string, token, match, _options) {\n      var valueCallback = function valueCallback(year) {\n        return {\n          year: year,\n          isTwoDigitYear: token === 'YY'\n        };\n      };\n\n      switch (token) {\n        case 'Y':\n          return parseNDigits(4, string, valueCallback);\n\n        case 'Yo':\n          return match.ordinalNumber(string, {\n            unit: 'year',\n            valueCallback: valueCallback\n          });\n\n        default:\n          return parseNDigits(token.length, string, valueCallback);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value.isTwoDigitYear || value.year > 0;\n    },\n    set: function set(date, flags, value, options) {\n      var currentYear = getUTCWeekYear(date, options);\n\n      if (value.isTwoDigitYear) {\n        var normalizedTwoDigitYear = normalizeTwoDigitYear(value.year, currentYear);\n        date.setUTCFullYear(normalizedTwoDigitYear, 0, options.firstWeekContainsDate);\n        date.setUTCHours(0, 0, 0, 0);\n        return startOfUTCWeek(date, options);\n      }\n\n      var year = !('era' in flags) || flags.era === 1 ? value.year : 1 - value.year;\n      date.setUTCFullYear(year, 0, options.firstWeekContainsDate);\n      date.setUTCHours(0, 0, 0, 0);\n      return startOfUTCWeek(date, options);\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'Q', 'q', 'M', 'L', 'I', 'd', 'D', 'i', 't', 'T']\n  },\n  // ISO week-numbering year\n  R: {\n    priority: 130,\n    parse: function parse(string, token, _match, _options) {\n      if (token === 'R') {\n        return parseNDigitsSigned(4, string);\n      }\n\n      return parseNDigitsSigned(token.length, string);\n    },\n    set: function set(_date, _flags, value, _options) {\n      var firstWeekOfYear = new Date(0);\n      firstWeekOfYear.setUTCFullYear(value, 0, 4);\n      firstWeekOfYear.setUTCHours(0, 0, 0, 0);\n      return startOfUTCISOWeek(firstWeekOfYear);\n    },\n    incompatibleTokens: ['G', 'y', 'Y', 'u', 'Q', 'q', 'M', 'L', 'w', 'd', 'D', 'e', 'c', 't', 'T']\n  },\n  // Extended year\n  u: {\n    priority: 130,\n    parse: function parse(string, token, _match, _options) {\n      if (token === 'u') {\n        return parseNDigitsSigned(4, string);\n      }\n\n      return parseNDigitsSigned(token.length, string);\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCFullYear(value, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['G', 'y', 'Y', 'R', 'w', 'I', 'i', 'e', 'c', 't', 'T']\n  },\n  // Quarter\n  Q: {\n    priority: 120,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        // 1, 2, 3, 4\n        case 'Q':\n        case 'QQ':\n          // 01, 02, 03, 04\n          return parseNDigits(token.length, string);\n        // 1st, 2nd, 3rd, 4th\n\n        case 'Qo':\n          return match.ordinalNumber(string, {\n            unit: 'quarter'\n          });\n        // Q1, Q2, Q3, Q4\n\n        case 'QQQ':\n          return match.quarter(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n        case 'QQQQQ':\n          return match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // 1st quarter, 2nd quarter, ...\n\n        case 'QQQQ':\n        default:\n          return match.quarter(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 4;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMonth((value - 1) * 3, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'M', 'L', 'w', 'I', 'd', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Stand-alone quarter\n  q: {\n    priority: 120,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        // 1, 2, 3, 4\n        case 'q':\n        case 'qq':\n          // 01, 02, 03, 04\n          return parseNDigits(token.length, string);\n        // 1st, 2nd, 3rd, 4th\n\n        case 'qo':\n          return match.ordinalNumber(string, {\n            unit: 'quarter'\n          });\n        // Q1, Q2, Q3, Q4\n\n        case 'qqq':\n          return match.quarter(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n        case 'qqqqq':\n          return match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // 1st quarter, 2nd quarter, ...\n\n        case 'qqqq':\n        default:\n          return match.quarter(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 4;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMonth((value - 1) * 3, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'Q', 'M', 'L', 'w', 'I', 'd', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Month\n  M: {\n    priority: 110,\n    parse: function parse(string, token, match, _options) {\n      var valueCallback = function valueCallback(value) {\n        return value - 1;\n      };\n\n      switch (token) {\n        // 1, 2, ..., 12\n        case 'M':\n          return parseNumericPattern(numericPatterns.month, string, valueCallback);\n        // 01, 02, ..., 12\n\n        case 'MM':\n          return parseNDigits(2, string, valueCallback);\n        // 1st, 2nd, ..., 12th\n\n        case 'Mo':\n          return match.ordinalNumber(string, {\n            unit: 'month',\n            valueCallback: valueCallback\n          });\n        // Jan, Feb, ..., Dec\n\n        case 'MMM':\n          return match.month(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // J, F, ..., D\n\n        case 'MMMMM':\n          return match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // January, February, ..., December\n\n        case 'MMMM':\n        default:\n          return match.month(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMonth(value, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'L', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Stand-alone month\n  L: {\n    priority: 110,\n    parse: function parse(string, token, match, _options) {\n      var valueCallback = function valueCallback(value) {\n        return value - 1;\n      };\n\n      switch (token) {\n        // 1, 2, ..., 12\n        case 'L':\n          return parseNumericPattern(numericPatterns.month, string, valueCallback);\n        // 01, 02, ..., 12\n\n        case 'LL':\n          return parseNDigits(2, string, valueCallback);\n        // 1st, 2nd, ..., 12th\n\n        case 'Lo':\n          return match.ordinalNumber(string, {\n            unit: 'month',\n            valueCallback: valueCallback\n          });\n        // Jan, Feb, ..., Dec\n\n        case 'LLL':\n          return match.month(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // J, F, ..., D\n\n        case 'LLLLL':\n          return match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // January, February, ..., December\n\n        case 'LLLL':\n        default:\n          return match.month(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMonth(value, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'M', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local week of year\n  w: {\n    priority: 100,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'w':\n          return parseNumericPattern(numericPatterns.week, string);\n\n        case 'wo':\n          return match.ordinalNumber(string, {\n            unit: 'week'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 53;\n    },\n    set: function set(date, _flags, value, options) {\n      return startOfUTCWeek(setUTCWeek(date, value, options), options);\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'i', 't', 'T']\n  },\n  // ISO week of year\n  I: {\n    priority: 100,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'I':\n          return parseNumericPattern(numericPatterns.week, string);\n\n        case 'Io':\n          return match.ordinalNumber(string, {\n            unit: 'week'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 53;\n    },\n    set: function set(date, _flags, value, options) {\n      return startOfUTCISOWeek(setUTCISOWeek(date, value, options), options);\n    },\n    incompatibleTokens: ['y', 'Y', 'u', 'q', 'Q', 'M', 'L', 'w', 'd', 'D', 'e', 'c', 't', 'T']\n  },\n  // Day of the month\n  d: {\n    priority: 90,\n    subPriority: 1,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'd':\n          return parseNumericPattern(numericPatterns.date, string);\n\n        case 'do':\n          return match.ordinalNumber(string, {\n            unit: 'date'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(date, value, _options) {\n      var year = date.getUTCFullYear();\n      var isLeapYear = isLeapYearIndex(year);\n      var month = date.getUTCMonth();\n\n      if (isLeapYear) {\n        return value >= 1 && value <= DAYS_IN_MONTH_LEAP_YEAR[month];\n      } else {\n        return value >= 1 && value <= DAYS_IN_MONTH[month];\n      }\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCDate(value);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Day of year\n  D: {\n    priority: 90,\n    subPriority: 1,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'D':\n        case 'DD':\n          return parseNumericPattern(numericPatterns.dayOfYear, string);\n\n        case 'Do':\n          return match.ordinalNumber(string, {\n            unit: 'date'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(date, value, _options) {\n      var year = date.getUTCFullYear();\n      var isLeapYear = isLeapYearIndex(year);\n\n      if (isLeapYear) {\n        return value >= 1 && value <= 366;\n      } else {\n        return value >= 1 && value <= 365;\n      }\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMonth(0, value);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'M', 'L', 'w', 'I', 'd', 'E', 'i', 'e', 'c', 't', 'T']\n  },\n  // Day of week\n  E: {\n    priority: 90,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        // Tue\n        case 'E':\n        case 'EE':\n        case 'EEE':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // T\n\n        case 'EEEEE':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tu\n\n        case 'EEEEEE':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tuesday\n\n        case 'EEEE':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function set(date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local day of week\n  e: {\n    priority: 90,\n    parse: function parse(string, token, match, options) {\n      var valueCallback = function valueCallback(value) {\n        var wholeWeekDays = Math.floor((value - 1) / 7) * 7;\n        return (value + options.weekStartsOn + 6) % 7 + wholeWeekDays;\n      };\n\n      switch (token) {\n        // 3\n        case 'e':\n        case 'ee':\n          // 03\n          return parseNDigits(token.length, string, valueCallback);\n        // 3rd\n\n        case 'eo':\n          return match.ordinalNumber(string, {\n            unit: 'day',\n            valueCallback: valueCallback\n          });\n        // Tue\n\n        case 'eee':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // T\n\n        case 'eeeee':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tu\n\n        case 'eeeeee':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tuesday\n\n        case 'eeee':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function set(date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'E', 'i', 'c', 't', 'T']\n  },\n  // Stand-alone local day of week\n  c: {\n    priority: 90,\n    parse: function parse(string, token, match, options) {\n      var valueCallback = function valueCallback(value) {\n        var wholeWeekDays = Math.floor((value - 1) / 7) * 7;\n        return (value + options.weekStartsOn + 6) % 7 + wholeWeekDays;\n      };\n\n      switch (token) {\n        // 3\n        case 'c':\n        case 'cc':\n          // 03\n          return parseNDigits(token.length, string, valueCallback);\n        // 3rd\n\n        case 'co':\n          return match.ordinalNumber(string, {\n            unit: 'day',\n            valueCallback: valueCallback\n          });\n        // Tue\n\n        case 'ccc':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // T\n\n        case 'ccccc':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // Tu\n\n        case 'cccccc':\n          return match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // Tuesday\n\n        case 'cccc':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function set(date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'E', 'i', 'e', 't', 'T']\n  },\n  // ISO day of week\n  i: {\n    priority: 90,\n    parse: function parse(string, token, match, _options) {\n      var valueCallback = function valueCallback(value) {\n        if (value === 0) {\n          return 7;\n        }\n\n        return value;\n      };\n\n      switch (token) {\n        // 2\n        case 'i':\n        case 'ii':\n          // 02\n          return parseNDigits(token.length, string);\n        // 2nd\n\n        case 'io':\n          return match.ordinalNumber(string, {\n            unit: 'day'\n          });\n        // Tue\n\n        case 'iii':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // T\n\n        case 'iiiii':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // Tu\n\n        case 'iiiiii':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // Tuesday\n\n        case 'iiii':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 7;\n    },\n    set: function set(date, _flags, value, options) {\n      date = setUTCISODay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'Y', 'u', 'q', 'Q', 'M', 'L', 'w', 'd', 'D', 'E', 'e', 'c', 't', 'T']\n  },\n  // AM or PM\n  a: {\n    priority: 80,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'a':\n        case 'aa':\n        case 'aaa':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'aaaaa':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'aaaa':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['b', 'B', 'H', 'k', 't', 'T']\n  },\n  // AM, PM, midnight\n  b: {\n    priority: 80,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'b':\n        case 'bb':\n        case 'bbb':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'bbbbb':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'bbbb':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'B', 'H', 'k', 't', 'T']\n  },\n  // in the morning, in the afternoon, in the evening, at night\n  B: {\n    priority: 80,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'B':\n        case 'BB':\n        case 'BBB':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'BBBBB':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'BBBB':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 't', 'T']\n  },\n  // Hour [1-12]\n  h: {\n    priority: 70,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'h':\n          return parseNumericPattern(numericPatterns.hour12h, string);\n\n        case 'ho':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 12;\n    },\n    set: function set(date, _flags, value, _options) {\n      var isPM = date.getUTCHours() >= 12;\n\n      if (isPM && value < 12) {\n        date.setUTCHours(value + 12, 0, 0, 0);\n      } else if (!isPM && value === 12) {\n        date.setUTCHours(0, 0, 0, 0);\n      } else {\n        date.setUTCHours(value, 0, 0, 0);\n      }\n\n      return date;\n    },\n    incompatibleTokens: ['H', 'K', 'k', 't', 'T']\n  },\n  // Hour [0-23]\n  H: {\n    priority: 70,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'H':\n          return parseNumericPattern(numericPatterns.hour23h, string);\n\n        case 'Ho':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 23;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCHours(value, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 'h', 'K', 'k', 't', 'T']\n  },\n  // Hour [0-11]\n  K: {\n    priority: 70,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'K':\n          return parseNumericPattern(numericPatterns.hour11h, string);\n\n        case 'Ko':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function set(date, _flags, value, _options) {\n      var isPM = date.getUTCHours() >= 12;\n\n      if (isPM && value < 12) {\n        date.setUTCHours(value + 12, 0, 0, 0);\n      } else {\n        date.setUTCHours(value, 0, 0, 0);\n      }\n\n      return date;\n    },\n    incompatibleTokens: ['h', 'H', 'k', 't', 'T']\n  },\n  // Hour [1-24]\n  k: {\n    priority: 70,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'k':\n          return parseNumericPattern(numericPatterns.hour24h, string);\n\n        case 'ko':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 1 && value <= 24;\n    },\n    set: function set(date, _flags, value, _options) {\n      var hours = value <= 24 ? value % 24 : value;\n      date.setUTCHours(hours, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 'h', 'H', 'K', 't', 'T']\n  },\n  // Minute\n  m: {\n    priority: 60,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 'm':\n          return parseNumericPattern(numericPatterns.minute, string);\n\n        case 'mo':\n          return match.ordinalNumber(string, {\n            unit: 'minute'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 59;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMinutes(value, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Second\n  s: {\n    priority: 50,\n    parse: function parse(string, token, match, _options) {\n      switch (token) {\n        case 's':\n          return parseNumericPattern(numericPatterns.second, string);\n\n        case 'so':\n          return match.ordinalNumber(string, {\n            unit: 'second'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function validate(_date, value, _options) {\n      return value >= 0 && value <= 59;\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCSeconds(value, 0);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Fraction of second\n  S: {\n    priority: 30,\n    parse: function parse(string, token, _match, _options) {\n      var valueCallback = function valueCallback(value) {\n        return Math.floor(value * Math.pow(10, -token.length + 3));\n      };\n\n      return parseNDigits(token.length, string, valueCallback);\n    },\n    set: function set(date, _flags, value, _options) {\n      date.setUTCMilliseconds(value);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Timezone (ISO-8601. +00:00 is `'Z'`)\n  X: {\n    priority: 10,\n    parse: function parse(string, token, _match, _options) {\n      switch (token) {\n        case 'X':\n          return parseTimezonePattern(timezonePatterns.basicOptionalMinutes, string);\n\n        case 'XX':\n          return parseTimezonePattern(timezonePatterns.basic, string);\n\n        case 'XXXX':\n          return parseTimezonePattern(timezonePatterns.basicOptionalSeconds, string);\n\n        case 'XXXXX':\n          return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds, string);\n\n        case 'XXX':\n        default:\n          return parseTimezonePattern(timezonePatterns.extended, string);\n      }\n    },\n    set: function set(date, flags, value, _options) {\n      if (flags.timestampIsSet) {\n        return date;\n      }\n\n      return new Date(date.getTime() - value);\n    },\n    incompatibleTokens: ['t', 'T', 'x']\n  },\n  // Timezone (ISO-8601)\n  x: {\n    priority: 10,\n    parse: function parse(string, token, _match, _options) {\n      switch (token) {\n        case 'x':\n          return parseTimezonePattern(timezonePatterns.basicOptionalMinutes, string);\n\n        case 'xx':\n          return parseTimezonePattern(timezonePatterns.basic, string);\n\n        case 'xxxx':\n          return parseTimezonePattern(timezonePatterns.basicOptionalSeconds, string);\n\n        case 'xxxxx':\n          return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds, string);\n\n        case 'xxx':\n        default:\n          return parseTimezonePattern(timezonePatterns.extended, string);\n      }\n    },\n    set: function set(date, flags, value, _options) {\n      if (flags.timestampIsSet) {\n        return date;\n      }\n\n      return new Date(date.getTime() - value);\n    },\n    incompatibleTokens: ['t', 'T', 'X']\n  },\n  // Seconds timestamp\n  t: {\n    priority: 40,\n    parse: function parse(string, _token, _match, _options) {\n      return parseAnyDigitsSigned(string);\n    },\n    set: function set(_date, _flags, value, _options) {\n      return [new Date(value * 1000), {\n        timestampIsSet: true\n      }];\n    },\n    incompatibleTokens: '*'\n  },\n  // Milliseconds timestamp\n  T: {\n    priority: 20,\n    parse: function parse(string, _token, _match, _options) {\n      return parseAnyDigitsSigned(string);\n    },\n    set: function set(_date, _flags, value, _options) {\n      return [new Date(value), {\n        timestampIsSet: true\n      }];\n    },\n    incompatibleTokens: '*'\n  }\n};\nvar parsers$1 = parsers;\nvar TIMEZONE_UNIT_PRIORITY = 10; // This RegExp consists of three parts separated by `|`:\n// - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token\n//   (one of the certain letters followed by `o`)\n// - (\\w)\\1* matches any sequences of the same letter\n// - '' matches two quote characters in a row\n// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),\n//   except a single quote symbol, which ends the sequence.\n//   Two quote characters do not end the sequence.\n//   If there is no matching single quote\n//   then the sequence will continue until the end of the string.\n// - . matches any single character unmatched by previous parts of the RegExps\n\nvar formattingTokensRegExp = /[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also\n// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`\n\nvar longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;\nvar escapedStringRegExp = /^'([^]*?)'?$/;\nvar doubleQuoteRegExp = /''/g;\nvar notWhitespaceRegExp = /\\S/;\nvar unescapedLatinCharacterRegExp = /[a-zA-Z]/;\n/**\n * @name parse\n * @category Common Helpers\n * @summary Parse the date.\n *\n * @description\n * Return the date parsed from string using the given format string.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://git.io/fxCyr\n *\n * The characters in the format string wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n *\n * Format of the format string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 5 below the table).\n *\n * Not all tokens are compatible. Combinations that don't make sense or could lead to bugs are prohibited\n * and will throw `RangeError`. For example usage of 24-hour format token with AM/PM token will throw an exception:\n *\n * ```javascript\n * parse('23 AM', 'HH a', new Date())\n * //=> RangeError: The format string mustn't contain `HH` and `a` at the same time\n * ```\n *\n * See the compatibility table: https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPU3xUhplll6dyoMmVUXHKl_8CRDs6_ueLmex3SoqwhuolkuN3O05l4rqx5h1dKX8eb46Ul-CCSrq/pubhtml?gid=0&single=true\n *\n * Accepted format string patterns:\n * | Unit                            |Prior| Pattern | Result examples                   | Notes |\n * |---------------------------------|-----|---------|-----------------------------------|-------|\n * | Era                             | 140 | G..GGG  | AD, BC                            |       |\n * |                                 |     | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 |     | GGGGG   | A, B                              |       |\n * | Calendar year                   | 130 | y       | 44, 1, 1900, 2017, 9999           | 4     |\n * |                                 |     | yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | yy      | 44, 01, 00, 17                    | 4     |\n * |                                 |     | yyy     | 044, 001, 123, 999                | 4     |\n * |                                 |     | yyyy    | 0044, 0001, 1900, 2017            | 4     |\n * |                                 |     | yyyyy   | ...                               | 2,4   |\n * | Local week-numbering year       | 130 | Y       | 44, 1, 1900, 2017, 9000           | 4     |\n * |                                 |     | Yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | YY      | 44, 01, 00, 17                    | 4,6   |\n * |                                 |     | YYY     | 044, 001, 123, 999                | 4     |\n * |                                 |     | YYYY    | 0044, 0001, 1900, 2017            | 4,6   |\n * |                                 |     | YYYYY   | ...                               | 2,4   |\n * | ISO week-numbering year         | 130 | R       | -43, 1, 1900, 2017, 9999, -9999   | 4,5   |\n * |                                 |     | RR      | -43, 01, 00, 17                   | 4,5   |\n * |                                 |     | RRR     | -043, 001, 123, 999, -999         | 4,5   |\n * |                                 |     | RRRR    | -0043, 0001, 2017, 9999, -9999    | 4,5   |\n * |                                 |     | RRRRR   | ...                               | 2,4,5 |\n * | Extended year                   | 130 | u       | -43, 1, 1900, 2017, 9999, -999    | 4     |\n * |                                 |     | uu      | -43, 01, 99, -99                  | 4     |\n * |                                 |     | uuu     | -043, 001, 123, 999, -999         | 4     |\n * |                                 |     | uuuu    | -0043, 0001, 2017, 9999, -9999    | 4     |\n * |                                 |     | uuuuu   | ...                               | 2,4   |\n * | Quarter (formatting)            | 120 | Q       | 1, 2, 3, 4                        |       |\n * |                                 |     | Qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | QQ      | 01, 02, 03, 04                    |       |\n * |                                 |     | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | 120 | q       | 1, 2, 3, 4                        |       |\n * |                                 |     | qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | qq      | 01, 02, 03, 04                    |       |\n * |                                 |     | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | qqqqq   | 1, 2, 3, 4                        | 3     |\n * | Month (formatting)              | 110 | M       | 1, 2, ..., 12                     |       |\n * |                                 |     | Mo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | MM      | 01, 02, ..., 12                   |       |\n * |                                 |     | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | MMMM    | January, February, ..., December  | 2     |\n * |                                 |     | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | 110 | L       | 1, 2, ..., 12                     |       |\n * |                                 |     | Lo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | LL      | 01, 02, ..., 12                   |       |\n * |                                 |     | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | LLLL    | January, February, ..., December  | 2     |\n * |                                 |     | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | 100 | w       | 1, 2, ..., 53                     |       |\n * |                                 |     | wo      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | 100 | I       | 1, 2, ..., 53                     | 5     |\n * |                                 |     | Io      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | II      | 01, 02, ..., 53                   | 5     |\n * | Day of month                    |  90 | d       | 1, 2, ..., 31                     |       |\n * |                                 |     | do      | 1st, 2nd, ..., 31st               | 5     |\n * |                                 |     | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     |  90 | D       | 1, 2, ..., 365, 366               | 7     |\n * |                                 |     | Do      | 1st, 2nd, ..., 365th, 366th       | 5     |\n * |                                 |     | DD      | 01, 02, ..., 365, 366             | 7     |\n * |                                 |     | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 |     | DDDD    | ...                               | 2     |\n * | Day of week (formatting)        |  90 | E..EEE  | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 |     | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 |     | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | ISO day of week (formatting)    |  90 | i       | 1, 2, 3, ..., 7                   | 5     |\n * |                                 |     | io      | 1st, 2nd, ..., 7th                | 5     |\n * |                                 |     | ii      | 01, 02, ..., 07                   | 5     |\n * |                                 |     | iii     | Mon, Tue, Wed, ..., Sun           | 5     |\n * |                                 |     | iiii    | Monday, Tuesday, ..., Sunday      | 2,5   |\n * |                                 |     | iiiii   | M, T, W, T, F, S, S               | 5     |\n * |                                 |     | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 5     |\n * | Local day of week (formatting)  |  90 | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | eo      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | ee      | 02, 03, ..., 01                   |       |\n * |                                 |     | eee     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 |     | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 |     | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | Local day of week (stand-alone) |  90 | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | co      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | cc      | 02, 03, ..., 01                   |       |\n * |                                 |     | ccc     | Mon, Tue, Wed, ..., Sun           |       |\n * |                                 |     | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 |     | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | AM, PM                          |  80 | a..aaa  | AM, PM                            |       |\n * |                                 |     | aaaa    | a.m., p.m.                        | 2     |\n * |                                 |     | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          |  80 | b..bbb  | AM, PM, noon, midnight            |       |\n * |                                 |     | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 |     | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             |  80 | B..BBB  | at night, in the morning, ...     |       |\n * |                                 |     | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 |     | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     |  70 | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 |     | ho      | 1st, 2nd, ..., 11th, 12th         | 5     |\n * |                                 |     | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     |  70 | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 |     | Ho      | 0th, 1st, 2nd, ..., 23rd          | 5     |\n * |                                 |     | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     |  70 | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 |     | Ko      | 1st, 2nd, ..., 11th, 0th          | 5     |\n * |                                 |     | KK      | 01, 02, ..., 11, 00               |       |\n * | Hour [1-24]                     |  70 | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 |     | ko      | 24th, 1st, 2nd, ..., 23rd         | 5     |\n * |                                 |     | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          |  60 | m       | 0, 1, ..., 59                     |       |\n * |                                 |     | mo      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | mm      | 00, 01, ..., 59                   |       |\n * | Second                          |  50 | s       | 0, 1, ..., 59                     |       |\n * |                                 |     | so      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | ss      | 00, 01, ..., 59                   |       |\n * | Seconds timestamp               |  40 | t       | 512969520                         |       |\n * |                                 |     | tt      | ...                               | 2     |\n * | Fraction of second              |  30 | S       | 0, 1, ..., 9                      |       |\n * |                                 |     | SS      | 00, 01, ..., 99                   |       |\n * |                                 |     | SSS     | 000, 001, ..., 999                |       |\n * |                                 |     | SSSS    | ...                               | 2     |\n * | Milliseconds timestamp          |  20 | T       | 512969520900                      |       |\n * |                                 |     | TT      | ...                               | 2     |\n * | Timezone (ISO-8601 w/ Z)        |  10 | X       | -08, +0530, Z                     |       |\n * |                                 |     | XX      | -0800, +0530, Z                   |       |\n * |                                 |     | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 |     | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 |     | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       |  10 | x       | -08, +0530, +00                   |       |\n * |                                 |     | xx      | -0800, +0530, +0000               |       |\n * |                                 |     | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 |     | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 |     | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Long localized date             |  NA | P       | 05/29/1453                        | 5,8   |\n * |                                 |     | PP      | May 29, 1453                      |       |\n * |                                 |     | PPP     | May 29th, 1453                    |       |\n * |                                 |     | PPPP    | Sunday, May 29th, 1453            | 2,5,8 |\n * | Long localized time             |  NA | p       | 12:00 AM                          | 5,8   |\n * |                                 |     | pp      | 12:00:00 AM                       |       |\n * | Combination of date and time    |  NA | Pp      | 05/29/1453, 12:00 AM              |       |\n * |                                 |     | PPpp    | May 29, 1453, 12:00:00 AM         |       |\n * |                                 |     | PPPpp   | May 29th, 1453 at ...             |       |\n * |                                 |     | PPPPpp  | Sunday, May 29th, 1453 at ...     | 2,5,8 |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular.\n *    In `format` function, they will produce different result:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n *    `parse` will try to match both formatting and stand-alone units interchangably.\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table:\n *    - for numerical units (`yyyyyyyy`) `parse` will try to match a number\n *      as wide as the sequence\n *    - for text units (`MMMMMMMM`) `parse` will try to match the widest variation of the unit.\n *      These variations are marked with \"2\" in the last column of the table.\n *\n * 3. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 4. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` will try to guess the century of two digit year by proximity with `referenceDate`:\n *\n *    `parse('50', 'yy', new Date(2018, 0, 1)) //=> Sat Jan 01 2050 00:00:00`\n *\n *    `parse('75', 'yy', new Date(2018, 0, 1)) //=> Wed Jan 01 1975 00:00:00`\n *\n *    while `uu` will just assign the year as is:\n *\n *    `parse('50', 'uu', new Date(2018, 0, 1)) //=> Sat Jan 01 0050 00:00:00`\n *\n *    `parse('75', 'uu', new Date(2018, 0, 1)) //=> Tue Jan 01 0075 00:00:00`\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [setISOWeekYear]{@link https://date-fns.org/docs/setISOWeekYear}\n *    and [setWeekYear]{@link https://date-fns.org/docs/setWeekYear}).\n *\n * 5. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 6. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 7. `D` and `DD` tokens represent days of the year but they are ofthen confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 8. `P+` tokens do not have a defined priority since they are merely aliases to other tokens based\n *    on the given locale.\n *\n *    using `en-US` locale: `P` => `MM/dd/yyyy`\n *    using `en-US` locale: `p` => `hh:mm a`\n *    using `pt-BR` locale: `P` => `dd/MM/yyyy`\n *    using `pt-BR` locale: `p` => `HH:mm`\n *\n * Values will be assigned to the date in the descending order of its unit's priority.\n * Units of an equal priority overwrite each other in the order of appearance.\n *\n * If no values of higher priority are parsed (e.g. when parsing string 'January 1st' without a year),\n * the values will be taken from 3rd argument `referenceDate` which works as a context of parsing.\n *\n * `referenceDate` must be passed for correct work of the function.\n * If you're not sure which `referenceDate` to supply, create a new instance of Date:\n * `parse('02/11/2014', 'MM/dd/yyyy', new Date())`\n * In this case parsing will be done in the context of the current date.\n * If `referenceDate` is `Invalid Date` or a value not convertible to valid `Date`,\n * then `Invalid Date` will be returned.\n *\n * The result may vary by locale.\n *\n * If `formatString` matches with `dateString` but does not provides tokens, `referenceDate` will be returned.\n *\n * If parsing failed, `Invalid Date` will be returned.\n * Invalid Date is a Date, whose time value is NaN.\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - Old `parse` was renamed to `toDate`.\n *   Now `parse` is a new function which parses a string using a provided format.\n *\n *   ```javascript\n *   // Before v2.0.0\n *   parse('2016-01-01')\n *\n *   // v2.0.0 onward (toDate no longer accepts a string)\n *   toDate(1392098430000) // Unix to timestamp\n *   toDate(new Date(2014, 1, 11, 11, 30, 30)) // Cloning the date\n *   parse('2016-01-01', 'yyyy-MM-dd', new Date())\n *   ```\n *\n * @param {String} dateString - the string to parse\n * @param {String} formatString - the string of tokens\n * @param {Date|Number} referenceDate - defines values missing from the parsed dateString\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @param {1|2|3|4|5|6|7} [options.firstWeekContainsDate=1] - the day of January, which is always in the first week of the year\n * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;\n *   see: https://git.io/fxCyr\n * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;\n *   see: https://git.io/fxCyr\n * @returns {Date} the parsed date\n * @throws {TypeError} 3 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7\n * @throws {RangeError} `options.locale` must contain `match` property\n * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `yy` instead of `YY` for formatting years using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `d` instead of `D` for formatting days of the month using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month using [format provided] to the input [input provided]; see: https://git.io/fxCyr\n * @throws {RangeError} format string contains an unescaped latin alphabet character\n *\n * @example\n * // Parse 11 February 2014 from middle-endian format:\n * var result = parse('02/11/2014', 'MM/dd/yyyy', new Date())\n * //=> Tue Feb 11 2014 00:00:00\n *\n * @example\n * // Parse 28th of February in Esperanto locale in the context of 2010 year:\n * import eo from 'date-fns/locale/eo'\n * var result = parse('28-a de februaro', \"do 'de' MMMM\", new Date(2010, 0, 1), {\n *   locale: eo\n * })\n * //=> Sun Feb 28 2010 00:00:00\n */\n\nfunction parse$1(dirtyDateString, dirtyFormatString, dirtyReferenceDate, dirtyOptions) {\n  requiredArgs(3, arguments);\n  var dateString = String(dirtyDateString);\n  var formatString = String(dirtyFormatString);\n  var options = dirtyOptions || {};\n  var locale = options.locale || defaultLocale;\n\n  if (!locale.match) {\n    throw new RangeError('locale must contain match property');\n  }\n\n  var localeFirstWeekContainsDate = locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var localeWeekStartsOn = locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  if (formatString === '') {\n    if (dateString === '') {\n      return toDate(dirtyReferenceDate);\n    } else {\n      return new Date(NaN);\n    }\n  }\n\n  var subFnOptions = {\n    firstWeekContainsDate: firstWeekContainsDate,\n    weekStartsOn: weekStartsOn,\n    locale: locale\n  }; // If timezone isn't specified, it will be set to the system timezone\n\n  var setters = [{\n    priority: TIMEZONE_UNIT_PRIORITY,\n    subPriority: -1,\n    set: dateToSystemTimezone,\n    index: 0\n  }];\n  var i;\n  var tokens = formatString.match(longFormattingTokensRegExp).map(function (substring) {\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === 'p' || firstCharacter === 'P') {\n      var longFormatter = longFormatters$1[firstCharacter];\n      return longFormatter(substring, locale.formatLong, subFnOptions);\n    }\n\n    return substring;\n  }).join('').match(formattingTokensRegExp);\n  var usedTokens = [];\n\n  for (i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (!options.useAdditionalWeekYearTokens && isProtectedWeekYearToken(token)) {\n      throwProtectedError(token, formatString, dirtyDateString);\n    }\n\n    if (!options.useAdditionalDayOfYearTokens && isProtectedDayOfYearToken(token)) {\n      throwProtectedError(token, formatString, dirtyDateString);\n    }\n\n    var firstCharacter = token[0];\n    var parser = parsers$1[firstCharacter];\n\n    if (parser) {\n      var incompatibleTokens = parser.incompatibleTokens;\n\n      if (Array.isArray(incompatibleTokens)) {\n        var incompatibleToken = void 0;\n\n        for (var _i = 0; _i < usedTokens.length; _i++) {\n          var usedToken = usedTokens[_i].token;\n\n          if (incompatibleTokens.indexOf(usedToken) !== -1 || usedToken === firstCharacter) {\n            incompatibleToken = usedTokens[_i];\n            break;\n          }\n        }\n\n        if (incompatibleToken) {\n          throw new RangeError(\"The format string mustn't contain `\".concat(incompatibleToken.fullToken, \"` and `\").concat(token, \"` at the same time\"));\n        }\n      } else if (parser.incompatibleTokens === '*' && usedTokens.length) {\n        throw new RangeError(\"The format string mustn't contain `\".concat(token, \"` and any other token at the same time\"));\n      }\n\n      usedTokens.push({\n        token: firstCharacter,\n        fullToken: token\n      });\n      var parseResult = parser.parse(dateString, token, locale.match, subFnOptions);\n\n      if (!parseResult) {\n        return new Date(NaN);\n      }\n\n      setters.push({\n        priority: parser.priority,\n        subPriority: parser.subPriority || 0,\n        set: parser.set,\n        validate: parser.validate,\n        value: parseResult.value,\n        index: setters.length\n      });\n      dateString = parseResult.rest;\n    } else {\n      if (firstCharacter.match(unescapedLatinCharacterRegExp)) {\n        throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');\n      } // Replace two single quote characters with one single quote character\n\n\n      if (token === \"''\") {\n        token = \"'\";\n      } else if (firstCharacter === \"'\") {\n        token = cleanEscapedString(token);\n      } // Cut token from string, or, if string doesn't match the token, return Invalid Date\n\n\n      if (dateString.indexOf(token) === 0) {\n        dateString = dateString.slice(token.length);\n      } else {\n        return new Date(NaN);\n      }\n    }\n  } // Check if the remaining input contains something other than whitespace\n\n\n  if (dateString.length > 0 && notWhitespaceRegExp.test(dateString)) {\n    return new Date(NaN);\n  }\n\n  var uniquePrioritySetters = setters.map(function (setter) {\n    return setter.priority;\n  }).sort(function (a, b) {\n    return b - a;\n  }).filter(function (priority, index, array) {\n    return array.indexOf(priority) === index;\n  }).map(function (priority) {\n    return setters.filter(function (setter) {\n      return setter.priority === priority;\n    }).sort(function (a, b) {\n      return b.subPriority - a.subPriority;\n    });\n  }).map(function (setterArray) {\n    return setterArray[0];\n  });\n  var date = toDate(dirtyReferenceDate);\n\n  if (isNaN(date)) {\n    return new Date(NaN);\n  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.\n  // This ensures that when UTC functions will be implemented, locales will be compatible with them.\n  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/37\n\n\n  var utcDate = subMilliseconds(date, getTimezoneOffsetInMilliseconds(date));\n  var flags = {};\n\n  for (i = 0; i < uniquePrioritySetters.length; i++) {\n    var setter = uniquePrioritySetters[i];\n\n    if (setter.validate && !setter.validate(utcDate, setter.value, subFnOptions)) {\n      return new Date(NaN);\n    }\n\n    var result = setter.set(utcDate, flags, setter.value, subFnOptions); // Result is tuple (date, flags)\n\n    if (result[0]) {\n      utcDate = result[0];\n      assign(flags, result[1]); // Result is date\n    } else {\n      utcDate = result;\n    }\n  }\n\n  return utcDate;\n}\n\nfunction dateToSystemTimezone(date, flags) {\n  if (flags.timestampIsSet) {\n    return date;\n  }\n\n  var convertedDate = new Date(0);\n  convertedDate.setFullYear(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n  convertedDate.setHours(date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\n  return convertedDate;\n}\n\nfunction cleanEscapedString(input) {\n  return input.match(escapedStringRegExp)[1].replace(doubleQuoteRegExp, \"'\");\n}\n/**\n * @name isMatch\n * @category Common Helpers\n * @summary validates the date string against given formats\n *\n * @description\n * Return the true if given date is string correct against the given format else\n * will return false.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://git.io/fxCyr\n *\n * The characters in the format string wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n *\n * Format of the format string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 5 below the table).\n *\n * Not all tokens are compatible. Combinations that don't make sense or could lead to bugs are prohibited\n * and will throw `RangeError`. For example usage of 24-hour format token with AM/PM token will throw an exception:\n *\n * ```javascript\n * isMatch('23 AM', 'HH a')\n * //=> RangeError: The format string mustn't contain `HH` and `a` at the same time\n * ```\n *\n * See the compatibility table: https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPU3xUhplll6dyoMmVUXHKl_8CRDs6_ueLmex3SoqwhuolkuN3O05l4rqx5h1dKX8eb46Ul-CCSrq/pubhtml?gid=0&single=true\n *\n * Accepted format string patterns:\n * | Unit                            |Prior| Pattern | Result examples                   | Notes |\n * |---------------------------------|-----|---------|-----------------------------------|-------|\n * | Era                             | 140 | G..GGG  | AD, BC                            |       |\n * |                                 |     | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 |     | GGGGG   | A, B                              |       |\n * | Calendar year                   | 130 | y       | 44, 1, 1900, 2017, 9999           | 4     |\n * |                                 |     | yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | yy      | 44, 01, 00, 17                    | 4     |\n * |                                 |     | yyy     | 044, 001, 123, 999                | 4     |\n * |                                 |     | yyyy    | 0044, 0001, 1900, 2017            | 4     |\n * |                                 |     | yyyyy   | ...                               | 2,4   |\n * | Local week-numbering year       | 130 | Y       | 44, 1, 1900, 2017, 9000           | 4     |\n * |                                 |     | Yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | YY      | 44, 01, 00, 17                    | 4,6   |\n * |                                 |     | YYY     | 044, 001, 123, 999                | 4     |\n * |                                 |     | YYYY    | 0044, 0001, 1900, 2017            | 4,6   |\n * |                                 |     | YYYYY   | ...                               | 2,4   |\n * | ISO week-numbering year         | 130 | R       | -43, 1, 1900, 2017, 9999, -9999   | 4,5   |\n * |                                 |     | RR      | -43, 01, 00, 17                   | 4,5   |\n * |                                 |     | RRR     | -043, 001, 123, 999, -999         | 4,5   |\n * |                                 |     | RRRR    | -0043, 0001, 2017, 9999, -9999    | 4,5   |\n * |                                 |     | RRRRR   | ...                               | 2,4,5 |\n * | Extended year                   | 130 | u       | -43, 1, 1900, 2017, 9999, -999    | 4     |\n * |                                 |     | uu      | -43, 01, 99, -99                  | 4     |\n * |                                 |     | uuu     | -043, 001, 123, 999, -999         | 4     |\n * |                                 |     | uuuu    | -0043, 0001, 2017, 9999, -9999    | 4     |\n * |                                 |     | uuuuu   | ...                               | 2,4   |\n * | Quarter (formatting)            | 120 | Q       | 1, 2, 3, 4                        |       |\n * |                                 |     | Qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | QQ      | 01, 02, 03, 04                    |       |\n * |                                 |     | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | 120 | q       | 1, 2, 3, 4                        |       |\n * |                                 |     | qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | qq      | 01, 02, 03, 04                    |       |\n * |                                 |     | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | qqqqq   | 1, 2, 3, 4                        | 3     |\n * | Month (formatting)              | 110 | M       | 1, 2, ..., 12                     |       |\n * |                                 |     | Mo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | MM      | 01, 02, ..., 12                   |       |\n * |                                 |     | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | MMMM    | January, February, ..., December  | 2     |\n * |                                 |     | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | 110 | L       | 1, 2, ..., 12                     |       |\n * |                                 |     | Lo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | LL      | 01, 02, ..., 12                   |       |\n * |                                 |     | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | LLLL    | January, February, ..., December  | 2     |\n * |                                 |     | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | 100 | w       | 1, 2, ..., 53                     |       |\n * |                                 |     | wo      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | 100 | I       | 1, 2, ..., 53                     | 5     |\n * |                                 |     | Io      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | II      | 01, 02, ..., 53                   | 5     |\n * | Day of month                    |  90 | d       | 1, 2, ..., 31                     |       |\n * |                                 |     | do      | 1st, 2nd, ..., 31st               | 5     |\n * |                                 |     | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     |  90 | D       | 1, 2, ..., 365, 366               | 7     |\n * |                                 |     | Do      | 1st, 2nd, ..., 365th, 366th       | 5     |\n * |                                 |     | DD      | 01, 02, ..., 365, 366             | 7     |\n * |                                 |     | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 |     | DDDD    | ...                               | 2     |\n * | Day of week (formatting)        |  90 | E..EEE  | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 |     | EEEEEE  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | ISO day of week (formatting)    |  90 | i       | 1, 2, 3, ..., 7                   | 5     |\n * |                                 |     | io      | 1st, 2nd, ..., 7th                | 5     |\n * |                                 |     | ii      | 01, 02, ..., 07                   | 5     |\n * |                                 |     | iii     | Mon, Tue, Wed, ..., Su            | 5     |\n * |                                 |     | iiii    | Monday, Tuesday, ..., Sunday      | 2,5   |\n * |                                 |     | iiiii   | M, T, W, T, F, S, S               | 5     |\n * |                                 |     | iiiiii  | Mo, Tu, We, Th, Fr, Sa, Su        | 5     |\n * | Local day of week (formatting)  |  90 | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | eo      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | ee      | 02, 03, ..., 01                   |       |\n * |                                 |     | eee     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 |     | eeeeee  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | Local day of week (stand-alone) |  90 | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | co      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | cc      | 02, 03, ..., 01                   |       |\n * |                                 |     | ccc     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 |     | cccccc  | Mo, Tu, We, Th, Fr, Sa, Su        |       |\n * | AM, PM                          |  80 | a..aaa  | AM, PM                            |       |\n * |                                 |     | aaaa    | a.m., p.m.                        | 2     |\n * |                                 |     | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          |  80 | b..bbb  | AM, PM, noon, midnight            |       |\n * |                                 |     | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 |     | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             |  80 | B..BBB  | at night, in the morning, ...     |       |\n * |                                 |     | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 |     | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     |  70 | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 |     | ho      | 1st, 2nd, ..., 11th, 12th         | 5     |\n * |                                 |     | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     |  70 | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 |     | Ho      | 0th, 1st, 2nd, ..., 23rd          | 5     |\n * |                                 |     | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     |  70 | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 |     | Ko      | 1st, 2nd, ..., 11th, 0th          | 5     |\n * |                                 |     | KK      | 01, 02, ..., 11, 00               |       |\n * | Hour [1-24]                     |  70 | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 |     | ko      | 24th, 1st, 2nd, ..., 23rd         | 5     |\n * |                                 |     | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          |  60 | m       | 0, 1, ..., 59                     |       |\n * |                                 |     | mo      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | mm      | 00, 01, ..., 59                   |       |\n * | Second                          |  50 | s       | 0, 1, ..., 59                     |       |\n * |                                 |     | so      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | ss      | 00, 01, ..., 59                   |       |\n * | Seconds timestamp               |  40 | t       | 512969520                         |       |\n * |                                 |     | tt      | ...                               | 2     |\n * | Fraction of second              |  30 | S       | 0, 1, ..., 9                      |       |\n * |                                 |     | SS      | 00, 01, ..., 99                   |       |\n * |                                 |     | SSS     | 000, 001, ..., 999                |       |\n * |                                 |     | SSSS    | ...                               | 2     |\n * | Milliseconds timestamp          |  20 | T       | 512969520900                      |       |\n * |                                 |     | TT      | ...                               | 2     |\n * | Timezone (ISO-8601 w/ Z)        |  10 | X       | -08, +0530, Z                     |       |\n * |                                 |     | XX      | -0800, +0530, Z                   |       |\n * |                                 |     | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 |     | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 |     | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       |  10 | x       | -08, +0530, +00                   |       |\n * |                                 |     | xx      | -0800, +0530, +0000               |       |\n * |                                 |     | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 |     | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 |     | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Long localized date             |  NA | P       | 05/29/1453                        | 5,8   |\n * |                                 |     | PP      | May 29, 1453                      |       |\n * |                                 |     | PPP     | May 29th, 1453                    |       |\n * |                                 |     | PPPP    | Sunday, May 29th, 1453            | 2,5,8 |\n * | Long localized time             |  NA | p       | 12:00 AM                          | 5,8   |\n * |                                 |     | pp      | 12:00:00 AM                       |       |\n * | Combination of date and time    |  NA | Pp      | 05/29/1453, 12:00 AM              |       |\n * |                                 |     | PPpp    | May 29, 1453, 12:00:00 AM         |       |\n * |                                 |     | PPPpp   | May 29th, 1453 at ...             |       |\n * |                                 |     | PPPPpp  | Sunday, May 29th, 1453 at ...     | 2,5,8 |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular.\n *    In `format` function, they will produce different result:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n *    `isMatch` will try to match both formatting and stand-alone units interchangably.\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table:\n *    - for numerical units (`yyyyyyyy`) `isMatch` will try to match a number\n *      as wide as the sequence\n *    - for text units (`MMMMMMMM`) `isMatch` will try to match the widest variation of the unit.\n *      These variations are marked with \"2\" in the last column of the table.\n *\n * 3. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 4. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` will try to guess the century of two digit year by proximity with `referenceDate`:\n *\n *    `isMatch('50', 'yy') //=> true`\n *\n *    `isMatch('75', 'yy') //=> true`\n *\n *    while `uu` will use the year as is:\n *\n *    `isMatch('50', 'uu') //=> true`\n *\n *    `isMatch('75', 'uu') //=> true`\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [setISOWeekYear]{@link https://date-fns.org/docs/setISOWeekYear}\n *    and [setWeekYear]{@link https://date-fns.org/docs/setWeekYear}).\n *\n * 5. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 6. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 7. `D` and `DD` tokens represent days of the year but they are ofthen confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 8. `P+` tokens do not have a defined priority since they are merely aliases to other tokens based\n *    on the given locale.\n *\n *    using `en-US` locale: `P` => `MM/dd/yyyy`\n *    using `en-US` locale: `p` => `hh:mm a`\n *    using `pt-BR` locale: `P` => `dd/MM/yyyy`\n *    using `pt-BR` locale: `p` => `HH:mm`\n *\n * Values will be checked in the descending order of its unit's priority.\n * Units of an equal priority overwrite each other in the order of appearance.\n *\n * If no values of higher priority are matched (e.g. when matching string 'January 1st' without a year),\n * the values will be taken from today's using `new Date()` date which works as a context of parsing.\n *\n * The result may vary by locale.\n *\n * If `formatString` matches with `dateString` but does not provides tokens, `referenceDate` will be returned.\n *\n *\n *\n * @param {String} dateString - the date string to verify\n * @param {String} formatString - the string of tokens\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @param {1|2|3|4|5|6|7} [options.firstWeekContainsDate=1] - the day of January, which is always in the first week of the year\n * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;\n *   see: https://git.io/fxCyr\n * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;\n *   see: https://git.io/fxCyr\n * @returns {Boolean}\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7\n * @throws {RangeError} `options.locale` must contain `match` property\n * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} format string contains an unescaped latin alphabet character\n *\n * @example\n * // Match 11 February 2014 from middle-endian format:\n * var result = isMatch('02/11/2014', 'MM/dd/yyyy')\n * //=> true\n *\n * @example\n * // Match 28th of February in Esperanto locale in the context of 2010 year:\n * import eo from 'date-fns/locale/eo'\n * var result = isMatch('28-a de februaro', \"do 'de' MMMM\", {\n *   locale: eo\n * })\n * //=> true\n */\n\n\nfunction isMatch(dateString, formatString, options) {\n  requiredArgs(2, arguments);\n  return isValid$2(parse$1(dateString, formatString, new Date(), options));\n} // Copyright (c) Cosmo Tech.\n\n\nvar parse = function parse(dateStr, dateFormat) {\n  try {\n    return parse$1(dateStr, dateFormat, new Date());\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nvar format = function format(date) {\n  var dateFormat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"yyyy-MM-dd'T'HH:mm:ss.SSSX\";\n\n  if (date) {\n    try {\n      return format$1(date, dateFormat);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  return '';\n};\n\nvar isValid$1 = function isValid$1(dateStr, dateFormat) {\n  return isMatch(dateStr, dateFormat);\n};\n\nvar min = function min(dateA, dateB) {\n  if (dateA && dateB) {\n    return dateA < dateB ? dateA : dateB;\n  }\n};\n\nvar max = function max(dateA, dateB) {\n  if (dateA && dateB) {\n    return dateA > dateB ? dateA : dateB;\n  }\n}; // Same as min, but accepts string parameters and returns a string value\n\n\nvar strMin = function strMin(dateStrA, dateStrB, dateFormat) {\n  var dateA = parse(dateStrA, dateFormat);\n  var dateB = parse(dateStrB, dateFormat);\n\n  if (dateA && dateB) {\n    return dateA < dateB ? dateStrA : dateStrB;\n  }\n}; // Same as max, but accepts string parameters and returns a string value\n\n\nvar strMax = function strMax(dateStrA, dateStrB, dateFormat) {\n  var dateA = parse(dateStrA, dateFormat);\n  var dateB = parse(dateStrB, dateFormat);\n\n  if (dateA && dateB) {\n    return dateA > dateB ? dateStrA : dateStrB;\n  }\n};\n\nvar DateUtils = {\n  parse: parse,\n  format: format,\n  isValid: isValid$1,\n  min: min,\n  max: max,\n  strMin: strMin,\n  strMax: strMax\n}; // Copyright (c) Cosmo Tech.\n\nvar isBool = function isBool(dataStr) {\n  return validator.isBoolean(dataStr, {\n    loose: true\n  });\n};\n\nvar isDate = function isDate(dataStr, dateFormat) {\n  return DateUtils.isValid(dataStr, dateFormat);\n};\n\nvar isEnum = function isEnum(dataStr, enumValues) {\n  return enumValues.indexOf(dataStr) !== -1;\n};\n\nvar isInt = function isInt(dataStr) {\n  return validator.isInt(dataStr);\n};\n\nvar isNumber = function isNumber(dataStr) {\n  return validator.isNumeric(dataStr);\n};\n\nvar isString = function isString(data) {\n  return typeof data === 'string';\n};\n\nvar isValid = function isValid(dataStr, type, options) {\n  var canBeEmpty = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  if (canBeEmpty && dataStr === '') {\n    return true;\n  }\n\n  switch (type) {\n    case 'bool':\n      return isBool(dataStr);\n\n    case 'date':\n      if (!options.dateFormat) {\n        console.error(\"Missing option dateFormat, can't perform date validation.\");\n        return false;\n      }\n\n      return isDate(dataStr, options.dateFormat);\n\n    case 'enum':\n      if (!options.enumValues) {\n        console.error(\"Missing option enumValues, can't perform enum validation.\");\n        return false;\n      }\n\n      return isEnum(dataStr, options.enumValues);\n\n    case 'int':\n      return isInt(dataStr);\n\n    case 'number':\n      return isNumber(dataStr);\n\n    case 'string':\n      return isString(dataStr);\n\n    default:\n      console.error(\"Unknown type \\\"\".concat(type, \"\\\", can't perform type validation.\"));\n      return false;\n  }\n};\n\nvar ValidationUtils = {\n  isBool: isBool,\n  isDate: isDate,\n  isEnum: isEnum,\n  isInt: isInt,\n  isNumber: isNumber,\n  isValid: isValid\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n\nvar Error$1 = /*#__PURE__*/function () {\n  function Error$1(summary, loc, context) {\n    _classCallCheck(this, Error$1);\n\n    this.summary = summary;\n    this.loc = loc;\n    this.context = context;\n  }\n\n  _createClass(Error$1, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Summary: \".concat(this.summary, \"\\n\") + \"Loc: \".concat(this.loc, \"\\n\") + \"Context: \".concat(this.context);\n    }\n  }]);\n\n  return Error$1;\n}();\n\nvar _buildColumnsCountError = function _buildColumnsCountError(missingColsCount, rowIndex, expectedColsCount, colsCount, expectedColsName, row) {\n  var errorSummary = \"Missing field\".concat(missingColsCount > 1 ? 's' : '');\n  var errorLoc = \"Line \".concat(rowIndex);\n  var errorContext = \"\".concat(errorSummary, \" (\").concat(errorLoc, \") : \").concat(expectedColsCount, \" fields expected, \") + \"but only \".concat(colsCount, \" field\").concat(colsCount > 1 ? 's' : '', \" found\\n\") + \"Expected data format : \\\"\".concat(expectedColsName, \"\\\"\\n\") + \"Incorrect Row : \\\"\".concat(row, \"\\\"\");\n  return new Error$1(errorSummary, errorLoc, errorContext);\n};\n\nvar _buildTypeError = function _buildTypeError(type, rowIndex, colIndex, colsData, value, expected) {\n  var errorSummary = \"Incorrect \".concat(type, \" value\");\n  var errorLoc = \"Line \".concat(rowIndex, \" , Column \").concat(colIndex, \" (\\\"\").concat(colsData[colIndex].field, \"\\\")\");\n  var errorContext = \"\".concat(errorSummary, \" (\").concat(errorLoc, \")\\n\") + \"Incorrect value : \\\"\".concat(value, \"\\\" for type \").concat(type);\n\n  if (!expected || expected.length === 0) {\n    return new Error$1(errorSummary, errorLoc, errorContext);\n  }\n\n  return new Error$1(errorSummary, errorLoc, errorContext + '\\n' + expected);\n};\n\nvar DEFAULT_CSV_EXPORT_OPTIONS = {\n  colSep: ',',\n  dateFormat: 'yyyy-MM-dd',\n  rowSep: '\\n',\n  writeHeader: true\n};\n\nvar _forgeColumnsCountError = function _forgeColumnsCountError(row, rowIndex, expectedCols) {\n  var colsCount = Object.values(row).filter(function (el) {\n    return el !== undefined;\n  }).length;\n  var expectedColsCount = expectedCols.length;\n  var expectedColsName = expectedCols.map(function (col) {\n    return col.field;\n  }).join();\n  var missingColsCount = expectedColsCount - colsCount;\n  return _buildColumnsCountError(missingColsCount, rowIndex, expectedColsCount, colsCount, expectedColsName, row);\n};\n\nvar _forgeTypeError = function _forgeTypeError(value, rowIndex, type, options, colsData, colIndex) {\n  var expected = '';\n\n  if (type === 'enum') {\n    expected = \"Expected values: [\".concat(options.enumValues.join(), \"]\");\n  } else if (type === 'date') {\n    expected = \"Expected format: \".concat(options.dateFormat);\n  }\n\n  return _buildTypeError(type, rowIndex, colIndex, colsData, value, expected);\n};\n\nvar _getColTypeFromTypeArray = function _getColTypeFromTypeArray(typeArray) {\n  if (!typeArray || typeArray.length === 0) {\n    return 'string'; // Fall back to default type\n  }\n\n  var knownTypes = ['bool', 'date', 'enum', 'int', 'number'];\n\n  for (var _i11 = 0, _knownTypes = knownTypes; _i11 < _knownTypes.length; _i11++) {\n    var type = _knownTypes[_i11];\n\n    if (typeArray.indexOf(type) !== -1) {\n      return type;\n    }\n  }\n\n  return 'string'; // Fall back to default type\n};\n\nvar _validateFormat = function _validateFormat(rows, hasHeader, cols, options) {\n  var colsData = cols.map(function (col) {\n    return _objectSpread2(_objectSpread2({}, col), {}, {\n      type: _getColTypeFromTypeArray(col.type)\n    });\n  });\n  var errors = [];\n  var knownColsCount = colsData.length;\n  var startIndex = hasHeader ? 1 : 0;\n\n  var _loop = function _loop(rowIndex) {\n    var row = rows[rowIndex];\n\n    if (row.length < knownColsCount || row.includes(undefined)) {\n      errors.push(_forgeColumnsCountError(rows[rowIndex], rowIndex, colsData));\n    }\n\n    row.forEach(function (rowCell, colIndex) {\n      if (colIndex < knownColsCount) {\n        var colType = colsData[colIndex].type;\n\n        if (colType && rowCell !== undefined) {\n          var _colsData$colIndex, _colsData$colIndex2, _colsData$colIndex2$c, _colsData$colIndex$ce, _colsData$colIndex$ce2;\n\n          var enumValues = ((_colsData$colIndex = colsData[colIndex]) === null || _colsData$colIndex === void 0 ? void 0 : _colsData$colIndex.enumValues) || ((_colsData$colIndex2 = colsData[colIndex]) === null || _colsData$colIndex2 === void 0 ? void 0 : (_colsData$colIndex2$c = _colsData$colIndex2.cellEditorParams) === null || _colsData$colIndex2$c === void 0 ? void 0 : _colsData$colIndex2$c.enumValues);\n\n          var colOptions = _objectSpread2(_objectSpread2({}, options), {}, {\n            enumValues: enumValues\n          });\n\n          var acceptsEmptyFields = (_colsData$colIndex$ce = (_colsData$colIndex$ce2 = colsData[colIndex].cellEditorParams) === null || _colsData$colIndex$ce2 === void 0 ? void 0 : _colsData$colIndex$ce2.acceptsEmptyFields) !== null && _colsData$colIndex$ce !== void 0 ? _colsData$colIndex$ce : false;\n\n          if (!ValidationUtils.isValid(rowCell, colType, colOptions, acceptsEmptyFields)) {\n            errors.push(_forgeTypeError(rowCell, rowIndex, colType, colOptions, colsData, colIndex));\n          }\n        }\n      }\n    });\n  };\n\n  for (var rowIndex = startIndex; rowIndex < rows.length; rowIndex++) {\n    _loop(rowIndex);\n  }\n\n  return errors;\n};\n\nvar _reformatBoolValue = function _reformatBoolValue(csvCellValue) {\n  csvCellValue = csvCellValue.toLowerCase();\n\n  if (['0', 'false', 'no'].includes(csvCellValue)) {\n    return 'false';\n  } else if (['1', 'true', 'yes'].includes(csvCellValue)) {\n    return 'true';\n  }\n};\n\nvar _reformatValue = function _reformatValue(csvCellValue, colTypes) {\n  if (colTypes && colTypes.includes('bool')) {\n    return _reformatBoolValue(csvCellValue);\n  }\n\n  return csvCellValue;\n};\n\nvar _buildCols = function _buildCols(header) {\n  return header.map(function (col) {\n    return {\n      field: col\n    };\n  });\n};\n\nvar _calculateEmptyCols = function _calculateEmptyCols(cols) {\n  return cols.map(function (_, index) {\n    return index;\n  }).filter(function (colIndex) {\n    var _cols$colIndex$cellEd;\n\n    return (_cols$colIndex$cellEd = cols[colIndex].cellEditorParams) === null || _cols$colIndex$cellEd === void 0 ? void 0 : _cols$colIndex$cellEd.acceptsEmptyFields;\n  });\n};\n\nvar _processTableToTransformNonAcceptableEmptyCols = function _processTableToTransformNonAcceptableEmptyCols(lines, emptyCols) {\n  return lines.map(function (line) {\n    return line.map(function (cell, index) {\n      return cell === '' && !emptyCols.includes(index) ? undefined : cell;\n    });\n  });\n};\n\nvar _buildRows = function _buildRows(rows, hasHeader, cols) {\n  var formattedData = [];\n  var startIndex = hasHeader ? 1 : 0;\n\n  for (var rowIndex = startIndex; rowIndex < rows.length; rowIndex++) {\n    var row = {};\n\n    for (var colIndex = 0; colIndex < cols.length; colIndex++) {\n      var csvCellValue = rows[rowIndex][colIndex];\n      row[cols[colIndex].field] = _reformatValue(csvCellValue, cols[colIndex].type);\n    }\n\n    formattedData.push(row);\n  }\n\n  return formattedData;\n};\n\nvar fromCSV = function fromCSV(dataStr) {\n  var hasHeader = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var cols = arguments.length > 2 ? arguments[2] : undefined;\n  var options = arguments.length > 3 ? arguments[3] : undefined;\n\n  if (!hasHeader && !cols) {\n    return {\n      error: [new Error$1('cols must be defined if hasHeader=false', null, null)]\n    };\n  }\n\n  if (!dataStr || dataStr.length === 0) {\n    return {\n      cols: [],\n      rows: []\n    };\n  }\n\n  var rows = [];\n  var csvLines;\n\n  var emptyCols = _calculateEmptyCols(cols);\n\n  try {\n    csvLines = _processTableToTransformNonAcceptableEmptyCols(CSVUtils.read(dataStr), emptyCols);\n  } catch (err) {\n    return {\n      error: [err]\n    };\n  }\n\n  if (!cols) {\n    cols = _buildCols(csvLines[0]);\n  }\n\n  var errors = _validateFormat(csvLines, hasHeader, cols, options);\n\n  if (errors.length > 0) return {\n    error: errors\n  };\n  rows = _buildRows(csvLines, hasHeader, cols);\n  return {\n    cols: cols,\n    rows: rows\n  };\n};\n\nvar _generateHeader = function _generateHeader(cols) {\n  var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n  return cols.map(function (col) {\n    return col.field;\n  }).join(separator);\n};\n\nvar _generateRow = function _generateRow(row, cols) {\n  var separator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ',';\n  return cols.map(function (col) {\n    return row[col.field];\n  }).join(separator);\n};\n\nvar _generateRows = function _generateRows(rows, cols) {\n  var colSep = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : ',';\n  var rowSep = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '\\n';\n  return rows.map(function (row) {\n    return _generateRow(row, cols, colSep);\n  }).join(rowSep);\n};\n\nvar toCSV = function toCSV(rows, cols, options) {\n  if (cols == null || cols.length === 0) {\n    return {\n      error: [\"Cols must be defined\"]\n    };\n  }\n\n  if (!rows) {\n    rows = [];\n  }\n\n  options = _objectSpread2(_objectSpread2({}, DEFAULT_CSV_EXPORT_OPTIONS), options);\n\n  var rowsStr = _generateRows(rows, cols, options.colSep, options.rowSep);\n\n  var header = '';\n\n  if (options.writeHeader) {\n    header = _generateHeader(cols);\n\n    if (rowsStr.length > 0) {\n      header = header.concat(options.rowSep);\n    }\n  }\n\n  return header.concat(rowsStr);\n};\n\nvar fromXLSX = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(fileBlob) {\n    var hasHeader,\n        cols,\n        options,\n        rows,\n        xlsxLines,\n        emptyCols,\n        errors,\n        _args2 = arguments;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            hasHeader = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : true;\n            cols = _args2.length > 2 ? _args2[2] : undefined;\n            options = _args2.length > 3 ? _args2[3] : undefined;\n\n            if (!(!hasHeader && !cols)) {\n              _context2.next = 5;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", {\n              error: [new Error$1('cols must be defined if hasHeader=false', null, null)]\n            });\n\n          case 5:\n            if (fileBlob) {\n              _context2.next = 7;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", {\n              cols: [],\n              rows: []\n            });\n\n          case 7:\n            rows = [];\n            emptyCols = _calculateEmptyCols(cols);\n            _context2.prev = 9;\n            _context2.next = 12;\n            return XLSXUtils.read(fileBlob, true, emptyCols.length > 0);\n\n          case 12:\n            xlsxLines = _context2.sent;\n            if (emptyCols.length > 0) xlsxLines = _processTableToTransformNonAcceptableEmptyCols(xlsxLines, emptyCols);\n            _context2.next = 19;\n            break;\n\n          case 16:\n            _context2.prev = 16;\n            _context2.t0 = _context2[\"catch\"](9);\n            return _context2.abrupt(\"return\", {\n              error: [new Error$1((_context2.t0 === null || _context2.t0 === void 0 ? void 0 : _context2.t0.message) || _context2.t0, fileBlob.name, (_context2.t0 === null || _context2.t0 === void 0 ? void 0 : _context2.t0.stack) || null)]\n            });\n\n          case 19:\n            if (!cols) {\n              cols = _buildCols(xlsxLines[0]);\n            }\n\n            errors = _validateFormat(xlsxLines, hasHeader, cols, options);\n\n            if (!(errors.length > 0)) {\n              _context2.next = 23;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", {\n              error: errors\n            });\n\n          case 23:\n            rows = _buildRows(xlsxLines, hasHeader, cols);\n            return _context2.abrupt(\"return\", {\n              cols: cols,\n              rows: rows\n            });\n\n          case 25:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[9, 16]]);\n  }));\n\n  return function fromXLSX(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar AgGridUtils = {\n  fromCSV: fromCSV,\n  fromXLSX: fromXLSX,\n  toCSV: toCSV\n};\n\nvar fileDownload = function fileDownload(data, filename, mime, bom) {\n  var blobData = typeof bom !== 'undefined' ? [bom, data] : [data];\n  var blob = new Blob(blobData, {\n    type: mime || 'application/octet-stream'\n  });\n\n  if (typeof window.navigator.msSaveBlob !== 'undefined') {\n    // IE workaround for \"HTML7007: One or more blob URLs were\n    // revoked by closing the blob for which they were created.\n    // These URLs will no longer resolve as the data backing\n    // the URL has been freed.\"\n    window.navigator.msSaveBlob(blob, filename);\n  } else {\n    var blobURL = window.URL && window.URL.createObjectURL ? window.URL.createObjectURL(blob) : window.webkitURL.createObjectURL(blob);\n    var tempLink = document.createElement('a');\n    tempLink.style.display = 'none';\n    tempLink.href = blobURL;\n    tempLink.setAttribute('download', filename); // Safari thinks _blank anchor are pop ups. We only want to set _blank\n    // target if the browser does not support the HTML5 download attribute.\n    // This allows you to download files in desktop safari if pop up blocking\n    // is enabled.\n\n    if (typeof tempLink.download === 'undefined') {\n      tempLink.setAttribute('target', '_blank');\n    }\n\n    document.body.appendChild(tempLink);\n    tempLink.click(); // Fixes \"webkit blob resource error 1\"\n\n    setTimeout(function () {\n      document.body.removeChild(tempLink);\n      window.URL.revokeObjectURL(blobURL);\n    }, 200);\n  }\n}; // Copyright (c) Cosmo Tech.\n\n\nfunction downloadFileFromData(fileData, fileName) {\n  fileDownload(fileData, fileName);\n}\n\nfunction readFileBlobAsync(fileBlob) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      resolve(reader.result);\n    };\n\n    reader.onerror = reject;\n    reader.readAsText(fileBlob);\n  });\n}\n\nvar FileBlobUtils = {\n  downloadFileFromData: downloadFileFromData,\n  readFileBlobAsync: readFileBlobAsync\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n\nvar getBaseNameFromFileName = function getBaseNameFromFileName(fileName) {\n  if (fileName.indexOf('.') === -1) {\n    return fileName;\n  }\n\n  var nameParts = fileName.split('.');\n  var extension = nameParts.pop();\n  var baseName = nameParts.join('.');\n\n  if (extension.length === 0 || baseName.length === 0) {\n    return fileName;\n  }\n\n  return baseName;\n};\n\nvar getExtensionFromFileName = function getExtensionFromFileName(fileName) {\n  if (fileName.indexOf('.') === -1) {\n    return '';\n  }\n\n  var nameParts = fileName.split('.');\n  var extension = nameParts.pop();\n  var baseName = nameParts.join('.');\n\n  if (extension.length === 0 || baseName.length === 0) {\n    return '';\n  }\n\n  return extension;\n};\n\nvar PathUtils = {\n  getBaseNameFromFileName: getBaseNameFromFileName,\n  getExtensionFromFileName: getExtensionFromFileName\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n// Functions to read & write from storage.\n// Notes : local storage works on Chromium but not on Firefox if \"Delete\n// cookies and site data when Firefox is closed\" is selected (for more\n// details, see https://bugzilla.mozilla.org/show_bug.cgi?id=1453699)\n\nfunction writeToStorage(key, value) {\n  localStorage.setItem(key, value);\n}\n\nfunction readFromStorage(key) {\n  return localStorage.getItem(key);\n}\n\nfunction clearFromStorage(key) {\n  localStorage.removeItem(key);\n} // Currently selected provider\n\n\nvar currentProvider; // Dict of registered providers\n\nvar providers = {}; // List of callbacks to call on authentication data change\n\nvar onAuthChangeCallbacks = [];\n\nfunction addProvider(newProvider) {\n  // Check that provider name is defined\n  if (newProvider.name === undefined) {\n    console.error('Trying to add a provider without name. Please make sure ' + 'that the provider name is defined and exported.');\n    return null;\n  } else if (providers[newProvider.name] !== undefined) {\n    // Do nothing if provider already exists\n    console.warn('Provider \"' + newProvider.name + '\" already exists');\n  } else {\n    // Otherwise, store new provider\n    providers[newProvider.name] = newProvider;\n  }\n\n  return providers[newProvider.name];\n}\n\nfunction setProvider(providerName) {\n  // Set new provider if it exists\n  if (providers[providerName] === undefined) {\n    console.error('Provider \"' + providerName + '\" does not exist, you have ' + 'to register authentication providers with \"addProvider\" function ' + 'before using them');\n    currentProvider = undefined;\n  } else {\n    currentProvider = providers[providerName]; // Update callbacks for the new provider\n\n    if (currentProvider.setAuthChangeCallbacks) {\n      currentProvider.setAuthChangeCallbacks(onAuthChangeCallbacks);\n    } // Store the provider used in local storage\n\n\n    writeToStorage('authProvider', providerName);\n  }\n} // If no provider is currently selected but local storage has the information\n// of a provider used (in another tab or before a page refresh, for instance),\n// this provider will be selected\n\n\nfunction initProviderIfNull() {\n  if (currentProvider === undefined) {\n    var newProviderName = readFromStorage('authProvider');\n\n    if (newProviderName !== undefined && newProviderName !== null) {\n      setProvider(newProviderName);\n    }\n  }\n}\n\nfunction signIn$1() {\n  return currentProvider.signIn();\n}\n\nfunction signOut$1() {\n  initProviderIfNull(); // Clear last auth provider used from local storage\n\n  clearFromStorage('authProvider');\n  return currentProvider.signOut();\n}\n\nfunction onAuthStateChanged(newCallback) {\n  onAuthChangeCallbacks.push(newCallback);\n}\n\nfunction isAsync$1() {\n  initProviderIfNull();\n\n  if (currentProvider && currentProvider.isAsync) {\n    return currentProvider.isAsync();\n  }\n\n  return false;\n}\n\nfunction acquireTokens$1(callback) {\n  initProviderIfNull();\n\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.acquireTokens(callback);\n}\n\nfunction acquireTokensByRequest$1(tokenReq) {\n  initProviderIfNull();\n\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.acquireTokensByRequest(tokenReq);\n}\n\nfunction isUserSignedIn$1(callback) {\n  initProviderIfNull();\n\n  if (currentProvider === undefined) {\n    return false;\n  }\n\n  return currentProvider.isUserSignedIn(callback);\n}\n\nfunction getUserName$1() {\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.getUserName();\n}\n\nfunction getUserRoles$1() {\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.getUserRoles();\n}\n\nfunction getUserId$1() {\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.getUserId();\n}\n\nfunction getUserPicUrl$1() {\n  if (currentProvider === undefined) {\n    return undefined;\n  }\n\n  return currentProvider.getUserPicUrl();\n}\n\nvar Auth = {\n  addProvider: addProvider,\n  setProvider: setProvider,\n  signIn: signIn$1,\n  signOut: signOut$1,\n  onAuthStateChanged: onAuthStateChanged,\n  isUserSignedIn: isUserSignedIn$1,\n  getUserName: getUserName$1,\n  getUserId: getUserId$1,\n  getUserRoles: getUserRoles$1,\n  getUserPicUrl: getUserPicUrl$1,\n  isAsync: isAsync$1,\n  acquireTokens: acquireTokens$1,\n  acquireTokensByRequest: acquireTokensByRequest$1\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n\nvar name = 'auth-dev';\nvar authData = null;\n\nfunction setDefaultUser() {\n  authData = {\n    userId: 1,\n    userName: 'le dev',\n    roles: ['Organization.User']\n  };\n}\n\nfunction signIn() {\n  setDefaultUser();\n  window.location.href = '/';\n}\n\nfunction signOut() {\n  window.location.href = '/';\n}\n\nfunction isAsync() {\n  return false;\n}\n\nfunction isUserSignedIn() {\n  setDefaultUser();\n  return true;\n}\n\nfunction getUserName() {\n  if (authData) {\n    return authData.userName;\n  }\n\n  return undefined;\n}\n\nfunction acquireTokens() {\n  return undefined;\n}\n\nfunction acquireTokensByRequest(tokenReq) {\n  return undefined;\n}\n\nfunction getUserId() {\n  if (authData) {\n    return authData.userId;\n  }\n\n  return undefined;\n}\n\nfunction getUserRoles() {\n  if (authData) {\n    return authData.roles;\n  }\n\n  return undefined;\n}\n\nfunction getUserPicUrl() {\n  return undefined;\n}\n\nvar AuthDev = {\n  name: name,\n  signIn: signIn,\n  signOut: signOut,\n  isUserSignedIn: isUserSignedIn,\n  getUserName: getUserName,\n  getUserRoles: getUserRoles,\n  getUserId: getUserId,\n  getUserPicUrl: getUserPicUrl,\n  isAsync: isAsync,\n  acquireTokens: acquireTokens,\n  acquireTokensByRequest: acquireTokensByRequest\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n\nvar getDatasetNames = function getDatasetNames(datasets, scenarioDatasets) {\n  if (!scenarioDatasets || !datasets) {\n    return '';\n  }\n\n  var names = [];\n\n  var _loop = function _loop(datasetId) {\n    var dataset = datasets.find(function (el) {\n      return el.id === datasetId;\n    });\n\n    if (dataset) {\n      names.push(dataset.name);\n    }\n  };\n\n  var _iterator2 = _createForOfIteratorHelper2(scenarioDatasets),\n      _step2;\n\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var datasetId = _step2.value;\n\n      _loop(datasetId);\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n\n  return names.join(', ');\n};\n\nvar DatasetUtils = {\n  getDatasetNames: getDatasetNames\n}; // Copyright (c) Cosmo Tech.\n// Licensed under the MIT license.\n\nvar scenarioExistsInList = function scenarioExistsInList(scenarioName, scenarioList) {\n  scenarioName = scenarioName.trim();\n  return scenarioList.find(function (scenario) {\n    return scenario.name.trim() === scenarioName;\n  }) !== undefined;\n};\n\nvar scenarioExistsInTree = function scenarioExistsInTree(scenarioName, scenarioTree) {\n  var treeSearch = function treeSearch(node) {\n    var _iterator3 = _createForOfIteratorHelper2(node),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var scenario = _step3.value;\n\n        if (scenarioName.trim() === scenario.name.trim() || treeSearch(scenario.children)) {\n          return true;\n        }\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n\n    return false;\n  };\n\n  return treeSearch(scenarioTree);\n};\n\nvar getScenarioTree = function getScenarioTree(scenarioList, compareFn) {\n  var scenarioTree = []; // Sort scenario list based on optional user-defined function\n\n  scenarioList.sort(compareFn); // Set master & orphan scenarios as root scenarios, and add all their children\n\n  var _loop = function _loop(parentScenario) {\n    if (!parentScenario.parentId || scenarioList.find(function (grandParent) {\n      return grandParent.id === parentScenario.parentId;\n    }) === undefined) {\n      scenarioTree.push(parentScenario);\n    }\n\n    parentScenario.children = [];\n\n    var _iterator4 = _createForOfIteratorHelper2(scenarioList),\n        _step4;\n\n    try {\n      for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n        var childScenario = _step4.value;\n\n        if (childScenario.parentId === parentScenario.id) {\n          parentScenario.children.push(childScenario);\n        }\n      }\n    } catch (err) {\n      _iterator4.e(err);\n    } finally {\n      _iterator4.f();\n    }\n  };\n\n  var _iterator5 = _createForOfIteratorHelper2(scenarioList),\n      _step5;\n\n  try {\n    for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n      var parentScenario = _step5.value;\n\n      _loop(parentScenario);\n    }\n  } catch (err) {\n    _iterator5.e(err);\n  } finally {\n    _iterator5.f();\n  }\n\n  return scenarioTree;\n};\n\nfunction countScenariosInTree(treeData) {\n  if (!treeData) {\n    return 0;\n  }\n\n  var count = treeData.length;\n\n  var _iterator6 = _createForOfIteratorHelper2(treeData),\n      _step6;\n\n  try {\n    for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n      var node = _step6.value;\n      count += countScenariosInTree(node.children);\n    }\n  } catch (err) {\n    _iterator6.e(err);\n  } finally {\n    _iterator6.f();\n  }\n\n  return count;\n}\n\nvar ScenarioUtils = {\n  scenarioExistsInList: scenarioExistsInList,\n  scenarioExistsInTree: scenarioExistsInTree,\n  getScenarioTree: getScenarioTree,\n  countScenariosInTree: countScenariosInTree\n};\nexport { AgGridUtils, Auth, AuthDev, CSVUtils, DatasetUtils, DateUtils, Error$1 as Error, FileBlobUtils, PathUtils, ScenarioUtils, ValidationUtils, XLSXUtils };"],"sourceRoot":""}